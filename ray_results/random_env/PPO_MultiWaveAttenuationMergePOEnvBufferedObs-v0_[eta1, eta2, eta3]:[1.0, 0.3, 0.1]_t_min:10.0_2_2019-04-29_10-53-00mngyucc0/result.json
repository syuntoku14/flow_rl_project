{"timesteps_this_iter": 124117, "timestamp": 1556535272, "episode_len_mean": 651.6428571428571, "timesteps_since_restore": 124117, "time_since_restore": 42.51547431945801, "done": false, "custom_metrics": {"outflow_rate_min": 456.6361027034545, "outflow_rate_mean": 595.6353384593252, "cost2_mean": -40.24000584735209, "outflow_rate_max": 697.0058530340398, "system_level_velocity_min": 6.4954248820670815, "cost2_max": -16.160499821477252, "cost2_min": -51.54838377111284, "system_level_velocity_mean": 8.503639191041367, "cost1_min": 15.047417006722426, "cost1_max": 223.20646068339002, "cost1_mean": 188.59966423818406, "system_level_velocity_max": 16.507237974586896}, "timesteps_total": 124117, "training_iteration": 1, "date": "2019-04-29_10-54-32", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63c50>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 1, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 244.9520331770449, "time_total_s": 42.51547431945801, "info": {"grad_time_ms": 27175.4, "default": {"total_loss": 1.1836763620376587, "kl": 0.0013177241198718548, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005752602592110634, "vf_loss": 1.183988094329834, "entropy": 1.419002652168274, "vf_explained_var": 0.8620601892471313, "cur_kl_coeff": 0.20000003278255463}, "num_steps_trained": 124117, "load_time_ms": 63.52, "update_time_ms": 422.173, "sample_time_ms": 14579.417, "num_steps_sampled": 124117}, "episode_reward_max": 335.1530425382448, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 26.120602725801536, "episodes_total": 14, "episodes_this_iter": 14, "time_this_iter_s": 42.51547431945801, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 117880, "timestamp": 1556535314, "episode_len_mean": 691.0921052631579, "timesteps_since_restore": 241997, "time_since_restore": 84.19805788993835, "done": false, "custom_metrics": {"outflow_rate_min": 280.57506274539907, "outflow_rate_mean": 589.5303896445103, "cost2_mean": -54.440937175830555, "outflow_rate_max": 745.066713651163, "system_level_velocity_min": 2.6645693408082263, "cost2_max": -16.160499821477252, "cost2_min": -111.33532395804822, "system_level_velocity_mean": 7.556141845936573, "cost1_min": 15.047417006722426, "cost1_max": 241.027491904475, "cost1_mean": 189.95928550720546, "system_level_velocity_max": 16.507237974586896}, "timesteps_total": 241997, "training_iteration": 2, "date": "2019-04-29_10-55-14", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dd68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcc0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 2, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 297.30285936503026, "time_total_s": 84.19805788993835, "info": {"grad_time_ms": 26794.909, "default": {"total_loss": 1.1139497756958008, "kl": 0.009660357609391212, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003728680545464158, "vf_loss": 1.1167124509811401, "entropy": 1.421420931816101, "vf_explained_var": 0.8976237177848816, "cur_kl_coeff": 0.10000001639127731}, "num_steps_trained": 241997, "load_time_ms": 44.154, "update_time_ms": 216.317, "sample_time_ms": 14790.761, "num_steps_sampled": 241997}, "episode_reward_max": 419.7502740616512, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 26.120602725801536, "episodes_total": 76, "episodes_this_iter": 62, "time_this_iter_s": 41.68258357048035, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109075, "timestamp": 1556535355, "episode_len_mean": 693.47, "timesteps_since_restore": 351072, "time_since_restore": 124.91079473495483, "done": false, "custom_metrics": {"outflow_rate_min": 288.0955320354691, "outflow_rate_mean": 603.606460103111, "cost2_mean": -51.974543235523946, "outflow_rate_max": 798.6064461552395, "system_level_velocity_min": 2.935666267888866, "cost2_max": -18.88543440514236, "cost2_min": -89.32565200753749, "system_level_velocity_mean": 7.74547362671186, "cost1_min": 29.157164111788617, "cost1_max": 290.01153645327406, "cost1_mean": 195.97900375010576, "system_level_velocity_max": 17.32040755591717}, "timesteps_total": 351072, "training_iteration": 3, "date": "2019-04-29_10-55-55", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d637f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 3, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 320.0782737502289, "time_total_s": 124.91079473495483, "info": {"grad_time_ms": 26285.099, "default": {"total_loss": 1.7756513357162476, "kl": 0.01236084382981062, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0072659337893128395, "vf_loss": 1.7816812992095947, "entropy": 1.4129788875579834, "vf_explained_var": 0.9238896369934082, "cur_kl_coeff": 0.10000001639127731}, "num_steps_trained": 351072, "load_time_ms": 34.528, "update_time_ms": 147.68, "sample_time_ms": 14939.92, "num_steps_sampled": 351072}, "episode_reward_max": 484.19093684115387, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 50.01772727282872, "episodes_total": 135, "episodes_this_iter": 59, "time_this_iter_s": 40.71273684501648, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106250, "timestamp": 1556535394, "episode_len_mean": 686.86, "timesteps_since_restore": 457322, "time_since_restore": 163.8964409828186, "done": false, "custom_metrics": {"outflow_rate_min": 481.68213577766505, "outflow_rate_mean": 656.7028277897257, "cost2_mean": -48.2469116207118, "outflow_rate_max": 928.3203575376731, "system_level_velocity_min": 5.646645931164659, "cost2_max": -18.88543440514236, "cost2_min": -104.64101198464209, "system_level_velocity_mean": 9.082736476192355, "cost1_min": 25.625327363520107, "cost1_max": 312.54509360412806, "cost1_mean": 225.18106558181253, "system_level_velocity_max": 17.820459265267374}, "timesteps_total": 457322, "training_iteration": 4, "date": "2019-04-29_10-56-34", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 4, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 382.1459762247167, "time_total_s": 163.8964409828186, "info": {"grad_time_ms": 25655.068, "default": {"total_loss": 3.8277125358581543, "kl": 0.0137545270845294, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00863440427929163, "vf_loss": 3.8349714279174805, "entropy": 1.3870340585708618, "vf_explained_var": 0.8628243207931519, "cur_kl_coeff": 0.10000001639127731}, "num_steps_trained": 457322, "load_time_ms": 30.152, "update_time_ms": 112.992, "sample_time_ms": 14957.357, "num_steps_sampled": 457322}, "episode_reward_max": 706.8819885352434, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 47.059625021786445, "episodes_total": 204, "episodes_this_iter": 69, "time_this_iter_s": 38.98564624786377, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109370, "timestamp": 1556535433, "episode_len_mean": 693.29, "timesteps_since_restore": 566692, "time_since_restore": 202.8864905834198, "done": false, "custom_metrics": {"outflow_rate_min": 489.846591981012, "outflow_rate_mean": 707.7400486636773, "cost2_mean": -48.390053274733, "outflow_rate_max": 956.042388356525, "system_level_velocity_min": 7.540402105337238, "cost2_max": -18.365628192718614, "cost2_min": -105.1775339364149, "system_level_velocity_mean": 9.796112170731043, "cost1_min": 19.094268535039987, "cost1_max": 326.695010048697, "cost1_mean": 248.57245352351245, "system_level_velocity_max": 17.866193557515437}, "timesteps_total": 566692, "training_iteration": 5, "date": "2019-04-29_10-57-13", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63390>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 5, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 458.2651069134856, "time_total_s": 202.8864905834198, "info": {"grad_time_ms": 25341.335, "default": {"total_loss": 4.530018329620361, "kl": 0.01547142956405878, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008738677017390728, "vf_loss": 4.537209510803223, "entropy": 1.38351571559906, "vf_explained_var": 0.8711726665496826, "cur_kl_coeff": 0.10000000894069672}, "num_steps_trained": 566692, "load_time_ms": 28.923, "update_time_ms": 92.819, "sample_time_ms": 14900.743, "num_steps_sampled": 566692}, "episode_reward_max": 732.4798670063531, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 35.64918016162099, "episodes_total": 265, "episodes_this_iter": 61, "time_this_iter_s": 38.990049600601196, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109639, "timestamp": 1556535470, "episode_len_mean": 693.29, "timesteps_since_restore": 676331, "time_since_restore": 239.89223408699036, "done": false, "custom_metrics": {"outflow_rate_min": 459.6155625367306, "outflow_rate_mean": 738.5969599160794, "cost2_mean": -50.03280366343816, "outflow_rate_max": 977.9164809579577, "system_level_velocity_min": 4.051812049099513, "cost2_max": -18.365628192718614, "cost2_min": -105.1775339364149, "system_level_velocity_mean": 9.867235858746115, "cost1_min": 19.094268535039987, "cost1_max": 336.7322599486372, "cost1_mean": 252.78763926698934, "system_level_velocity_max": 17.866193557515437}, "timesteps_total": 676331, "training_iteration": 6, "date": "2019-04-29_10-57-50", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 6, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 519.8854939502672, "time_total_s": 239.89223408699036, "info": {"grad_time_ms": 24678.484, "default": {"total_loss": 6.350063323974609, "kl": 0.014132259413599968, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0077543058432638645, "vf_loss": 6.3564043045043945, "entropy": 1.3760489225387573, "vf_explained_var": 0.803566038608551, "cur_kl_coeff": 0.10000000894069672}, "num_steps_trained": 676331, "load_time_ms": 28.037, "update_time_ms": 79.072, "sample_time_ms": 14984.046, "num_steps_sampled": 676331}, "episode_reward_max": 808.7300259615566, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 35.64918016162099, "episodes_total": 336, "episodes_this_iter": 71, "time_this_iter_s": 37.00574350357056, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111216, "timestamp": 1556535510, "episode_len_mean": 700.0, "timesteps_since_restore": 787547, "time_since_restore": 279.7467768192291, "done": false, "custom_metrics": {"outflow_rate_min": 459.6155625367306, "outflow_rate_mean": 762.8272282348964, "cost2_mean": -50.9152280372419, "outflow_rate_max": 961.7844505738648, "system_level_velocity_min": 4.051812049099513, "cost2_max": -25.123566446171058, "cost2_min": -90.11875150265706, "system_level_velocity_mean": 9.896474809980806, "cost1_min": 103.06913316961263, "cost1_max": 327.6623497632555, "cost1_mean": 259.09298498039936, "system_level_velocity_max": 12.456841378759341}, "timesteps_total": 787547, "training_iteration": 7, "date": "2019-04-29_10-58-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d639e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63128>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 7, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 573.46717135082, "time_total_s": 279.7467768192291, "info": {"grad_time_ms": 24683.958, "default": {"total_loss": 6.203438758850098, "kl": 0.016638752073049545, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008097839541733265, "vf_loss": 6.209873199462891, "entropy": 1.3807215690612793, "vf_explained_var": 0.7974483370780945, "cur_kl_coeff": 0.10000000894069672}, "num_steps_trained": 787547, "load_time_ms": 27.319, "update_time_ms": 69.177, "sample_time_ms": 14969.871, "num_steps_sampled": 787547}, "episode_reward_max": 794.4746144617911, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 320.19079832773923, "episodes_total": 395, "episodes_this_iter": 59, "time_this_iter_s": 39.85454273223877, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112857, "timestamp": 1556535550, "episode_len_mean": 700.0, "timesteps_since_restore": 900404, "time_since_restore": 320.1337957382202, "done": false, "custom_metrics": {"outflow_rate_min": 554.8551094109325, "outflow_rate_mean": 772.7322015641498, "cost2_mean": -50.45312702586976, "outflow_rate_max": 972.7278314056565, "system_level_velocity_min": 6.218280588461497, "cost2_max": -25.851195714646174, "cost2_min": -95.4067473667549, "system_level_velocity_mean": 10.058834280914104, "cost1_min": 159.16041667499894, "cost1_max": 339.7195452732914, "cost1_mean": 263.7526598746482, "system_level_velocity_max": 12.89457647433318}, "timesteps_total": 900404, "training_iteration": 8, "date": "2019-04-29_10-59-10", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 8, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 596.0456318733229, "time_total_s": 320.1337957382202, "info": {"grad_time_ms": 24685.159, "default": {"total_loss": 6.804519176483154, "kl": 0.017063932493329048, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008656739257276058, "vf_loss": 6.811469078063965, "entropy": 1.37730872631073, "vf_explained_var": 0.8045685887336731, "cur_kl_coeff": 0.10000001639127731}, "num_steps_trained": 900404, "load_time_ms": 25.585, "update_time_ms": 61.915, "sample_time_ms": 15030.654, "num_steps_sampled": 900404}, "episode_reward_max": 817.9298820843677, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 360.9743938238283, "episodes_total": 455, "episodes_this_iter": 60, "time_this_iter_s": 40.38701891899109, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113268, "timestamp": 1556535590, "episode_len_mean": 700.0, "timesteps_since_restore": 1013672, "time_since_restore": 359.862282037735, "done": false, "custom_metrics": {"outflow_rate_min": 403.4083677758286, "outflow_rate_mean": 764.5801801303425, "cost2_mean": -48.310047549603496, "outflow_rate_max": 960.8382632250662, "system_level_velocity_min": 5.711535764769458, "cost2_max": -25.851195714646174, "cost2_min": -95.4067473667549, "system_level_velocity_mean": 9.911608598550822, "cost1_min": 150.81339462665693, "cost1_max": 324.59830210993016, "cost1_mean": 260.41343345141775, "system_level_velocity_max": 12.278547110942803}, "timesteps_total": 1013672, "training_iteration": 9, "date": "2019-04-29_10-59-50", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d635c0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 9, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 587.9288341407406, "time_total_s": 359.862282037735, "info": {"grad_time_ms": 24535.03, "default": {"total_loss": 7.058897495269775, "kl": 0.0241314098238945, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010542521253228188, "vf_loss": 7.067026615142822, "entropy": 1.395256757736206, "vf_explained_var": 0.8554511666297913, "cur_kl_coeff": 0.10000001639127731}, "num_steps_trained": 1013672, "load_time_ms": 24.412, "update_time_ms": 56.323, "sample_time_ms": 15158.434, "num_steps_sampled": 1013672}, "episode_reward_max": 836.5516531574085, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 379.9996051269203, "episodes_total": 513, "episodes_this_iter": 58, "time_this_iter_s": 39.72848629951477, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112970, "timestamp": 1556535630, "episode_len_mean": 700.0, "timesteps_since_restore": 1126642, "time_since_restore": 399.71641063690186, "done": false, "custom_metrics": {"outflow_rate_min": 458.24178076047394, "outflow_rate_mean": 776.6729962487859, "cost2_mean": -49.274359728977444, "outflow_rate_max": 970.2163688108325, "system_level_velocity_min": 5.72765823499198, "cost2_max": -25.854109709702822, "cost2_min": -89.26893868144016, "system_level_velocity_mean": 10.095477518337942, "cost1_min": 149.79126087083296, "cost1_max": 328.9242552064331, "cost1_mean": 265.5443143971802, "system_level_velocity_max": 12.379011926049474}, "timesteps_total": 1126642, "training_iteration": 10, "date": "2019-04-29_11-00-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dbe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d6d8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 10, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 595.590973804511, "time_total_s": 399.71641063690186, "info": {"grad_time_ms": 24480.228, "default": {"total_loss": 8.12566089630127, "kl": 0.01635848544538021, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00900333747267723, "vf_loss": 8.132209777832031, "entropy": 1.3872183561325073, "vf_explained_var": 0.8253870010375977, "cur_kl_coeff": 0.14999999105930328}, "num_steps_trained": 1126642, "load_time_ms": 23.387, "update_time_ms": 51.611, "sample_time_ms": 15205.841, "num_steps_sampled": 1126642}, "episode_reward_max": 797.2649808568066, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 410.7360278279933, "episodes_total": 571, "episodes_this_iter": 58, "time_this_iter_s": 39.85412859916687, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109475, "timestamp": 1556535672, "episode_len_mean": 700.0, "timesteps_since_restore": 1236117, "time_since_restore": 442.0817964076996, "done": false, "custom_metrics": {"outflow_rate_min": 458.24178076047394, "outflow_rate_mean": 788.156617374081, "cost2_mean": -49.08082253032826, "outflow_rate_max": 992.6527555021968, "system_level_velocity_min": 5.72765823499198, "cost2_max": -14.669766496436273, "cost2_min": -98.60149846260761, "system_level_velocity_mean": 10.415564947840704, "cost1_min": 149.79126087083296, "cost1_max": 337.98634721216206, "cost1_mean": 273.24616139236673, "system_level_velocity_max": 12.791743433795236}, "timesteps_total": 1236117, "training_iteration": 11, "date": "2019-04-29_11-01-12", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d639b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d412e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 11, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 603.5451311432544, "time_total_s": 442.0817964076996, "info": {"grad_time_ms": 24431.556, "default": {"total_loss": 8.358133316040039, "kl": 0.015228797681629658, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009579986333847046, "vf_loss": 8.365428924560547, "entropy": 1.3630599975585938, "vf_explained_var": 0.8087565302848816, "cur_kl_coeff": 0.1499999761581421}, "num_steps_trained": 1236117, "load_time_ms": 19.435, "update_time_ms": 10.557, "sample_time_ms": 15289.439, "num_steps_sampled": 1236117}, "episode_reward_max": 824.520871507904, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 334.87771875871044, "episodes_total": 631, "episodes_this_iter": 60, "time_this_iter_s": 42.36538577079773, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108081, "timestamp": 1556535712, "episode_len_mean": 700.0, "timesteps_since_restore": 1344198, "time_since_restore": 481.4117851257324, "done": false, "custom_metrics": {"outflow_rate_min": 543.0847012569022, "outflow_rate_mean": 806.7085663646947, "cost2_mean": -48.67931609236428, "outflow_rate_max": 1002.683124754424, "system_level_velocity_min": 6.564118358138585, "cost2_max": -14.669766496436273, "cost2_min": -91.32631883886964, "system_level_velocity_mean": 10.702274749719363, "cost1_min": 173.34070000876642, "cost1_max": 351.07296061162924, "cost1_mean": 280.9498476961886, "system_level_velocity_max": 13.38392238332498}, "timesteps_total": 1344198, "training_iteration": 12, "date": "2019-04-29_11-01-52", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d9b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 12, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 629.9521601394831, "time_total_s": 481.4117851257324, "info": {"grad_time_ms": 24136.091, "default": {"total_loss": 9.770442008972168, "kl": 0.01678508333861828, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010037307627499104, "vf_loss": 9.777961730957031, "entropy": 1.3681566715240479, "vf_explained_var": 0.7534148097038269, "cur_kl_coeff": 0.14999999105930328}, "num_steps_trained": 1344198, "load_time_ms": 19.241, "update_time_ms": 10.852, "sample_time_ms": 15354.016, "num_steps_sampled": 1344198}, "episode_reward_max": 826.1038273696176, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 334.87771875871044, "episodes_total": 694, "episodes_this_iter": 63, "time_this_iter_s": 39.32998871803284, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108553, "timestamp": 1556535750, "episode_len_mean": 693.35, "timesteps_since_restore": 1452751, "time_since_restore": 519.8177542686462, "done": false, "custom_metrics": {"outflow_rate_min": 497.3183773671225, "outflow_rate_mean": 818.2323201406593, "cost2_mean": -47.55011314208652, "outflow_rate_max": 1017.368070522354, "system_level_velocity_min": 7.846146151146339, "cost2_max": -16.726192787650874, "cost2_min": -99.72190551925857, "system_level_velocity_mean": 11.15474599288892, "cost1_min": 22.119073365669514, "cost1_max": 355.7126302930071, "cost1_mean": 288.7613289241246, "system_level_velocity_max": 17.095704264422164}, "timesteps_total": 1452751, "training_iteration": 13, "date": "2019-04-29_11-02-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d636a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 13, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 636.2596509153044, "time_total_s": 519.8177542686462, "info": {"grad_time_ms": 23901.412, "default": {"total_loss": 10.022988319396973, "kl": 0.019089218229055405, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011210870929062366, "vf_loss": 10.03133487701416, "entropy": 1.3824336528778076, "vf_explained_var": 0.7877975106239319, "cur_kl_coeff": 0.14999999105930328}, "num_steps_trained": 1452751, "load_time_ms": 19.213, "update_time_ms": 10.816, "sample_time_ms": 15353.211, "num_steps_sampled": 1452751}, "episode_reward_max": 836.9874945259617, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 41.56879029659421, "episodes_total": 756, "episodes_this_iter": 62, "time_this_iter_s": 38.40596914291382, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107272, "timestamp": 1556535788, "episode_len_mean": 693.35, "timesteps_since_restore": 1560023, "time_since_restore": 557.6440215110779, "done": false, "custom_metrics": {"outflow_rate_min": 497.3183773671225, "outflow_rate_mean": 825.966375413922, "cost2_mean": -47.65672523825808, "outflow_rate_max": 1019.1313360715932, "system_level_velocity_min": 8.165154009687685, "cost2_max": -13.847314112401891, "cost2_min": -99.72190551925857, "system_level_velocity_mean": 11.490192242107888, "cost1_min": 22.119073365669514, "cost1_max": 355.7126302930071, "cost1_mean": 297.1237679938027, "system_level_velocity_max": 17.095704264422164}, "timesteps_total": 1560023, "training_iteration": 14, "date": "2019-04-29_11-03-08", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5def0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da58>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 14, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 639.811175278451, "time_total_s": 557.6440215110779, "info": {"grad_time_ms": 23747.145, "default": {"total_loss": 9.854219436645508, "kl": 0.020407505333423615, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013163421303033829, "vf_loss": 9.8643217086792, "entropy": 1.3927056789398193, "vf_explained_var": 0.7998234033584595, "cur_kl_coeff": 0.1499999761581421}, "num_steps_trained": 1560023, "load_time_ms": 19.774, "update_time_ms": 11.143, "sample_time_ms": 15390.079, "num_steps_sampled": 1560023}, "episode_reward_max": 839.760929360345, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 41.56879029659421, "episodes_total": 818, "episodes_this_iter": 62, "time_this_iter_s": 37.82626724243164, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107172, "timestamp": 1556535827, "episode_len_mean": 700.0, "timesteps_since_restore": 1667195, "time_since_restore": 596.198867559433, "done": false, "custom_metrics": {"outflow_rate_min": 558.4081964131835, "outflow_rate_mean": 810.9937369147596, "cost2_mean": -43.20493058797863, "outflow_rate_max": 1058.3611162665002, "system_level_velocity_min": 8.211059708398492, "cost2_max": -13.847314112401891, "cost2_min": -90.23796223434424, "system_level_velocity_mean": 11.578046614613847, "cost1_min": 213.12911836187655, "cost1_max": 377.9538361773941, "cost1_mean": 302.77395905811227, "system_level_velocity_max": 14.844439110918488}, "timesteps_total": 1667195, "training_iteration": 15, "date": "2019-04-29_11-03-47", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d636a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63898>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 15, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 623.5106747989829, "time_total_s": 596.198867559433, "info": {"grad_time_ms": 23609.43, "default": {"total_loss": 11.286436080932617, "kl": 0.015356378629803658, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010500863194465637, "vf_loss": 11.293481826782227, "entropy": 1.3790464401245117, "vf_explained_var": 0.7482814788818359, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 1667195, "load_time_ms": 19.941, "update_time_ms": 10.955, "sample_time_ms": 15481.039, "num_steps_sampled": 1667195}, "episode_reward_max": 925.4823517064393, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 240.7021206514788, "episodes_total": 888, "episodes_this_iter": 70, "time_this_iter_s": 38.5548460483551, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105980, "timestamp": 1556535864, "episode_len_mean": 700.0, "timesteps_since_restore": 1773175, "time_since_restore": 633.2230317592621, "done": false, "custom_metrics": {"outflow_rate_min": 576.3528674591723, "outflow_rate_mean": 822.6922281585811, "cost2_mean": -44.37881659995401, "outflow_rate_max": 1011.2684496945296, "system_level_velocity_min": 8.407217996137167, "cost2_max": -15.928126258333771, "cost2_min": -87.93686753415793, "system_level_velocity_mean": 11.718735449455153, "cost1_min": 222.7764878052963, "cost1_max": 391.94647304218364, "cost1_mean": 306.9550617102986, "system_level_velocity_max": 15.57830805499753}, "timesteps_total": 1773175, "training_iteration": 16, "date": "2019-04-29_11-04-24", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5ddd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d6d8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 16, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 636.9089572344819, "time_total_s": 633.2230317592621, "info": {"grad_time_ms": 23673.161, "default": {"total_loss": 12.578239440917969, "kl": 0.016428252682089806, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012284758500754833, "vf_loss": 12.586828231811523, "entropy": 1.3927727937698364, "vf_explained_var": 0.7391036152839661, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 1773175, "load_time_ms": 18.863, "update_time_ms": 10.891, "sample_time_ms": 15421.571, "num_steps_sampled": 1773175}, "episode_reward_max": 880.340272957177, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 306.25280246912797, "episodes_total": 956, "episodes_this_iter": 68, "time_this_iter_s": 37.0241641998291, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107276, "timestamp": 1556535903, "episode_len_mean": 693.47, "timesteps_since_restore": 1880451, "time_since_restore": 672.195953130722, "done": false, "custom_metrics": {"outflow_rate_min": 529.3977226474415, "outflow_rate_mean": 809.0804759012615, "cost2_mean": -41.63269959936977, "outflow_rate_max": 1025.5058749932443, "system_level_velocity_min": 8.795155658246292, "cost2_max": -15.035429404522674, "cost2_min": -98.60249343740553, "system_level_velocity_mean": 12.03922725149599, "cost1_min": 28.298526610921037, "cost1_max": 377.0019377026815, "cost1_mean": 310.5813143214574, "system_level_velocity_max": 17.081984188291923}, "timesteps_total": 1880451, "training_iteration": 17, "date": "2019-04-29_11-05-03", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d160>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 17, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 632.7743269888821, "time_total_s": 672.195953130722, "info": {"grad_time_ms": 23522.385, "default": {"total_loss": 12.872641563415527, "kl": 0.015816563740372658, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010880595073103905, "vf_loss": 12.879962921142578, "entropy": 1.3828809261322021, "vf_explained_var": 0.6995925903320312, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 1880451, "load_time_ms": 17.955, "update_time_ms": 11.07, "sample_time_ms": 15483.381, "num_steps_sampled": 1880451}, "episode_reward_max": 889.7291967920058, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 57.55996727383519, "episodes_total": 1025, "episodes_this_iter": 69, "time_this_iter_s": 38.97292137145996, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106406, "timestamp": 1556535941, "episode_len_mean": 700.0, "timesteps_since_restore": 1986857, "time_since_restore": 709.9388563632965, "done": false, "custom_metrics": {"outflow_rate_min": 626.3528288430466, "outflow_rate_mean": 839.1403716236059, "cost2_mean": -44.30844709892708, "outflow_rate_max": 1058.160505770427, "system_level_velocity_min": 8.368000679706558, "cost2_max": -18.786450199672444, "cost2_min": -98.60249343740553, "system_level_velocity_mean": 12.085985014263, "cost1_min": 218.9391638574476, "cost1_max": 386.65062805931984, "cost1_mean": 317.7233237984827, "system_level_velocity_max": 15.340868095065126}, "timesteps_total": 1986857, "training_iteration": 18, "date": "2019-04-29_11-05-41", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d3c8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 18, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 669.0385596675326, "time_total_s": 709.9388563632965, "info": {"grad_time_ms": 23363.476, "default": {"total_loss": 12.20559310913086, "kl": 0.017271358519792557, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013132372871041298, "vf_loss": 12.214838027954102, "entropy": 1.3836581707000732, "vf_explained_var": 0.693165123462677, "cur_kl_coeff": 0.22499996423721313}, "num_steps_trained": 1986857, "load_time_ms": 18.191, "update_time_ms": 11.096, "sample_time_ms": 15377.154, "num_steps_sampled": 1986857}, "episode_reward_max": 895.5161772561135, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 310.6724190684407, "episodes_total": 1090, "episodes_this_iter": 65, "time_this_iter_s": 37.74290323257446, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105347, "timestamp": 1556535981, "episode_len_mean": 693.34, "timesteps_since_restore": 2092204, "time_since_restore": 750.3994033336639, "done": false, "custom_metrics": {"outflow_rate_min": 496.61627662309377, "outflow_rate_mean": 833.3973477225387, "cost2_mean": -41.61177407974144, "outflow_rate_max": 1035.7585026858621, "system_level_velocity_min": 8.729835969254754, "cost2_max": -14.319673727691814, "cost2_min": -81.95871006478401, "system_level_velocity_mean": 12.589821575530216, "cost1_min": 21.49876971590502, "cost1_max": 394.5219047946564, "cost1_mean": 325.6618639576914, "system_level_velocity_max": 17.26029177605679}, "timesteps_total": 2092204, "training_iteration": 19, "date": "2019-04-29_11-06-21", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d128>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 19, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 665.2428995216363, "time_total_s": 750.3994033336639, "info": {"grad_time_ms": 23558.354, "default": {"total_loss": 15.517767906188965, "kl": 0.017640499398112297, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012918662279844284, "vf_loss": 15.526716232299805, "entropy": 1.3985415697097778, "vf_explained_var": 0.6830673217773438, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 2092204, "load_time_ms": 19.18, "update_time_ms": 11.044, "sample_time_ms": 15254.164, "num_steps_sampled": 2092204}, "episode_reward_max": 895.383716817542, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 36.12237606723225, "episodes_total": 1162, "episodes_this_iter": 72, "time_this_iter_s": 40.46054697036743, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105626, "timestamp": 1556536019, "episode_len_mean": 700.0, "timesteps_since_restore": 2197830, "time_since_restore": 788.4744021892548, "done": false, "custom_metrics": {"outflow_rate_min": 630.5594750779735, "outflow_rate_mean": 840.7458847085758, "cost2_mean": -41.96151728548282, "outflow_rate_max": 1053.9144686042555, "system_level_velocity_min": 9.501757133608976, "cost2_max": -14.319673727691814, "cost2_min": -78.24945546336252, "system_level_velocity_mean": 13.018933491051657, "cost1_min": 254.1603580726259, "cost1_max": 405.3280528716554, "cost1_mean": 339.515066728977, "system_level_velocity_max": 16.103276473870253}, "timesteps_total": 2197830, "training_iteration": 20, "date": "2019-04-29_11-06-59", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da58>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 20, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 673.8102458291512, "time_total_s": 788.4744021892548, "info": {"grad_time_ms": 23420.51, "default": {"total_loss": 14.457140922546387, "kl": 0.01602763496339321, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011565468274056911, "vf_loss": 14.465102195739746, "entropy": 1.409291386604309, "vf_explained_var": 0.7058942914009094, "cur_kl_coeff": 0.22499996423721313}, "num_steps_trained": 2197830, "load_time_ms": 19.001, "update_time_ms": 11.188, "sample_time_ms": 15216.021, "num_steps_sampled": 2197830}, "episode_reward_max": 895.383716817542, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 434.31778206839016, "episodes_total": 1234, "episodes_this_iter": 72, "time_this_iter_s": 38.07499885559082, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103362, "timestamp": 1556536058, "episode_len_mean": 693.47, "timesteps_since_restore": 2301192, "time_since_restore": 827.6017999649048, "done": false, "custom_metrics": {"outflow_rate_min": 527.4919313173697, "outflow_rate_mean": 828.0269985125477, "cost2_mean": -42.05900792650751, "outflow_rate_max": 1053.9144686042555, "system_level_velocity_min": 9.80024506326803, "cost2_max": -19.39762539211625, "cost2_min": -83.3549692985053, "system_level_velocity_mean": 12.92960097043059, "cost1_min": 29.21862604901003, "cost1_max": 424.09598344153727, "cost1_mean": 331.8190036876693, "system_level_velocity_max": 17.51272197634182}, "timesteps_total": 2301192, "training_iteration": 21, "date": "2019-04-29_11-07-38", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d668>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 21, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 659.638300337069, "time_total_s": 827.6017999649048, "info": {"grad_time_ms": 23022.311, "default": {"total_loss": 14.463970184326172, "kl": 0.016747795045375824, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012752247042953968, "vf_loss": 14.472954750061035, "entropy": 1.4174033403396606, "vf_explained_var": 0.6937024593353271, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 2301192, "load_time_ms": 18.85, "update_time_ms": 11.166, "sample_time_ms": 15294.348, "num_steps_sampled": 2301192}, "episode_reward_max": 871.1714338970031, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 48.908913809307194, "episodes_total": 1303, "episodes_this_iter": 69, "time_this_iter_s": 39.127397775650024, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102144, "timestamp": 1556536096, "episode_len_mean": 691.87, "timesteps_since_restore": 2403336, "time_since_restore": 865.1345181465149, "done": false, "custom_metrics": {"outflow_rate_min": 527.4919313173697, "outflow_rate_mean": 816.0962378191683, "cost2_mean": -39.235962797112286, "outflow_rate_max": 1081.0050285934772, "system_level_velocity_min": 9.705235105717424, "cost2_max": -17.836896278896333, "cost2_min": -86.41231989090795, "system_level_velocity_mean": 13.359985055260967, "cost1_min": 29.21862604901003, "cost1_max": 424.09598344153727, "cost1_mean": 340.78748620990666, "system_level_velocity_max": 17.51272197634182}, "timesteps_total": 2403336, "training_iteration": 22, "date": "2019-04-29_11-08-16", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63ac8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 22, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 646.6173968071894, "time_total_s": 865.1345181465149, "info": {"grad_time_ms": 22946.436, "default": {"total_loss": 15.563603401184082, "kl": 0.01702534407377243, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012063643895089626, "vf_loss": 15.571837425231934, "entropy": 1.4180773496627808, "vf_explained_var": 0.6150722503662109, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 2403336, "load_time_ms": 18.767, "update_time_ms": 10.91, "sample_time_ms": 15187.9, "num_steps_sampled": 2403336}, "episode_reward_max": 853.9605628077537, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 48.908913809307194, "episodes_total": 1373, "episodes_this_iter": 70, "time_this_iter_s": 37.53271818161011, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100655, "timestamp": 1556536133, "episode_len_mean": 696.32, "timesteps_since_restore": 2503991, "time_since_restore": 901.7075550556183, "done": false, "custom_metrics": {"outflow_rate_min": 640.3579953854105, "outflow_rate_mean": 806.7456650929308, "cost2_mean": -35.62812001356594, "outflow_rate_max": 1060.6195580380313, "system_level_velocity_min": 10.464638510791078, "cost2_max": -17.836896278896333, "cost2_min": -83.71401241460411, "system_level_velocity_mean": 13.986088914191468, "cost1_min": 194.66337407910075, "cost1_max": 423.654021576484, "cost1_mean": 358.60205917623506, "system_level_velocity_max": 16.765806756375515}, "timesteps_total": 2503991, "training_iteration": 23, "date": "2019-04-29_11-08-53", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d412e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4d0f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 23, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 659.8671930753485, "time_total_s": 901.7075550556183, "info": {"grad_time_ms": 22842.971, "default": {"total_loss": 17.189077377319336, "kl": 0.01696678251028061, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012512093409895897, "vf_loss": 17.197769165039062, "entropy": 1.4259930849075317, "vf_explained_var": 0.5918087363243103, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 2503991, "load_time_ms": 18.485, "update_time_ms": 11.054, "sample_time_ms": 15108.567, "num_steps_sampled": 2503991}, "episode_reward_max": 893.8641006658505, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 327.16494662044215, "episodes_total": 1449, "episodes_this_iter": 76, "time_this_iter_s": 36.573036909103394, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100546, "timestamp": 1556536168, "episode_len_mean": 688.79, "timesteps_since_restore": 2604537, "time_since_restore": 936.5168941020966, "done": false, "custom_metrics": {"outflow_rate_min": 530.9100113852667, "outflow_rate_mean": 799.3785309670492, "cost2_mean": -32.36586371577623, "outflow_rate_max": 1032.659155640979, "system_level_velocity_min": 11.429069736966817, "cost2_max": -18.34367814443538, "cost2_min": -61.36489763728191, "system_level_velocity_mean": 14.374690245515225, "cost1_min": 31.35990543445475, "cost1_max": 432.50795065372165, "cost1_mean": 362.0030171845945, "system_level_velocity_max": 17.967579459713917}, "timesteps_total": 2604537, "training_iteration": 24, "date": "2019-04-29_11-09-28", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63ba8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 24, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 650.5475167478866, "time_total_s": 936.5168941020966, "info": {"grad_time_ms": 22579.836, "default": {"total_loss": 19.24721908569336, "kl": 0.01750374026596546, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012909012846648693, "vf_loss": 19.256189346313477, "entropy": 1.426606297492981, "vf_explained_var": 0.5819729566574097, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 2604537, "load_time_ms": 18.109, "update_time_ms": 12.138, "sample_time_ms": 15069.731, "num_steps_sampled": 2604537}, "episode_reward_max": 893.8641006658505, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 59.47058568402782, "episodes_total": 1531, "episodes_this_iter": 82, "time_this_iter_s": 34.80933904647827, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100521, "timestamp": 1556536202, "episode_len_mean": 700.0, "timesteps_since_restore": 2705058, "time_since_restore": 971.1636419296265, "done": false, "custom_metrics": {"outflow_rate_min": 639.2811774351012, "outflow_rate_mean": 791.2995588688618, "cost2_mean": -31.803358158518975, "outflow_rate_max": 1005.161820454308, "system_level_velocity_min": 8.090416231961033, "cost2_max": -18.42627852400343, "cost2_min": -54.829336428625, "system_level_velocity_mean": 14.136022877026585, "cost1_min": 216.5185828823512, "cost1_max": 432.0385860265112, "cost1_mean": 363.4305692826025, "system_level_velocity_max": 17.643630039460053}, "timesteps_total": 2705058, "training_iteration": 25, "date": "2019-04-29_11-10-02", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63358>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 25, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 651.7229526027708, "time_total_s": 971.1636419296265, "info": {"grad_time_ms": 22279.123, "default": {"total_loss": 19.119325637817383, "kl": 0.018229864537715912, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013314486481249332, "vf_loss": 19.128538131713867, "entropy": 1.4381541013717651, "vf_explained_var": 0.5588735938072205, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 2705058, "load_time_ms": 15.985, "update_time_ms": 12.295, "sample_time_ms": 14983.396, "num_steps_sampled": 2705058}, "episode_reward_max": 890.7044855286276, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 466.726746836156, "episodes_total": 1610, "episodes_this_iter": 79, "time_this_iter_s": 34.64674782752991, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99086, "timestamp": 1556536238, "episode_len_mean": 700.0, "timesteps_since_restore": 2804144, "time_since_restore": 1006.8415343761444, "done": false, "custom_metrics": {"outflow_rate_min": 615.5338232162452, "outflow_rate_mean": 791.3444153681751, "cost2_mean": -30.38522666229163, "outflow_rate_max": 1017.5752264623316, "system_level_velocity_min": 8.090416231961033, "cost2_max": -19.490595079171662, "cost2_min": -51.87585107478314, "system_level_velocity_mean": 14.356328644350077, "cost1_min": 216.5185828823512, "cost1_max": 432.52492988867766, "cost1_mean": 368.72663631102506, "system_level_velocity_max": 17.264435679925498}, "timesteps_total": 2804144, "training_iteration": 26, "date": "2019-04-29_11-10-38", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d637f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d412e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 26, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 653.0551400366624, "time_total_s": 1006.8415343761444, "info": {"grad_time_ms": 22144.734, "default": {"total_loss": 20.57706069946289, "kl": 0.01734848879277706, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011692541651427746, "vf_loss": 20.584850311279297, "entropy": 1.444920301437378, "vf_explained_var": 0.4779747426509857, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 2804144, "load_time_ms": 15.812, "update_time_ms": 12.392, "sample_time_ms": 14984.603, "num_steps_sampled": 2804144}, "episode_reward_max": 838.3897969151373, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 530.1556753547277, "episodes_total": 1688, "episodes_this_iter": 78, "time_this_iter_s": 35.677892446517944, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99535, "timestamp": 1556536275, "episode_len_mean": 697.24, "timesteps_since_restore": 2903679, "time_since_restore": 1043.6580138206482, "done": false, "custom_metrics": {"outflow_rate_min": 657.1018890163595, "outflow_rate_mean": 770.6262722960325, "cost2_mean": -29.035939480868198, "outflow_rate_max": 980.4412924046775, "system_level_velocity_min": 10.779008546695332, "cost2_max": -17.59846278918684, "cost2_min": -51.87585107478314, "system_level_velocity_mean": 14.730600471227365, "cost1_min": 231.88518675709844, "cost1_max": 438.62541330583883, "cost1_mean": 375.53300901961046, "system_level_velocity_max": 17.780704251422183}, "timesteps_total": 2903679, "training_iteration": 27, "date": "2019-04-29_11-11-15", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d655c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d655f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 27, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 639.4873384921948, "time_total_s": 1043.6580138206482, "info": {"grad_time_ms": 22025.777, "default": {"total_loss": 20.147811889648438, "kl": 0.01680641993880272, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012392573989927769, "vf_loss": 20.156423568725586, "entropy": 1.4172769784927368, "vf_explained_var": 0.5086237192153931, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 2903679, "load_time_ms": 15.476, "update_time_ms": 12.439, "sample_time_ms": 14887.606, "num_steps_sampled": 2903679}, "episode_reward_max": 851.9074903163396, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 375.64751827196, "episodes_total": 1768, "episodes_this_iter": 80, "time_this_iter_s": 36.816479444503784, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99979, "timestamp": 1556536313, "episode_len_mean": 697.09, "timesteps_since_restore": 3003658, "time_since_restore": 1081.1634147167206, "done": false, "custom_metrics": {"outflow_rate_min": 650.170529149345, "outflow_rate_mean": 767.6932653247785, "cost2_mean": -29.015361001609467, "outflow_rate_max": 944.5561601906256, "system_level_velocity_min": 11.356248438782929, "cost2_max": -16.838840914537236, "cost2_min": -46.75455421650019, "system_level_velocity_mean": 14.365364247008579, "cost1_min": 231.88518675709844, "cost1_max": 424.1189157954876, "cost1_mean": 367.3734729077544, "system_level_velocity_max": 16.982774788339153}, "timesteps_total": 3003658, "training_iteration": 28, "date": "2019-04-29_11-11-53", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d636a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d637f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 28, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 631.1395246668924, "time_total_s": 1081.1634147167206, "info": {"grad_time_ms": 21884.985, "default": {"total_loss": 20.028579711914062, "kl": 0.017889434471726418, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012688267044723034, "vf_loss": 20.03724479675293, "entropy": 1.4401493072509766, "vf_explained_var": 0.5781159996986389, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3003658, "load_time_ms": 15.005, "update_time_ms": 12.677, "sample_time_ms": 15005.955, "num_steps_sampled": 3003658}, "episode_reward_max": 824.3079870669634, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 375.64751827196, "episodes_total": 1850, "episodes_this_iter": 82, "time_this_iter_s": 37.50540089607239, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99310, "timestamp": 1556536349, "episode_len_mean": 683.12, "timesteps_since_restore": 3102968, "time_since_restore": 1117.9234101772308, "done": false, "custom_metrics": {"outflow_rate_min": 467.4585551651172, "outflow_rate_mean": 759.8159599145137, "cost2_mean": -28.127716402777533, "outflow_rate_max": 923.1259899728352, "system_level_velocity_min": 10.847898534650826, "cost2_max": -13.899580989837009, "cost2_min": -43.709758258776034, "system_level_velocity_mean": 14.20586207604998, "cost1_min": 16.319357359940984, "cost1_max": 435.8565950652607, "cost1_mean": 355.2823456237929, "system_level_velocity_max": 18.0194323458546}, "timesteps_total": 3102968, "training_iteration": 29, "date": "2019-04-29_11-12-29", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d654a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65208>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 29, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 629.6846290871126, "time_total_s": 1117.9234101772308, "info": {"grad_time_ms": 21532.975, "default": {"total_loss": 21.253271102905273, "kl": 0.01809089444577694, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013594727963209152, "vf_loss": 21.262794494628906, "entropy": 1.4520282745361328, "vf_explained_var": 0.5510072708129883, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3102968, "load_time_ms": 14.475, "update_time_ms": 12.628, "sample_time_ms": 14986.667, "num_steps_sampled": 3102968}, "episode_reward_max": 807.1535922565134, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 28.91788353678568, "episodes_total": 1930, "episodes_this_iter": 80, "time_this_iter_s": 36.759995460510254, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98733, "timestamp": 1556536386, "episode_len_mean": 690.06, "timesteps_since_restore": 3201701, "time_since_restore": 1154.3394026756287, "done": false, "custom_metrics": {"outflow_rate_min": 536.3996229363835, "outflow_rate_mean": 760.6831306632544, "cost2_mean": -26.996696349415124, "outflow_rate_max": 928.9843037329305, "system_level_velocity_min": 11.034151113026036, "cost2_max": -16.253014861434544, "cost2_min": -43.75900095205499, "system_level_velocity_mean": 14.782980627273622, "cost1_min": 28.473727514517535, "cost1_max": 425.9859597490139, "cost1_mean": 373.4446848314044, "system_level_velocity_max": 17.67575554870828}, "timesteps_total": 3201701, "training_iteration": 30, "date": "2019-04-29_11-13-06", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 30, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 639.9112092358548, "time_total_s": 1154.3394026756287, "info": {"grad_time_ms": 21430.588, "default": {"total_loss": 24.231225967407227, "kl": 0.017109477892518044, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012983662076294422, "vf_loss": 24.240358352661133, "entropy": 1.4595036506652832, "vf_explained_var": 0.4725867509841919, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3201701, "load_time_ms": 15.37, "update_time_ms": 12.714, "sample_time_ms": 14922.1, "num_steps_sampled": 3201701}, "episode_reward_max": 885.7274718460355, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 57.53146192771139, "episodes_total": 2016, "episodes_this_iter": 86, "time_this_iter_s": 36.41599249839783, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99686, "timestamp": 1556536421, "episode_len_mean": 698.6, "timesteps_since_restore": 3301387, "time_since_restore": 1189.7947947978973, "done": false, "custom_metrics": {"outflow_rate_min": 661.1273856031075, "outflow_rate_mean": 768.2764511036493, "cost2_mean": -26.0009465193314, "outflow_rate_max": 955.7201396356016, "system_level_velocity_min": 11.985440251354662, "cost2_max": -16.930823715410263, "cost2_min": -43.99881814866136, "system_level_velocity_mean": 14.85521406754708, "cost1_min": 280.7884695885692, "cost1_max": 427.93095430401445, "cost1_mean": 379.9636786873336, "system_level_velocity_max": 17.16046447188975}, "timesteps_total": 3301387, "training_iteration": 31, "date": "2019-04-29_11-13-41", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65438>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 31, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 642.4367209732225, "time_total_s": 1189.7947947978973, "info": {"grad_time_ms": 21218.726, "default": {"total_loss": 21.48936653137207, "kl": 0.01782425120472908, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012942858040332794, "vf_loss": 21.49829864501953, "entropy": 1.4608709812164307, "vf_explained_var": 0.5206916928291321, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 3301387, "load_time_ms": 14.204, "update_time_ms": 12.674, "sample_time_ms": 14766.579, "num_steps_sampled": 3301387}, "episode_reward_max": 870.2327699623589, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 517.5067053259575, "episodes_total": 2091, "episodes_this_iter": 75, "time_this_iter_s": 35.45539212226868, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99255, "timestamp": 1556536455, "episode_len_mean": 698.6, "timesteps_since_restore": 3400642, "time_since_restore": 1223.751023054123, "done": false, "custom_metrics": {"outflow_rate_min": 619.5081140296643, "outflow_rate_mean": 766.2487674188457, "cost2_mean": -26.50110412501562, "outflow_rate_max": 955.7201396356016, "system_level_velocity_min": 10.394395456954443, "cost2_max": -16.930823715410263, "cost2_min": -53.92940207194564, "system_level_velocity_mean": 14.714188015409748, "cost1_min": 270.49518373744644, "cost1_max": 426.99682121049113, "cost1_mean": 376.5212377446453, "system_level_velocity_max": 16.893570393180394}, "timesteps_total": 3400642, "training_iteration": 32, "date": "2019-04-29_11-14-15", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d637f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d639e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d636d8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 32, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 650.434918428504, "time_total_s": 1223.751023054123, "info": {"grad_time_ms": 20864.55, "default": {"total_loss": 20.925962448120117, "kl": 0.016841774806380272, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012716695666313171, "vf_loss": 20.93488883972168, "entropy": 1.4614148139953613, "vf_explained_var": 0.49577435851097107, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3400642, "load_time_ms": 13.933, "update_time_ms": 12.617, "sample_time_ms": 14766.099, "num_steps_sampled": 3400642}, "episode_reward_max": 851.9550480518504, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 519.4971245753358, "episodes_total": 2171, "episodes_this_iter": 80, "time_this_iter_s": 33.956228256225586, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99223, "timestamp": 1556536492, "episode_len_mean": 700.0, "timesteps_since_restore": 3499865, "time_since_restore": 1260.497342824936, "done": false, "custom_metrics": {"outflow_rate_min": 671.9801440160901, "outflow_rate_mean": 786.6990092351883, "cost2_mean": -27.932821163545356, "outflow_rate_max": 956.7198389099075, "system_level_velocity_min": 11.001313078055762, "cost2_max": -19.09098336202654, "cost2_min": -53.92940207194564, "system_level_velocity_mean": 14.69214768217521, "cost1_min": 290.58969331936476, "cost1_max": 429.1515895205798, "cost1_mean": 377.6677109342588, "system_level_velocity_max": 17.30022629178892}, "timesteps_total": 3499865, "training_iteration": 33, "date": "2019-04-29_11-14-52", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d655c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65550>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 33, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 675.5293705460892, "time_total_s": 1260.497342824936, "info": {"grad_time_ms": 20850.333, "default": {"total_loss": 24.56720733642578, "kl": 0.018209464848041534, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013281380757689476, "vf_loss": 24.576393127441406, "entropy": 1.455780029296875, "vf_explained_var": 0.5004172921180725, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3499865, "load_time_ms": 14.004, "update_time_ms": 12.49, "sample_time_ms": 14799.356, "num_steps_sampled": 3499865}, "episode_reward_max": 843.2580423490616, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 535.750516622743, "episodes_total": 2253, "episodes_this_iter": 82, "time_this_iter_s": 36.74631977081299, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 97826, "timestamp": 1556536528, "episode_len_mean": 700.0, "timesteps_since_restore": 3597691, "time_since_restore": 1296.0085060596466, "done": false, "custom_metrics": {"outflow_rate_min": 653.7046637555147, "outflow_rate_mean": 771.4972352355834, "cost2_mean": -27.03399759042792, "outflow_rate_max": 910.6396870039972, "system_level_velocity_min": 11.001313078055762, "cost2_max": -17.52400968540596, "cost2_min": -52.19450680109597, "system_level_velocity_mean": 14.62428438387826, "cost1_min": 290.58969331936476, "cost1_max": 433.0630750340702, "cost1_mean": 375.1478774903864, "system_level_velocity_max": 17.314905020582763}, "timesteps_total": 3597691, "training_iteration": 34, "date": "2019-04-29_11-15-28", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d659e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 34, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 651.9731664017147, "time_total_s": 1296.0085060596466, "info": {"grad_time_ms": 20973.11, "default": {"total_loss": 22.80376625061035, "kl": 0.0191823597997427, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013911481015384197, "vf_loss": 22.81336212158203, "entropy": 1.4326977729797363, "vf_explained_var": 0.5132060647010803, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3597691, "load_time_ms": 13.938, "update_time_ms": 11.241, "sample_time_ms": 14743.406, "num_steps_sampled": 3597691}, "episode_reward_max": 801.8116642380302, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 526.7015613171218, "episodes_total": 2335, "episodes_this_iter": 82, "time_this_iter_s": 35.51116323471069, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98146, "timestamp": 1556536564, "episode_len_mean": 693.5, "timesteps_since_restore": 3695837, "time_since_restore": 1331.7423114776611, "done": false, "custom_metrics": {"outflow_rate_min": 509.7067947242139, "outflow_rate_mean": 757.9391837132819, "cost2_mean": -25.906683148738146, "outflow_rate_max": 910.6396870039972, "system_level_velocity_min": 11.537227026825844, "cost2_max": -16.965965449540754, "cost2_min": -41.15678549218937, "system_level_velocity_mean": 14.99115358648495, "cost1_min": 30.711524729222663, "cost1_max": 444.29690597930824, "cost1_mean": 378.9116686020377, "system_level_velocity_max": 17.817786045054895}, "timesteps_total": 3695837, "training_iteration": 35, "date": "2019-04-29_11-16-04", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d652e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d659b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 35, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 638.8091276730859, "time_total_s": 1331.7423114776611, "info": {"grad_time_ms": 21097.135, "default": {"total_loss": 25.043134689331055, "kl": 0.019441494718194008, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013317511416971684, "vf_loss": 25.05207633972168, "entropy": 1.45854914188385, "vf_explained_var": 0.4443989396095276, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3695837, "load_time_ms": 15.42, "update_time_ms": 11.243, "sample_time_ms": 14728.589, "num_steps_sampled": 3695837}, "episode_reward_max": 785.4189855285234, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 59.915402445233745, "episodes_total": 2414, "episodes_this_iter": 79, "time_this_iter_s": 35.733805418014526, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98437, "timestamp": 1556536602, "episode_len_mean": 693.52, "timesteps_since_restore": 3794274, "time_since_restore": 1369.8592414855957, "done": false, "custom_metrics": {"outflow_rate_min": 549.6227590650244, "outflow_rate_mean": 765.1064275861717, "cost2_mean": -25.09106814946654, "outflow_rate_max": 926.2056291920511, "system_level_velocity_min": 11.881500457641643, "cost2_max": -16.298856542244913, "cost2_min": -39.820988016873045, "system_level_velocity_mean": 15.29457945314927, "cost1_min": 33.51242284710034, "cost1_max": 441.4169578012592, "cost1_mean": 385.61600393739195, "system_level_velocity_max": 18.24929229880687}, "timesteps_total": 3794274, "training_iteration": 36, "date": "2019-04-29_11-16-42", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d659e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 36, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 648.2980680520976, "time_total_s": 1369.8592414855957, "info": {"grad_time_ms": 21372.561, "default": {"total_loss": 24.829364776611328, "kl": 0.0188016165047884, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012545696459710598, "vf_loss": 24.837678909301758, "entropy": 1.450208067893982, "vf_explained_var": 0.45144888758659363, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3794274, "load_time_ms": 16.201, "update_time_ms": 11.258, "sample_time_ms": 14692.877, "num_steps_sampled": 3794274}, "episode_reward_max": 800.64459151255, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 68.69434405615858, "episodes_total": 2497, "episodes_this_iter": 83, "time_this_iter_s": 38.11693000793457, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98085, "timestamp": 1556536638, "episode_len_mean": 700.0, "timesteps_since_restore": 3892359, "time_since_restore": 1406.1712400913239, "done": false, "custom_metrics": {"outflow_rate_min": 660.8135030617477, "outflow_rate_mean": 766.6044410275645, "cost2_mean": -25.804460439663547, "outflow_rate_max": 889.7215691538288, "system_level_velocity_min": 12.202525284762272, "cost2_max": -17.191111641760553, "cost2_min": -40.321148792677384, "system_level_velocity_mean": 15.11866938537179, "cost1_min": 316.9483356976729, "cost1_max": 435.29723315771344, "cost1_mean": 386.02326698788056, "system_level_velocity_max": 17.6824782458118}, "timesteps_total": 3892359, "training_iteration": 37, "date": "2019-04-29_11-17-18", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65208>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 37, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 652.6231150044483, "time_total_s": 1406.1712400913239, "info": {"grad_time_ms": 21277.706, "default": {"total_loss": 24.971393585205078, "kl": 0.019069628790020943, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013585912063717842, "vf_loss": 24.980690002441406, "entropy": 1.4657601118087769, "vf_explained_var": 0.4352335035800934, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 3892359, "load_time_ms": 16.432, "update_time_ms": 11.301, "sample_time_ms": 14740.201, "num_steps_sampled": 3892359}, "episode_reward_max": 804.410322422478, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 516.8244248138559, "episodes_total": 2581, "episodes_this_iter": 84, "time_this_iter_s": 36.31199860572815, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98267, "timestamp": 1556536674, "episode_len_mean": 696.92, "timesteps_since_restore": 3990626, "time_since_restore": 1442.2222850322723, "done": false, "custom_metrics": {"outflow_rate_min": 649.2001583318371, "outflow_rate_mean": 752.7636871000574, "cost2_mean": -25.466578345197796, "outflow_rate_max": 846.8269757685238, "system_level_velocity_min": 11.98612683312096, "cost2_max": -17.172774309129903, "cost2_min": -47.24868131315081, "system_level_velocity_mean": 15.177283259269977, "cost1_min": 192.08457287664976, "cost1_max": 436.7569833992982, "cost1_mean": 384.9951141986448, "system_level_velocity_max": 17.708777933919784}, "timesteps_total": 3990626, "training_iteration": 38, "date": "2019-04-29_11-17-54", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d636d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 38, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 638.100437575542, "time_total_s": 1442.2222850322723, "info": {"grad_time_ms": 21202.466, "default": {"total_loss": 27.07394027709961, "kl": 0.019802315160632133, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014027201570570469, "vf_loss": 27.083513259887695, "entropy": 1.4744421243667603, "vf_explained_var": 0.42420729994773865, "cur_kl_coeff": 0.22499997913837433}, "num_steps_trained": 3990626, "load_time_ms": 17.033, "update_time_ms": 11.215, "sample_time_ms": 14672.265, "num_steps_sampled": 3990626}, "episode_reward_max": 779.4394070977114, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 363.3611751996791, "episodes_total": 2667, "episodes_this_iter": 86, "time_this_iter_s": 36.051044940948486, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98548, "timestamp": 1556536710, "episode_len_mean": 682.59, "timesteps_since_restore": 4089174, "time_since_restore": 1477.7713589668274, "done": false, "custom_metrics": {"outflow_rate_min": 499.06041710949773, "outflow_rate_mean": 750.1916137921332, "cost2_mean": -25.19605961441368, "outflow_rate_max": 884.1132493038724, "system_level_velocity_min": 11.786234007772748, "cost2_max": -15.055381264362893, "cost2_min": -47.24868131315081, "system_level_velocity_mean": 14.941154051099272, "cost1_min": 27.50520753246668, "cost1_max": 439.9670658287043, "cost1_mean": 370.4499533559706, "system_level_velocity_max": 18.428410942185437}, "timesteps_total": 4089174, "training_iteration": 39, "date": "2019-04-29_11-18-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d654a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d659b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65550>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 39, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 630.6070648723882, "time_total_s": 1477.7713589668274, "info": {"grad_time_ms": 21105.504, "default": {"total_loss": 24.074392318725586, "kl": 0.019095445051789284, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013858306221663952, "vf_loss": 24.083951950073242, "entropy": 1.4876106977462769, "vf_explained_var": 0.42834973335266113, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 4089174, "load_time_ms": 16.984, "update_time_ms": 11.158, "sample_time_ms": 14649.719, "num_steps_sampled": 4089174}, "episode_reward_max": 792.2328603192781, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 57.29599436144452, "episodes_total": 2748, "episodes_this_iter": 81, "time_this_iter_s": 35.549073934555054, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98772, "timestamp": 1556536747, "episode_len_mean": 683.1, "timesteps_since_restore": 4187946, "time_since_restore": 1514.4094824790955, "done": false, "custom_metrics": {"outflow_rate_min": 509.23873480200945, "outflow_rate_mean": 763.1436880717265, "cost2_mean": -25.142330276671586, "outflow_rate_max": 885.0636534836781, "system_level_velocity_min": 11.6685761110883, "cost2_max": -14.91472678074151, "cost2_min": -40.29197877540426, "system_level_velocity_mean": 14.835220710006977, "cost1_min": 25.13195267477501, "cost1_max": 429.5613306373172, "cost1_mean": 369.6142789750651, "system_level_velocity_max": 17.351426331477754}, "timesteps_total": 4187946, "training_iteration": 40, "date": "2019-04-29_11-19-07", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da58>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 40, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 644.5402023881709, "time_total_s": 1514.4094824790955, "info": {"grad_time_ms": 21085.908, "default": {"total_loss": 28.313364028930664, "kl": 0.021521124988794327, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014371694065630436, "vf_loss": 28.322891235351562, "entropy": 1.4844430685043335, "vf_explained_var": 0.3927808701992035, "cur_kl_coeff": 0.22499999403953552}, "num_steps_trained": 4187946, "load_time_ms": 17.243, "update_time_ms": 11.078, "sample_time_ms": 14690.784, "num_steps_sampled": 4187946}, "episode_reward_max": 810.0049154738648, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 49.35180960611896, "episodes_total": 2838, "episodes_this_iter": 90, "time_this_iter_s": 36.638123512268066, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98303, "timestamp": 1556536781, "episode_len_mean": 699.98, "timesteps_since_restore": 4286249, "time_since_restore": 1548.9816200733185, "done": false, "custom_metrics": {"outflow_rate_min": 664.4336387238427, "outflow_rate_mean": 772.3162950590533, "cost2_mean": -24.507985635527834, "outflow_rate_max": 888.9552051643201, "system_level_velocity_min": 11.276823187658454, "cost2_max": -16.27580000127403, "cost2_min": -44.442112821786246, "system_level_velocity_mean": 15.02369623083149, "cost1_min": 286.7386696646695, "cost1_max": 439.85271393238486, "cost1_mean": 383.8526769558554, "system_level_velocity_max": 17.291156057747457}, "timesteps_total": 4286249, "training_iteration": 41, "date": "2019-04-29_11-19-41", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65940>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 41, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 665.3564143890794, "time_total_s": 1548.9816200733185, "info": {"grad_time_ms": 21071.029, "default": {"total_loss": 22.778034210205078, "kl": 0.01601308025419712, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014202453196048737, "vf_loss": 22.78683090209961, "entropy": 1.4839128255844116, "vf_explained_var": 0.4560551643371582, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 4286249, "load_time_ms": 17.518, "update_time_ms": 11.054, "sample_time_ms": 14615.923, "num_steps_sampled": 4286249}, "episode_reward_max": 837.1479309349365, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 509.6377431410463, "episodes_total": 2912, "episodes_this_iter": 74, "time_this_iter_s": 34.57213759422302, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98508, "timestamp": 1556536817, "episode_len_mean": 693.41, "timesteps_since_restore": 4384757, "time_since_restore": 1584.3063006401062, "done": false, "custom_metrics": {"outflow_rate_min": 504.30167441508445, "outflow_rate_mean": 754.753586113998, "cost2_mean": -23.491800349339222, "outflow_rate_max": 883.4411390307919, "system_level_velocity_min": 10.913166526248112, "cost2_max": -12.00986257460656, "cost2_min": -44.442112821786246, "system_level_velocity_mean": 14.786666326994418, "cost1_min": 22.874029038226645, "cost1_max": 431.41067958202905, "cost1_mean": 374.1590065940735, "system_level_velocity_max": 17.005107986550442}, "timesteps_total": 4384757, "training_iteration": 42, "date": "2019-04-29_11-20-17", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 42, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 638.9455775176882, "time_total_s": 1584.3063006401062, "info": {"grad_time_ms": 21180.831, "default": {"total_loss": 26.06215476989746, "kl": 0.01609334535896778, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014272980391979218, "vf_loss": 26.070995330810547, "entropy": 1.4843896627426147, "vf_explained_var": 0.4278717637062073, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 4384757, "load_time_ms": 16.608, "update_time_ms": 11.13, "sample_time_ms": 14641.404, "num_steps_sampled": 4384757}, "episode_reward_max": 786.639330964606, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 42.294234395447646, "episodes_total": 2995, "episodes_this_iter": 83, "time_this_iter_s": 35.32468056678772, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98507, "timestamp": 1556536854, "episode_len_mean": 700.0, "timesteps_since_restore": 4483264, "time_since_restore": 1621.7984132766724, "done": false, "custom_metrics": {"outflow_rate_min": 642.154204935685, "outflow_rate_mean": 757.0680036845012, "cost2_mean": -23.68351674755132, "outflow_rate_max": 960.5256380384154, "system_level_velocity_min": 11.281786839335275, "cost2_max": -16.76864343069041, "cost2_min": -41.555750191327455, "system_level_velocity_mean": 14.840075990765854, "cost1_min": 287.17224094486994, "cost1_max": 432.5426747197291, "cost1_mean": 379.860685228138, "system_level_velocity_max": 17.143091722307712}, "timesteps_total": 4483264, "training_iteration": 43, "date": "2019-04-29_11-20-54", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d652e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 43, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 650.4671399726747, "time_total_s": 1621.7984132766724, "info": {"grad_time_ms": 21238.485, "default": {"total_loss": 28.120845794677734, "kl": 0.015429002232849598, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013203277252614498, "vf_loss": 28.128843307495117, "entropy": 1.4905058145523071, "vf_explained_var": 0.408765971660614, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 4483264, "load_time_ms": 15.951, "update_time_ms": 11.209, "sample_time_ms": 14658.156, "num_steps_sampled": 4483264}, "episode_reward_max": 848.0633796386131, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 527.0522291468842, "episodes_total": 3083, "episodes_this_iter": 88, "time_this_iter_s": 37.49211263656616, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98750, "timestamp": 1556536890, "episode_len_mean": 700.0, "timesteps_since_restore": 4582014, "time_since_restore": 1657.749484539032, "done": false, "custom_metrics": {"outflow_rate_min": 642.6941674331929, "outflow_rate_mean": 765.3361280976361, "cost2_mean": -24.46747879799834, "outflow_rate_max": 960.5256380384154, "system_level_velocity_min": 11.93596927773671, "cost2_max": -16.266778776908385, "cost2_min": -53.491686222428484, "system_level_velocity_mean": 14.827424738369313, "cost1_min": 311.9866772453874, "cost1_max": 426.3088120653333, "cost1_mean": 379.3437919184538, "system_level_velocity_max": 16.813719501917987}, "timesteps_total": 4582014, "training_iteration": 44, "date": "2019-04-29_11-21-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65f98>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 44, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 662.6820887034265, "time_total_s": 1657.749484539032, "info": {"grad_time_ms": 21302.071, "default": {"total_loss": 25.31725311279297, "kl": 0.015803871676325798, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013351529836654663, "vf_loss": 25.325273513793945, "entropy": 1.5000604391098022, "vf_explained_var": 0.4235404431819916, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 4582014, "load_time_ms": 15.241, "update_time_ms": 11.391, "sample_time_ms": 14643.386, "num_steps_sampled": 4582014}, "episode_reward_max": 848.0633796386131, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 535.4871019416119, "episodes_total": 3161, "episodes_this_iter": 78, "time_this_iter_s": 35.95107126235962, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99148, "timestamp": 1556536927, "episode_len_mean": 699.65, "timesteps_since_restore": 4681162, "time_since_restore": 1694.1492755413055, "done": false, "custom_metrics": {"outflow_rate_min": 642.6941674331929, "outflow_rate_mean": 775.9088543518966, "cost2_mean": -24.73527393118843, "outflow_rate_max": 922.1818480170201, "system_level_velocity_min": 11.93596927773671, "cost2_max": -16.266778776908385, "cost2_min": -42.6250604399382, "system_level_velocity_mean": 14.846257273515738, "cost1_min": 311.9866772453874, "cost1_max": 436.30067356489303, "cost1_mean": 379.5817355230972, "system_level_velocity_max": 17.512282191901388}, "timesteps_total": 4681162, "training_iteration": 45, "date": "2019-04-29_11-22-07", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65ba8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 45, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 666.5928116959564, "time_total_s": 1694.1492755413055, "info": {"grad_time_ms": 21264.953, "default": {"total_loss": 25.476612091064453, "kl": 0.01635480299592018, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014249961823225021, "vf_loss": 25.48534393310547, "entropy": 1.4999603033065796, "vf_explained_var": 0.4222916066646576, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 4681162, "load_time_ms": 14.394, "update_time_ms": 11.449, "sample_time_ms": 14747.676, "num_steps_sampled": 4681162}, "episode_reward_max": 827.8796780860285, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 522.517078354123, "episodes_total": 3241, "episodes_this_iter": 80, "time_this_iter_s": 36.39979100227356, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98844, "timestamp": 1556536963, "episode_len_mean": 699.65, "timesteps_since_restore": 4780006, "time_since_restore": 1730.1083962917328, "done": false, "custom_metrics": {"outflow_rate_min": 635.8058302777465, "outflow_rate_mean": 764.2287403565261, "cost2_mean": -23.836323784381438, "outflow_rate_max": 886.5670162114696, "system_level_velocity_min": 12.382090682569824, "cost2_max": -15.703861654683982, "cost2_min": -41.6773061609811, "system_level_velocity_mean": 14.67085370883684, "cost1_min": 308.8110563423914, "cost1_max": 430.28324330690094, "cost1_mean": 376.885748850105, "system_level_velocity_max": 17.133747541320798}, "timesteps_total": 4780006, "training_iteration": 46, "date": "2019-04-29_11-22-43", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65cf8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 46, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 662.1848552884256, "time_total_s": 1730.1083962917328, "info": {"grad_time_ms": 21032.336, "default": {"total_loss": 29.671974182128906, "kl": 0.015929115936160088, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014376870356500149, "vf_loss": 29.680973052978516, "entropy": 1.5190420150756836, "vf_explained_var": 0.40121492743492126, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 4780006, "load_time_ms": 13.84, "update_time_ms": 11.688, "sample_time_ms": 14767.335, "num_steps_sampled": 4780006}, "episode_reward_max": 788.8216122100639, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 518.527333674504, "episodes_total": 3326, "episodes_this_iter": 85, "time_this_iter_s": 35.959120750427246, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98573, "timestamp": 1556536999, "episode_len_mean": 700.0, "timesteps_since_restore": 4878579, "time_since_restore": 1766.3325109481812, "done": false, "custom_metrics": {"outflow_rate_min": 628.4285177419063, "outflow_rate_mean": 761.0851444439833, "cost2_mean": -24.066316724448253, "outflow_rate_max": 1001.1361478213075, "system_level_velocity_min": 12.11929115522416, "cost2_max": -17.208335056720486, "cost2_min": -37.984272485194325, "system_level_velocity_mean": 14.651326772648343, "cost1_min": 308.8110563423914, "cost1_max": 427.14927103754076, "cost1_mean": 376.98650124174566, "system_level_velocity_max": 16.974209397973176}, "timesteps_total": 4878579, "training_iteration": 47, "date": "2019-04-29_11-23-19", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d655f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65b00>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 47, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 665.5903647618048, "time_total_s": 1766.3325109481812, "info": {"grad_time_ms": 21060.003, "default": {"total_loss": 27.327054977416992, "kl": 0.016500668600201607, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012978016398847103, "vf_loss": 27.334463119506836, "entropy": 1.5069578886032104, "vf_explained_var": 0.3877496123313904, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 4878579, "load_time_ms": 14.712, "update_time_ms": 11.533, "sample_time_ms": 14730.234, "num_steps_sampled": 4878579}, "episode_reward_max": 832.0663266884768, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 518.527333674504, "episodes_total": 3401, "episodes_this_iter": 75, "time_this_iter_s": 36.224114656448364, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99082, "timestamp": 1556537035, "episode_len_mean": 700.0, "timesteps_since_restore": 4977661, "time_since_restore": 1802.1825938224792, "done": false, "custom_metrics": {"outflow_rate_min": 647.0028726567393, "outflow_rate_mean": 778.9221280248706, "cost2_mean": -24.154085772035724, "outflow_rate_max": 945.6673188494375, "system_level_velocity_min": 10.979279892198049, "cost2_max": -16.503419690301698, "cost2_min": -37.984272485194325, "system_level_velocity_mean": 14.695780327342227, "cost1_min": 285.13123248299803, "cost1_max": 425.5231693793728, "cost1_mean": 378.1000917809121, "system_level_velocity_max": 16.697085250899793}, "timesteps_total": 4977661, "training_iteration": 48, "date": "2019-04-29_11-23-55", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65f60>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 48, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 669.9711866400834, "time_total_s": 1802.1825938224792, "info": {"grad_time_ms": 21077.009, "default": {"total_loss": 27.29311180114746, "kl": 0.017032966017723083, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015253212302923203, "vf_loss": 27.3026180267334, "entropy": 1.515944242477417, "vf_explained_var": 0.39712271094322205, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 4977661, "load_time_ms": 15.18, "update_time_ms": 11.381, "sample_time_ms": 14691.158, "num_steps_sampled": 4977661}, "episode_reward_max": 832.0663266884768, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 560.2121953387008, "episodes_total": 3480, "episodes_this_iter": 79, "time_this_iter_s": 35.850082874298096, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98819, "timestamp": 1556537070, "episode_len_mean": 696.39, "timesteps_since_restore": 5076480, "time_since_restore": 1837.501038312912, "done": false, "custom_metrics": {"outflow_rate_min": 647.0028726567393, "outflow_rate_mean": 774.0897050847769, "cost2_mean": -23.353588177029014, "outflow_rate_max": 908.7844993436884, "system_level_velocity_min": 10.979279892198049, "cost2_max": -17.561083291128725, "cost2_min": -36.11201555007639, "system_level_velocity_mean": 14.858095591814534, "cost1_min": 215.1880277113661, "cost1_max": 436.76541432655466, "cost1_mean": 379.3709921772489, "system_level_velocity_max": 17.40905510872873}, "timesteps_total": 5076480, "training_iteration": 49, "date": "2019-04-29_11-24-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d650f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d655c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d654a8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 49, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 676.1437072911037, "time_total_s": 1837.501038312912, "info": {"grad_time_ms": 21035.27, "default": {"total_loss": 30.979455947875977, "kl": 0.01622002385556698, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0140520129352808, "vf_loss": 30.988035202026367, "entropy": 1.524024486541748, "vf_explained_var": 0.3814094066619873, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 5076480, "load_time_ms": 15.42, "update_time_ms": 11.365, "sample_time_ms": 14710.368, "num_steps_sampled": 5076480}, "episode_reward_max": 829.383602974911, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 420.78164614002145, "episodes_total": 3568, "episodes_this_iter": 88, "time_this_iter_s": 35.31844449043274, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99773, "timestamp": 1556537106, "episode_len_mean": 693.46, "timesteps_since_restore": 5176253, "time_since_restore": 1873.2336342334747, "done": false, "custom_metrics": {"outflow_rate_min": 539.3225189132501, "outflow_rate_mean": 775.8751551510719, "cost2_mean": -23.760300442585294, "outflow_rate_max": 915.2835495998578, "system_level_velocity_min": 11.612662622629475, "cost2_max": -17.26542572758882, "cost2_min": -42.936242689167095, "system_level_velocity_mean": 14.852365428047435, "cost1_min": 28.606004827997484, "cost1_max": 439.51067854490674, "cost1_mean": 377.8728446255459, "system_level_velocity_max": 17.67162179723245}, "timesteps_total": 5176253, "training_iteration": 50, "date": "2019-04-29_11-25-06", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65748>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 50, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 683.6191349347221, "time_total_s": 1873.2336342334747, "info": {"grad_time_ms": 21005.454, "default": {"total_loss": 28.00392723083496, "kl": 0.016451988369226456, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013345088809728622, "vf_loss": 28.01171875, "entropy": 1.5147002935409546, "vf_explained_var": 0.412625789642334, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 5176253, "load_time_ms": 14.099, "update_time_ms": 11.43, "sample_time_ms": 14651.664, "num_steps_sampled": 5176253}, "episode_reward_max": 906.1895571986994, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 54.79075027007655, "episodes_total": 3644, "episodes_this_iter": 76, "time_this_iter_s": 35.732595920562744, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99881, "timestamp": 1556537141, "episode_len_mean": 700.0, "timesteps_since_restore": 5276134, "time_since_restore": 1908.1157298088074, "done": false, "custom_metrics": {"outflow_rate_min": 674.3368411231564, "outflow_rate_mean": 781.6880821110752, "cost2_mean": -24.386008765954895, "outflow_rate_max": 935.753077259141, "system_level_velocity_min": 11.612662622629475, "cost2_max": -17.26542572758882, "cost2_min": -37.9504247740169, "system_level_velocity_mean": 14.516799518905502, "cost1_min": 304.4516507843789, "cost1_max": 443.23524658996234, "cost1_mean": 375.7392311086121, "system_level_velocity_max": 17.472753454993143}, "timesteps_total": 5276134, "training_iteration": 51, "date": "2019-04-29_11-25-41", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d656a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65438>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 51, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 687.9583900120739, "time_total_s": 1908.1157298088074, "info": {"grad_time_ms": 20934.165, "default": {"total_loss": 26.34674072265625, "kl": 0.01555574033409357, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013994749635457993, "vf_loss": 26.355484008789062, "entropy": 1.5266499519348145, "vf_explained_var": 0.4169723093509674, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 5276134, "load_time_ms": 13.77, "update_time_ms": 11.414, "sample_time_ms": 14754.183, "num_steps_sampled": 5276134}, "episode_reward_max": 890.7761615550967, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 544.9680600638432, "episodes_total": 3721, "episodes_this_iter": 77, "time_this_iter_s": 34.88209557533264, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99316, "timestamp": 1556537177, "episode_len_mean": 693.31, "timesteps_since_restore": 5375450, "time_since_restore": 1944.3129591941833, "done": false, "custom_metrics": {"outflow_rate_min": 501.39749255957776, "outflow_rate_mean": 787.1833357887721, "cost2_mean": -24.369071379667815, "outflow_rate_max": 929.5246914753944, "system_level_velocity_min": 12.301819449439222, "cost2_max": -14.985058997674415, "cost2_min": -57.85847698498201, "system_level_velocity_mean": 14.724908185466825, "cost1_min": 24.76585525365893, "cost1_max": 441.0837822341357, "cost1_mean": 376.22265871702564, "system_level_velocity_max": 17.44440415714373}, "timesteps_total": 5375450, "training_iteration": 52, "date": "2019-04-29_11-26-17", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 52, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 686.7359267675008, "time_total_s": 1944.3129591941833, "info": {"grad_time_ms": 21021.403, "default": {"total_loss": 31.551198959350586, "kl": 0.016926662996411324, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015108859166502953, "vf_loss": 31.56059455871582, "entropy": 1.5415281057357788, "vf_explained_var": 0.38779398798942566, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 5375450, "load_time_ms": 14.754, "update_time_ms": 11.603, "sample_time_ms": 14755.165, "num_steps_sampled": 5375450}, "episode_reward_max": 838.5467714142457, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 49.911814494269876, "episodes_total": 3808, "episodes_this_iter": 87, "time_this_iter_s": 36.19722938537598, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100406, "timestamp": 1556537215, "episode_len_mean": 688.23, "timesteps_since_restore": 5475856, "time_since_restore": 1982.4880232810974, "done": false, "custom_metrics": {"outflow_rate_min": 521.1905621167895, "outflow_rate_mean": 784.914831224485, "cost2_mean": -23.570612206145892, "outflow_rate_max": 911.7366506262493, "system_level_velocity_min": 10.737387316451564, "cost2_max": -14.325601983588449, "cost2_min": -37.1291742614235, "system_level_velocity_mean": 14.723477258365936, "cost1_min": 25.35366108409157, "cost1_max": 431.70704356054637, "cost1_mean": 373.05651287226266, "system_level_velocity_max": 17.220309989793204}, "timesteps_total": 5475856, "training_iteration": 53, "date": "2019-04-29_11-26-55", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d657b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 53, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 678.6698923918912, "time_total_s": 1982.4880232810974, "info": {"grad_time_ms": 21089.064, "default": {"total_loss": 27.941709518432617, "kl": 0.01649140566587448, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015269778668880463, "vf_loss": 27.951414108276367, "entropy": 1.5385555028915405, "vf_explained_var": 0.3785841763019562, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 5475856, "load_time_ms": 15.37, "update_time_ms": 11.572, "sample_time_ms": 14756.998, "num_steps_sampled": 5475856}, "episode_reward_max": 804.8617759151623, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 50.89321608083515, "episodes_total": 3882, "episodes_this_iter": 74, "time_this_iter_s": 38.17506408691406, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100173, "timestamp": 1556537252, "episode_len_mean": 685.56, "timesteps_since_restore": 5576029, "time_since_restore": 2019.3219375610352, "done": false, "custom_metrics": {"outflow_rate_min": 521.1905621167895, "outflow_rate_mean": 784.9829993005598, "cost2_mean": -23.912810689708657, "outflow_rate_max": 992.7262218265162, "system_level_velocity_min": 11.64327837438596, "cost2_max": -14.325601983588449, "cost2_min": -59.66827513641033, "system_level_velocity_mean": 14.793250493600128, "cost1_min": 25.35366108409157, "cost1_max": 437.2850896473268, "cost1_mean": 373.40273550664546, "system_level_velocity_max": 17.450985020828053}, "timesteps_total": 5576029, "training_iteration": 54, "date": "2019-04-29_11-27-32", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a3c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a160>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 54, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 682.6824027232387, "time_total_s": 2019.3219375610352, "info": {"grad_time_ms": 21118.998, "default": {"total_loss": 29.486003875732422, "kl": 0.01602238044142723, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014472007751464844, "vf_loss": 29.495065689086914, "entropy": 1.5532892942428589, "vf_explained_var": 0.37573039531707764, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 5576029, "load_time_ms": 16.448, "update_time_ms": 11.576, "sample_time_ms": 14814.013, "num_steps_sampled": 5576029}, "episode_reward_max": 929.3536607459972, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 50.89321608083515, "episodes_total": 3960, "episodes_this_iter": 78, "time_this_iter_s": 36.833914279937744, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99575, "timestamp": 1556537287, "episode_len_mean": 700.0, "timesteps_since_restore": 5675604, "time_since_restore": 2053.8933804035187, "done": false, "custom_metrics": {"outflow_rate_min": 650.6992384451542, "outflow_rate_mean": 802.442063341281, "cost2_mean": -24.53223169277574, "outflow_rate_max": 930.053178350707, "system_level_velocity_min": 12.159111610991635, "cost2_max": -16.708821099789322, "cost2_min": -41.896418204567304, "system_level_velocity_mean": 14.84150728841073, "cost1_min": 316.85133777297483, "cost1_max": 429.7442543173111, "cost1_mean": 383.09754466541676, "system_level_velocity_max": 17.12780435040621}, "timesteps_total": 5675604, "training_iteration": 55, "date": "2019-04-29_11-28-07", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d656a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d654a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65c50>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 55, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 710.7454931344708, "time_total_s": 2053.8933804035187, "info": {"grad_time_ms": 21009.697, "default": {"total_loss": 29.831708908081055, "kl": 0.016875676810741425, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014836927875876427, "vf_loss": 29.840848922729492, "entropy": 1.5515449047088623, "vf_explained_var": 0.38774019479751587, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 5675604, "load_time_ms": 16.54, "update_time_ms": 11.436, "sample_time_ms": 14737.382, "num_steps_sampled": 5675604}, "episode_reward_max": 824.096214956307, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 550.227442916882, "episodes_total": 4042, "episodes_this_iter": 82, "time_this_iter_s": 34.57144284248352, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100447, "timestamp": 1556537323, "episode_len_mean": 700.0, "timesteps_since_restore": 5776051, "time_since_restore": 2089.7011108398438, "done": false, "custom_metrics": {"outflow_rate_min": 650.8386953978658, "outflow_rate_mean": 795.9771325961634, "cost2_mean": -24.444759836270695, "outflow_rate_max": 927.6788223852818, "system_level_velocity_min": 11.147147248648919, "cost2_max": -16.256632422412927, "cost2_min": -43.585585968087365, "system_level_velocity_mean": 14.920182696841486, "cost1_min": 292.9163801520177, "cost1_max": 433.876632492456, "cost1_mean": 385.00412020860267, "system_level_velocity_max": 17.208000275849415}, "timesteps_total": 5776051, "training_iteration": 56, "date": "2019-04-29_11-28-43", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4ae10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a278>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 56, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 702.2808108626616, "time_total_s": 2089.7011108398438, "info": {"grad_time_ms": 20980.411, "default": {"total_loss": 31.217269897460938, "kl": 0.01651833951473236, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013947484083473682, "vf_loss": 31.22564125061035, "entropy": 1.5482847690582275, "vf_explained_var": 0.3547682464122772, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 5776051, "load_time_ms": 16.353, "update_time_ms": 11.232, "sample_time_ms": 14749.197, "num_steps_sampled": 5776051}, "episode_reward_max": 815.5672103693629, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 548.361754608969, "episodes_total": 4120, "episodes_this_iter": 78, "time_this_iter_s": 35.80773043632507, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99965, "timestamp": 1556537359, "episode_len_mean": 700.0, "timesteps_since_restore": 5876016, "time_since_restore": 2125.292117834091, "done": false, "custom_metrics": {"outflow_rate_min": 650.8386953978658, "outflow_rate_mean": 802.01143831964, "cost2_mean": -24.871765498573815, "outflow_rate_max": 970.9840227878776, "system_level_velocity_min": 11.626831005913825, "cost2_max": -16.256632422412927, "cost2_min": -43.585585968087365, "system_level_velocity_mean": 14.780349371734431, "cost1_min": 302.78304529971433, "cost1_max": 433.876632492456, "cost1_mean": 381.8825696169466, "system_level_velocity_max": 17.208000275849415}, "timesteps_total": 5876016, "training_iteration": 57, "date": "2019-04-29_11-29-19", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d635c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d412e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 57, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 707.068690338544, "time_total_s": 2125.292117834091, "info": {"grad_time_ms": 20905.382, "default": {"total_loss": 29.69993019104004, "kl": 0.016067374497652054, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013607560656964779, "vf_loss": 29.708114624023438, "entropy": 1.5502914190292358, "vf_explained_var": 0.38594484329223633, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 5876016, "load_time_ms": 15.395, "update_time_ms": 11.341, "sample_time_ms": 14759.843, "num_steps_sampled": 5876016}, "episode_reward_max": 849.5101239290626, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 558.2929285654188, "episodes_total": 4199, "episodes_this_iter": 79, "time_this_iter_s": 35.59100699424744, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99669, "timestamp": 1556537394, "episode_len_mean": 693.48, "timesteps_since_restore": 5975685, "time_since_restore": 2160.5941495895386, "done": false, "custom_metrics": {"outflow_rate_min": 529.2548205312615, "outflow_rate_mean": 796.0860274244619, "cost2_mean": -24.219687531189823, "outflow_rate_max": 948.6187229877808, "system_level_velocity_min": 11.286235406303291, "cost2_max": -14.647829724359337, "cost2_min": -41.26558369377264, "system_level_velocity_mean": 14.658319001419581, "cost1_min": 29.649483166769585, "cost1_max": 436.8476437199396, "cost1_mean": 375.24835215583835, "system_level_velocity_max": 17.44314561793828}, "timesteps_total": 5975685, "training_iteration": 58, "date": "2019-04-29_11-29-54", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4aeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a390>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 58, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 694.6900043198622, "time_total_s": 2160.5941495895386, "info": {"grad_time_ms": 20813.262, "default": {"total_loss": 28.358686447143555, "kl": 0.016021067276597023, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014379581436514854, "vf_loss": 28.367656707763672, "entropy": 1.5342317819595337, "vf_explained_var": 0.3953040838241577, "cur_kl_coeff": 0.33750009536743164}, "num_steps_trained": 5975685, "load_time_ms": 15.597, "update_time_ms": 11.316, "sample_time_ms": 14794.374, "num_steps_sampled": 5975685}, "episode_reward_max": 873.0003002672175, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 56.88265510906177, "episodes_total": 4278, "episodes_this_iter": 79, "time_this_iter_s": 35.30203175544739, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100275, "timestamp": 1556537429, "episode_len_mean": 692.21, "timesteps_since_restore": 6075960, "time_since_restore": 2195.245035171509, "done": false, "custom_metrics": {"outflow_rate_min": 532.8329422127415, "outflow_rate_mean": 787.0033112599626, "cost2_mean": -24.31735115385718, "outflow_rate_max": 954.698815773813, "system_level_velocity_min": 12.136886989004404, "cost2_max": -17.17799358412543, "cost2_min": -44.72915709558616, "system_level_velocity_mean": 14.759718302565544, "cost1_min": 31.2517368465598, "cost1_max": 437.1858353030345, "cost1_mean": 375.8500720686554, "system_level_velocity_max": 18.44413930824923}, "timesteps_total": 6075960, "training_iteration": 59, "date": "2019-04-29_11-30-29", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5c0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 59, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 685.7462894226061, "time_total_s": 2195.245035171509, "info": {"grad_time_ms": 20757.064, "default": {"total_loss": 28.43376922607422, "kl": 0.016474846750497818, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014988810755312443, "vf_loss": 28.443195343017578, "entropy": 1.5541683435440063, "vf_explained_var": 0.389091819524765, "cur_kl_coeff": 0.33750009536743164}, "num_steps_trained": 6075960, "load_time_ms": 15.383, "update_time_ms": 11.421, "sample_time_ms": 14782.941, "num_steps_sampled": 6075960}, "episode_reward_max": 846.8043845978682, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 63.30596747695162, "episodes_total": 4355, "episodes_this_iter": 77, "time_this_iter_s": 34.650885581970215, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99474, "timestamp": 1556537464, "episode_len_mean": 693.28, "timesteps_since_restore": 6175434, "time_since_restore": 2230.8794918060303, "done": false, "custom_metrics": {"outflow_rate_min": 462.78861341889404, "outflow_rate_mean": 809.4581742839712, "cost2_mean": -25.116086778605965, "outflow_rate_max": 1015.9976616058578, "system_level_velocity_min": 9.283372853305224, "cost2_max": -15.020016968124288, "cost2_min": -41.56949235907191, "system_level_velocity_mean": 15.015851565569665, "cost1_min": 17.865017553164165, "cost1_max": 446.67884336668567, "cost1_mean": 382.2038952632198, "system_level_velocity_max": 18.230574585900307}, "timesteps_total": 6175434, "training_iteration": 60, "date": "2019-04-29_11-31-04", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4af28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4ac18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4acc0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 60, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 703.6011324506306, "time_total_s": 2230.8794918060303, "info": {"grad_time_ms": 20674.908, "default": {"total_loss": 32.467247009277344, "kl": 0.016910074278712273, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014426026493310928, "vf_loss": 32.4759635925293, "entropy": 1.5475867986679077, "vf_explained_var": 0.3614259660243988, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 6175434, "load_time_ms": 16.124, "update_time_ms": 11.382, "sample_time_ms": 14854.312, "num_steps_sampled": 6175434}, "episode_reward_max": 914.4750361436794, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 34.37437441010454, "episodes_total": 4436, "episodes_this_iter": 81, "time_this_iter_s": 35.634456634521484, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99028, "timestamp": 1556537500, "episode_len_mean": 698.44, "timesteps_since_restore": 6274462, "time_since_restore": 2266.049868583679, "done": false, "custom_metrics": {"outflow_rate_min": 647.1612651119058, "outflow_rate_mean": 817.8880341645713, "cost2_mean": -26.11553805461973, "outflow_rate_max": 952.9513441473621, "system_level_velocity_min": 12.677481985666166, "cost2_max": -17.108469654387434, "cost2_min": -41.793934884387774, "system_level_velocity_mean": 15.201804081662884, "cost1_min": 314.7783016097618, "cost1_max": 439.8037771186894, "cost1_mean": 389.30357257298255, "system_level_velocity_max": 17.53782380167164}, "timesteps_total": 6274462, "training_iteration": 61, "date": "2019-04-29_11-31-40", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5db00>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 61, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 712.9359978526343, "time_total_s": 2266.049868583679, "info": {"grad_time_ms": 20747.548, "default": {"total_loss": 29.47657012939453, "kl": 0.017045387998223305, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015288086608052254, "vf_loss": 29.486108779907227, "entropy": 1.5683482885360718, "vf_explained_var": 0.40546703338623047, "cur_kl_coeff": 0.33750009536743164}, "num_steps_trained": 6274462, "load_time_ms": 16.084, "update_time_ms": 11.369, "sample_time_ms": 14812.944, "num_steps_sampled": 6274462}, "episode_reward_max": 884.7613766993578, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 558.2617962472104, "episodes_total": 4517, "episodes_this_iter": 81, "time_this_iter_s": 35.170376777648926, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100682, "timestamp": 1556537538, "episode_len_mean": 696.89, "timesteps_since_restore": 6375144, "time_since_restore": 2304.8048610687256, "done": false, "custom_metrics": {"outflow_rate_min": 647.1612651119058, "outflow_rate_mean": 803.0493649028253, "cost2_mean": -26.004979867673832, "outflow_rate_max": 948.4368109879429, "system_level_velocity_min": 12.719647678701815, "cost2_max": -17.332607407057697, "cost2_min": -46.23426539512413, "system_level_velocity_mean": 15.188506503510128, "cost1_min": 303.6773022345558, "cost1_max": 443.7601980492966, "cost1_mean": 387.0877005137104, "system_level_velocity_max": 17.976653913313108}, "timesteps_total": 6375144, "training_iteration": 62, "date": "2019-04-29_11-32-18", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a9b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 62, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 697.1642910637607, "time_total_s": 2304.8048610687256, "info": {"grad_time_ms": 20981.128, "default": {"total_loss": 28.640748977661133, "kl": 0.016834789887070656, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014573615044355392, "vf_loss": 28.649641036987305, "entropy": 1.57297682762146, "vf_explained_var": 0.4366025924682617, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 6375144, "load_time_ms": 15.995, "update_time_ms": 11.225, "sample_time_ms": 14832.736, "num_steps_sampled": 6375144}, "episode_reward_max": 869.4673015574058, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 482.2431883396946, "episodes_total": 4593, "episodes_this_iter": 76, "time_this_iter_s": 38.75499248504639, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99186, "timestamp": 1556537574, "episode_len_mean": 684.5, "timesteps_since_restore": 6474330, "time_since_restore": 2340.063311815262, "done": false, "custom_metrics": {"outflow_rate_min": 542.6506085309725, "outflow_rate_mean": 811.1924191188492, "cost2_mean": -25.84148167476849, "outflow_rate_max": 948.4368109879429, "system_level_velocity_min": 10.657547939963688, "cost2_max": -16.718136678557187, "cost2_min": -43.45918249357648, "system_level_velocity_mean": 15.178154300755645, "cost1_min": 31.01955369198177, "cost1_max": 447.9707589644679, "cost1_mean": 379.6904551516828, "system_level_velocity_max": 19.14210065504825}, "timesteps_total": 6474330, "training_iteration": 63, "date": "2019-04-29_11-32-54", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d320>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 63, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 692.4602796025958, "time_total_s": 2340.063311815262, "info": {"grad_time_ms": 20710.632, "default": {"total_loss": 28.929122924804688, "kl": 0.017319941893219948, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014247736893594265, "vf_loss": 28.937524795532227, "entropy": 1.5776845216751099, "vf_explained_var": 0.415670782327652, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 6474330, "load_time_ms": 16.603, "update_time_ms": 11.325, "sample_time_ms": 14812.311, "num_steps_sampled": 6474330}, "episode_reward_max": 876.4692424615957, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 61.466604093550906, "episodes_total": 4677, "episodes_this_iter": 84, "time_this_iter_s": 35.258450746536255, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98891, "timestamp": 1556537611, "episode_len_mean": 688.61, "timesteps_since_restore": 6573221, "time_since_restore": 2376.8361060619354, "done": false, "custom_metrics": {"outflow_rate_min": 542.6506085309725, "outflow_rate_mean": 796.9448292333868, "cost2_mean": -24.81272172724206, "outflow_rate_max": 966.106962262166, "system_level_velocity_min": 12.157133069094655, "cost2_max": -17.79417557864118, "cost2_min": -43.85061348348219, "system_level_velocity_mean": 15.353657961823332, "cost1_min": 31.01955369198177, "cost1_max": 447.9707589644679, "cost1_mean": 384.7293879532265, "system_level_velocity_max": 19.14210065504825}, "timesteps_total": 6573221, "training_iteration": 64, "date": "2019-04-29_11-33-31", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a7f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a160>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 64, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 684.631263916651, "time_total_s": 2376.8361060619354, "info": {"grad_time_ms": 20682.437, "default": {"total_loss": 30.764545440673828, "kl": 0.017022762447595596, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015056037344038486, "vf_loss": 30.77385711669922, "entropy": 1.5705512762069702, "vf_explained_var": 0.38965001702308655, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 6573221, "load_time_ms": 15.503, "update_time_ms": 11.149, "sample_time_ms": 14835.32, "num_steps_sampled": 6573221}, "episode_reward_max": 903.9604217813678, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 61.466604093550906, "episodes_total": 4758, "episodes_this_iter": 81, "time_this_iter_s": 36.772794246673584, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99645, "timestamp": 1556537647, "episode_len_mean": 700.0, "timesteps_since_restore": 6672866, "time_since_restore": 2412.9888117313385, "done": false, "custom_metrics": {"outflow_rate_min": 646.4822719580181, "outflow_rate_mean": 805.0236157474134, "cost2_mean": -25.57328459865715, "outflow_rate_max": 980.3096850572933, "system_level_velocity_min": 12.490967752890523, "cost2_max": -17.98434835337635, "cost2_min": -38.690922411077096, "system_level_velocity_mean": 15.38194374776986, "cost1_min": 330.19434393646395, "cost1_max": 440.5036446636732, "cost1_mean": 392.32290008848065, "system_level_velocity_max": 17.80407975445734}, "timesteps_total": 6672866, "training_iteration": 65, "date": "2019-04-29_11-34-07", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d390>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 65, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 696.2058460570207, "time_total_s": 2412.9888117313385, "info": {"grad_time_ms": 20871.377, "default": {"total_loss": 30.20936393737793, "kl": 0.01638955995440483, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014611131511628628, "vf_loss": 30.218442916870117, "entropy": 1.5873833894729614, "vf_explained_var": 0.3673846423625946, "cur_kl_coeff": 0.33750009536743164}, "num_steps_trained": 6672866, "load_time_ms": 16.124, "update_time_ms": 11.09, "sample_time_ms": 14807.084, "num_steps_sampled": 6672866}, "episode_reward_max": 920.417843305769, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 540.764120188149, "episodes_total": 4835, "episodes_this_iter": 77, "time_this_iter_s": 36.152705669403076, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98895, "timestamp": 1556537684, "episode_len_mean": 690.41, "timesteps_since_restore": 6771761, "time_since_restore": 2450.646617412567, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 798.0166047392321, "cost2_mean": -25.01139919423466, "outflow_rate_max": 939.3410567507194, "system_level_velocity_min": 12.010575402226056, "cost2_max": -10.80536023610297, "cost2_min": -42.78088994848239, "system_level_velocity_mean": 15.249840005152052, "cost1_min": 11.77703979149338, "cost1_max": 438.2412664567262, "cost1_mean": 383.25891238945746, "system_level_velocity_max": 17.732676097528035}, "timesteps_total": 6771761, "training_iteration": 66, "date": "2019-04-29_11-34-44", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4aeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4ae48>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 66, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 684.8521382491116, "time_total_s": 2450.646617412567, "info": {"grad_time_ms": 21034.614, "default": {"total_loss": 30.41877555847168, "kl": 0.016365651041269302, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015210002660751343, "vf_loss": 30.428462982177734, "entropy": 1.6022378206253052, "vf_explained_var": 0.3812565803527832, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 6771761, "load_time_ms": 16.046, "update_time_ms": 11.013, "sample_time_ms": 14828.953, "num_steps_sampled": 6771761}, "episode_reward_max": 847.6220560846905, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 24.71512436748906, "episodes_total": 4917, "episodes_this_iter": 82, "time_this_iter_s": 37.65780568122864, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99370, "timestamp": 1556537721, "episode_len_mean": 694.08, "timesteps_since_restore": 6871131, "time_since_restore": 2486.861013650894, "done": false, "custom_metrics": {"outflow_rate_min": 656.4810487955664, "outflow_rate_mean": 804.3691295113285, "cost2_mean": -25.68348596952662, "outflow_rate_max": 980.691865835279, "system_level_velocity_min": 12.35157135179326, "cost2_max": -14.279593419897145, "cost2_min": -51.490643787136996, "system_level_velocity_mean": 15.309682331260351, "cost1_min": 134.39334939381914, "cost1_max": 435.38670743218955, "cost1_mean": 386.1763102139661, "system_level_velocity_max": 17.732676097528035}, "timesteps_total": 6871131, "training_iteration": 67, "date": "2019-04-29_11-35-21", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5db00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5c0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 67, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 688.5578545991855, "time_total_s": 2486.861013650894, "info": {"grad_time_ms": 21091.568, "default": {"total_loss": 35.011749267578125, "kl": 0.018284641206264496, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01517329178750515, "vf_loss": 35.020755767822266, "entropy": 1.5916138887405396, "vf_explained_var": 0.36406078934669495, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 6871131, "load_time_ms": 16.63, "update_time_ms": 11.07, "sample_time_ms": 14834.641, "num_steps_sampled": 6871131}, "episode_reward_max": 865.3016835032441, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 244.6464118577971, "episodes_total": 5002, "episodes_this_iter": 85, "time_this_iter_s": 36.214396238327026, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98412, "timestamp": 1556537757, "episode_len_mean": 699.27, "timesteps_since_restore": 6969543, "time_since_restore": 2523.185752391815, "done": false, "custom_metrics": {"outflow_rate_min": 658.0658221395059, "outflow_rate_mean": 812.1919652173998, "cost2_mean": -25.327508390883423, "outflow_rate_max": 958.8440378317963, "system_level_velocity_min": 12.474940792483103, "cost2_max": -18.766531490680944, "cost2_min": -39.60045394493944, "system_level_velocity_mean": 15.519415648556782, "cost1_min": 320.6461349420127, "cost1_max": 439.3402924089209, "cost1_mean": 394.49787589438876, "system_level_velocity_max": 17.98445529063436}, "timesteps_total": 6969543, "training_iteration": 68, "date": "2019-04-29_11-35-57", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4ae48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a748>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 68, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 691.010331981894, "time_total_s": 2523.185752391815, "info": {"grad_time_ms": 21203.184, "default": {"total_loss": 26.96031951904297, "kl": 0.017344476655125618, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013784143142402172, "vf_loss": 26.96824836730957, "entropy": 1.582727074623108, "vf_explained_var": 0.42968106269836426, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 6969543, "load_time_ms": 15.27, "update_time_ms": 11.063, "sample_time_ms": 14829.34, "num_steps_sampled": 6969543}, "episode_reward_max": 812.7466632544842, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 532.3256077274907, "episodes_total": 5077, "episodes_this_iter": 75, "time_this_iter_s": 36.32473874092102, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98929, "timestamp": 1556537794, "episode_len_mean": 681.27, "timesteps_since_restore": 7068472, "time_since_restore": 2560.41051030159, "done": false, "custom_metrics": {"outflow_rate_min": 449.342779117061, "outflow_rate_mean": 792.3049289954274, "cost2_mean": -26.00798389570114, "outflow_rate_max": 953.8823531388534, "system_level_velocity_min": 11.310495536901557, "cost2_max": -7.7618718779149205, "cost2_min": -61.79315658009745, "system_level_velocity_mean": 15.279075910462453, "cost1_min": 9.48561571823555, "cost1_max": 443.78873194666875, "cost1_mean": 378.2163499309881, "system_level_velocity_max": 18.10584637277063}, "timesteps_total": 7068472, "training_iteration": 69, "date": "2019-04-29_11-36-34", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d636a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d635c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 69, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 674.5194780072072, "time_total_s": 2560.41051030159, "info": {"grad_time_ms": 21354.697, "default": {"total_loss": 31.22396469116211, "kl": 0.0166439488530159, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015033847652375698, "vf_loss": 31.233381271362305, "entropy": 1.5860613584518433, "vf_explained_var": 0.4033978581428528, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 7068472, "load_time_ms": 15.406, "update_time_ms": 10.904, "sample_time_ms": 14933.547, "num_steps_sampled": 7068472}, "episode_reward_max": 862.4085551255458, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 15.1201989996194, "episodes_total": 5160, "episodes_this_iter": 83, "time_this_iter_s": 37.22475790977478, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99124, "timestamp": 1556537832, "episode_len_mean": 673.88, "timesteps_since_restore": 7167596, "time_since_restore": 2597.9946172237396, "done": false, "custom_metrics": {"outflow_rate_min": 449.342779117061, "outflow_rate_mean": 802.5366746399262, "cost2_mean": -26.256295488417244, "outflow_rate_max": 945.4465370895407, "system_level_velocity_min": 10.877504721832548, "cost2_max": -7.7618718779149205, "cost2_min": -43.137355697635215, "system_level_velocity_mean": 15.392413685642802, "cost1_min": 9.48561571823555, "cost1_max": 448.80353216500237, "cost1_mean": 376.9326488439503, "system_level_velocity_max": 18.01295516119397}, "timesteps_total": 7167596, "training_iteration": 70, "date": "2019-04-29_11-37-12", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4ae10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4aba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4acf8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 70, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 677.1194214763278, "time_total_s": 2597.9946172237396, "info": {"grad_time_ms": 21516.729, "default": {"total_loss": 31.54521369934082, "kl": 0.017636816948652267, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015474250540137291, "vf_loss": 31.554737091064453, "entropy": 1.6175360679626465, "vf_explained_var": 0.4059091806411743, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 7167596, "load_time_ms": 14.509, "update_time_ms": 10.911, "sample_time_ms": 14967.167, "num_steps_sampled": 7167596}, "episode_reward_max": 847.0691260847087, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 15.1201989996194, "episodes_total": 5245, "episodes_this_iter": 85, "time_this_iter_s": 37.58410692214966, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98994, "timestamp": 1556537868, "episode_len_mean": 692.14, "timesteps_since_restore": 7266590, "time_since_restore": 2633.7600090503693, "done": false, "custom_metrics": {"outflow_rate_min": 509.79988209979126, "outflow_rate_mean": 808.366246859684, "cost2_mean": -26.29586836609366, "outflow_rate_max": 945.4465370895407, "system_level_velocity_min": 10.877504721832548, "cost2_max": -14.117882712169607, "cost2_min": -40.4189427186954, "system_level_velocity_mean": 15.534660942767408, "cost1_min": 23.207223596327392, "cost1_max": 440.2285563481211, "cost1_mean": 388.71438399548526, "system_level_velocity_max": 18.016171220505864}, "timesteps_total": 7266590, "training_iteration": 71, "date": "2019-04-29_11-37-48", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da20>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 71, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 688.2017457551284, "time_total_s": 2633.7600090503693, "info": {"grad_time_ms": 21490.506, "default": {"total_loss": 32.05687713623047, "kl": 0.016946328803896904, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015340136364102364, "vf_loss": 32.066497802734375, "entropy": 1.6011935472488403, "vf_explained_var": 0.40856000781059265, "cur_kl_coeff": 0.33750009536743164}, "num_steps_trained": 7266590, "load_time_ms": 15.342, "update_time_ms": 11.21, "sample_time_ms": 15052.541, "num_steps_sampled": 7266590}, "episode_reward_max": 847.0691260847087, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 47.565474019867374, "episodes_total": 5326, "episodes_this_iter": 81, "time_this_iter_s": 35.76539182662964, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99337, "timestamp": 1556537904, "episode_len_mean": 700.0, "timesteps_since_restore": 7365927, "time_since_restore": 2669.3412466049194, "done": false, "custom_metrics": {"outflow_rate_min": 663.1739532946832, "outflow_rate_mean": 811.9179409477454, "cost2_mean": -25.88372008752455, "outflow_rate_max": 959.884885514168, "system_level_velocity_min": 11.113153151001137, "cost2_max": -17.66797865525993, "cost2_min": -42.97656272508351, "system_level_velocity_mean": 15.39418250896814, "cost1_min": 289.6307207762822, "cost1_max": 443.53732520080166, "cost1_mean": 391.30245224566187, "system_level_velocity_max": 17.95873582116507}, "timesteps_total": 7365927, "training_iteration": 72, "date": "2019-04-29_11-38-24", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4ab38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a9b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 72, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.0910876887035, "time_total_s": 2669.3412466049194, "info": {"grad_time_ms": 21213.138, "default": {"total_loss": 29.038715362548828, "kl": 0.017988862469792366, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016159575432538986, "vf_loss": 29.048803329467773, "entropy": 1.6072161197662354, "vf_explained_var": 0.43276017904281616, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 7365927, "load_time_ms": 14.511, "update_time_ms": 10.98, "sample_time_ms": 15013.671, "num_steps_sampled": 7365927}, "episode_reward_max": 834.1458218150409, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 530.0548119242388, "episodes_total": 5402, "episodes_this_iter": 76, "time_this_iter_s": 35.58123755455017, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98721, "timestamp": 1556537940, "episode_len_mean": 693.19, "timesteps_since_restore": 7464648, "time_since_restore": 2706.158352613449, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 814.8065355334379, "cost2_mean": -27.11138768156344, "outflow_rate_max": 949.2966409764524, "system_level_velocity_min": 11.622882304687959, "cost2_max": -13.568738976202685, "cost2_min": -42.97656272508351, "system_level_velocity_mean": 15.43064554055031, "cost1_min": 12.298016606084213, "cost1_max": 446.5244682839573, "cost1_mean": 388.15759846777655, "system_level_velocity_max": 17.88819605002165}, "timesteps_total": 7464648, "training_iteration": 73, "date": "2019-04-29_11-39-00", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d7f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 73, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 698.7622915171294, "time_total_s": 2706.158352613449, "info": {"grad_time_ms": 21358.979, "default": {"total_loss": 30.908540725708008, "kl": 0.017688781023025513, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015252223238348961, "vf_loss": 30.917821884155273, "entropy": 1.6028468608856201, "vf_explained_var": 0.40255579352378845, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 7464648, "load_time_ms": 14.649, "update_time_ms": 10.865, "sample_time_ms": 15020.895, "num_steps_sampled": 7464648}, "episode_reward_max": 836.6480712851305, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 19.710272322522673, "episodes_total": 5485, "episodes_this_iter": 83, "time_this_iter_s": 36.81710600852966, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99254, "timestamp": 1556537977, "episode_len_mean": 686.55, "timesteps_since_restore": 7563902, "time_since_restore": 2742.8065345287323, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 813.8764645691502, "cost2_mean": -27.829636433509048, "outflow_rate_max": 927.0434514255929, "system_level_velocity_min": 11.622882304687959, "cost2_max": -13.568738976202685, "cost2_min": -50.570460928122664, "system_level_velocity_mean": 15.37674458410853, "cost1_min": 12.298016606084213, "cost1_max": 446.5244682839573, "cost1_mean": 383.5885637640197, "system_level_velocity_max": 18.00874013450021}, "timesteps_total": 7563902, "training_iteration": 74, "date": "2019-04-29_11-39-37", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4acc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a978>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 74, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 689.8956584931829, "time_total_s": 2742.8065345287323, "info": {"grad_time_ms": 21368.99, "default": {"total_loss": 29.728845596313477, "kl": 0.0164333563297987, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013664977625012398, "vf_loss": 29.736963272094727, "entropy": 1.614721417427063, "vf_explained_var": 0.42930200695991516, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 7563902, "load_time_ms": 14.589, "update_time_ms": 10.903, "sample_time_ms": 14999.171, "num_steps_sampled": 7563902}, "episode_reward_max": 824.9028530201051, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 19.710272322522673, "episodes_total": 5563, "episodes_this_iter": 78, "time_this_iter_s": 36.6481819152832, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99754, "timestamp": 1556538013, "episode_len_mean": 700.0, "timesteps_since_restore": 7663656, "time_since_restore": 2778.1225366592407, "done": false, "custom_metrics": {"outflow_rate_min": 678.3693173733602, "outflow_rate_mean": 823.6555177470934, "cost2_mean": -28.214096312828737, "outflow_rate_max": 944.0179445527224, "system_level_velocity_min": 11.700614847547293, "cost2_max": -17.489515207632078, "cost2_min": -44.52005399848595, "system_level_velocity_mean": 15.287775973252474, "cost1_min": 304.18411531155004, "cost1_max": 445.9465897643924, "cost1_mean": 389.7219936583518, "system_level_velocity_max": 17.647446321732065}, "timesteps_total": 7663656, "training_iteration": 75, "date": "2019-04-29_11-40-13", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d650f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 75, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 709.3603192473433, "time_total_s": 2778.1225366592407, "info": {"grad_time_ms": 21269.708, "default": {"total_loss": 32.841121673583984, "kl": 0.016908498480916023, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014362918213009834, "vf_loss": 32.84977722167969, "entropy": 1.6073684692382812, "vf_explained_var": 0.4304804801940918, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 7663656, "load_time_ms": 14.721, "update_time_ms": 11.168, "sample_time_ms": 15011.433, "num_steps_sampled": 7663656}, "episode_reward_max": 829.170351023537, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 564.4259056718003, "episodes_total": 5644, "episodes_this_iter": 81, "time_this_iter_s": 35.31600213050842, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99746, "timestamp": 1556538049, "episode_len_mean": 700.0, "timesteps_since_restore": 7763402, "time_since_restore": 2814.7089529037476, "done": false, "custom_metrics": {"outflow_rate_min": 710.286062647379, "outflow_rate_mean": 828.7981622543898, "cost2_mean": -29.34672962511531, "outflow_rate_max": 943.471529420232, "system_level_velocity_min": 11.700614847547293, "cost2_max": -18.216644242926403, "cost2_min": -55.988778955902625, "system_level_velocity_mean": 15.323268553829005, "cost1_min": 304.18411531155004, "cost1_max": 445.9465897643924, "cost1_mean": 389.9411255430555, "system_level_velocity_max": 17.647446321732065}, "timesteps_total": 7763402, "training_iteration": 76, "date": "2019-04-29_11-40-49", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65208>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 76, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 712.9716122273752, "time_total_s": 2814.7089529037476, "info": {"grad_time_ms": 21164.334, "default": {"total_loss": 33.18730545043945, "kl": 0.018594369292259216, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015692193061113358, "vf_loss": 33.196720123291016, "entropy": 1.6154866218566895, "vf_explained_var": 0.40822333097457886, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 7763402, "load_time_ms": 15.344, "update_time_ms": 11.318, "sample_time_ms": 15007.737, "num_steps_sampled": 7763402}, "episode_reward_max": 837.6035544353288, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 610.6389985108218, "episodes_total": 5723, "episodes_this_iter": 79, "time_this_iter_s": 36.586416244506836, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100462, "timestamp": 1556538085, "episode_len_mean": 693.51, "timesteps_since_restore": 7863864, "time_since_restore": 2850.861401796341, "done": false, "custom_metrics": {"outflow_rate_min": 522.6354998524575, "outflow_rate_mean": 825.2609954123568, "cost2_mean": -27.8314594738956, "outflow_rate_max": 935.7205296697271, "system_level_velocity_min": 11.25550284895555, "cost2_max": -15.75260717968618, "cost2_min": -50.65509484717943, "system_level_velocity_mean": 15.306622153464724, "cost1_min": 30.900016019130575, "cost1_max": 436.424220072248, "cost1_mean": 386.04113217920116, "system_level_velocity_max": 17.757424611424092}, "timesteps_total": 7863864, "training_iteration": 77, "date": "2019-04-29_11-41-25", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 77, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 705.511904724175, "time_total_s": 2850.861401796341, "info": {"grad_time_ms": 21142.915, "default": {"total_loss": 31.663509368896484, "kl": 0.01838644966483116, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015259122475981712, "vf_loss": 31.672561645507812, "entropy": 1.636124849319458, "vf_explained_var": 0.3968872129917145, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 7863864, "load_time_ms": 15.708, "update_time_ms": 11.267, "sample_time_ms": 15022.221, "num_steps_sampled": 7863864}, "episode_reward_max": 839.7570493832219, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 56.99183150453858, "episodes_total": 5801, "episodes_this_iter": 78, "time_this_iter_s": 36.152448892593384, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100592, "timestamp": 1556538121, "episode_len_mean": 696.31, "timesteps_since_restore": 7964456, "time_since_restore": 2886.736088991165, "done": false, "custom_metrics": {"outflow_rate_min": 687.7321831540085, "outflow_rate_mean": 832.3401281689131, "cost2_mean": -29.175103472388074, "outflow_rate_max": 954.2115273708494, "system_level_velocity_min": 11.25550284895555, "cost2_max": -17.682916004344847, "cost2_min": -50.65509484717943, "system_level_velocity_mean": 15.113861463577962, "cost1_min": 199.37022453428995, "cost1_max": 435.7729231569104, "cost1_mean": 383.99340609850674, "system_level_velocity_max": 17.392862608534593}, "timesteps_total": 7964456, "training_iteration": 78, "date": "2019-04-29_11-42-01", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d652b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65668>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 78, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 712.2470690801327, "time_total_s": 2886.736088991165, "info": {"grad_time_ms": 21101.796, "default": {"total_loss": 30.70359992980957, "kl": 0.016995685175061226, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015200210735201836, "vf_loss": 30.713062286376953, "entropy": 1.6320817470550537, "vf_explained_var": 0.41660016775131226, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 7964456, "load_time_ms": 16.553, "update_time_ms": 11.273, "sample_time_ms": 15018.3, "num_steps_sampled": 7964456}, "episode_reward_max": 855.7868751988498, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 347.83895160117436, "episodes_total": 5878, "episodes_this_iter": 77, "time_this_iter_s": 35.87468719482422, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100388, "timestamp": 1556538160, "episode_len_mean": 693.17, "timesteps_since_restore": 8064844, "time_since_restore": 2925.2287023067474, "done": false, "custom_metrics": {"outflow_rate_min": 441.5458222670991, "outflow_rate_mean": 824.0995936914243, "cost2_mean": -28.715988167058427, "outflow_rate_max": 947.7374229605018, "system_level_velocity_min": 11.190030646898059, "cost2_max": -9.973576743863488, "cost2_min": -47.1972608838563, "system_level_velocity_mean": 14.809427970942922, "cost1_min": 10.894590082945278, "cost1_max": 427.6025315856865, "cost1_mean": 375.131496937722, "system_level_velocity_max": 17.199471844663023}, "timesteps_total": 8064844, "training_iteration": 79, "date": "2019-04-29_11-42-40", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a0b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 79, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 704.696869116121, "time_total_s": 2925.2287023067474, "info": {"grad_time_ms": 21303.733, "default": {"total_loss": 32.66937255859375, "kl": 0.01802145130932331, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015956658869981766, "vf_loss": 32.67924499511719, "entropy": 1.6418839693069458, "vf_explained_var": 0.42054620385169983, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 8064844, "load_time_ms": 16.658, "update_time_ms": 11.373, "sample_time_ms": 14943.039, "num_steps_sampled": 8064844}, "episode_reward_max": 835.3501910209116, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 17.77414171514288, "episodes_total": 5962, "episodes_this_iter": 84, "time_this_iter_s": 38.492613315582275, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100109, "timestamp": 1556538197, "episode_len_mean": 682.26, "timesteps_since_restore": 8164953, "time_since_restore": 2962.4870414733887, "done": false, "custom_metrics": {"outflow_rate_min": 441.5458222670991, "outflow_rate_mean": 816.3179254368389, "cost2_mean": -27.306801423209855, "outflow_rate_max": 954.2111148910467, "system_level_velocity_min": 11.190030646898059, "cost2_max": -9.973576743863488, "cost2_min": -59.13564844645846, "system_level_velocity_mean": 15.201797039527387, "cost1_min": 10.894590082945278, "cost1_max": 434.61806427279964, "cost1_mean": 377.8235206168327, "system_level_velocity_max": 17.943211757999745}, "timesteps_total": 8164953, "training_iteration": 80, "date": "2019-04-29_11-43-17", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d655f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d659e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 80, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 690.51163009039, "time_total_s": 2962.4870414733887, "info": {"grad_time_ms": 21294.38, "default": {"total_loss": 30.867767333984375, "kl": 0.017971288412809372, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015502465888857841, "vf_loss": 30.8772029876709, "entropy": 1.6370033025741577, "vf_explained_var": 0.4508990943431854, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 8164953, "load_time_ms": 17.708, "update_time_ms": 11.354, "sample_time_ms": 14918.941, "num_steps_sampled": 8164953}, "episode_reward_max": 833.157704830456, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 17.77414171514288, "episodes_total": 6039, "episodes_this_iter": 77, "time_this_iter_s": 37.258339166641235, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100116, "timestamp": 1556538236, "episode_len_mean": 689.79, "timesteps_since_restore": 8265069, "time_since_restore": 3001.122668504715, "done": false, "custom_metrics": {"outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 833.7253554539608, "cost2_mean": -27.80784128640456, "outflow_rate_max": 975.3627233018666, "system_level_velocity_min": 12.550104117752548, "cost2_max": -13.60495785497137, "cost2_min": -40.41863743963207, "system_level_velocity_mean": 15.183022532108117, "cost1_min": 15.18672745996046, "cost1_max": 429.3646142929718, "cost1_mean": 382.00001721038905, "system_level_velocity_max": 17.061031582463013}, "timesteps_total": 8265069, "training_iteration": 81, "date": "2019-04-29_11-43-56", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a438>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 81, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 707.8083817489655, "time_total_s": 3001.122668504715, "info": {"grad_time_ms": 21468.83, "default": {"total_loss": 30.615428924560547, "kl": 0.018456459045410156, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017329005524516106, "vf_loss": 30.626527786254883, "entropy": 1.628260612487793, "vf_explained_var": 0.404479444026947, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 8265069, "load_time_ms": 16.355, "update_time_ms": 11.07, "sample_time_ms": 15028.892, "num_steps_sampled": 8265069}, "episode_reward_max": 870.7259785823525, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 26.26765321435872, "episodes_total": 6116, "episodes_this_iter": 77, "time_this_iter_s": 38.635627031326294, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100398, "timestamp": 1556538272, "episode_len_mean": 686.19, "timesteps_since_restore": 8365467, "time_since_restore": 3037.543384552002, "done": false, "custom_metrics": {"outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 832.7893309862742, "cost2_mean": -28.993311945265035, "outflow_rate_max": 961.6845111174272, "system_level_velocity_min": 9.123741941512463, "cost2_max": -13.60495785497137, "cost2_min": -56.03608608908799, "system_level_velocity_mean": 15.097782740567125, "cost1_min": 15.18672745996046, "cost1_max": 431.35895506059217, "cost1_mean": 377.4317255700259, "system_level_velocity_max": 17.061031582463013}, "timesteps_total": 8365467, "training_iteration": 82, "date": "2019-04-29_11-44-32", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d652b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 82, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 704.8737508897876, "time_total_s": 3037.543384552002, "info": {"grad_time_ms": 21536.306, "default": {"total_loss": 27.79389762878418, "kl": 0.018037231639027596, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01629200205206871, "vf_loss": 27.804101943969727, "entropy": 1.6596916913986206, "vf_explained_var": 0.5097518563270569, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 8365467, "load_time_ms": 17.336, "update_time_ms": 11.352, "sample_time_ms": 15046.471, "num_steps_sampled": 8365467}, "episode_reward_max": 870.5396016725344, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 26.26765321435872, "episodes_total": 6193, "episodes_this_iter": 77, "time_this_iter_s": 36.42071604728699, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100767, "timestamp": 1556538308, "episode_len_mean": 700.0, "timesteps_since_restore": 8466234, "time_since_restore": 3073.053905725479, "done": false, "custom_metrics": {"outflow_rate_min": 719.6022366678272, "outflow_rate_mean": 847.2833753783041, "cost2_mean": -28.242024970186844, "outflow_rate_max": 953.9835403970327, "system_level_velocity_min": 12.218821196783272, "cost2_max": -17.617242622214285, "cost2_min": -48.58890770914006, "system_level_velocity_mean": 15.147825624514681, "cost1_min": 315.0895166068734, "cost1_max": 432.8464531869772, "cost1_mean": 387.159023000502, "system_level_velocity_max": 17.405618447783294}, "timesteps_total": 8466234, "training_iteration": 83, "date": "2019-04-29_11-45-08", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a240>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 83, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 725.1726692999343, "time_total_s": 3073.053905725479, "info": {"grad_time_ms": 21381.997, "default": {"total_loss": 31.560787200927734, "kl": 0.017079856246709824, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015259701758623123, "vf_loss": 31.570281982421875, "entropy": 1.6648222208023071, "vf_explained_var": 0.4344332218170166, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 8466234, "load_time_ms": 16.439, "update_time_ms": 11.503, "sample_time_ms": 15070.652, "num_steps_sampled": 8466234}, "episode_reward_max": 835.080217832742, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 611.9633726163614, "episodes_total": 6270, "episodes_this_iter": 77, "time_this_iter_s": 35.51052117347717, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100706, "timestamp": 1556538345, "episode_len_mean": 697.33, "timesteps_since_restore": 8566940, "time_since_restore": 3109.5945699214935, "done": false, "custom_metrics": {"outflow_rate_min": 712.9835153580171, "outflow_rate_mean": 844.0116288125236, "cost2_mean": -28.47887657523443, "outflow_rate_max": 953.7042446669168, "system_level_velocity_min": 10.98320746570928, "cost2_max": -19.07146965918897, "cost2_min": -48.75548260602598, "system_level_velocity_mean": 15.110353319335513, "cost1_min": 232.45539384865185, "cost1_max": 432.8464531869772, "cost1_mean": 384.3914322513293, "system_level_velocity_max": 17.005008127068354}, "timesteps_total": 8566940, "training_iteration": 84, "date": "2019-04-29_11-45-45", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d656a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65c88>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 84, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 724.4750189148181, "time_total_s": 3109.5945699214935, "info": {"grad_time_ms": 21373.597, "default": {"total_loss": 32.57354736328125, "kl": 0.018203502520918846, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016007976606488228, "vf_loss": 32.583412170410156, "entropy": 1.6628915071487427, "vf_explained_var": 0.4136875569820404, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 8566940, "load_time_ms": 16.43, "update_time_ms": 11.603, "sample_time_ms": 15068.424, "num_steps_sampled": 8566940}, "episode_reward_max": 870.0251301262399, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 434.74749527704216, "episodes_total": 6345, "episodes_this_iter": 75, "time_this_iter_s": 36.540664196014404, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 101152, "timestamp": 1556538382, "episode_len_mean": 688.37, "timesteps_since_restore": 8668092, "time_since_restore": 3146.9115736484528, "done": false, "custom_metrics": {"outflow_rate_min": 513.344548631384, "outflow_rate_mean": 837.597755489796, "cost2_mean": -28.626810586151535, "outflow_rate_max": 970.7568525954096, "system_level_velocity_min": 9.962538101036913, "cost2_max": -14.472458652786177, "cost2_min": -47.58876971455057, "system_level_velocity_mean": 14.964358401788667, "cost1_min": 25.01091057311137, "cost1_max": 435.1700971446911, "cost1_mean": 375.71593554201814, "system_level_velocity_max": 17.511350943181323}, "timesteps_total": 8668092, "training_iteration": 85, "date": "2019-04-29_11-46-22", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a4a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4a828>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 85, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 710.4529747030068, "time_total_s": 3146.9115736484528, "info": {"grad_time_ms": 21515.261, "default": {"total_loss": 32.51886749267578, "kl": 0.018304074183106422, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016764506697654724, "vf_loss": 32.52945327758789, "entropy": 1.6763393878936768, "vf_explained_var": 0.4377662241458893, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 8668092, "load_time_ms": 16.532, "update_time_ms": 11.275, "sample_time_ms": 15127.469, "num_steps_sampled": 8668092}, "episode_reward_max": 843.3199485405436, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 51.318461433946275, "episodes_total": 6425, "episodes_this_iter": 80, "time_this_iter_s": 37.31700372695923, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 101180, "timestamp": 1556538419, "episode_len_mean": 685.93, "timesteps_since_restore": 8769272, "time_since_restore": 3184.008400917053, "done": false, "custom_metrics": {"outflow_rate_min": 455.20282093948606, "outflow_rate_mean": 844.1044374714991, "cost2_mean": -29.11684377990887, "outflow_rate_max": 991.9360925566713, "system_level_velocity_min": 12.049690677851636, "cost2_max": -8.241882819094508, "cost2_min": -50.764775061604155, "system_level_velocity_mean": 14.879517419223232, "cost1_min": 9.839869587533252, "cost1_max": 429.4540568929391, "cost1_mean": 373.03949710902924, "system_level_velocity_max": 17.818951623512305}, "timesteps_total": 8769272, "training_iteration": 86, "date": "2019-04-29_11-46-59", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcc0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 86, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 719.5381917060212, "time_total_s": 3184.008400917053, "info": {"grad_time_ms": 21559.226, "default": {"total_loss": 29.053558349609375, "kl": 0.01846981607377529, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017185185104608536, "vf_loss": 29.06450843811035, "entropy": 1.6651005744934082, "vf_explained_var": 0.4885907769203186, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 8769272, "load_time_ms": 15.185, "update_time_ms": 11.184, "sample_time_ms": 15139.631, "num_steps_sampled": 8769272}, "episode_reward_max": 869.5946504578005, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 15.597874705354151, "episodes_total": 6505, "episodes_this_iter": 80, "time_this_iter_s": 37.096827268600464, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100475, "timestamp": 1556538458, "episode_len_mean": 686.44, "timesteps_since_restore": 8869747, "time_since_restore": 3222.8618309497833, "done": false, "custom_metrics": {"outflow_rate_min": 455.20282093948606, "outflow_rate_mean": 839.0076520019657, "cost2_mean": -27.70499304213179, "outflow_rate_max": 997.0829293720449, "system_level_velocity_min": 11.310103565157462, "cost2_max": -8.241882819094508, "cost2_min": -51.000443360340164, "system_level_velocity_mean": 15.083898046482453, "cost1_min": 9.839869587533252, "cost1_max": 432.5782283507458, "cost1_mean": 377.0771542397283, "system_level_velocity_max": 17.818951623512305}, "timesteps_total": 8869747, "training_iteration": 87, "date": "2019-04-29_11-47-38", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c4e0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 87, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 713.2335305759348, "time_total_s": 3222.8618309497833, "info": {"grad_time_ms": 21833.353, "default": {"total_loss": 29.376617431640625, "kl": 0.018490001559257507, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01655665412545204, "vf_loss": 29.386932373046875, "entropy": 1.6834280490875244, "vf_explained_var": 0.4515721797943115, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 8869747, "load_time_ms": 15.325, "update_time_ms": 11.221, "sample_time_ms": 15133.782, "num_steps_sampled": 8869747}, "episode_reward_max": 901.1577860338602, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 15.597874705354151, "episodes_total": 6580, "episodes_this_iter": 75, "time_this_iter_s": 38.8534300327301, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100934, "timestamp": 1556538496, "episode_len_mean": 698.63, "timesteps_since_restore": 8970681, "time_since_restore": 3260.363191843033, "done": false, "custom_metrics": {"outflow_rate_min": 696.3551843061837, "outflow_rate_mean": 844.5645519252444, "cost2_mean": -28.766289038842142, "outflow_rate_max": 967.0729853317257, "system_level_velocity_min": 11.472478479263655, "cost2_max": -16.471242560544855, "cost2_min": -56.95817780301742, "system_level_velocity_mean": 15.04838753406704, "cost1_min": 294.0800075712475, "cost1_max": 434.338953572412, "cost1_mean": 384.8835641288429, "system_level_velocity_max": 16.915851228398825}, "timesteps_total": 8970681, "training_iteration": 88, "date": "2019-04-29_11-48-16", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d659e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d652b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 88, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 729.8829438852139, "time_total_s": 3260.363191843033, "info": {"grad_time_ms": 21957.029, "default": {"total_loss": 29.950225830078125, "kl": 0.01887192390859127, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016532577574253082, "vf_loss": 29.960384368896484, "entropy": 1.6919598579406738, "vf_explained_var": 0.4661458730697632, "cur_kl_coeff": 0.33750006556510925}, "num_steps_trained": 8970681, "load_time_ms": 14.534, "update_time_ms": 11.678, "sample_time_ms": 15171.969, "num_steps_sampled": 8970681}, "episode_reward_max": 886.1183695024937, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 604.1678258704115, "episodes_total": 6658, "episodes_this_iter": 78, "time_this_iter_s": 37.50136089324951, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100376, "timestamp": 1556538532, "episode_len_mean": 698.63, "timesteps_since_restore": 9071057, "time_since_restore": 3296.972139120102, "done": false, "custom_metrics": {"outflow_rate_min": 707.7351113781247, "outflow_rate_mean": 840.977103620263, "cost2_mean": -28.075599160360422, "outflow_rate_max": 967.0729853317257, "system_level_velocity_min": 11.961563802121608, "cost2_max": -16.471242560544855, "cost2_min": -47.01216537176999, "system_level_velocity_mean": 15.115638472672028, "cost1_min": 308.3019608574592, "cost1_max": 445.3130630745983, "cost1_mean": 385.23428949352683, "system_level_velocity_max": 17.77342385846703}, "timesteps_total": 9071057, "training_iteration": 89, "date": "2019-04-29_11-48-52", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c198>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 89, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 723.2468437119591, "time_total_s": 3296.972139120102, "info": {"grad_time_ms": 21760.345, "default": {"total_loss": 29.709815979003906, "kl": 0.02012278139591217, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016432417556643486, "vf_loss": 29.719457626342773, "entropy": 1.6816160678863525, "vf_explained_var": 0.4403991997241974, "cur_kl_coeff": 0.33750003576278687}, "num_steps_trained": 9071057, "load_time_ms": 13.432, "update_time_ms": 11.966, "sample_time_ms": 15179.913, "num_steps_sampled": 9071057}, "episode_reward_max": 886.1183695024937, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 576.2169360060476, "episodes_total": 6733, "episodes_this_iter": 75, "time_this_iter_s": 36.60894727706909, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100676, "timestamp": 1556538570, "episode_len_mean": 695.01, "timesteps_since_restore": 9171733, "time_since_restore": 3334.499132156372, "done": false, "custom_metrics": {"outflow_rate_min": 701.7107290661684, "outflow_rate_mean": 832.5492270531875, "cost2_mean": -26.71818144050217, "outflow_rate_max": 963.8435136674377, "system_level_velocity_min": 11.502401787672566, "cost2_max": -16.01363236955606, "cost2_min": -45.722713259935404, "system_level_velocity_mean": 15.10630896144937, "cost1_min": 120.7094592446551, "cost1_max": 445.3130630745983, "cost1_mean": 382.2600556189222, "system_level_velocity_max": 17.77342385846703}, "timesteps_total": 9171733, "training_iteration": 90, "date": "2019-04-29_11-49-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 90, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 710.5137445664731, "time_total_s": 3334.499132156372, "info": {"grad_time_ms": 21806.206, "default": {"total_loss": 34.180545806884766, "kl": 0.013833005912601948, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015003069303929806, "vf_loss": 34.18854522705078, "entropy": 1.6861060857772827, "vf_explained_var": 0.4127618670463562, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 9171733, "load_time_ms": 12.615, "update_time_ms": 11.977, "sample_time_ms": 15159.028, "num_steps_sampled": 9171733}, "episode_reward_max": 859.7972990755998, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 223.47188586167312, "episodes_total": 6814, "episodes_this_iter": 81, "time_this_iter_s": 37.52699303627014, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100615, "timestamp": 1556538606, "episode_len_mean": 700.0, "timesteps_since_restore": 9272348, "time_since_restore": 3370.4701170921326, "done": false, "custom_metrics": {"outflow_rate_min": 719.5592221936001, "outflow_rate_mean": 837.5539603858538, "cost2_mean": -27.20727054648137, "outflow_rate_max": 958.3896059448596, "system_level_velocity_min": 11.147632271479328, "cost2_max": -15.975744919714607, "cost2_min": -49.04556120211885, "system_level_velocity_mean": 15.282622969604526, "cost1_min": 285.0225332659385, "cost1_max": 450.28337820828267, "cost1_mean": 389.58487977178623, "system_level_velocity_max": 18.320788952575473}, "timesteps_total": 9272348, "training_iteration": 91, "date": "2019-04-29_11-50-06", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c6d8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 91, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 726.2724487575956, "time_total_s": 3370.4701170921326, "info": {"grad_time_ms": 21663.642, "default": {"total_loss": 33.45001983642578, "kl": 0.014994300901889801, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014676863327622414, "vf_loss": 33.45710754394531, "entropy": 1.6958421468734741, "vf_explained_var": 0.4331725537776947, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 9272348, "load_time_ms": 13.58, "update_time_ms": 12.03, "sample_time_ms": 15035.085, "num_steps_sampled": 9272348}, "episode_reward_max": 888.769557074714, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 585.237785639052, "episodes_total": 6894, "episodes_this_iter": 80, "time_this_iter_s": 35.9709849357605, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100682, "timestamp": 1556538643, "episode_len_mean": 682.2, "timesteps_since_restore": 9373030, "time_since_restore": 3407.675075531006, "done": false, "custom_metrics": {"outflow_rate_min": 463.10604991409474, "outflow_rate_mean": 825.7125662477185, "cost2_mean": -27.340332111142107, "outflow_rate_max": 963.8021178009534, "system_level_velocity_min": 10.772143612010034, "cost2_max": -12.60247203376208, "cost2_min": -49.04556120211885, "system_level_velocity_mean": 15.104213787406945, "cost1_min": 15.838856917906003, "cost1_max": 441.2669882248532, "cost1_mean": 373.6685358016974, "system_level_velocity_max": 17.635130235982807}, "timesteps_total": 9373030, "training_iteration": 92, "date": "2019-04-29_11-50-43", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 92, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 692.0039878649103, "time_total_s": 3407.675075531006, "info": {"grad_time_ms": 21715.883, "default": {"total_loss": 29.322772979736328, "kl": 0.013940778560936451, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014608344063162804, "vf_loss": 29.330324172973633, "entropy": 1.7076040506362915, "vf_explained_var": 0.4665229022502899, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 9373030, "load_time_ms": 13.113, "update_time_ms": 12.208, "sample_time_ms": 15057.918, "num_steps_sampled": 9373030}, "episode_reward_max": 820.7836011470337, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 35.616719018959856, "episodes_total": 6969, "episodes_this_iter": 75, "time_this_iter_s": 37.20495843887329, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100457, "timestamp": 1556538681, "episode_len_mean": 690.11, "timesteps_since_restore": 9473487, "time_since_restore": 3445.29861164093, "done": false, "custom_metrics": {"outflow_rate_min": 508.87183951581244, "outflow_rate_mean": 836.1802623221381, "cost2_mean": -28.409652441676215, "outflow_rate_max": 972.0678477260237, "system_level_velocity_min": 12.007554877817856, "cost2_max": -15.717977292720947, "cost2_min": -46.24114118261062, "system_level_velocity_mean": 14.89851131339756, "cost1_min": 26.030428645865605, "cost1_max": 438.6595574682846, "cost1_mean": 374.8254304359629, "system_level_velocity_max": 17.514219269855463}, "timesteps_total": 9473487, "training_iteration": 93, "date": "2019-04-29_11-51-21", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c0b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 93, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 707.8933346158882, "time_total_s": 3445.29861164093, "info": {"grad_time_ms": 21945.855, "default": {"total_loss": 30.48274040222168, "kl": 0.01370291318744421, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015080377459526062, "vf_loss": 30.49088478088379, "entropy": 1.691768765449524, "vf_explained_var": 0.4370422065258026, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 9473487, "load_time_ms": 13.039, "update_time_ms": 12.109, "sample_time_ms": 15041.461, "num_steps_sampled": 9473487}, "episode_reward_max": 847.2379569193232, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 46.19359187171896, "episodes_total": 7047, "episodes_this_iter": 78, "time_this_iter_s": 37.623536109924316, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99940, "timestamp": 1556538716, "episode_len_mean": 691.87, "timesteps_since_restore": 9573427, "time_since_restore": 3480.6687302589417, "done": false, "custom_metrics": {"outflow_rate_min": 494.35734413624397, "outflow_rate_mean": 835.9035119824132, "cost2_mean": -27.88921178788403, "outflow_rate_max": 997.9338194161321, "system_level_velocity_min": 12.440610876453185, "cost2_max": -14.3088133222762, "cost2_min": -49.198543280373116, "system_level_velocity_mean": 15.265275265764876, "cost1_min": 20.42630515086611, "cost1_max": 430.65673299437736, "cost1_mean": 384.13760104254783, "system_level_velocity_max": 17.746397924572296}, "timesteps_total": 9573427, "training_iteration": 94, "date": "2019-04-29_11-51-56", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d659e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65518>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 94, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 710.4808256870491, "time_total_s": 3480.6687302589417, "info": {"grad_time_ms": 21800.069, "default": {"total_loss": 31.2752628326416, "kl": 0.014647251926362514, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015750862658023834, "vf_loss": 31.283597946166992, "entropy": 1.7143980264663696, "vf_explained_var": 0.454404354095459, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 9573427, "load_time_ms": 14.076, "update_time_ms": 11.976, "sample_time_ms": 15069.488, "num_steps_sampled": 9573427}, "episode_reward_max": 847.2379569193232, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 39.98515495360144, "episodes_total": 7128, "episodes_this_iter": 81, "time_this_iter_s": 35.370118618011475, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100573, "timestamp": 1556538753, "episode_len_mean": 700.0, "timesteps_since_restore": 9674000, "time_since_restore": 3516.8379650115967, "done": false, "custom_metrics": {"outflow_rate_min": 663.8473485162733, "outflow_rate_mean": 828.9569032712171, "cost2_mean": -27.106931732897788, "outflow_rate_max": 997.9338194161321, "system_level_velocity_min": 12.482544140736495, "cost2_max": -17.927480714561323, "cost2_min": -39.27713236197136, "system_level_velocity_mean": 15.081003175300143, "cost1_min": 322.3281775704309, "cost1_max": 437.82265928134314, "cost1_mean": 385.17204000339075, "system_level_velocity_max": 17.510326771157978}, "timesteps_total": 9674000, "training_iteration": 95, "date": "2019-04-29_11-52-33", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c908>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 95, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 714.8420124803105, "time_total_s": 3516.8379650115967, "info": {"grad_time_ms": 21713.445, "default": {"total_loss": 32.010372161865234, "kl": 0.013538815081119537, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014085071161389351, "vf_loss": 32.01760482788086, "entropy": 1.7224855422973633, "vf_explained_var": 0.44297921657562256, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 9674000, "load_time_ms": 13.918, "update_time_ms": 11.981, "sample_time_ms": 15040.601, "num_steps_sampled": 9674000}, "episode_reward_max": 844.4601152966196, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 568.1696047432727, "episodes_total": 7205, "episodes_this_iter": 77, "time_this_iter_s": 36.16923475265503, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99643, "timestamp": 1556538791, "episode_len_mean": 693.42, "timesteps_since_restore": 9773643, "time_since_restore": 3555.154689311981, "done": false, "custom_metrics": {"outflow_rate_min": 663.8473485162733, "outflow_rate_mean": 833.0138074751809, "cost2_mean": -27.610275048529854, "outflow_rate_max": 958.4975060930054, "system_level_velocity_min": 11.790442010102938, "cost2_max": -16.524690041061483, "cost2_min": -54.94479979800034, "system_level_velocity_mean": 15.04005646877929, "cost1_min": 152.1177339640372, "cost1_max": 443.66152713981086, "cost1_mean": 380.1954530789434, "system_level_velocity_max": 17.671525585651228}, "timesteps_total": 9773643, "training_iteration": 96, "date": "2019-04-29_11-53-11", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c7f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 96, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 707.5092023156936, "time_total_s": 3555.154689311981, "info": {"grad_time_ms": 21813.178, "default": {"total_loss": 34.233009338378906, "kl": 0.014515768736600876, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015600007958710194, "vf_loss": 34.24126052856445, "entropy": 1.7142459154129028, "vf_explained_var": 0.385745644569397, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 9773643, "load_time_ms": 15.708, "update_time_ms": 12.043, "sample_time_ms": 15057.062, "num_steps_sampled": 9773643}, "episode_reward_max": 848.5860810328855, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 293.5010228596861, "episodes_total": 7286, "episodes_this_iter": 81, "time_this_iter_s": 38.31672430038452, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99779, "timestamp": 1556538826, "episode_len_mean": 698.23, "timesteps_since_restore": 9873422, "time_since_restore": 3590.386512517929, "done": false, "custom_metrics": {"outflow_rate_min": 691.5275299516286, "outflow_rate_mean": 832.692419643518, "cost2_mean": -27.18852258410119, "outflow_rate_max": 975.014451783143, "system_level_velocity_min": 11.773776088457591, "cost2_max": -17.760327984828415, "cost2_min": -57.95734976923867, "system_level_velocity_mean": 15.153884126346854, "cost1_min": 300.088904074123, "cost1_max": 443.66152713981086, "cost1_mean": 384.4581899977477, "system_level_velocity_max": 17.75507091082363}, "timesteps_total": 9873422, "training_iteration": 97, "date": "2019-04-29_11-53-46", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c3c8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 97, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 706.0031148762012, "time_total_s": 3590.386512517929, "info": {"grad_time_ms": 21439.363, "default": {"total_loss": 30.096649169921875, "kl": 0.013578260317444801, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015600509010255337, "vf_loss": 30.105379104614258, "entropy": 1.7447104454040527, "vf_explained_var": 0.4129554033279419, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 9873422, "load_time_ms": 15.777, "update_time_ms": 11.927, "sample_time_ms": 15070.65, "num_steps_sampled": 9873422}, "episode_reward_max": 884.9709706938629, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 473.34282868611615, "episodes_total": 7366, "episodes_this_iter": 80, "time_this_iter_s": 35.231823205947876, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99762, "timestamp": 1556538862, "episode_len_mean": 686.82, "timesteps_since_restore": 9973184, "time_since_restore": 3625.7001996040344, "done": false, "custom_metrics": {"outflow_rate_min": 490.6824065546897, "outflow_rate_mean": 823.8684157357748, "cost2_mean": -25.376911461443648, "outflow_rate_max": 989.2819544327639, "system_level_velocity_min": 12.581804288409995, "cost2_max": -14.014043379522798, "cost2_min": -42.019585649562714, "system_level_velocity_mean": 15.55305233475421, "cost1_min": 19.369480879643312, "cost1_max": 440.9560214377103, "cost1_mean": 386.09565546370607, "system_level_velocity_max": 18.075734408139926}, "timesteps_total": 9973184, "training_iteration": 98, "date": "2019-04-29_11-54-22", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c7f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 98, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 698.7725415339715, "time_total_s": 3625.7001996040344, "info": {"grad_time_ms": 21238.139, "default": {"total_loss": 30.413677215576172, "kl": 0.013677308335900307, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015166345052421093, "vf_loss": 30.421920776367188, "entropy": 1.737054705619812, "vf_explained_var": 0.4458349943161011, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 9973184, "load_time_ms": 16.192, "update_time_ms": 11.448, "sample_time_ms": 15050.337, "num_steps_sampled": 9973184}, "episode_reward_max": 841.4315866857122, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 40.42569546542739, "episodes_total": 7443, "episodes_this_iter": 77, "time_this_iter_s": 35.31368708610535, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99903, "timestamp": 1556538898, "episode_len_mean": 682.96, "timesteps_since_restore": 10073087, "time_since_restore": 3662.3851664066315, "done": false, "custom_metrics": {"outflow_rate_min": 541.8284998111702, "outflow_rate_mean": 817.7529397062178, "cost2_mean": -25.327229937388505, "outflow_rate_max": 988.7914584021893, "system_level_velocity_min": 12.770553089531276, "cost2_max": -15.151674958298244, "cost2_min": -37.714524299996185, "system_level_velocity_mean": 15.59917023933194, "cost1_min": 32.197246933174085, "cost1_max": 442.081827977034, "cost1_mean": 385.09482515822924, "system_level_velocity_max": 18.075734408139926}, "timesteps_total": 10073087, "training_iteration": 99, "date": "2019-04-29_11-54-58", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c438>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 99, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 691.8589402070753, "time_total_s": 3662.3851664066315, "info": {"grad_time_ms": 21235.974, "default": {"total_loss": 32.59526062011719, "kl": 0.013902288861572742, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01510127354413271, "vf_loss": 32.60332489013672, "entropy": 1.7323976755142212, "vf_explained_var": 0.4455980062484741, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 10073087, "load_time_ms": 16.136, "update_time_ms": 11.452, "sample_time_ms": 15060.373, "num_steps_sampled": 10073087}, "episode_reward_max": 841.4315866857122, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 61.43394494863431, "episodes_total": 7523, "episodes_this_iter": 80, "time_this_iter_s": 36.684966802597046, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100420, "timestamp": 1556538935, "episode_len_mean": 693.44, "timesteps_since_restore": 10173507, "time_since_restore": 3698.9365417957306, "done": false, "custom_metrics": {"outflow_rate_min": 533.5425044902677, "outflow_rate_mean": 811.1804263621083, "cost2_mean": -25.617669887417737, "outflow_rate_max": 988.7914584021893, "system_level_velocity_min": 11.771654686648354, "cost2_max": -14.561079880275908, "cost2_min": -44.194017267553555, "system_level_velocity_mean": 15.190412407763136, "cost1_min": 28.04833639630283, "cost1_max": 442.081827977034, "cost1_mean": 381.3577932263845, "system_level_velocity_max": 18.474572945535446}, "timesteps_total": 10173507, "training_iteration": 100, "date": "2019-04-29_11-55-35", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c7f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 100, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 697.7456934534767, "time_total_s": 3698.9365417957306, "info": {"grad_time_ms": 21162.769, "default": {"total_loss": 32.35320281982422, "kl": 0.013910213485360146, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016176102682948112, "vf_loss": 32.36233901977539, "entropy": 1.752944827079773, "vf_explained_var": 0.4409680962562561, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 10173507, "load_time_ms": 17.137, "update_time_ms": 11.432, "sample_time_ms": 15037.669, "num_steps_sampled": 10173507}, "episode_reward_max": 835.6488350604911, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 58.37539381282136, "episodes_total": 7603, "episodes_this_iter": 80, "time_this_iter_s": 36.55137538909912, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99938, "timestamp": 1556538972, "episode_len_mean": 700.0, "timesteps_since_restore": 10273445, "time_since_restore": 3735.527466058731, "done": false, "custom_metrics": {"outflow_rate_min": 664.189233994377, "outflow_rate_mean": 822.4949890448546, "cost2_mean": -27.183296927530154, "outflow_rate_max": 945.2034389502344, "system_level_velocity_min": 11.243552041780173, "cost2_max": -16.82957552298756, "cost2_min": -57.62592825367187, "system_level_velocity_mean": 14.96548585086067, "cost1_min": 292.3036503960921, "cost1_max": 435.7908383223879, "cost1_mean": 381.528613284224, "system_level_velocity_max": 17.46657659394933}, "timesteps_total": 10273445, "training_iteration": 101, "date": "2019-04-29_11-56-12", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df98>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 101, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 712.7745239850773, "time_total_s": 3735.527466058731, "info": {"grad_time_ms": 21278.362, "default": {"total_loss": 27.197511672973633, "kl": 0.01351704727858305, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014876632019877434, "vf_loss": 27.205543518066406, "entropy": 1.7333154678344727, "vf_explained_var": 0.44854894280433655, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 10273445, "load_time_ms": 17.578, "update_time_ms": 11.494, "sample_time_ms": 14986.224, "num_steps_sampled": 10273445}, "episode_reward_max": 848.5847041236332, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 599.4036137793669, "episodes_total": 7680, "episodes_this_iter": 77, "time_this_iter_s": 36.59092426300049, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99930, "timestamp": 1556539009, "episode_len_mean": 695.12, "timesteps_since_restore": 10373375, "time_since_restore": 3772.652114868164, "done": false, "custom_metrics": {"outflow_rate_min": 635.6614679808216, "outflow_rate_mean": 821.5432452419067, "cost2_mean": -25.350863509444313, "outflow_rate_max": 984.730108281889, "system_level_velocity_min": 12.754003470235018, "cost2_max": -16.376826237945384, "cost2_min": -48.00111745941137, "system_level_velocity_mean": 15.253886611149433, "cost1_min": 108.17020035814508, "cost1_max": 440.09408007549786, "cost1_mean": 384.9915332118627, "system_level_velocity_max": 18.03779935614392}, "timesteps_total": 10373375, "training_iteration": 102, "date": "2019-04-29_11-56-49", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ce10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 102, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 705.373255794844, "time_total_s": 3772.652114868164, "info": {"grad_time_ms": 21274.083, "default": {"total_loss": 31.889522552490234, "kl": 0.013882339932024479, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015056929551064968, "vf_loss": 31.897550582885742, "entropy": 1.7398719787597656, "vf_explained_var": 0.36793142557144165, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 10373375, "load_time_ms": 16.409, "update_time_ms": 11.208, "sample_time_ms": 14987.366, "num_steps_sampled": 10373375}, "episode_reward_max": 834.0711858546919, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 209.95388286638388, "episodes_total": 7760, "episodes_this_iter": 80, "time_this_iter_s": 37.12464880943298, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99429, "timestamp": 1556539046, "episode_len_mean": 695.91, "timesteps_since_restore": 10472804, "time_since_restore": 3810.0038425922394, "done": false, "custom_metrics": {"outflow_rate_min": 696.5203841401836, "outflow_rate_mean": 808.6721892077652, "cost2_mean": -25.085802391600943, "outflow_rate_max": 914.4488367756114, "system_level_velocity_min": 11.167378100854336, "cost2_max": -13.85569197181468, "cost2_min": -65.95913761174927, "system_level_velocity_mean": 15.25818139259242, "cost1_min": 218.58323299190906, "cost1_max": 438.6744929843821, "cost1_mean": 384.0842121233433, "system_level_velocity_max": 17.635427720095837}, "timesteps_total": 10472804, "training_iteration": 103, "date": "2019-04-29_11-57-26", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d657b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d656a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65668>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 103, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.7500330639233, "time_total_s": 3810.0038425922394, "info": {"grad_time_ms": 21261.567, "default": {"total_loss": 31.283031463623047, "kl": 0.014391599223017693, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01591883786022663, "vf_loss": 31.291664123535156, "entropy": 1.7647558450698853, "vf_explained_var": 0.396957665681839, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 10472804, "load_time_ms": 17.716, "update_time_ms": 11.249, "sample_time_ms": 14969.639, "num_steps_sampled": 10472804}, "episode_reward_max": 818.0882915230036, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 435.1038858530403, "episodes_total": 7841, "episodes_this_iter": 81, "time_this_iter_s": 37.35172772407532, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100237, "timestamp": 1556539085, "episode_len_mean": 700.0, "timesteps_since_restore": 10573041, "time_since_restore": 3848.206776857376, "done": false, "custom_metrics": {"outflow_rate_min": 671.5639463632913, "outflow_rate_mean": 802.2995838700706, "cost2_mean": -23.643736667097198, "outflow_rate_max": 948.3024321204801, "system_level_velocity_min": 12.551313017616668, "cost2_max": -13.85569197181468, "cost2_min": -40.20720774993131, "system_level_velocity_mean": 15.28989376383651, "cost1_min": 320.5130429842467, "cost1_max": 427.4188204493635, "cost1_mean": 387.355819855224, "system_level_velocity_max": 17.17052456463779}, "timesteps_total": 10573041, "training_iteration": 104, "date": "2019-04-29_11-58-05", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ccf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c358>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 104, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 699.3785581127843, "time_total_s": 3848.206776857376, "info": {"grad_time_ms": 21563.291, "default": {"total_loss": 30.21903419494629, "kl": 0.01306552067399025, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014455968514084816, "vf_loss": 30.22687339782715, "entropy": 1.7655911445617676, "vf_explained_var": 0.4195711314678192, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 10573041, "load_time_ms": 17.908, "update_time_ms": 11.271, "sample_time_ms": 14946.823, "num_steps_sampled": 10573041}, "episode_reward_max": 832.7296062905612, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 599.3820021688573, "episodes_total": 7921, "episodes_this_iter": 80, "time_this_iter_s": 38.20293426513672, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100070, "timestamp": 1556539121, "episode_len_mean": 696.55, "timesteps_since_restore": 10673111, "time_since_restore": 3884.2131612300873, "done": false, "custom_metrics": {"outflow_rate_min": 660.4286090412869, "outflow_rate_mean": 811.2457033704625, "cost2_mean": -25.04399535935537, "outflow_rate_max": 945.5461274140256, "system_level_velocity_min": 11.664832605537875, "cost2_max": -15.001310232077465, "cost2_min": -56.737255270236254, "system_level_velocity_mean": 15.190824054861247, "cost1_min": 198.67953270856378, "cost1_max": 440.50208477351686, "cost1_mean": 383.5459417911501, "system_level_velocity_max": 17.802408757276513}, "timesteps_total": 10673111, "training_iteration": 105, "date": "2019-04-29_11-58-41", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5db00>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 105, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 702.2946161291756, "time_total_s": 3884.2131612300873, "info": {"grad_time_ms": 21574.183, "default": {"total_loss": 29.280006408691406, "kl": 0.014164595864713192, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015789257362484932, "vf_loss": 29.28862762451172, "entropy": 1.748343825340271, "vf_explained_var": 0.4090442657470703, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 10673111, "load_time_ms": 17.226, "update_time_ms": 11.496, "sample_time_ms": 14922.17, "num_steps_sampled": 10673111}, "episode_reward_max": 832.7296062905612, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 353.88178971201876, "episodes_total": 7999, "episodes_this_iter": 78, "time_this_iter_s": 36.00638437271118, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99739, "timestamp": 1556539157, "episode_len_mean": 678.09, "timesteps_since_restore": 10772850, "time_since_restore": 3920.494846343994, "done": false, "custom_metrics": {"outflow_rate_min": 466.2378612271436, "outflow_rate_mean": 805.7058273774074, "cost2_mean": -25.62249457237153, "outflow_rate_max": 945.5461274140256, "system_level_velocity_min": 11.621733498943904, "cost2_max": -12.94634318919696, "cost2_min": -62.14877394648772, "system_level_velocity_mean": 15.113289429758083, "cost1_min": 15.64943104491547, "cost1_max": 436.374831211524, "cost1_mean": 370.3474666012101, "system_level_velocity_max": 17.951077883714383}, "timesteps_total": 10772850, "training_iteration": 106, "date": "2019-04-29_11-59-17", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c908>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 106, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 678.7228542831267, "time_total_s": 3920.494846343994, "info": {"grad_time_ms": 21415.759, "default": {"total_loss": 33.66573715209961, "kl": 0.013337171636521816, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015339893288910389, "vf_loss": 33.674320220947266, "entropy": 1.7640451192855835, "vf_explained_var": 0.38336190581321716, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 10772850, "load_time_ms": 17.177, "update_time_ms": 11.587, "sample_time_ms": 14879.356, "num_steps_sampled": 10772850}, "episode_reward_max": 804.8438926913004, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 32.78570969583306, "episodes_total": 8079, "episodes_this_iter": 80, "time_this_iter_s": 36.28168511390686, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99332, "timestamp": 1556539192, "episode_len_mean": 672.88, "timesteps_since_restore": 10872182, "time_since_restore": 3955.8597407341003, "done": false, "custom_metrics": {"outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 803.1103890367577, "cost2_mean": -23.921000687454075, "outflow_rate_max": 928.2801314606684, "system_level_velocity_min": 11.278900922130719, "cost2_max": -12.734091114205317, "cost2_min": -54.89951414927668, "system_level_velocity_mean": 15.344118918882963, "cost1_min": 14.793860776029952, "cost1_max": 440.35257230636705, "cost1_mean": 372.83583189006936, "system_level_velocity_max": 18.109729457925827}, "timesteps_total": 10872182, "training_iteration": 107, "date": "2019-04-29_11-59-52", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d659e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d639b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 107, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 669.8759297993171, "time_total_s": 3955.8597407341003, "info": {"grad_time_ms": 21449.937, "default": {"total_loss": 33.19304656982422, "kl": 0.013495794497430325, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016012944281101227, "vf_loss": 33.20222854614258, "entropy": 1.766565203666687, "vf_explained_var": 0.4018142521381378, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 10872182, "load_time_ms": 15.881, "update_time_ms": 11.557, "sample_time_ms": 14863.42, "num_steps_sampled": 10872182}, "episode_reward_max": 795.8587246295748, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 32.48060076399104, "episodes_total": 8165, "episodes_this_iter": 86, "time_this_iter_s": 35.3648943901062, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100059, "timestamp": 1556539229, "episode_len_mean": 696.72, "timesteps_since_restore": 10972241, "time_since_restore": 3992.836696624756, "done": false, "custom_metrics": {"outflow_rate_min": 645.8402189278959, "outflow_rate_mean": 803.1985745461102, "cost2_mean": -23.978868507619513, "outflow_rate_max": 1001.6963216896005, "system_level_velocity_min": 11.960666095680295, "cost2_max": -14.801849646548401, "cost2_min": -42.41196547156293, "system_level_velocity_mean": 15.358599039073917, "cost1_min": 183.03705654734148, "cost1_max": 433.8946441477536, "cost1_mean": 386.99285875907697, "system_level_velocity_max": 17.911823470075742}, "timesteps_total": 10972241, "training_iteration": 108, "date": "2019-04-29_12-00-29", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c5f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 108, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 690.7023055530045, "time_total_s": 3992.836696624756, "info": {"grad_time_ms": 21612.64, "default": {"total_loss": 30.049240112304688, "kl": 0.014132020995020866, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01689242012798786, "vf_loss": 30.058979034423828, "entropy": 1.7908289432525635, "vf_explained_var": 0.4296538829803467, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 10972241, "load_time_ms": 16.43, "update_time_ms": 11.531, "sample_time_ms": 14866.95, "num_steps_sampled": 10972241}, "episode_reward_max": 797.2170487673361, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 348.59121586550214, "episodes_total": 8244, "episodes_this_iter": 79, "time_this_iter_s": 36.97695589065552, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99671, "timestamp": 1556539266, "episode_len_mean": 698.07, "timesteps_since_restore": 11071912, "time_since_restore": 4029.2268800735474, "done": false, "custom_metrics": {"outflow_rate_min": 673.4211221185494, "outflow_rate_mean": 804.7723054235255, "cost2_mean": -24.933505333907874, "outflow_rate_max": 1001.6963216896005, "system_level_velocity_min": 12.461632423523987, "cost2_max": -15.428731594857668, "cost2_min": -42.41196547156293, "system_level_velocity_mean": 15.063775973108394, "cost1_min": 310.28496575310555, "cost1_max": 433.8946441477536, "cost1_mean": 380.7477740053053, "system_level_velocity_max": 17.911823470075742}, "timesteps_total": 11071912, "training_iteration": 109, "date": "2019-04-29_12-01-06", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d654e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65940>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 109, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 688.8888924096208, "time_total_s": 4029.2268800735474, "info": {"grad_time_ms": 21620.591, "default": {"total_loss": 30.66053581237793, "kl": 0.013942478224635124, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016551511362195015, "vf_loss": 30.670026779174805, "entropy": 1.7764623165130615, "vf_explained_var": 0.40276268124580383, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 11071912, "load_time_ms": 16.495, "update_time_ms": 11.466, "sample_time_ms": 14832.189, "num_steps_sampled": 11071912}, "episode_reward_max": 798.1239348878772, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 473.4654248262452, "episodes_total": 8320, "episodes_this_iter": 76, "time_this_iter_s": 36.390183448791504, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99650, "timestamp": 1556539300, "episode_len_mean": 699.56, "timesteps_since_restore": 11171562, "time_since_restore": 4063.2639055252075, "done": false, "custom_metrics": {"outflow_rate_min": 673.2129499594371, "outflow_rate_mean": 813.5101540243674, "cost2_mean": -25.94312841550491, "outflow_rate_max": 933.665458083848, "system_level_velocity_min": 12.576427468260809, "cost2_max": -15.428731594857668, "cost2_min": -51.917213509938655, "system_level_velocity_mean": 15.122802690120373, "cost1_min": 322.62882343064257, "cost1_max": 432.220525441862, "cost1_mean": 383.11547364023653, "system_level_velocity_max": 17.31651108886425}, "timesteps_total": 11171562, "training_iteration": 110, "date": "2019-04-29_12-01-40", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c588>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 110, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 698.9236905575349, "time_total_s": 4063.2639055252075, "info": {"grad_time_ms": 21359.484, "default": {"total_loss": 32.79698944091797, "kl": 0.013833805918693542, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015809273347258568, "vf_loss": 32.8057975769043, "entropy": 1.7758140563964844, "vf_explained_var": 0.3724408447742462, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 11171562, "load_time_ms": 15.855, "update_time_ms": 11.475, "sample_time_ms": 14840.179, "num_steps_sampled": 11171562}, "episode_reward_max": 830.5917553023579, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 530.8891867815435, "episodes_total": 8402, "episodes_this_iter": 82, "time_this_iter_s": 34.037025451660156, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100364, "timestamp": 1556539337, "episode_len_mean": 697.82, "timesteps_since_restore": 11271926, "time_since_restore": 4099.780455589294, "done": false, "custom_metrics": {"outflow_rate_min": 673.2129499594371, "outflow_rate_mean": 803.2687766224361, "cost2_mean": -25.940227684529667, "outflow_rate_max": 928.0155852084006, "system_level_velocity_min": 11.364288349114185, "cost2_max": -15.924892741546953, "cost2_min": -43.55727912030059, "system_level_velocity_mean": 14.987777543030568, "cost1_min": 241.16293618818173, "cost1_max": 440.85778046781286, "cost1_mean": 379.9900893908078, "system_level_velocity_max": 17.455285124241144}, "timesteps_total": 11271926, "training_iteration": 111, "date": "2019-04-29_12-02-17", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ce48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c128>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 111, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 690.0737195436433, "time_total_s": 4099.780455589294, "info": {"grad_time_ms": 21323.682, "default": {"total_loss": 28.71721076965332, "kl": 0.013687500730156898, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016172414645552635, "vf_loss": 28.72645378112793, "entropy": 1.780049204826355, "vf_explained_var": 0.4401988685131073, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 11271926, "load_time_ms": 15.205, "update_time_ms": 11.393, "sample_time_ms": 14867.682, "num_steps_sampled": 11271926}, "episode_reward_max": 821.732230687023, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 492.9203647086739, "episodes_total": 8482, "episodes_this_iter": 80, "time_this_iter_s": 36.516550064086914, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100120, "timestamp": 1556539374, "episode_len_mean": 692.5, "timesteps_since_restore": 11372046, "time_since_restore": 4136.782031297684, "done": false, "custom_metrics": {"outflow_rate_min": 701.3887071290934, "outflow_rate_mean": 820.2145736268103, "cost2_mean": -26.349636235775066, "outflow_rate_max": 929.2932994834913, "system_level_velocity_min": 11.364288349114185, "cost2_max": -16.63842047841188, "cost2_min": -59.689394505569034, "system_level_velocity_mean": 15.104141661994916, "cost1_min": 118.60436010383438, "cost1_max": 433.1287569993776, "cost1_mean": 379.00414749895356, "system_level_velocity_max": 17.230924666088747}, "timesteps_total": 11372046, "training_iteration": 112, "date": "2019-04-29_12-02-54", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ccf8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 112, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 690.9948162687022, "time_total_s": 4136.782031297684, "info": {"grad_time_ms": 21337.951, "default": {"total_loss": 31.38360595703125, "kl": 0.01316207367926836, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015200193971395493, "vf_loss": 31.39214324951172, "entropy": 1.7799409627914429, "vf_explained_var": 0.4062899649143219, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 11372046, "load_time_ms": 15.911, "update_time_ms": 11.373, "sample_time_ms": 14837.847, "num_steps_sampled": 11372046}, "episode_reward_max": 844.1222621249607, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 230.57181376078935, "episodes_total": 8559, "episodes_this_iter": 77, "time_this_iter_s": 37.00157570838928, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100183, "timestamp": 1556539410, "episode_len_mean": 696.3, "timesteps_since_restore": 11472229, "time_since_restore": 4173.159459352493, "done": false, "custom_metrics": {"outflow_rate_min": 657.0732048632635, "outflow_rate_mean": 819.6249766693091, "cost2_mean": -25.220589381780005, "outflow_rate_max": 945.2891367176283, "system_level_velocity_min": 11.588533291229956, "cost2_max": -14.616836678169674, "cost2_min": -59.689394505569034, "system_level_velocity_mean": 15.15452705327412, "cost1_min": 248.6274761652124, "cost1_max": 431.28780741235687, "cost1_mean": 382.4945085528811, "system_level_velocity_max": 17.486572969186955}, "timesteps_total": 11472229, "training_iteration": 113, "date": "2019-04-29_12-03-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ceb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c978>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 113, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 698.9536932470758, "time_total_s": 4173.159459352493, "info": {"grad_time_ms": 21168.502, "default": {"total_loss": 32.39374542236328, "kl": 0.013494723476469517, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01549537107348442, "vf_loss": 32.402408599853516, "entropy": 1.7855429649353027, "vf_explained_var": 0.39739036560058594, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 11472229, "load_time_ms": 15.015, "update_time_ms": 11.374, "sample_time_ms": 14912.5, "num_steps_sampled": 11472229}, "episode_reward_max": 838.4554211444691, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 493.44424893166433, "episodes_total": 8639, "episodes_this_iter": 80, "time_this_iter_s": 36.37742805480957, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100121, "timestamp": 1556539446, "episode_len_mean": 682.35, "timesteps_since_restore": 11572350, "time_since_restore": 4209.453320503235, "done": false, "custom_metrics": {"outflow_rate_min": 440.29843071181995, "outflow_rate_mean": 820.4134442615672, "cost2_mean": -26.016095631352083, "outflow_rate_max": 976.9145947317537, "system_level_velocity_min": 11.750130237644449, "cost2_max": -9.321593751859648, "cost2_min": -51.05115375243398, "system_level_velocity_mean": 15.06057748270651, "cost1_min": 10.147200780281995, "cost1_max": 431.41020961165583, "cost1_mean": 373.26769869467296, "system_level_velocity_max": 17.486572969186955}, "timesteps_total": 11572350, "training_iteration": 114, "date": "2019-04-29_12-04-06", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ccc0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 114, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 688.7939399797433, "time_total_s": 4209.453320503235, "info": {"grad_time_ms": 20997.23, "default": {"total_loss": 31.836326599121094, "kl": 0.014407843351364136, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016421839594841003, "vf_loss": 31.8454532623291, "entropy": 1.7806833982467651, "vf_explained_var": 0.42591893672943115, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 11572350, "load_time_ms": 13.222, "update_time_ms": 11.462, "sample_time_ms": 14897.801, "num_steps_sampled": 11572350}, "episode_reward_max": 839.6088073235956, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 15.52010567883433, "episodes_total": 8716, "episodes_this_iter": 77, "time_this_iter_s": 36.29386115074158, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100299, "timestamp": 1556539484, "episode_len_mean": 690.71, "timesteps_since_restore": 11672649, "time_since_restore": 4246.9754140377045, "done": false, "custom_metrics": {"outflow_rate_min": 440.29843071181995, "outflow_rate_mean": 812.8548437640707, "cost2_mean": -24.543262403508326, "outflow_rate_max": 1012.9547118651427, "system_level_velocity_min": 11.586275334247015, "cost2_max": -9.321593751859648, "cost2_min": -38.02673197625106, "system_level_velocity_mean": 15.20382797364084, "cost1_min": 10.147200780281995, "cost1_max": 431.7295468202666, "cost1_mean": 381.37173955741383, "system_level_velocity_max": 17.332293187356886}, "timesteps_total": 11672649, "training_iteration": 115, "date": "2019-04-29_12-04-44", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d3c8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 115, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.0400665958518, "time_total_s": 4246.9754140377045, "info": {"grad_time_ms": 21130.268, "default": {"total_loss": 32.971282958984375, "kl": 0.014221388846635818, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016963189467787743, "vf_loss": 32.981048583984375, "entropy": 1.7907581329345703, "vf_explained_var": 0.3850947320461273, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 11672649, "load_time_ms": 14.528, "update_time_ms": 11.372, "sample_time_ms": 14912.479, "num_steps_sampled": 11672649}, "episode_reward_max": 839.4395046261094, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 15.52010567883433, "episodes_total": 8797, "episodes_this_iter": 81, "time_this_iter_s": 37.522093534469604, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100168, "timestamp": 1556539521, "episode_len_mean": 693.44, "timesteps_since_restore": 11772817, "time_since_restore": 4284.153121948242, "done": false, "custom_metrics": {"outflow_rate_min": 514.0709317557338, "outflow_rate_mean": 818.6032198824096, "cost2_mean": -25.973168677234625, "outflow_rate_max": 957.4606502265893, "system_level_velocity_min": 11.3506218307009, "cost2_max": -12.100219034175218, "cost2_min": -82.44025403362127, "system_level_velocity_mean": 15.127155302540936, "cost1_min": 24.261634324896526, "cost1_max": 435.71923248763653, "cost1_mean": 381.0976419872526, "system_level_velocity_max": 17.263255243846114}, "timesteps_total": 11772817, "training_iteration": 116, "date": "2019-04-29_12-05-21", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ca20>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 116, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 703.1333372907606, "time_total_s": 4284.153121948242, "info": {"grad_time_ms": 21185.162, "default": {"total_loss": 32.393470764160156, "kl": 0.013993136584758759, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014515319839119911, "vf_loss": 32.400901794433594, "entropy": 1.78218674659729, "vf_explained_var": 0.40199002623558044, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 11772817, "load_time_ms": 13.496, "update_time_ms": 11.171, "sample_time_ms": 14947.457, "num_steps_sampled": 11772817}, "episode_reward_max": 856.9901292103456, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 44.534485960335516, "episodes_total": 8879, "episodes_this_iter": 82, "time_this_iter_s": 37.17770791053772, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99925, "timestamp": 1556539558, "episode_len_mean": 682.35, "timesteps_since_restore": 11872742, "time_since_restore": 4321.189470529556, "done": false, "custom_metrics": {"outflow_rate_min": 519.8515632511079, "outflow_rate_mean": 814.3499782890954, "cost2_mean": -26.937524634049545, "outflow_rate_max": 984.5485835939004, "system_level_velocity_min": 11.3506218307009, "cost2_max": -14.680567375626195, "cost2_min": -82.44025403362127, "system_level_velocity_mean": 15.005645708108544, "cost1_min": 26.395307838058706, "cost1_max": 432.64807646252245, "cost1_mean": 371.16337237923005, "system_level_velocity_max": 17.53098654844398}, "timesteps_total": 11872742, "training_iteration": 117, "date": "2019-04-29_12-05-58", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c470>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 117, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 687.8404851917355, "time_total_s": 4321.189470529556, "info": {"grad_time_ms": 21355.279, "default": {"total_loss": 31.594310760498047, "kl": 0.014487222768366337, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01599101722240448, "vf_loss": 31.60296630859375, "entropy": 1.7866946458816528, "vf_explained_var": 0.386980801820755, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 11872742, "load_time_ms": 13.417, "update_time_ms": 11.212, "sample_time_ms": 14942.738, "num_steps_sampled": 11872742}, "episode_reward_max": 845.3707157610582, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 45.609294549684414, "episodes_total": 8956, "episodes_this_iter": 77, "time_this_iter_s": 37.03634858131409, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100320, "timestamp": 1556539595, "episode_len_mean": 700.0, "timesteps_since_restore": 11973062, "time_since_restore": 4358.065604686737, "done": false, "custom_metrics": {"outflow_rate_min": 699.3201026265363, "outflow_rate_mean": 817.0266504246314, "cost2_mean": -25.914122987307387, "outflow_rate_max": 969.5292425659618, "system_level_velocity_min": 11.083206450723447, "cost2_max": -15.74212616273784, "cost2_min": -66.0112805654747, "system_level_velocity_mean": 15.091972261507102, "cost1_min": 293.4054427927938, "cost1_max": 434.32751156671486, "cost1_mean": 383.57846451754915, "system_level_velocity_max": 17.725367817112247}, "timesteps_total": 11973062, "training_iteration": 118, "date": "2019-04-29_12-06-35", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cc88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c438>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 118, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 707.5093007449142, "time_total_s": 4358.065604686737, "info": {"grad_time_ms": 21340.573, "default": {"total_loss": 33.70503616333008, "kl": 0.013873882591724396, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015407869592308998, "vf_loss": 33.71342086791992, "entropy": 1.7802749872207642, "vf_explained_var": 0.37436041235923767, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 11973062, "load_time_ms": 13.476, "update_time_ms": 11.097, "sample_time_ms": 14947.57, "num_steps_sampled": 11973062}, "episode_reward_max": 810.933887524922, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 538.7520425117698, "episodes_total": 9037, "episodes_this_iter": 81, "time_this_iter_s": 36.876134157180786, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100146, "timestamp": 1556539633, "episode_len_mean": 679.91, "timesteps_since_restore": 12073208, "time_since_restore": 4395.341334581375, "done": false, "custom_metrics": {"outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 812.3459920440338, "cost2_mean": -25.224969144135134, "outflow_rate_max": 964.6444990216563, "system_level_velocity_min": 12.609553473170843, "cost2_max": -11.592710662863297, "cost2_min": -46.95103399001989, "system_level_velocity_mean": 15.139380698876055, "cost1_min": 14.855336011486788, "cost1_max": 434.2001079346493, "cost1_mean": 371.26214578272726, "system_level_velocity_max": 17.912193398100467}, "timesteps_total": 12073208, "training_iteration": 119, "date": "2019-04-29_12-07-13", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ca90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cda0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 119, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 687.6736853054734, "time_total_s": 4395.341334581375, "info": {"grad_time_ms": 21359.779, "default": {"total_loss": 30.966772079467773, "kl": 0.013826093636453152, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015199257992208004, "vf_loss": 30.974973678588867, "entropy": 1.7982661724090576, "vf_explained_var": 0.37752774357795715, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 12073208, "load_time_ms": 14.484, "update_time_ms": 10.904, "sample_time_ms": 15013.845, "num_steps_sampled": 12073208}, "episode_reward_max": 821.7712876770509, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 31.645769677033005, "episodes_total": 9112, "episodes_this_iter": 75, "time_this_iter_s": 37.27572989463806, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99914, "timestamp": 1556539670, "episode_len_mean": 673.45, "timesteps_since_restore": 12173122, "time_since_restore": 4433.155816316605, "done": false, "custom_metrics": {"outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 811.2810033751036, "cost2_mean": -23.641916710389324, "outflow_rate_max": 1006.7742336281477, "system_level_velocity_min": 12.714347863509419, "cost2_max": -11.592710662863297, "cost2_min": -43.063132012825896, "system_level_velocity_mean": 15.378018394477706, "cost1_min": 14.855336011486788, "cost1_max": 436.7293852775667, "cost1_mean": 374.18749844017475, "system_level_velocity_max": 17.58220543080855}, "timesteps_total": 12173122, "training_iteration": 120, "date": "2019-04-29_12-07-50", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d128>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 120, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 681.0972101586664, "time_total_s": 4433.155816316605, "info": {"grad_time_ms": 21715.259, "default": {"total_loss": 37.51463317871094, "kl": 0.013882661238312721, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015200181864202023, "vf_loss": 37.52280807495117, "entropy": 1.7987780570983887, "vf_explained_var": 0.33893072605133057, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 12173122, "load_time_ms": 14.23, "update_time_ms": 10.906, "sample_time_ms": 15038.278, "num_steps_sampled": 12173122}, "episode_reward_max": 832.9557058767584, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 31.645769677033005, "episodes_total": 9202, "episodes_this_iter": 90, "time_this_iter_s": 37.81448173522949, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99890, "timestamp": 1556539711, "episode_len_mean": 685.61, "timesteps_since_restore": 12273012, "time_since_restore": 4473.788520336151, "done": false, "custom_metrics": {"outflow_rate_min": 480.45261623008713, "outflow_rate_mean": 818.6956937367202, "cost2_mean": -26.099518957110252, "outflow_rate_max": 1001.2663288471477, "system_level_velocity_min": 11.386046816377979, "cost2_max": -15.323855207891178, "cost2_min": -63.25064764598533, "system_level_velocity_mean": 15.213305258222451, "cost1_min": 21.355573093333213, "cost1_max": 430.53157420628463, "cost1_mean": 377.8523242831452, "system_level_velocity_max": 17.386083865213855}, "timesteps_total": 12273012, "training_iteration": 121, "date": "2019-04-29_12-08-31", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65550>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 121, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 692.9957457607984, "time_total_s": 4473.788520336151, "info": {"grad_time_ms": 22009.218, "default": {"total_loss": 34.069969177246094, "kl": 0.014651337638497353, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01639610156416893, "vf_loss": 34.078948974609375, "entropy": 1.7919036149978638, "vf_explained_var": 0.38032954931259155, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 12273012, "load_time_ms": 14.413, "update_time_ms": 10.798, "sample_time_ms": 15155.104, "num_steps_sampled": 12273012}, "episode_reward_max": 855.5171701491927, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 39.159681941604255, "episodes_total": 9280, "episodes_this_iter": 78, "time_this_iter_s": 40.63270401954651, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99926, "timestamp": 1556539746, "episode_len_mean": 697.57, "timesteps_since_restore": 12372938, "time_since_restore": 4509.033601284027, "done": false, "custom_metrics": {"outflow_rate_min": 687.2996479688569, "outflow_rate_mean": 820.4667339781914, "cost2_mean": -25.6268424726862, "outflow_rate_max": 979.992035047265, "system_level_velocity_min": 11.695437455182274, "cost2_max": -15.573735775478086, "cost2_min": -56.88098970553166, "system_level_velocity_mean": 15.173220966351142, "cost1_min": 264.24452753438345, "cost1_max": 428.06675017382497, "cost1_mean": 383.73952181366286, "system_level_velocity_max": 17.31099864199433}, "timesteps_total": 12372938, "training_iteration": 122, "date": "2019-04-29_12-09-06", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d160>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 122, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 694.0595672130734, "time_total_s": 4509.033601284027, "info": {"grad_time_ms": 21846.098, "default": {"total_loss": 32.732425689697266, "kl": 0.0141542823985219, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014913104474544525, "vf_loss": 32.74017333984375, "entropy": 1.8008757829666138, "vf_explained_var": 0.3448805510997772, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 12372938, "load_time_ms": 13.709, "update_time_ms": 10.768, "sample_time_ms": 15145.853, "num_steps_sampled": 12372938}, "episode_reward_max": 804.1589254699278, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 451.5382203743085, "episodes_total": 9356, "episodes_this_iter": 76, "time_this_iter_s": 35.24508094787598, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99181, "timestamp": 1556539783, "episode_len_mean": 683.63, "timesteps_since_restore": 12472119, "time_since_restore": 4545.549154520035, "done": false, "custom_metrics": {"outflow_rate_min": 470.6106698001805, "outflow_rate_mean": 801.14754745204, "cost2_mean": -24.965949815561824, "outflow_rate_max": 969.2607194455493, "system_level_velocity_min": 10.204343785231204, "cost2_max": -11.789744030447936, "cost2_min": -60.32465766257846, "system_level_velocity_mean": 15.361663598793925, "cost1_min": 12.870526587413956, "cost1_max": 439.1102792622285, "cost1_mean": 379.14617991895693, "system_level_velocity_max": 17.80695800801418}, "timesteps_total": 12472119, "training_iteration": 123, "date": "2019-04-29_12-09-43", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cc50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c0b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 123, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 684.35313205726, "time_total_s": 4545.549154520035, "info": {"grad_time_ms": 21907.245, "default": {"total_loss": 33.00859451293945, "kl": 0.014296961948275566, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015825722366571426, "vf_loss": 33.01718521118164, "entropy": 1.8081384897232056, "vf_explained_var": 0.349529504776001, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 12472119, "load_time_ms": 13.472, "update_time_ms": 10.962, "sample_time_ms": 15097.172, "num_steps_sampled": 12472119}, "episode_reward_max": 807.6108706184477, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 27.141344547613976, "episodes_total": 9440, "episodes_this_iter": 84, "time_this_iter_s": 36.51555323600769, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99230, "timestamp": 1556539821, "episode_len_mean": 691.23, "timesteps_since_restore": 12571349, "time_since_restore": 4582.998021841049, "done": false, "custom_metrics": {"outflow_rate_min": 461.5110052641438, "outflow_rate_mean": 819.1195811742797, "cost2_mean": -23.55821941924483, "outflow_rate_max": 963.0788685220272, "system_level_velocity_min": 12.394504988304197, "cost2_max": -13.67490926425227, "cost2_min": -43.060682042703114, "system_level_velocity_mean": 15.688470307804975, "cost1_min": 16.498636347921966, "cost1_max": 439.1102792622285, "cost1_mean": 391.2627538347477, "system_level_velocity_max": 17.80695800801418}, "timesteps_total": 12571349, "training_iteration": 124, "date": "2019-04-29_12-10-21", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d128>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 124, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 700.0513063529195, "time_total_s": 4582.998021841049, "info": {"grad_time_ms": 21971.766, "default": {"total_loss": 34.86320495605469, "kl": 0.013662138022482395, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01466449350118637, "vf_loss": 34.87095260620117, "entropy": 1.8146562576293945, "vf_explained_var": 0.33082908391952515, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 12571349, "load_time_ms": 14.906, "update_time_ms": 11.091, "sample_time_ms": 15143.8, "num_steps_sampled": 12571349}, "episode_reward_max": 801.145739348959, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 34.86480846860575, "episodes_total": 9520, "episodes_this_iter": 80, "time_this_iter_s": 37.448867321014404, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99352, "timestamp": 1556539856, "episode_len_mean": 686.37, "timesteps_since_restore": 12670701, "time_since_restore": 4618.6121146678925, "done": false, "custom_metrics": {"outflow_rate_min": 461.5110052641438, "outflow_rate_mean": 804.082441933191, "cost2_mean": -23.331471092361102, "outflow_rate_max": 945.3565136121134, "system_level_velocity_min": 12.238730978309645, "cost2_max": -13.67490926425227, "cost2_min": -39.597250813164386, "system_level_velocity_mean": 15.57001738033038, "cost1_min": 16.498636347921966, "cost1_max": 432.97918107557643, "cost1_mean": 384.78921634887587, "system_level_velocity_max": 17.95120772055294}, "timesteps_total": 12670701, "training_iteration": 125, "date": "2019-04-29_12-10-56", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d3c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 125, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 680.2729165443087, "time_total_s": 4618.6121146678925, "info": {"grad_time_ms": 21798.577, "default": {"total_loss": 34.835350036621094, "kl": 0.013667418621480465, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014056197367608547, "vf_loss": 34.84248733520508, "entropy": 1.8195422887802124, "vf_explained_var": 0.30146920680999756, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 12670701, "load_time_ms": 13.474, "update_time_ms": 11.193, "sample_time_ms": 15130.935, "num_steps_sampled": 12670701}, "episode_reward_max": 807.4604375825926, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 34.86480846860575, "episodes_total": 9602, "episodes_this_iter": 82, "time_this_iter_s": 35.61409282684326, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99961, "timestamp": 1556539895, "episode_len_mean": 696.36, "timesteps_since_restore": 12770662, "time_since_restore": 4657.00693821907, "done": false, "custom_metrics": {"outflow_rate_min": 689.7751160775196, "outflow_rate_mean": 825.1811791879545, "cost2_mean": -24.427862700953046, "outflow_rate_max": 945.3565136121134, "system_level_velocity_min": 11.866620361947403, "cost2_max": -14.510799512134229, "cost2_min": -42.678651237265704, "system_level_velocity_mean": 15.489778309317769, "cost1_min": 183.14003212874044, "cost1_max": 437.2660894823712, "cost1_mean": 388.74916127820734, "system_level_velocity_max": 18.307040632578857}, "timesteps_total": 12770662, "training_iteration": 126, "date": "2019-04-29_12-11-35", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cf28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c7b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 126, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 699.122407866127, "time_total_s": 4657.00693821907, "info": {"grad_time_ms": 21809.144, "default": {"total_loss": 35.46591567993164, "kl": 0.013468382880091667, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014441262930631638, "vf_loss": 35.47353744506836, "entropy": 1.8323417901992798, "vf_explained_var": 0.30945515632629395, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 12770662, "load_time_ms": 14.514, "update_time_ms": 11.195, "sample_time_ms": 15241.005, "num_steps_sampled": 12770662}, "episode_reward_max": 838.6224540718638, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 359.87790540042, "episodes_total": 9687, "episodes_this_iter": 85, "time_this_iter_s": 38.39482355117798, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99284, "timestamp": 1556539931, "episode_len_mean": 688.34, "timesteps_since_restore": 12869946, "time_since_restore": 4693.283030748367, "done": false, "custom_metrics": {"outflow_rate_min": 476.4898462992569, "outflow_rate_mean": 822.4220591395421, "cost2_mean": -24.012645666667655, "outflow_rate_max": 961.6692399650016, "system_level_velocity_min": 12.29127480409896, "cost2_max": -10.9752819206472, "cost2_min": -39.719350139507355, "system_level_velocity_mean": 15.603561951474722, "cost1_min": 14.03725695950382, "cost1_max": 439.08144704244444, "cost1_mean": 387.02700011080793, "system_level_velocity_max": 17.698280412904897}, "timesteps_total": 12869946, "training_iteration": 127, "date": "2019-04-29_12-12-11", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f0f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 127, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 699.4883674348315, "time_total_s": 4693.283030748367, "info": {"grad_time_ms": 21730.115, "default": {"total_loss": 33.09183883666992, "kl": 0.014345250092446804, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015313784591853619, "vf_loss": 33.09988784790039, "entropy": 1.8297137022018433, "vf_explained_var": 0.3217889070510864, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 12869946, "load_time_ms": 15.525, "update_time_ms": 11.133, "sample_time_ms": 15241.13, "num_steps_sampled": 12869946}, "episode_reward_max": 822.3922764314972, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 29.66128287054895, "episodes_total": 9757, "episodes_this_iter": 70, "time_this_iter_s": 36.276092529296875, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99862, "timestamp": 1556539968, "episode_len_mean": 693.39, "timesteps_since_restore": 12969808, "time_since_restore": 4730.549955844879, "done": false, "custom_metrics": {"outflow_rate_min": 525.7124222124799, "outflow_rate_mean": 824.303674177378, "cost2_mean": -25.383536774607947, "outflow_rate_max": 1009.3805893014637, "system_level_velocity_min": 10.110247420577705, "cost2_max": -14.058201969561186, "cost2_min": -45.05243779177985, "system_level_velocity_mean": 15.421594272631502, "cost1_min": 24.800311621615965, "cost1_max": 439.71850553807496, "cost1_mean": 386.32821057824583, "system_level_velocity_max": 17.783418480274143}, "timesteps_total": 12969808, "training_iteration": 128, "date": "2019-04-29_12-12-48", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c710>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 128, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 699.5386337848394, "time_total_s": 4730.549955844879, "info": {"grad_time_ms": 21748.216, "default": {"total_loss": 35.37312316894531, "kl": 0.013572387397289276, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014056420885026455, "vf_loss": 35.38031005859375, "entropy": 1.8186516761779785, "vf_explained_var": 0.3284352123737335, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 12969808, "load_time_ms": 14.665, "update_time_ms": 11.363, "sample_time_ms": 15265.274, "num_steps_sampled": 12969808}, "episode_reward_max": 820.6751732875731, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 51.21943448812342, "episodes_total": 9844, "episodes_this_iter": 87, "time_this_iter_s": 37.26692509651184, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100048, "timestamp": 1556540006, "episode_len_mean": 697.11, "timesteps_since_restore": 13069856, "time_since_restore": 4767.945069551468, "done": false, "custom_metrics": {"outflow_rate_min": 704.1320023721191, "outflow_rate_mean": 817.9677900341849, "cost2_mean": -25.523779636244793, "outflow_rate_max": 983.0609317129617, "system_level_velocity_min": 11.891748219021938, "cost2_max": -16.88418918618622, "cost2_min": -54.65383593960874, "system_level_velocity_mean": 15.217751675354846, "cost1_min": 254.53030849977495, "cost1_max": 446.0355894402993, "cost1_mean": 383.21273205537216, "system_level_velocity_max": 17.880414119032512}, "timesteps_total": 13069856, "training_iteration": 129, "date": "2019-04-29_12-13-26", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 129, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.366660311129, "time_total_s": 4767.945069551468, "info": {"grad_time_ms": 21788.027, "default": {"total_loss": 32.58180236816406, "kl": 0.013710727915167809, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015670549124479294, "vf_loss": 32.59053039550781, "entropy": 1.841259479522705, "vf_explained_var": 0.34447184205055237, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 13069856, "load_time_ms": 13.498, "update_time_ms": 11.361, "sample_time_ms": 15239.886, "num_steps_sampled": 13069856}, "episode_reward_max": 815.9806288382817, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 446.48314699611194, "episodes_total": 9924, "episodes_this_iter": 80, "time_this_iter_s": 37.395113706588745, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100148, "timestamp": 1556540042, "episode_len_mean": 700.0, "timesteps_since_restore": 13170004, "time_since_restore": 4803.578308105469, "done": false, "custom_metrics": {"outflow_rate_min": 699.5697003747989, "outflow_rate_mean": 822.5191306816039, "cost2_mean": -24.158346885089827, "outflow_rate_max": 955.7737230112298, "system_level_velocity_min": 12.69114000724, "cost2_max": -17.10380936389415, "cost2_min": -47.67819065998402, "system_level_velocity_mean": 15.51669636431113, "cost1_min": 322.638220867471, "cost1_max": 433.44004442198207, "cost1_mean": 392.55300606677264, "system_level_velocity_max": 17.705813931096632}, "timesteps_total": 13170004, "training_iteration": 130, "date": "2019-04-29_12-14-02", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 130, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 710.4246512212912, "time_total_s": 4803.578308105469, "info": {"grad_time_ms": 21522.717, "default": {"total_loss": 29.311935424804688, "kl": 0.014619305729866028, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01512211374938488, "vf_loss": 29.319658279418945, "entropy": 1.8474419116973877, "vf_explained_var": 0.4206998348236084, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 13170004, "load_time_ms": 14.077, "update_time_ms": 11.53, "sample_time_ms": 15287.568, "num_steps_sampled": 13170004}, "episode_reward_max": 831.6372379379102, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 609.7961649127814, "episodes_total": 9998, "episodes_this_iter": 74, "time_this_iter_s": 35.633238554000854, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99472, "timestamp": 1556540079, "episode_len_mean": 693.52, "timesteps_since_restore": 13269476, "time_since_restore": 4841.06640291214, "done": false, "custom_metrics": {"outflow_rate_min": 537.302365146084, "outflow_rate_mean": 818.6710600693847, "cost2_mean": -24.434562602388677, "outflow_rate_max": 980.2900380723004, "system_level_velocity_min": 11.872320597147336, "cost2_max": -12.686920625674608, "cost2_min": -36.17427279988599, "system_level_velocity_mean": 15.354890666479426, "cost1_min": 31.28849888540219, "cost1_max": 434.8294089454763, "cost1_mean": 384.2577213203677, "system_level_velocity_max": 17.905991141494496}, "timesteps_total": 13269476, "training_iteration": 131, "date": "2019-04-29_12-14-39", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fd30>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 131, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 700.052378084321, "time_total_s": 4841.06640291214, "info": {"grad_time_ms": 21299.195, "default": {"total_loss": 34.21940612792969, "kl": 0.014678278006613255, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015521140769124031, "vf_loss": 34.22749710083008, "entropy": 1.8407517671585083, "vf_explained_var": 0.33719733357429504, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 13269476, "load_time_ms": 13.836, "update_time_ms": 11.583, "sample_time_ms": 15195.02, "num_steps_sampled": 13269476}, "episode_reward_max": 877.1735666442629, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 61.60705142704155, "episodes_total": 10081, "episodes_this_iter": 83, "time_this_iter_s": 37.48809480667114, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100747, "timestamp": 1556540116, "episode_len_mean": 700.0, "timesteps_since_restore": 13370223, "time_since_restore": 4878.1583132743835, "done": false, "custom_metrics": {"outflow_rate_min": 678.3306743100114, "outflow_rate_mean": 831.2145823339416, "cost2_mean": -24.95396235312633, "outflow_rate_max": 973.764029833224, "system_level_velocity_min": 11.953361553264715, "cost2_max": -15.416219647069427, "cost2_min": -37.591482398283155, "system_level_velocity_mean": 15.42767239343909, "cost1_min": 311.1138651590074, "cost1_max": 438.9540562881815, "cost1_mean": 389.5699261147313, "system_level_velocity_max": 17.905991141494496}, "timesteps_total": 13370223, "training_iteration": 132, "date": "2019-04-29_12-15-16", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c9b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 132, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 715.3116788148369, "time_total_s": 4878.1583132743835, "info": {"grad_time_ms": 21427.876, "default": {"total_loss": 31.858457565307617, "kl": 0.013740663416683674, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01523276511579752, "vf_loss": 31.866731643676758, "entropy": 1.8564726114273071, "vf_explained_var": 0.3543013334274292, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 13370223, "load_time_ms": 15.239, "update_time_ms": 11.897, "sample_time_ms": 15249.224, "num_steps_sampled": 13370223}, "episode_reward_max": 832.7214463261984, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 558.0327886973162, "episodes_total": 10160, "episodes_this_iter": 79, "time_this_iter_s": 37.09191036224365, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99914, "timestamp": 1556540153, "episode_len_mean": 699.22, "timesteps_since_restore": 13470137, "time_since_restore": 4914.720407247543, "done": false, "custom_metrics": {"outflow_rate_min": 651.023845578451, "outflow_rate_mean": 841.1929246908254, "cost2_mean": -26.429745744619225, "outflow_rate_max": 958.6175909389323, "system_level_velocity_min": 11.55647899147031, "cost2_max": -13.506053663167734, "cost2_min": -46.40243956406603, "system_level_velocity_mean": 15.257877558436883, "cost1_min": 300.57278859677456, "cost1_max": 443.88112255834636, "cost1_mean": 387.30242506736016, "system_level_velocity_max": 17.96343883035199}, "timesteps_total": 13470137, "training_iteration": 133, "date": "2019-04-29_12-15-53", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 133, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 722.4700880569517, "time_total_s": 4914.720407247543, "info": {"grad_time_ms": 21431.05, "default": {"total_loss": 32.43446350097656, "kl": 0.01341791171580553, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014848603866994381, "vf_loss": 32.4425163269043, "entropy": 1.863463282585144, "vf_explained_var": 0.3492608368396759, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 13470137, "load_time_ms": 16.387, "update_time_ms": 11.679, "sample_time_ms": 15250.43, "num_steps_sampled": 13470137}, "episode_reward_max": 839.2861903483113, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 563.353952246707, "episodes_total": 10237, "episodes_this_iter": 77, "time_this_iter_s": 36.56209397315979, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99812, "timestamp": 1556540190, "episode_len_mean": 695.48, "timesteps_since_restore": 13569949, "time_since_restore": 4951.576545476913, "done": false, "custom_metrics": {"outflow_rate_min": 674.1451489383219, "outflow_rate_mean": 833.5247421169354, "cost2_mean": -24.873618251184087, "outflow_rate_max": 963.2094457581234, "system_level_velocity_min": 11.202663996469362, "cost2_max": -14.950670589764961, "cost2_min": -63.7918136820132, "system_level_velocity_mean": 15.422038759705329, "cost1_min": 194.02502163682286, "cost1_max": 440.8315496666578, "cost1_mean": 387.9244526004588, "system_level_velocity_max": 17.719498736634435}, "timesteps_total": 13569949, "training_iteration": 134, "date": "2019-04-29_12-16-30", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65da0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 134, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 713.3095358850062, "time_total_s": 4951.576545476913, "info": {"grad_time_ms": 21418.875, "default": {"total_loss": 32.342491149902344, "kl": 0.014416266232728958, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016703976318240166, "vf_loss": 32.35189437866211, "entropy": 1.8636804819107056, "vf_explained_var": 0.3488565683364868, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 13569949, "load_time_ms": 15.448, "update_time_ms": 11.363, "sample_time_ms": 15204.359, "num_steps_sampled": 13569949}, "episode_reward_max": 840.7230745936725, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 389.75690968544336, "episodes_total": 10314, "episodes_this_iter": 77, "time_this_iter_s": 36.85613822937012, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100063, "timestamp": 1556540227, "episode_len_mean": 679.1, "timesteps_since_restore": 13670012, "time_since_restore": 4988.9003121852875, "done": false, "custom_metrics": {"outflow_rate_min": 499.71688175064116, "outflow_rate_mean": 818.5994668170644, "cost2_mean": -25.409671411408546, "outflow_rate_max": 941.3014384001751, "system_level_velocity_min": 12.18499108386445, "cost2_max": -12.735667883745494, "cost2_min": -43.94997368588136, "system_level_velocity_mean": 15.225744402123599, "cost1_min": 20.74655199244579, "cost1_max": 440.65232918346123, "cost1_mean": 373.7254697851328, "system_level_velocity_max": 18.09878540608687}, "timesteps_total": 13670012, "training_iteration": 135, "date": "2019-04-29_12-17-07", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ccc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c4a8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 135, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 691.7383448555972, "time_total_s": 4988.9003121852875, "info": {"grad_time_ms": 21569.25, "default": {"total_loss": 34.19828796386719, "kl": 0.013757743872702122, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014812496490776539, "vf_loss": 34.206138610839844, "entropy": 1.861283779144287, "vf_explained_var": 0.35890576243400574, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 13670012, "load_time_ms": 16.43, "update_time_ms": 11.35, "sample_time_ms": 15221.46, "num_steps_sampled": 13670012}, "episode_reward_max": 807.9209384553283, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 41.16626237785195, "episodes_total": 10397, "episodes_this_iter": 83, "time_this_iter_s": 37.32376670837402, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100485, "timestamp": 1556540266, "episode_len_mean": 680.16, "timesteps_since_restore": 13770497, "time_since_restore": 5027.182537555695, "done": false, "custom_metrics": {"outflow_rate_min": 497.96338035008074, "outflow_rate_mean": 823.5821119799377, "cost2_mean": -25.364268716471926, "outflow_rate_max": 934.7477064238767, "system_level_velocity_min": 11.637463560873368, "cost2_max": -13.285598908209549, "cost2_min": -40.938133827391326, "system_level_velocity_mean": 15.188605591746416, "cost1_min": 21.357611869134274, "cost1_max": 445.4749888831102, "cost1_mean": 374.2763869887717, "system_level_velocity_max": 18.21562884207294}, "timesteps_total": 13770497, "training_iteration": 136, "date": "2019-04-29_12-17-46", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c518>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 136, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 692.8652842691538, "time_total_s": 5027.182537555695, "info": {"grad_time_ms": 21614.794, "default": {"total_loss": 31.057132720947266, "kl": 0.014241175726056099, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015355464071035385, "vf_loss": 31.06528091430664, "entropy": 1.8525443077087402, "vf_explained_var": 0.3783639669418335, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 13770497, "load_time_ms": 16.39, "update_time_ms": 11.586, "sample_time_ms": 15166.741, "num_steps_sampled": 13770497}, "episode_reward_max": 840.8278396835391, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 39.53790516133024, "episodes_total": 10476, "episodes_this_iter": 79, "time_this_iter_s": 38.282225370407104, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99883, "timestamp": 1556540303, "episode_len_mean": 700.0, "timesteps_since_restore": 13870380, "time_since_restore": 5064.5870707035065, "done": false, "custom_metrics": {"outflow_rate_min": 655.3986604475515, "outflow_rate_mean": 833.6733579346734, "cost2_mean": -25.172402655567286, "outflow_rate_max": 980.1476092253697, "system_level_velocity_min": 12.25800486830857, "cost2_max": -16.690912012591482, "cost2_min": -42.245336284359105, "system_level_velocity_mean": 15.117520444732225, "cost1_min": 320.62435161525, "cost1_max": 445.4749888831102, "cost1_mean": 383.91977286272567, "system_level_velocity_max": 18.21562884207294}, "timesteps_total": 13870380, "training_iteration": 137, "date": "2019-04-29_12-18-23", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d657b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65550>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 137, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 716.0955162015417, "time_total_s": 5064.5870707035065, "info": {"grad_time_ms": 21676.91, "default": {"total_loss": 33.436614990234375, "kl": 0.013506820425391197, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014787035994231701, "vf_loss": 33.44456100463867, "entropy": 1.8666118383407593, "vf_explained_var": 0.3284204602241516, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 13870380, "load_time_ms": 15.288, "update_time_ms": 11.542, "sample_time_ms": 15218.267, "num_steps_sampled": 13870380}, "episode_reward_max": 853.7875000183892, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 566.3398592983976, "episodes_total": 10554, "episodes_this_iter": 78, "time_this_iter_s": 37.40453314781189, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100872, "timestamp": 1556540342, "episode_len_mean": 696.71, "timesteps_since_restore": 13971252, "time_since_restore": 5103.520082473755, "done": false, "custom_metrics": {"outflow_rate_min": 680.5326927857342, "outflow_rate_mean": 846.4722558130929, "cost2_mean": -25.641629645193976, "outflow_rate_max": 970.3435567451864, "system_level_velocity_min": 12.677981349179104, "cost2_max": -16.82441845823466, "cost2_min": -44.004471963351776, "system_level_velocity_mean": 15.323788792595922, "cost1_min": 181.1639202700734, "cost1_max": 435.8410818023953, "cost1_mean": 387.5033529045467, "system_level_velocity_max": 17.502531544735145}, "timesteps_total": 13971252, "training_iteration": 138, "date": "2019-04-29_12-19-02", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c828>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 138, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 725.5620924265911, "time_total_s": 5103.520082473755, "info": {"grad_time_ms": 21813.368, "default": {"total_loss": 33.03228759765625, "kl": 0.014712855219841003, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015136031433939934, "vf_loss": 33.039974212646484, "entropy": 1.8747138977050781, "vf_explained_var": 0.33671337366104126, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 13971252, "load_time_ms": 16.368, "update_time_ms": 11.568, "sample_time_ms": 15245.297, "num_steps_sampled": 13971252}, "episode_reward_max": 853.7875000183892, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 342.31624382808087, "episodes_total": 10632, "episodes_this_iter": 78, "time_this_iter_s": 38.93301177024841, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100494, "timestamp": 1556540378, "episode_len_mean": 693.32, "timesteps_since_restore": 14071746, "time_since_restore": 5139.37003493309, "done": false, "custom_metrics": {"outflow_rate_min": 480.5062692836654, "outflow_rate_mean": 833.1798744004471, "cost2_mean": -27.818830872952255, "outflow_rate_max": 948.8619245217217, "system_level_velocity_min": 9.519803860963542, "cost2_max": -12.293141849181094, "cost2_min": -99.07075662090662, "system_level_velocity_mean": 14.883688871711398, "cost1_min": 19.292408437363342, "cost1_max": 437.6501631552005, "cost1_mean": 374.830461366726, "system_level_velocity_max": 17.49273560290226}, "timesteps_total": 14071746, "training_iteration": 139, "date": "2019-04-29_12-19-38", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 139, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 717.0577273574324, "time_total_s": 5139.37003493309, "info": {"grad_time_ms": 21671.974, "default": {"total_loss": 33.221134185791016, "kl": 0.014636218547821045, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015024499036371708, "vf_loss": 33.22875213623047, "entropy": 1.8910106420516968, "vf_explained_var": 0.39628469944000244, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 14071746, "load_time_ms": 17.152, "update_time_ms": 11.729, "sample_time_ms": 15230.304, "num_steps_sampled": 14071746}, "episode_reward_max": 842.2020875548076, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 43.2813532031361, "episodes_total": 10707, "episodes_this_iter": 75, "time_this_iter_s": 35.84995245933533, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100001, "timestamp": 1556540414, "episode_len_mean": 691.04, "timesteps_since_restore": 14171747, "time_since_restore": 5175.583780527115, "done": false, "custom_metrics": {"outflow_rate_min": 653.1962136718291, "outflow_rate_mean": 833.1031160001212, "cost2_mean": -26.281656385238115, "outflow_rate_max": 991.888655877078, "system_level_velocity_min": 9.350373413684816, "cost2_max": -15.721843330650476, "cost2_min": -56.12949031370451, "system_level_velocity_mean": 15.258030421653576, "cost1_min": 68.27554276332232, "cost1_max": 435.6507350206839, "cost1_mean": 381.73331696230053, "system_level_velocity_max": 17.5378721280601}, "timesteps_total": 14171747, "training_iteration": 140, "date": "2019-04-29_12-20-14", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65e80>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 140, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 709.8833761507398, "time_total_s": 5175.583780527115, "info": {"grad_time_ms": 21790.247, "default": {"total_loss": 36.68629837036133, "kl": 0.01408506277948618, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016139304265379906, "vf_loss": 36.695308685302734, "entropy": 1.902936339378357, "vf_explained_var": 0.351349413394928, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 14171747, "load_time_ms": 17.38, "update_time_ms": 11.624, "sample_time_ms": 15168.703, "num_steps_sampled": 14171747}, "episode_reward_max": 825.31757266026, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 129.69605811651007, "episodes_total": 10790, "episodes_this_iter": 83, "time_this_iter_s": 36.21374559402466, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100014, "timestamp": 1556540450, "episode_len_mean": 685.57, "timesteps_since_restore": 14271761, "time_since_restore": 5211.248492240906, "done": false, "custom_metrics": {"outflow_rate_min": 498.53592173718806, "outflow_rate_mean": 829.2902379447819, "cost2_mean": -25.6248451150713, "outflow_rate_max": 991.888655877078, "system_level_velocity_min": 10.140327417269484, "cost2_max": -15.721843330650476, "cost2_min": -73.26036089102944, "system_level_velocity_mean": 15.379215937099955, "cost1_min": 25.523000757870555, "cost1_max": 441.29795818448736, "cost1_mean": 380.76370973055214, "system_level_velocity_max": 18.39677373985854}, "timesteps_total": 14271761, "training_iteration": 141, "date": "2019-04-29_12-20-50", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fc18>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 141, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 699.4338266365038, "time_total_s": 5211.248492240906, "info": {"grad_time_ms": 21652.314, "default": {"total_loss": 32.35431671142578, "kl": 0.013594594784080982, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015525688417255878, "vf_loss": 32.36296081542969, "entropy": 1.8945109844207764, "vf_explained_var": 0.3949066698551178, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 14271761, "load_time_ms": 17.487, "update_time_ms": 11.691, "sample_time_ms": 15127.518, "num_steps_sampled": 14271761}, "episode_reward_max": 839.7291458484221, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 50.01606394120728, "episodes_total": 10871, "episodes_this_iter": 81, "time_this_iter_s": 35.664711713790894, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100109, "timestamp": 1556540485, "episode_len_mean": 693.79, "timesteps_since_restore": 14371870, "time_since_restore": 5245.908210515976, "done": false, "custom_metrics": {"outflow_rate_min": 699.3340441723126, "outflow_rate_mean": 825.9410928366892, "cost2_mean": -24.79514882093357, "outflow_rate_max": 951.0898827814293, "system_level_velocity_min": 12.032275302348674, "cost2_max": -16.92542601588678, "cost2_min": -38.155429182169726, "system_level_velocity_mean": 15.382782609603439, "cost1_min": 206.63425570822108, "cost1_max": 441.29795818448736, "cost1_mean": 386.74860312804043, "system_level_velocity_max": 17.90067170810126}, "timesteps_total": 14371870, "training_iteration": 142, "date": "2019-04-29_12-21-25", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcc0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 142, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 703.2126511973735, "time_total_s": 5245.908210515976, "info": {"grad_time_ms": 21465.58, "default": {"total_loss": 32.75688934326172, "kl": 0.01356638316065073, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015505403280258179, "vf_loss": 32.76552963256836, "entropy": 1.9082789421081543, "vf_explained_var": 0.37243542075157166, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 14371870, "load_time_ms": 17.576, "update_time_ms": 11.347, "sample_time_ms": 15071.182, "num_steps_sampled": 14371870}, "episode_reward_max": 809.9076696364202, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 424.01018939534765, "episodes_total": 10945, "episodes_this_iter": 74, "time_this_iter_s": 34.65971827507019, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100077, "timestamp": 1556540521, "episode_len_mean": 693.34, "timesteps_since_restore": 14471947, "time_since_restore": 5281.898027896881, "done": false, "custom_metrics": {"outflow_rate_min": 495.0285173766783, "outflow_rate_mean": 820.7805447927207, "cost2_mean": -26.36242662954696, "outflow_rate_max": 966.3818406086752, "system_level_velocity_min": 8.151704278444148, "cost2_max": -13.88605776913023, "cost2_min": -55.392976205059014, "system_level_velocity_mean": 15.143061664069329, "cost1_min": 21.384474510384432, "cost1_max": 442.3128591887211, "cost1_mean": 379.374597809324, "system_level_velocity_max": 18.132574785462587}, "timesteps_total": 14471947, "training_iteration": 143, "date": "2019-04-29_12-22-01", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fbe0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 143, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 692.9169268438526, "time_total_s": 5281.898027896881, "info": {"grad_time_ms": 21410.894, "default": {"total_loss": 35.79872512817383, "kl": 0.012982259504497051, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013971186242997646, "vf_loss": 35.806129455566406, "entropy": 1.9091525077819824, "vf_explained_var": 0.34695184230804443, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 14471947, "load_time_ms": 17.066, "update_time_ms": 11.53, "sample_time_ms": 15070.01, "num_steps_sampled": 14471947}, "episode_reward_max": 803.5700050328868, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 46.334776090808546, "episodes_total": 11026, "episodes_this_iter": 81, "time_this_iter_s": 35.98981738090515, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100651, "timestamp": 1556540557, "episode_len_mean": 683.48, "timesteps_since_restore": 14572598, "time_since_restore": 5318.36000084877, "done": false, "custom_metrics": {"outflow_rate_min": 495.0285173766783, "outflow_rate_mean": 825.6412202124711, "cost2_mean": -25.59440439679476, "outflow_rate_max": 990.6299112086099, "system_level_velocity_min": 12.191543306143592, "cost2_max": -13.88605776913023, "cost2_min": -53.61046187127633, "system_level_velocity_mean": 15.28317020432106, "cost1_min": 21.384474510384432, "cost1_max": 435.7925787971551, "cost1_mean": 377.97363111262246, "system_level_velocity_max": 18.132574785462587}, "timesteps_total": 14572598, "training_iteration": 144, "date": "2019-04-29_12-22-37", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fe10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 144, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.0973332144806, "time_total_s": 5318.36000084877, "info": {"grad_time_ms": 21337.15, "default": {"total_loss": 34.2715950012207, "kl": 0.01499010156840086, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015251263976097107, "vf_loss": 34.279258728027344, "entropy": 1.9050897359848022, "vf_explained_var": 0.37787890434265137, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 14572598, "load_time_ms": 17.168, "update_time_ms": 11.551, "sample_time_ms": 15103.894, "num_steps_sampled": 14572598}, "episode_reward_max": 827.4856609032136, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 46.334776090808546, "episodes_total": 11109, "episodes_this_iter": 83, "time_this_iter_s": 36.46197295188904, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99873, "timestamp": 1556540594, "episode_len_mean": 677.48, "timesteps_since_restore": 14672471, "time_since_restore": 5354.912986755371, "done": false, "custom_metrics": {"outflow_rate_min": 454.6304098282526, "outflow_rate_mean": 818.0074086000288, "cost2_mean": -25.860687320595243, "outflow_rate_max": 956.8667814401862, "system_level_velocity_min": 9.036687383620876, "cost2_max": -12.01467683087203, "cost2_min": -47.63429393971695, "system_level_velocity_mean": 15.361498375926773, "cost1_min": 12.598014228702201, "cost1_max": 437.88003287380053, "cost1_mean": 375.86980299237206, "system_level_velocity_max": 18.151052138141093}, "timesteps_total": 14672471, "training_iteration": 145, "date": "2019-04-29_12-23-14", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f198>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 145, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 692.8844077011828, "time_total_s": 5354.912986755371, "info": {"grad_time_ms": 21153.184, "default": {"total_loss": 33.71778869628906, "kl": 0.013564997352659702, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015131120570003986, "vf_loss": 33.726051330566406, "entropy": 1.9324907064437866, "vf_explained_var": 0.30777254700660706, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 14672471, "load_time_ms": 17.067, "update_time_ms": 11.443, "sample_time_ms": 15212.586, "num_steps_sampled": 14672471}, "episode_reward_max": 811.2233831199053, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 19.145985538940575, "episodes_total": 11182, "episodes_this_iter": 73, "time_this_iter_s": 36.55298590660095, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99616, "timestamp": 1556540630, "episode_len_mean": 683.65, "timesteps_since_restore": 14772087, "time_since_restore": 5391.25729060173, "done": false, "custom_metrics": {"outflow_rate_min": 454.6304098282526, "outflow_rate_mean": 818.3373324247765, "cost2_mean": -26.045600456900907, "outflow_rate_max": 947.6542377102097, "system_level_velocity_min": 9.036687383620876, "cost2_max": -12.830500420929205, "cost2_min": -56.134193281925604, "system_level_velocity_mean": 15.199182808345492, "cost1_min": 12.598014228702201, "cost1_max": 436.630508039241, "cost1_mean": 376.9579073314099, "system_level_velocity_max": 17.41804510456479}, "timesteps_total": 14772087, "training_iteration": 146, "date": "2019-04-29_12-23-50", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f3c8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 146, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.1058120910191, "time_total_s": 5391.25729060173, "info": {"grad_time_ms": 21025.451, "default": {"total_loss": 34.947879791259766, "kl": 0.013259599916636944, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014065979979932308, "vf_loss": 34.955230712890625, "entropy": 1.9325391054153442, "vf_explained_var": 0.319894015789032, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 14772087, "load_time_ms": 16.94, "update_time_ms": 11.268, "sample_time_ms": 15146.33, "num_steps_sampled": 14772087}, "episode_reward_max": 803.0362813168866, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 19.145985538940575, "episodes_total": 11265, "episodes_this_iter": 83, "time_this_iter_s": 36.34430384635925, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99975, "timestamp": 1556540667, "episode_len_mean": 686.8, "timesteps_since_restore": 14872062, "time_since_restore": 5427.984712362289, "done": false, "custom_metrics": {"outflow_rate_min": 517.5555788553406, "outflow_rate_mean": 826.183250915191, "cost2_mean": -26.004272158142143, "outflow_rate_max": 939.3808872682782, "system_level_velocity_min": 12.393981425275848, "cost2_max": -13.345139939861223, "cost2_min": -42.68888906748822, "system_level_velocity_mean": 15.382854551000412, "cost1_min": 25.21745121101676, "cost1_max": 435.2728139148195, "cost1_mean": 383.36184723891654, "system_level_velocity_max": 18.020685795404106}, "timesteps_total": 14872062, "training_iteration": 147, "date": "2019-04-29_12-24-27", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fc50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f1d0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 147, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 700.238660069547, "time_total_s": 5427.984712362289, "info": {"grad_time_ms": 20937.048, "default": {"total_loss": 34.330780029296875, "kl": 0.014235210604965687, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015421150252223015, "vf_loss": 34.338993072509766, "entropy": 1.9299616813659668, "vf_explained_var": 0.3374733030796051, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 14872062, "load_time_ms": 17.939, "update_time_ms": 11.477, "sample_time_ms": 15165.884, "num_steps_sampled": 14872062}, "episode_reward_max": 801.6837037083841, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 49.719064017393, "episodes_total": 11347, "episodes_this_iter": 82, "time_this_iter_s": 36.72742176055908, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99766, "timestamp": 1556540704, "episode_len_mean": 690.66, "timesteps_since_restore": 14971828, "time_since_restore": 5464.622882843018, "done": false, "custom_metrics": {"outflow_rate_min": 517.5555788553406, "outflow_rate_mean": 829.4695506742227, "cost2_mean": -26.30304635705971, "outflow_rate_max": 946.4548054660421, "system_level_velocity_min": 12.043093668497702, "cost2_max": -16.54901672673312, "cost2_min": -53.998227965061275, "system_level_velocity_mean": 15.300456440583002, "cost1_min": 25.21745121101676, "cost1_max": 437.36869215478197, "cost1_mean": 384.05180848870606, "system_level_velocity_max": 18.020685795404106}, "timesteps_total": 14971828, "training_iteration": 148, "date": "2019-04-29_12-25-04", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ff60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f2b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 148, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 706.1086143481283, "time_total_s": 5464.622882843018, "info": {"grad_time_ms": 20793.123, "default": {"total_loss": 30.700397491455078, "kl": 0.013424795120954514, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015576082281768322, "vf_loss": 30.709177017211914, "entropy": 1.936261534690857, "vf_explained_var": 0.36051425337791443, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 14971828, "load_time_ms": 16.585, "update_time_ms": 11.385, "sample_time_ms": 15080.519, "num_steps_sampled": 14971828}, "episode_reward_max": 790.8865624509226, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 49.719064017393, "episodes_total": 11421, "episodes_this_iter": 74, "time_this_iter_s": 36.63817048072815, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100059, "timestamp": 1556540742, "episode_len_mean": 693.43, "timesteps_since_restore": 15071887, "time_since_restore": 5502.353322505951, "done": false, "custom_metrics": {"outflow_rate_min": 524.6515500356782, "outflow_rate_mean": 822.477518261137, "cost2_mean": -25.87168320129981, "outflow_rate_max": 927.162627222155, "system_level_velocity_min": 12.561017121072224, "cost2_max": -11.764433402967855, "cost2_min": -50.79734085964624, "system_level_velocity_mean": 15.346281993373013, "cost1_min": 26.423911884309824, "cost1_max": 442.266392682904, "cost1_mean": 385.68768060402743, "system_level_velocity_max": 17.85383842592897}, "timesteps_total": 15071887, "training_iteration": 149, "date": "2019-04-29_12-25-42", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f470>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 149, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 706.3793840083247, "time_total_s": 5502.353322505951, "info": {"grad_time_ms": 20974.094, "default": {"total_loss": 35.7549934387207, "kl": 0.013464787043631077, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014814271591603756, "vf_loss": 35.76298904418945, "entropy": 1.9318541288375854, "vf_explained_var": 0.32499048113822937, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 15071887, "load_time_ms": 16.041, "update_time_ms": 11.192, "sample_time_ms": 15088.532, "num_steps_sampled": 15071887}, "episode_reward_max": 888.1019849690676, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 57.753564736136696, "episodes_total": 11501, "episodes_this_iter": 80, "time_this_iter_s": 37.73043966293335, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100290, "timestamp": 1556540779, "episode_len_mean": 692.98, "timesteps_since_restore": 15172177, "time_since_restore": 5539.751171827316, "done": false, "custom_metrics": {"outflow_rate_min": 487.8609739564202, "outflow_rate_mean": 832.4399837608249, "cost2_mean": -26.783132519530422, "outflow_rate_max": 957.1836604568401, "system_level_velocity_min": 12.211879768837616, "cost2_max": -14.277391476213605, "cost2_min": -41.525907515006224, "system_level_velocity_mean": 15.37049419885309, "cost1_min": 22.49603385255586, "cost1_max": 440.8997328049968, "cost1_mean": 385.7397021825691, "system_level_velocity_max": 17.63475902150435}, "timesteps_total": 15172177, "training_iteration": 150, "date": "2019-04-29_12-26-19", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ccc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c278>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 150, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 706.201709729747, "time_total_s": 5539.751171827316, "info": {"grad_time_ms": 21076.12, "default": {"total_loss": 35.390377044677734, "kl": 0.013539605773985386, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014309581369161606, "vf_loss": 35.39783477783203, "entropy": 1.9480582475662231, "vf_explained_var": 0.3383852541446686, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 15172177, "load_time_ms": 16.102, "update_time_ms": 11.016, "sample_time_ms": 15101.435, "num_steps_sampled": 15172177}, "episode_reward_max": 801.5179826171877, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 47.65818242695832, "episodes_total": 11587, "episodes_this_iter": 86, "time_this_iter_s": 37.397849321365356, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100262, "timestamp": 1556540815, "episode_len_mean": 682.14, "timesteps_since_restore": 15272439, "time_since_restore": 5575.502744674683, "done": false, "custom_metrics": {"outflow_rate_min": 484.2860374355761, "outflow_rate_mean": 819.4636503728402, "cost2_mean": -25.560409436729202, "outflow_rate_max": 956.8938713101417, "system_level_velocity_min": 12.853388561327982, "cost2_max": -12.34091447200814, "cost2_min": -42.77002081767546, "system_level_velocity_mean": 15.387036669790266, "cost1_min": 18.866863788596966, "cost1_max": 435.3347763568376, "cost1_mean": 379.5692638357183, "system_level_velocity_max": 17.63475902150435}, "timesteps_total": 15272439, "training_iteration": 151, "date": "2019-04-29_12-26-55", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ca90>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 151, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 691.801150621309, "time_total_s": 5575.502744674683, "info": {"grad_time_ms": 21057.414, "default": {"total_loss": 35.85997772216797, "kl": 0.013999042101204395, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015079905278980732, "vf_loss": 35.867977142333984, "entropy": 1.9442722797393799, "vf_explained_var": 0.30242234468460083, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 15272439, "load_time_ms": 15.384, "update_time_ms": 10.996, "sample_time_ms": 15129.003, "num_steps_sampled": 15272439}, "episode_reward_max": 798.9991840498624, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 40.26307348167241, "episodes_total": 11667, "episodes_this_iter": 80, "time_this_iter_s": 35.75157284736633, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100245, "timestamp": 1556540851, "episode_len_mean": 693.3, "timesteps_since_restore": 15372684, "time_since_restore": 5611.09775185585, "done": false, "custom_metrics": {"outflow_rate_min": 484.2860374355761, "outflow_rate_mean": 828.263703410108, "cost2_mean": -26.829307308189684, "outflow_rate_max": 975.015329375706, "system_level_velocity_min": 11.622327793764075, "cost2_max": -12.34091447200814, "cost2_min": -42.92585938881729, "system_level_velocity_mean": 15.388350415444378, "cost1_min": 18.866863788596966, "cost1_max": 438.3076838216792, "cost1_mean": 387.1526237846814, "system_level_velocity_max": 17.576539106154982}, "timesteps_total": 15372684, "training_iteration": 152, "date": "2019-04-29_12-27-31", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f390>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 152, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 714.1129777481623, "time_total_s": 5611.09775185585, "info": {"grad_time_ms": 21140.526, "default": {"total_loss": 34.24903106689453, "kl": 0.014262865297496319, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01587488315999508, "vf_loss": 34.257686614990234, "entropy": 1.9495580196380615, "vf_explained_var": 0.3286707401275635, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 15372684, "load_time_ms": 14.638, "update_time_ms": 11.101, "sample_time_ms": 15139.09, "num_steps_sampled": 15372684}, "episode_reward_max": 838.9506535165341, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 40.26307348167241, "episodes_total": 11743, "episodes_this_iter": 76, "time_this_iter_s": 35.5950071811676, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99512, "timestamp": 1556540888, "episode_len_mean": 700.0, "timesteps_since_restore": 15472196, "time_since_restore": 5648.049232959747, "done": false, "custom_metrics": {"outflow_rate_min": 698.181318799836, "outflow_rate_mean": 822.6864220553917, "cost2_mean": -27.53144974885681, "outflow_rate_max": 954.0752046076891, "system_level_velocity_min": 11.502578011870687, "cost2_max": -17.553788189642535, "cost2_min": -48.282890495439, "system_level_velocity_mean": 15.532360726422645, "cost1_min": 297.51870987482283, "cost1_max": 438.3076838216792, "cost1_mean": 393.8869691700276, "system_level_velocity_max": 17.567715700420152}, "timesteps_total": 15472196, "training_iteration": 153, "date": "2019-04-29_12-28-08", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ca58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c4a8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 153, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 709.9005559972, "time_total_s": 5648.049232959747, "info": {"grad_time_ms": 21222.167, "default": {"total_loss": 37.34408950805664, "kl": 0.013189652003347874, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014323142357170582, "vf_loss": 37.35173797607422, "entropy": 1.9508638381958008, "vf_explained_var": 0.30828648805618286, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 15472196, "load_time_ms": 14.885, "update_time_ms": 11.11, "sample_time_ms": 15152.385, "num_steps_sampled": 15472196}, "episode_reward_max": 828.2445642315752, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 574.6872930697389, "episodes_total": 11823, "episodes_this_iter": 80, "time_this_iter_s": 36.951481103897095, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100470, "timestamp": 1556540925, "episode_len_mean": 692.71, "timesteps_since_restore": 15572666, "time_since_restore": 5685.561404466629, "done": false, "custom_metrics": {"outflow_rate_min": 489.846591981012, "outflow_rate_mean": 829.7153238377578, "cost2_mean": -26.954387286670435, "outflow_rate_max": 961.1380266362058, "system_level_velocity_min": 13.040727755454553, "cost2_max": -14.672124836158655, "cost2_min": -44.306775395679594, "system_level_velocity_mean": 15.51857769371876, "cost1_min": 19.084028000156636, "cost1_max": 445.7892868321038, "cost1_mean": 390.04178086794724, "system_level_velocity_max": 18.042057285184274}, "timesteps_total": 15572666, "training_iteration": 154, "date": "2019-04-29_12-28-45", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 154, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 715.1586374222835, "time_total_s": 5685.561404466629, "info": {"grad_time_ms": 21340.926, "default": {"total_loss": 33.2281379699707, "kl": 0.014070757664740086, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01432539988309145, "vf_loss": 33.2353401184082, "entropy": 1.9494099617004395, "vf_explained_var": 0.3484717011451721, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 15572666, "load_time_ms": 15.735, "update_time_ms": 11.629, "sample_time_ms": 15139.455, "num_steps_sampled": 15572666}, "episode_reward_max": 828.2445642315752, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 38.60033929161935, "episodes_total": 11900, "episodes_this_iter": 77, "time_this_iter_s": 37.512171506881714, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100357, "timestamp": 1556540963, "episode_len_mean": 700.0, "timesteps_since_restore": 15673023, "time_since_restore": 5723.375999212265, "done": false, "custom_metrics": {"outflow_rate_min": 626.4360552492132, "outflow_rate_mean": 827.1308858047139, "cost2_mean": -26.812650813062955, "outflow_rate_max": 937.6090290790163, "system_level_velocity_min": 9.85402161465454, "cost2_max": -17.73682563576259, "cost2_min": -59.03624460936062, "system_level_velocity_mean": 15.37407057458136, "cost1_min": 258.9787344416922, "cost1_max": 439.05662763344884, "cost1_mean": 391.8552363664783, "system_level_velocity_max": 17.964131719113833}, "timesteps_total": 15673023, "training_iteration": 155, "date": "2019-04-29_12-29-23", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ca90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cb38>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 155, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 716.5464167520098, "time_total_s": 5723.375999212265, "info": {"grad_time_ms": 21516.394, "default": {"total_loss": 31.593454360961914, "kl": 0.014347951859235764, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01584453694522381, "vf_loss": 31.602033615112305, "entropy": 1.9492415189743042, "vf_explained_var": 0.3883793354034424, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 15673023, "load_time_ms": 14.229, "update_time_ms": 11.555, "sample_time_ms": 15089.529, "num_steps_sampled": 15673023}, "episode_reward_max": 816.4015993339599, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 527.163250884151, "episodes_total": 11976, "episodes_this_iter": 76, "time_this_iter_s": 37.814594745635986, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99866, "timestamp": 1556541000, "episode_len_mean": 700.0, "timesteps_since_restore": 15772889, "time_since_restore": 5760.26630115509, "done": false, "custom_metrics": {"outflow_rate_min": 642.3254778554201, "outflow_rate_mean": 833.3140268073538, "cost2_mean": -27.57660732560826, "outflow_rate_max": 969.1067650022577, "system_level_velocity_min": 10.525243398086062, "cost2_max": -16.293995704993918, "cost2_min": -93.15437076947072, "system_level_velocity_mean": 15.408110178243225, "cost1_min": 278.47654099610975, "cost1_max": 440.00548543721663, "cost1_mean": 391.82228017606576, "system_level_velocity_max": 18.271292387749604}, "timesteps_total": 15772889, "training_iteration": 156, "date": "2019-04-29_12-30-00", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f438>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 156, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 718.4617268438211, "time_total_s": 5760.26630115509, "info": {"grad_time_ms": 21558.575, "default": {"total_loss": 35.956085205078125, "kl": 0.014304249547421932, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015741201117634773, "vf_loss": 35.9645881652832, "entropy": 1.9559340476989746, "vf_explained_var": 0.3867277503013611, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 15772889, "load_time_ms": 13.489, "update_time_ms": 11.585, "sample_time_ms": 15100.02, "num_steps_sampled": 15772889}, "episode_reward_max": 824.5112242874161, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 445.6792637639058, "episodes_total": 12059, "episodes_this_iter": 83, "time_this_iter_s": 36.89030194282532, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100077, "timestamp": 1556541037, "episode_len_mean": 693.48, "timesteps_since_restore": 15872966, "time_since_restore": 5796.930184364319, "done": false, "custom_metrics": {"outflow_rate_min": 534.7204066002058, "outflow_rate_mean": 829.5024574340667, "cost2_mean": -27.122931503868294, "outflow_rate_max": 952.7365012291225, "system_level_velocity_min": 11.396234446046362, "cost2_max": -14.588163740709346, "cost2_min": -93.15437076947072, "system_level_velocity_mean": 15.558392823137607, "cost1_min": 29.424741225444023, "cost1_max": 448.51817424178694, "cost1_mean": 391.79168068332694, "system_level_velocity_max": 17.97789243139767}, "timesteps_total": 15872966, "training_iteration": 157, "date": "2019-04-29_12-30-37", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65128>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 157, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 709.3037462755694, "time_total_s": 5796.930184364319, "info": {"grad_time_ms": 21614.861, "default": {"total_loss": 35.034637451171875, "kl": 0.013657636940479279, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01608186587691307, "vf_loss": 35.04380416870117, "entropy": 1.965927243232727, "vf_explained_var": 0.3764049708843231, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 15872966, "load_time_ms": 13.674, "update_time_ms": 11.333, "sample_time_ms": 15038.112, "num_steps_sampled": 15872966}, "episode_reward_max": 800.258499357262, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 57.50254648146488, "episodes_total": 12140, "episodes_this_iter": 81, "time_this_iter_s": 36.663883209228516, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100588, "timestamp": 1556541073, "episode_len_mean": 700.0, "timesteps_since_restore": 15973554, "time_since_restore": 5833.011657476425, "done": false, "custom_metrics": {"outflow_rate_min": 711.3994264285951, "outflow_rate_mean": 823.0826075656752, "cost2_mean": -27.35073602678512, "outflow_rate_max": 931.5255354609733, "system_level_velocity_min": 12.323876275311239, "cost2_max": -18.77734226086044, "cost2_min": -52.399496978579776, "system_level_velocity_mean": 15.423058868154412, "cost1_min": 313.0201190848777, "cost1_max": 448.51817424178694, "cost1_mean": 392.57102688795055, "system_level_velocity_max": 18.397835490260373}, "timesteps_total": 15973554, "training_iteration": 158, "date": "2019-04-29_12-31-13", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 158, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 715.3171693293839, "time_total_s": 5833.011657476425, "info": {"grad_time_ms": 21524.599, "default": {"total_loss": 30.7106990814209, "kl": 0.013591909781098366, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015738114714622498, "vf_loss": 30.719552993774414, "entropy": 1.9780226945877075, "vf_explained_var": 0.4226886034011841, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 15973554, "load_time_ms": 13.726, "update_time_ms": 11.375, "sample_time_ms": 15072.037, "num_steps_sampled": 15973554}, "episode_reward_max": 799.1365861551892, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 582.9472188815234, "episodes_total": 12217, "episodes_this_iter": 77, "time_this_iter_s": 36.08147311210632, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100666, "timestamp": 1556541110, "episode_len_mean": 673.43, "timesteps_since_restore": 16074220, "time_since_restore": 5870.299409389496, "done": false, "custom_metrics": {"outflow_rate_min": 453.2158683480317, "outflow_rate_mean": 808.5794968350293, "cost2_mean": -26.844512474418057, "outflow_rate_max": 931.5255354609733, "system_level_velocity_min": 10.947777138797921, "cost2_max": -13.03333523519794, "cost2_min": -58.8659992611475, "system_level_velocity_mean": 15.212834115216078, "cost1_min": 19.73884461073488, "cost1_max": 445.9379426367318, "cost1_mean": 372.5069175148439, "system_level_velocity_max": 18.130817924633334}, "timesteps_total": 16074220, "training_iteration": 159, "date": "2019-04-29_12-31-50", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ceb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 159, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 687.3206096189731, "time_total_s": 5870.299409389496, "info": {"grad_time_ms": 21455.502, "default": {"total_loss": 34.68595504760742, "kl": 0.015048859640955925, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01639791950583458, "vf_loss": 34.694732666015625, "entropy": 1.9821362495422363, "vf_explained_var": 0.38523656129837036, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 16074220, "load_time_ms": 13.633, "update_time_ms": 11.466, "sample_time_ms": 15098.356, "num_steps_sampled": 16074220}, "episode_reward_max": 828.4022249613047, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 36.88799675595431, "episodes_total": 12299, "episodes_this_iter": 82, "time_this_iter_s": 37.28775191307068, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100472, "timestamp": 1556541147, "episode_len_mean": 693.0, "timesteps_since_restore": 16174692, "time_since_restore": 5907.096879482269, "done": false, "custom_metrics": {"outflow_rate_min": 515.1874238875369, "outflow_rate_mean": 834.9725784166324, "cost2_mean": -28.156260154186757, "outflow_rate_max": 959.9643934093024, "system_level_velocity_min": 11.62706893423907, "cost2_max": -14.062071618361696, "cost2_min": -58.8659992611475, "system_level_velocity_mean": 15.161592377590132, "cost1_min": 23.15407444932567, "cost1_max": 439.6807042668471, "cost1_mean": 383.3604667138636, "system_level_velocity_max": 17.850531192926265}, "timesteps_total": 16174692, "training_iteration": 160, "date": "2019-04-29_12-32-27", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f390>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 160, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 717.2409712195577, "time_total_s": 5907.096879482269, "info": {"grad_time_ms": 21436.164, "default": {"total_loss": 34.1246452331543, "kl": 0.013497591018676758, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01420368067920208, "vf_loss": 34.13201904296875, "entropy": 1.9877924919128418, "vf_explained_var": 0.33976373076438904, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 16174692, "load_time_ms": 12.628, "update_time_ms": 11.467, "sample_time_ms": 15061.559, "num_steps_sampled": 16174692}, "episode_reward_max": 844.8837688674702, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 44.5547011275579, "episodes_total": 12374, "episodes_this_iter": 75, "time_this_iter_s": 36.79747009277344, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100365, "timestamp": 1556541184, "episode_len_mean": 686.78, "timesteps_since_restore": 16275057, "time_since_restore": 5943.880989551544, "done": false, "custom_metrics": {"outflow_rate_min": 515.2266561615202, "outflow_rate_mean": 834.758669607005, "cost2_mean": -27.236109967859406, "outflow_rate_max": 959.9643934093024, "system_level_velocity_min": 10.800474710284833, "cost2_max": -13.648802241713284, "cost2_min": -72.37899940984911, "system_level_velocity_mean": 15.135414234739935, "cost1_min": 22.742868872073686, "cost1_max": 437.1575811578447, "cost1_mean": 378.76865643997405, "system_level_velocity_max": 17.560316532177765}, "timesteps_total": 16275057, "training_iteration": 161, "date": "2019-04-29_12-33-04", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f828>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 161, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 711.5842268792952, "time_total_s": 5943.880989551544, "info": {"grad_time_ms": 21540.869, "default": {"total_loss": 35.38811111450195, "kl": 0.014842169359326363, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015182239934802055, "vf_loss": 35.395782470703125, "entropy": 1.9824578762054443, "vf_explained_var": 0.31965792179107666, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 16275057, "load_time_ms": 13.709, "update_time_ms": 11.568, "sample_time_ms": 15053.854, "num_steps_sampled": 16275057}, "episode_reward_max": 864.525307583877, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 42.7262803349874, "episodes_total": 12452, "episodes_this_iter": 78, "time_this_iter_s": 36.7841100692749, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99954, "timestamp": 1556541220, "episode_len_mean": 700.0, "timesteps_since_restore": 16375011, "time_since_restore": 5979.74375462532, "done": false, "custom_metrics": {"outflow_rate_min": 711.9498493415854, "outflow_rate_mean": 840.7187841796841, "cost2_mean": -27.85166539242118, "outflow_rate_max": 984.237920860155, "system_level_velocity_min": 11.281094186867247, "cost2_max": -15.66735452237159, "cost2_min": -72.37899940984911, "system_level_velocity_mean": 15.45430185733333, "cost1_min": 290.77658399849247, "cost1_max": 441.5084653379312, "cost1_mean": 393.6610484988648, "system_level_velocity_max": 17.560316532177765}, "timesteps_total": 16375011, "training_iteration": 162, "date": "2019-04-29_12-33-40", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f8d0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 162, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 727.1489051747157, "time_total_s": 5979.74375462532, "info": {"grad_time_ms": 21550.012, "default": {"total_loss": 35.7342529296875, "kl": 0.013900519348680973, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014708421193063259, "vf_loss": 35.741920471191406, "entropy": 1.974241018295288, "vf_explained_var": 0.2924269139766693, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 16375011, "load_time_ms": 14.738, "update_time_ms": 11.613, "sample_time_ms": 15069.973, "num_steps_sampled": 16375011}, "episode_reward_max": 807.0536748936285, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 611.3884810105898, "episodes_total": 12533, "episodes_this_iter": 81, "time_this_iter_s": 35.862765073776245, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99992, "timestamp": 1556541258, "episode_len_mean": 699.57, "timesteps_since_restore": 16475003, "time_since_restore": 6018.018953561783, "done": false, "custom_metrics": {"outflow_rate_min": 717.5749837014788, "outflow_rate_mean": 836.7765504095137, "cost2_mean": -28.12143900747611, "outflow_rate_max": 991.3443364627419, "system_level_velocity_min": 12.816677987239377, "cost2_max": -16.1872495282164, "cost2_min": -62.5660421693964, "system_level_velocity_mean": 15.662156257460044, "cost1_min": 334.60119433385546, "cost1_max": 441.5084653379312, "cost1_mean": 398.6099060777119, "system_level_velocity_max": 18.161896538692073}, "timesteps_total": 16475003, "training_iteration": 163, "date": "2019-04-29_12-34-18", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 163, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 723.8132242514731, "time_total_s": 6018.018953561783, "info": {"grad_time_ms": 21698.873, "default": {"total_loss": 34.48970413208008, "kl": 0.014555341564118862, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014585278928279877, "vf_loss": 34.496917724609375, "entropy": 1.9864351749420166, "vf_explained_var": 0.3004298806190491, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 16475003, "load_time_ms": 14.678, "update_time_ms": 11.404, "sample_time_ms": 15050.978, "num_steps_sampled": 16475003}, "episode_reward_max": 836.0855902538212, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 592.3377904759426, "episodes_total": 12612, "episodes_this_iter": 79, "time_this_iter_s": 38.2751989364624, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99871, "timestamp": 1556541295, "episode_len_mean": 695.24, "timesteps_since_restore": 16574874, "time_since_restore": 6055.046585321426, "done": false, "custom_metrics": {"outflow_rate_min": 726.3738711845751, "outflow_rate_mean": 845.8913722681662, "cost2_mean": -27.558599258853082, "outflow_rate_max": 957.2768416132241, "system_level_velocity_min": 12.894782070156479, "cost2_max": -16.1872495282164, "cost2_min": -49.670824340463604, "system_level_velocity_mean": 15.602917749857749, "cost1_min": 229.8552444549649, "cost1_max": 442.1838840506267, "cost1_mean": 394.4876056195533, "system_level_velocity_max": 18.14316382767321}, "timesteps_total": 16574874, "training_iteration": 164, "date": "2019-04-29_12-34-55", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 164, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 719.1226588193241, "time_total_s": 6055.046585321426, "info": {"grad_time_ms": 21654.077, "default": {"total_loss": 35.360538482666016, "kl": 0.01464594341814518, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013775450177490711, "vf_loss": 35.36689758300781, "entropy": 1.97295081615448, "vf_explained_var": 0.3285527229309082, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 16574874, "load_time_ms": 14.039, "update_time_ms": 11.007, "sample_time_ms": 15048.483, "num_steps_sampled": 16574874}, "episode_reward_max": 873.437379862253, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 424.64442574475095, "episodes_total": 12691, "episodes_this_iter": 79, "time_this_iter_s": 37.027631759643555, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99597, "timestamp": 1556541333, "episode_len_mean": 693.41, "timesteps_since_restore": 16674471, "time_since_restore": 6093.06423997879, "done": false, "custom_metrics": {"outflow_rate_min": 512.8573012885829, "outflow_rate_mean": 833.5875116007759, "cost2_mean": -27.75370790728614, "outflow_rate_max": 999.0383687277473, "system_level_velocity_min": 11.148779868628392, "cost2_max": -15.884143986015086, "cost2_min": -57.11074587451657, "system_level_velocity_mean": 15.794627663695964, "cost1_min": 25.376043230355386, "cost1_max": 446.8396842448982, "cost1_mean": 395.7169440082247, "system_level_velocity_max": 18.199547715218415}, "timesteps_total": 16674471, "training_iteration": 165, "date": "2019-04-29_12-35-33", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d636d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fb70>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 165, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 707.2500784233939, "time_total_s": 6093.06423997879, "info": {"grad_time_ms": 21703.522, "default": {"total_loss": 32.163448333740234, "kl": 0.014461850747466087, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016187502071261406, "vf_loss": 32.17231750488281, "entropy": 1.9881006479263306, "vf_explained_var": 0.3506843149662018, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 16674471, "load_time_ms": 15.686, "update_time_ms": 11.088, "sample_time_ms": 15017.458, "num_steps_sampled": 16674471}, "episode_reward_max": 845.3247396279357, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 51.39560440586648, "episodes_total": 12772, "episodes_this_iter": 81, "time_this_iter_s": 38.01765465736389, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99978, "timestamp": 1556541370, "episode_len_mean": 692.17, "timesteps_since_restore": 16774449, "time_since_restore": 6129.991760969162, "done": false, "custom_metrics": {"outflow_rate_min": 742.2344711129083, "outflow_rate_mean": 839.4044069063781, "cost2_mean": -27.733107997730215, "outflow_rate_max": 975.7458015707829, "system_level_velocity_min": 12.5242019073621, "cost2_max": -18.994529625447953, "cost2_min": -51.33171075001048, "system_level_velocity_mean": 15.857250426262702, "cost1_min": 120.8709057505647, "cost1_max": 450.53708184559173, "cost1_mean": 397.4543565605138, "system_level_velocity_max": 18.487668343475978}, "timesteps_total": 16774449, "training_iteration": 166, "date": "2019-04-29_12-36-10", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fbe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f518>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 166, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 712.5950565571741, "time_total_s": 6129.991760969162, "info": {"grad_time_ms": 21723.491, "default": {"total_loss": 36.64542770385742, "kl": 0.014462464489042759, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014560067094862461, "vf_loss": 36.65266799926758, "entropy": 1.990081787109375, "vf_explained_var": 0.306564062833786, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 16774449, "load_time_ms": 16.396, "update_time_ms": 11.038, "sample_time_ms": 15000.024, "num_steps_sampled": 16774449}, "episode_reward_max": 857.014433243173, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 213.34130376663575, "episodes_total": 12850, "episodes_this_iter": 78, "time_this_iter_s": 36.927520990371704, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100115, "timestamp": 1556541407, "episode_len_mean": 686.07, "timesteps_since_restore": 16874564, "time_since_restore": 6166.691447496414, "done": false, "custom_metrics": {"outflow_rate_min": 509.8695165156401, "outflow_rate_mean": 838.0822753928015, "cost2_mean": -27.97556107480616, "outflow_rate_max": 982.5307120050196, "system_level_velocity_min": 12.410572339281202, "cost2_max": -18.70980981454252, "cost2_min": -44.078389613831064, "system_level_velocity_mean": 15.859517285724445, "cost1_min": 24.879065075626357, "cost1_max": 450.41970168879567, "cost1_mean": 393.2263704373495, "system_level_velocity_max": 18.21859926329093}, "timesteps_total": 16874564, "training_iteration": 167, "date": "2019-04-29_12-36-47", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f748>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 167, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 709.7998042939929, "time_total_s": 6166.691447496414, "info": {"grad_time_ms": 21699.673, "default": {"total_loss": 39.10020065307617, "kl": 0.01402699388563633, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016004618257284164, "vf_loss": 39.109100341796875, "entropy": 2.001976490020752, "vf_explained_var": 0.28313058614730835, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 16874564, "load_time_ms": 16.399, "update_time_ms": 11.232, "sample_time_ms": 15028.619, "num_steps_sampled": 16874564}, "episode_reward_max": 857.014433243173, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 42.13863329818841, "episodes_total": 12935, "episodes_this_iter": 85, "time_this_iter_s": 36.6996865272522, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99425, "timestamp": 1556541443, "episode_len_mean": 692.35, "timesteps_since_restore": 16973989, "time_since_restore": 6202.925244092941, "done": false, "custom_metrics": {"outflow_rate_min": 594.6488002899778, "outflow_rate_mean": 835.5365928967695, "cost2_mean": -27.45209464440114, "outflow_rate_max": 969.810673867486, "system_level_velocity_min": 8.924531375320553, "cost2_max": -16.272603571884005, "cost2_min": -48.921302045649526, "system_level_velocity_mean": 15.67088671801062, "cost1_min": 61.810298945084874, "cost1_max": 450.41970168879567, "cost1_mean": 391.8461164046143, "system_level_velocity_max": 18.40849382652387}, "timesteps_total": 16973989, "training_iteration": 168, "date": "2019-04-29_12-37-23", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f7b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 168, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 720.548022224931, "time_total_s": 6202.925244092941, "info": {"grad_time_ms": 21736.506, "default": {"total_loss": 36.74348449707031, "kl": 0.014239010401070118, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015328618697822094, "vf_loss": 36.75160598754883, "entropy": 2.007223606109619, "vf_explained_var": 0.30235737562179565, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 16973989, "load_time_ms": 17.256, "update_time_ms": 11.217, "sample_time_ms": 15009.001, "num_steps_sampled": 16973989}, "episode_reward_max": 864.5722140172334, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 123.22036726581817, "episodes_total": 13013, "episodes_this_iter": 78, "time_this_iter_s": 36.2337965965271, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99782, "timestamp": 1556541479, "episode_len_mean": 699.03, "timesteps_since_restore": 17073771, "time_since_restore": 6238.470868587494, "done": false, "custom_metrics": {"outflow_rate_min": 750.0390968709679, "outflow_rate_mean": 844.4500967385128, "cost2_mean": -25.855592343047675, "outflow_rate_max": 961.1357625933166, "system_level_velocity_min": 11.812379090381546, "cost2_max": -16.272603571884005, "cost2_min": -41.85379899834119, "system_level_velocity_mean": 15.763147398180454, "cost1_min": 304.7385796448414, "cost1_max": 452.82466477135756, "cost1_mean": 398.9187346983456, "system_level_velocity_max": 18.40849382652387}, "timesteps_total": 17073771, "training_iteration": 169, "date": "2019-04-29_12-37-59", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f908>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 169, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 725.4605967522185, "time_total_s": 6238.470868587494, "info": {"grad_time_ms": 21608.38, "default": {"total_loss": 32.021629333496094, "kl": 0.014058762229979038, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015303918160498142, "vf_loss": 32.029815673828125, "entropy": 2.0119800567626953, "vf_explained_var": 0.2945350706577301, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 17073771, "load_time_ms": 17.362, "update_time_ms": 11.528, "sample_time_ms": 14962.651, "num_steps_sampled": 17073771}, "episode_reward_max": 835.5338872161849, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 639.348545218716, "episodes_total": 13089, "episodes_this_iter": 76, "time_this_iter_s": 35.54562449455261, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99221, "timestamp": 1556541516, "episode_len_mean": 685.49, "timesteps_since_restore": 17172992, "time_since_restore": 6274.97931265831, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 827.5233897776267, "cost2_mean": -26.44781969964506, "outflow_rate_max": 922.4209917485681, "system_level_velocity_min": 12.444815168107226, "cost2_max": -12.138826513890693, "cost2_min": -47.75045688761317, "system_level_velocity_mean": 15.825545972453959, "cost1_min": 12.017203738372018, "cost1_max": 446.81339306496307, "cost1_mean": 390.9054410575081, "system_level_velocity_max": 18.442346134655228}, "timesteps_total": 17172992, "training_iteration": 170, "date": "2019-04-29_12-38-36", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f898>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 170, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 709.4481275013814, "time_total_s": 6274.97931265831, "info": {"grad_time_ms": 21543.426, "default": {"total_loss": 38.07114028930664, "kl": 0.014281625859439373, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016345921903848648, "vf_loss": 38.08025360107422, "entropy": 2.023045063018799, "vf_explained_var": 0.2555485963821411, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 17172992, "load_time_ms": 17.479, "update_time_ms": 11.614, "sample_time_ms": 14995.027, "num_steps_sampled": 17172992}, "episode_reward_max": 820.4661034829986, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 19.566931721326256, "episodes_total": 13173, "episodes_this_iter": 84, "time_this_iter_s": 36.50844407081604, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99289, "timestamp": 1556541553, "episode_len_mean": 699.85, "timesteps_since_restore": 17272281, "time_since_restore": 6311.872581005096, "done": false, "custom_metrics": {"outflow_rate_min": 714.7246774766819, "outflow_rate_mean": 828.2510913720685, "cost2_mean": -26.543497347261923, "outflow_rate_max": 922.7111307345699, "system_level_velocity_min": 11.39612909507944, "cost2_max": -17.139540358593866, "cost2_min": -46.591653109056665, "system_level_velocity_mean": 15.812420266930237, "cost1_min": 298.9449963035853, "cost1_max": 444.9338842111374, "cost1_mean": 399.8313711703884, "system_level_velocity_max": 18.421033165529455}, "timesteps_total": 17272281, "training_iteration": 171, "date": "2019-04-29_12-39-13", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f828>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 171, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 715.6337468338784, "time_total_s": 6311.872581005096, "info": {"grad_time_ms": 21545.162, "default": {"total_loss": 39.70807647705078, "kl": 0.01475286390632391, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014778928831219673, "vf_loss": 39.71538543701172, "entropy": 2.045300006866455, "vf_explained_var": 0.24652855098247528, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 17272281, "load_time_ms": 17.257, "update_time_ms": 11.68, "sample_time_ms": 15008.788, "num_steps_sampled": 17272281}, "episode_reward_max": 828.7937903055673, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 618.9547841028646, "episodes_total": 13259, "episodes_this_iter": 86, "time_this_iter_s": 36.8932683467865, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99510, "timestamp": 1556541590, "episode_len_mean": 682.48, "timesteps_since_restore": 17371791, "time_since_restore": 6349.42630648613, "done": false, "custom_metrics": {"outflow_rate_min": 477.8054575421641, "outflow_rate_mean": 830.162382565407, "cost2_mean": -26.565713045031856, "outflow_rate_max": 963.7625491264872, "system_level_velocity_min": 12.043354411483, "cost2_max": -13.333779994463825, "cost2_min": -46.591653109056665, "system_level_velocity_mean": 15.915138147023333, "cost1_min": 15.112173724806912, "cost1_max": 447.22027218120843, "cost1_mean": 392.55361477111575, "system_level_velocity_max": 17.97790464294565}, "timesteps_total": 17371791, "training_iteration": 172, "date": "2019-04-29_12-39-50", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f5f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 172, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 697.9614841591906, "time_total_s": 6349.42630648613, "info": {"grad_time_ms": 21678.811, "default": {"total_loss": 31.655960083007812, "kl": 0.014529741369187832, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01504216343164444, "vf_loss": 31.66364860534668, "entropy": 2.040126085281372, "vf_explained_var": 0.2779606282711029, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 17371791, "load_time_ms": 16.27, "update_time_ms": 11.66, "sample_time_ms": 15042.971, "num_steps_sampled": 17371791}, "episode_reward_max": 790.9358325928127, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 28.39307630598504, "episodes_total": 13336, "episodes_this_iter": 77, "time_this_iter_s": 37.553725481033325, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99402, "timestamp": 1556541626, "episode_len_mean": 686.52, "timesteps_since_restore": 17471193, "time_since_restore": 6385.259278059006, "done": false, "custom_metrics": {"outflow_rate_min": 477.8054575421641, "outflow_rate_mean": 824.1923629858571, "cost2_mean": -27.512838289990327, "outflow_rate_max": 963.7625491264872, "system_level_velocity_min": 12.242881047440218, "cost2_max": -13.333779994463825, "cost2_min": -41.11846580997982, "system_level_velocity_mean": 15.758583127963313, "cost1_min": 15.112173724806912, "cost1_max": 450.13367748795616, "cost1_mean": 390.7524543612968, "system_level_velocity_max": 18.521001323951158}, "timesteps_total": 17471193, "training_iteration": 173, "date": "2019-04-29_12-40-26", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fb70>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 173, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 705.7291460890732, "time_total_s": 6385.259278059006, "info": {"grad_time_ms": 21410.024, "default": {"total_loss": 36.622135162353516, "kl": 0.013957436196506023, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01582920365035534, "vf_loss": 36.63090133666992, "entropy": 2.050842046737671, "vf_explained_var": 0.27567416429519653, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 17471193, "load_time_ms": 16.286, "update_time_ms": 11.592, "sample_time_ms": 15067.82, "num_steps_sampled": 17471193}, "episode_reward_max": 793.8112064486501, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 28.39307630598504, "episodes_total": 13417, "episodes_this_iter": 81, "time_this_iter_s": 35.83297157287598, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99034, "timestamp": 1556541663, "episode_len_mean": 698.37, "timesteps_since_restore": 17570227, "time_since_restore": 6422.219915390015, "done": false, "custom_metrics": {"outflow_rate_min": 680.9107911489704, "outflow_rate_mean": 829.0468046133196, "cost2_mean": -27.445640245058268, "outflow_rate_max": 950.8896771361705, "system_level_velocity_min": 10.773702201233778, "cost2_max": -18.373802843222524, "cost2_min": -42.03869118052345, "system_level_velocity_mean": 15.777814090957763, "cost1_min": 275.3469070467879, "cost1_max": 446.6475369553706, "cost1_mean": 398.66728364488984, "system_level_velocity_max": 17.906788188748973}, "timesteps_total": 17570227, "training_iteration": 174, "date": "2019-04-29_12-41-03", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ff60>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 174, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 706.7126527066556, "time_total_s": 6422.219915390015, "info": {"grad_time_ms": 21412.518, "default": {"total_loss": 38.803306579589844, "kl": 0.014593412168323994, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01627560332417488, "vf_loss": 38.812191009521484, "entropy": 2.043314218521118, "vf_explained_var": 0.30510270595550537, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 17570227, "load_time_ms": 17.026, "update_time_ms": 11.542, "sample_time_ms": 15054.224, "num_steps_sampled": 17570227}, "episode_reward_max": 822.4672359366051, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 546.3868748078022, "episodes_total": 13500, "episodes_this_iter": 83, "time_this_iter_s": 36.96063733100891, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98990, "timestamp": 1556541699, "episode_len_mean": 698.37, "timesteps_since_restore": 17669217, "time_since_restore": 6458.35173034668, "done": false, "custom_metrics": {"outflow_rate_min": 680.9107911489704, "outflow_rate_mean": 818.9101209840411, "cost2_mean": -26.264890731925323, "outflow_rate_max": 940.4919637754748, "system_level_velocity_min": 10.773702201233778, "cost2_max": -15.744960431727321, "cost2_min": -42.24811627151259, "system_level_velocity_mean": 15.767898908121191, "cost1_min": 275.3469070467879, "cost1_max": 452.31990037365085, "cost1_mean": 398.42671997655566, "system_level_velocity_max": 18.51553861461882}, "timesteps_total": 17669217, "training_iteration": 175, "date": "2019-04-29_12-41-39", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f748>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 175, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 702.8595989662199, "time_total_s": 6458.35173034668, "info": {"grad_time_ms": 21297.884, "default": {"total_loss": 31.095245361328125, "kl": 0.013816332444548607, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015619360841810703, "vf_loss": 31.103872299194336, "entropy": 2.047902822494507, "vf_explained_var": 0.32801294326782227, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 17669217, "load_time_ms": 15.581, "update_time_ms": 11.544, "sample_time_ms": 14984.117, "num_steps_sampled": 17669217}, "episode_reward_max": 794.6037277063002, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 546.3868748078022, "episodes_total": 13574, "episodes_this_iter": 74, "time_this_iter_s": 36.13181495666504, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99560, "timestamp": 1556541735, "episode_len_mean": 689.08, "timesteps_since_restore": 17768777, "time_since_restore": 6494.400059938431, "done": false, "custom_metrics": {"outflow_rate_min": 674.6246988246559, "outflow_rate_mean": 818.0566062481649, "cost2_mean": -25.64713989264686, "outflow_rate_max": 954.5730986277547, "system_level_velocity_min": 12.274987116553437, "cost2_max": -14.455357214308016, "cost2_min": -45.31235139684013, "system_level_velocity_mean": 15.933549871617947, "cost1_min": 71.21733858560903, "cost1_max": 450.6655507100564, "cost1_mean": 396.7196949818218, "system_level_velocity_max": 18.58531969665511}, "timesteps_total": 17768777, "training_iteration": 176, "date": "2019-04-29_12-42-15", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d208>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 176, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.0511872005137, "time_total_s": 6494.400059938431, "info": {"grad_time_ms": 21244.812, "default": {"total_loss": 35.51650619506836, "kl": 0.014815879985690117, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016026882454752922, "vf_loss": 35.52503204345703, "entropy": 2.0752949714660645, "vf_explained_var": 0.3698579668998718, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 17768777, "load_time_ms": 15.709, "update_time_ms": 11.592, "sample_time_ms": 14949.386, "num_steps_sampled": 17768777}, "episode_reward_max": 795.2196910501772, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 126.33240077705344, "episodes_total": 13658, "episodes_this_iter": 84, "time_this_iter_s": 36.0483295917511, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99088, "timestamp": 1556541772, "episode_len_mean": 700.0, "timesteps_since_restore": 17867865, "time_since_restore": 6530.647706747055, "done": false, "custom_metrics": {"outflow_rate_min": 698.4758915140125, "outflow_rate_mean": 820.8075973599614, "cost2_mean": -27.12756442973174, "outflow_rate_max": 941.3723876107167, "system_level_velocity_min": 12.149346976795181, "cost2_max": -16.300835163945067, "cost2_min": -56.19948680992913, "system_level_velocity_mean": 15.837728179539061, "cost1_min": 318.96440038856576, "cost1_max": 450.6655507100564, "cost1_mean": 400.45829838118925, "system_level_velocity_max": 18.58531969665511}, "timesteps_total": 17867865, "training_iteration": 177, "date": "2019-04-29_12-42-52", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f550>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 177, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 699.5866096924851, "time_total_s": 6530.647706747055, "info": {"grad_time_ms": 21229.226, "default": {"total_loss": 38.091793060302734, "kl": 0.014568506740033627, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016125375404953957, "vf_loss": 38.10054016113281, "entropy": 2.074843168258667, "vf_explained_var": 0.3488004505634308, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 17867865, "load_time_ms": 15.863, "update_time_ms": 11.59, "sample_time_ms": 14918.638, "num_steps_sampled": 17867865}, "episode_reward_max": 795.1633193837794, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 494.58894502089225, "episodes_total": 13743, "episodes_this_iter": 85, "time_this_iter_s": 36.24764680862427, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99182, "timestamp": 1556541809, "episode_len_mean": 690.67, "timesteps_since_restore": 17967047, "time_since_restore": 6567.766109704971, "done": false, "custom_metrics": {"outflow_rate_min": 470.6106698001805, "outflow_rate_mean": 811.1523627266417, "cost2_mean": -27.162221429869316, "outflow_rate_max": 950.5469516881517, "system_level_velocity_min": 9.904954626232858, "cost2_max": -13.341107461368823, "cost2_min": -43.23999668378926, "system_level_velocity_mean": 15.635950811255645, "cost1_min": 12.87164678829248, "cost1_max": 451.6999639156021, "cost1_mean": 390.14202367891886, "system_level_velocity_max": 17.98477814122273}, "timesteps_total": 17967047, "training_iteration": 178, "date": "2019-04-29_12-43-29", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 178, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 689.3878603471317, "time_total_s": 6567.766109704971, "info": {"grad_time_ms": 21245.343, "default": {"total_loss": 33.953636169433594, "kl": 0.014783667400479317, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016790762543678284, "vf_loss": 33.96294021606445, "entropy": 2.073718547821045, "vf_explained_var": 0.36701148748397827, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 17967047, "load_time_ms": 15.112, "update_time_ms": 11.496, "sample_time_ms": 14988.971, "num_steps_sampled": 17967047}, "episode_reward_max": 788.3472652626884, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 19.43147096869982, "episodes_total": 13820, "episodes_this_iter": 77, "time_this_iter_s": 37.11840295791626, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 98984, "timestamp": 1556541846, "episode_len_mean": 686.81, "timesteps_since_restore": 18066031, "time_since_restore": 6604.44061255455, "done": false, "custom_metrics": {"outflow_rate_min": 507.2897802266834, "outflow_rate_mean": 806.6031051614416, "cost2_mean": -26.120574622672667, "outflow_rate_max": 958.8712952531437, "system_level_velocity_min": 11.682662048888632, "cost2_max": -13.065539725123685, "cost2_min": -46.80647576558287, "system_level_velocity_mean": 15.69040776127255, "cost1_min": 21.33041405482686, "cost1_max": 447.87482629710706, "cost1_mean": 388.86154044257523, "system_level_velocity_max": 18.050624244942902}, "timesteps_total": 18066031, "training_iteration": 179, "date": "2019-04-29_12-44-06", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fa90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fdd8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 179, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 675.0317510453856, "time_total_s": 6604.44061255455, "info": {"grad_time_ms": 21349.34, "default": {"total_loss": 35.779510498046875, "kl": 0.014972753822803497, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01615583337843418, "vf_loss": 35.7880859375, "entropy": 2.091493606567383, "vf_explained_var": 0.4392419159412384, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 18066031, "load_time_ms": 15.358, "update_time_ms": 11.175, "sample_time_ms": 14996.093, "num_steps_sampled": 18066031}, "episode_reward_max": 773.0329640222692, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 44.10061669464504, "episodes_total": 13900, "episodes_this_iter": 80, "time_this_iter_s": 36.67450284957886, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99862, "timestamp": 1556541885, "episode_len_mean": 699.23, "timesteps_since_restore": 18165893, "time_since_restore": 6643.370862960815, "done": false, "custom_metrics": {"outflow_rate_min": 690.8395592122846, "outflow_rate_mean": 819.7472434172066, "cost2_mean": -25.947574701762164, "outflow_rate_max": 915.817461862077, "system_level_velocity_min": 11.682662048888632, "cost2_max": -17.089662049543847, "cost2_min": -39.8881784927119, "system_level_velocity_mean": 15.68116382585443, "cost1_min": 305.9219076287659, "cost1_max": 446.1183882068812, "cost1_mean": 397.02095603603675, "system_level_velocity_max": 17.980746887075885}, "timesteps_total": 18165893, "training_iteration": 180, "date": "2019-04-29_12-44-45", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 180, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 691.7588110502323, "time_total_s": 6643.370862960815, "info": {"grad_time_ms": 21603.387, "default": {"total_loss": 35.997276306152344, "kl": 0.014309880323708057, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015891307964920998, "vf_loss": 36.005924224853516, "entropy": 2.071442127227783, "vf_explained_var": 0.43133920431137085, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 18165893, "load_time_ms": 14.929, "update_time_ms": 11.241, "sample_time_ms": 14985.909, "num_steps_sampled": 18165893}, "episode_reward_max": 794.5134613073848, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 392.6576590265639, "episodes_total": 13986, "episodes_this_iter": 86, "time_this_iter_s": 38.93025040626526, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99910, "timestamp": 1556541920, "episode_len_mean": 691.16, "timesteps_since_restore": 18265803, "time_since_restore": 6678.910342216492, "done": false, "custom_metrics": {"outflow_rate_min": 558.3198980064321, "outflow_rate_mean": 823.2233943621782, "cost2_mean": -27.25732962751375, "outflow_rate_max": 975.9061124299881, "system_level_velocity_min": 12.506982746575991, "cost2_max": -14.857560635540857, "cost2_min": -44.90239720997475, "system_level_velocity_mean": 15.58132643792098, "cost1_min": 30.13690238054805, "cost1_max": 437.5345257927984, "cost1_mean": 389.7654221906214, "system_level_velocity_max": 17.88226291268277}, "timesteps_total": 18265803, "training_iteration": 181, "date": "2019-04-29_12-45-20", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fe80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f588>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 181, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.0631011733099, "time_total_s": 6678.910342216492, "info": {"grad_time_ms": 21498.816, "default": {"total_loss": 32.63838577270508, "kl": 0.014292052015662193, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016156569123268127, "vf_loss": 32.64730453491211, "entropy": 2.075204610824585, "vf_explained_var": 0.4536322057247162, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 18265803, "load_time_ms": 13.956, "update_time_ms": 11.12, "sample_time_ms": 14956.259, "num_steps_sampled": 18265803}, "episode_reward_max": 787.1206147698059, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 56.10819840890863, "episodes_total": 14063, "episodes_this_iter": 77, "time_this_iter_s": 35.53947925567627, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99913, "timestamp": 1556541955, "episode_len_mean": 700.0, "timesteps_since_restore": 18365716, "time_since_restore": 6713.579759836197, "done": false, "custom_metrics": {"outflow_rate_min": 594.9804103783417, "outflow_rate_mean": 826.7781761152139, "cost2_mean": -27.429762601409465, "outflow_rate_max": 933.3736330726049, "system_level_velocity_min": 9.57820959870703, "cost2_max": -15.970501010836069, "cost2_min": -51.01588630984983, "system_level_velocity_mean": 15.530314439850947, "cost1_min": 248.002040570748, "cost1_max": 444.3103372845571, "cost1_mean": 394.9247480750718, "system_level_velocity_max": 17.92203087709964}, "timesteps_total": 18365716, "training_iteration": 182, "date": "2019-04-29_12-45-55", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d65438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d656a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ccf8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 182, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 707.9348763882714, "time_total_s": 6713.579759836197, "info": {"grad_time_ms": 21253.757, "default": {"total_loss": 33.56272506713867, "kl": 0.015054905787110329, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01557942945510149, "vf_loss": 33.57068634033203, "entropy": 2.0882630348205566, "vf_explained_var": 0.43966612219810486, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 18365716, "load_time_ms": 14.161, "update_time_ms": 11.107, "sample_time_ms": 14914.973, "num_steps_sampled": 18365716}, "episode_reward_max": 804.0388725349936, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 424.32636254536413, "episodes_total": 14140, "episodes_this_iter": 77, "time_this_iter_s": 34.6694176197052, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99625, "timestamp": 1556541991, "episode_len_mean": 690.45, "timesteps_since_restore": 18465341, "time_since_restore": 6749.865278959274, "done": false, "custom_metrics": {"outflow_rate_min": 502.84020309931793, "outflow_rate_mean": 830.8799948854052, "cost2_mean": -27.72018079283504, "outflow_rate_max": 959.3646929525246, "system_level_velocity_min": 10.91524423191973, "cost2_max": -13.33850870983764, "cost2_min": -51.01588630984983, "system_level_velocity_mean": 15.700942917398208, "cost1_min": 22.08993794471733, "cost1_max": 443.3215874925746, "cost1_mean": 392.96501413534185, "system_level_velocity_max": 17.75324255813668}, "timesteps_total": 18465341, "training_iteration": 183, "date": "2019-04-29_12-46-31", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fa90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fe48>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 183, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 706.2815842986857, "time_total_s": 6749.865278959274, "info": {"grad_time_ms": 21310.565, "default": {"total_loss": 38.783538818359375, "kl": 0.014015146531164646, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01598142646253109, "vf_loss": 38.792423248291016, "entropy": 2.082934617996216, "vf_explained_var": 0.4613111615180969, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 18465341, "load_time_ms": 14.136, "update_time_ms": 11.111, "sample_time_ms": 14903.318, "num_steps_sampled": 18465341}, "episode_reward_max": 804.0388725349936, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 47.718369166159505, "episodes_total": 14227, "episodes_this_iter": 87, "time_this_iter_s": 36.28551912307739, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100053, "timestamp": 1556542029, "episode_len_mean": 690.02, "timesteps_since_restore": 18565394, "time_since_restore": 6787.985449552536, "done": false, "custom_metrics": {"outflow_rate_min": 489.7966667128977, "outflow_rate_mean": 832.4491287116299, "cost2_mean": -28.142967474210305, "outflow_rate_max": 968.1633905440432, "system_level_velocity_min": 11.515050684295865, "cost2_max": -14.312396139380802, "cost2_min": -49.74383849909552, "system_level_velocity_mean": 15.71007822382894, "cost1_min": 18.44879444729408, "cost1_max": 446.0482224021317, "cost1_mean": 393.2106808104246, "system_level_velocity_max": 18.04958123920806}, "timesteps_total": 18565394, "training_iteration": 184, "date": "2019-04-29_12-47-09", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 184, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 703.9575445315304, "time_total_s": 6787.985449552536, "info": {"grad_time_ms": 21299.421, "default": {"total_loss": 34.48600387573242, "kl": 0.013930592685937881, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015268317423760891, "vf_loss": 34.494224548339844, "entropy": 2.084313154220581, "vf_explained_var": 0.416533499956131, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 18565394, "load_time_ms": 13.863, "update_time_ms": 11.198, "sample_time_ms": 15034.137, "num_steps_sampled": 18565394}, "episode_reward_max": 807.8533946176825, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 34.7173956338353, "episodes_total": 14303, "episodes_this_iter": 76, "time_this_iter_s": 38.12017059326172, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99354, "timestamp": 1556542066, "episode_len_mean": 694.73, "timesteps_since_restore": 18664748, "time_since_restore": 6824.7983655929565, "done": false, "custom_metrics": {"outflow_rate_min": 660.0829391402683, "outflow_rate_mean": 815.1845318217056, "cost2_mean": -27.946800191290734, "outflow_rate_max": 947.1063145616208, "system_level_velocity_min": 11.341904877068918, "cost2_max": -16.402922660487178, "cost2_min": -45.66567662222442, "system_level_velocity_mean": 15.391964566240983, "cost1_min": 151.86277445001554, "cost1_max": 436.3874157232797, "cost1_mean": 388.55123625031905, "system_level_velocity_max": 17.48651955908919}, "timesteps_total": 18664748, "training_iteration": 185, "date": "2019-04-29_12-47-46", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ff98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 185, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 694.7790724599951, "time_total_s": 6824.7983655929565, "info": {"grad_time_ms": 21356.26, "default": {"total_loss": 34.335933685302734, "kl": 0.015248593874275684, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01628238707780838, "vf_loss": 34.3444938659668, "entropy": 2.0958313941955566, "vf_explained_var": 0.38167044520378113, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 18664748, "load_time_ms": 14.283, "update_time_ms": 11.331, "sample_time_ms": 15044.101, "num_steps_sampled": 18664748}, "episode_reward_max": 773.8257985694822, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 287.5088196159219, "episodes_total": 14381, "episodes_this_iter": 78, "time_this_iter_s": 36.81291604042053, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100262, "timestamp": 1556542104, "episode_len_mean": 685.69, "timesteps_since_restore": 18765010, "time_since_restore": 6862.697294473648, "done": false, "custom_metrics": {"outflow_rate_min": 472.27522138912553, "outflow_rate_mean": 823.1242895135479, "cost2_mean": -27.81829956719396, "outflow_rate_max": 966.9362212539269, "system_level_velocity_min": 11.341904877068918, "cost2_max": -12.921666692989252, "cost2_min": -53.285055180375245, "system_level_velocity_mean": 15.59088508521679, "cost1_min": 20.736758332536517, "cost1_max": 445.3143126043496, "cost1_mean": 386.6980285398091, "system_level_velocity_max": 17.917901715970412}, "timesteps_total": 18765010, "training_iteration": 186, "date": "2019-04-29_12-48-24", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ccf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c2e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 186, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 695.0371492376821, "time_total_s": 6862.697294473648, "info": {"grad_time_ms": 21489.606, "default": {"total_loss": 36.49277114868164, "kl": 0.01464005745947361, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016114113852381706, "vf_loss": 36.50147247314453, "entropy": 2.1030960083007812, "vf_explained_var": 0.3273501992225647, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 18765010, "load_time_ms": 14.225, "update_time_ms": 11.171, "sample_time_ms": 15094.938, "num_steps_sampled": 18765010}, "episode_reward_max": 862.7398229207566, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 44.89629873291189, "episodes_total": 14468, "episodes_this_iter": 87, "time_this_iter_s": 37.89892888069153, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99823, "timestamp": 1556542141, "episode_len_mean": 667.11, "timesteps_since_restore": 18864833, "time_since_restore": 6899.4266057014465, "done": false, "custom_metrics": {"outflow_rate_min": 438.4828282571101, "outflow_rate_mean": 817.0658634094445, "cost2_mean": -27.18713754251046, "outflow_rate_max": 961.6386844686056, "system_level_velocity_min": 11.220787161239638, "cost2_max": -7.868292578453984, "cost2_min": -47.534214606487154, "system_level_velocity_mean": 15.552375950166441, "cost1_min": 9.148938612969035, "cost1_max": 440.25678929798164, "cost1_mean": 375.6165475762877, "system_level_velocity_max": 17.599019904707415}, "timesteps_total": 18864833, "training_iteration": 187, "date": "2019-04-29_12-49-01", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fb00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fc50>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 187, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 675.4976145402983, "time_total_s": 6899.4266057014465, "info": {"grad_time_ms": 21527.443, "default": {"total_loss": 32.80808639526367, "kl": 0.014702803455293179, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016606129705905914, "vf_loss": 32.8172492980957, "entropy": 2.1262035369873047, "vf_explained_var": 0.37689366936683655, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 18864833, "load_time_ms": 14.109, "update_time_ms": 11.111, "sample_time_ms": 15104.039, "num_steps_sampled": 18864833}, "episode_reward_max": 775.0322023953619, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 14.296460252283167, "episodes_total": 14547, "episodes_this_iter": 79, "time_this_iter_s": 36.72931122779846, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99822, "timestamp": 1556542178, "episode_len_mean": 686.78, "timesteps_since_restore": 18964655, "time_since_restore": 6936.317574501038, "done": false, "custom_metrics": {"outflow_rate_min": 506.3899887205047, "outflow_rate_mean": 831.4896009527724, "cost2_mean": -27.058002368958384, "outflow_rate_max": 976.2735845185092, "system_level_velocity_min": 11.90578597485759, "cost2_max": -14.141544740456293, "cost2_min": -47.534214606487154, "system_level_velocity_mean": 15.684747327730737, "cost1_min": 24.221866597955586, "cost1_max": 440.25678929798164, "cost1_mean": 390.1129561201531, "system_level_velocity_max": 18.21042853726481}, "timesteps_total": 18964655, "training_iteration": 188, "date": "2019-04-29_12-49-38", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cf98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6cbe0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 188, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 706.9966852395705, "time_total_s": 6936.317574501038, "info": {"grad_time_ms": 21560.835, "default": {"total_loss": 32.09628677368164, "kl": 0.014909287914633751, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01650787517428398, "vf_loss": 32.10524368286133, "entropy": 2.106367349624634, "vf_explained_var": 0.374671071767807, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 18964655, "load_time_ms": 13.499, "update_time_ms": 11.147, "sample_time_ms": 15047.915, "num_steps_sampled": 18964655}, "episode_reward_max": 803.4065998562141, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 47.70090043308848, "episodes_total": 14626, "episodes_this_iter": 79, "time_this_iter_s": 36.890968799591064, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100314, "timestamp": 1556542217, "episode_len_mean": 693.38, "timesteps_since_restore": 19064969, "time_since_restore": 6974.946789264679, "done": false, "custom_metrics": {"outflow_rate_min": 523.7118570043469, "outflow_rate_mean": 846.0041136178459, "cost2_mean": -27.703279759603664, "outflow_rate_max": 997.9173859704154, "system_level_velocity_min": 11.242798223888013, "cost2_max": -15.80164020318652, "cost2_min": -50.90661933207571, "system_level_velocity_mean": 15.696569062563054, "cost1_min": 25.15216114951488, "cost1_max": 435.48259398414467, "cost1_mean": 394.1513946004039, "system_level_velocity_max": 18.21042853726481}, "timesteps_total": 19064969, "training_iteration": 189, "date": "2019-04-29_12-50-17", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ff98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ff60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f940>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 189, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 720.7895448082319, "time_total_s": 6974.946789264679, "info": {"grad_time_ms": 21637.845, "default": {"total_loss": 38.35895919799805, "kl": 0.01565469428896904, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01613730937242508, "vf_loss": 38.36717224121094, "entropy": 2.0926952362060547, "vf_explained_var": 0.3070813715457916, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 19064969, "load_time_ms": 14.317, "update_time_ms": 11.368, "sample_time_ms": 15165.703, "num_steps_sampled": 19064969}, "episode_reward_max": 823.4082196770281, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 50.83860243228645, "episodes_total": 14706, "episodes_this_iter": 80, "time_this_iter_s": 38.62921476364136, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100023, "timestamp": 1556542254, "episode_len_mean": 677.96, "timesteps_since_restore": 19164992, "time_since_restore": 7012.178552150726, "done": false, "custom_metrics": {"outflow_rate_min": 489.846591981012, "outflow_rate_mean": 835.1683853172444, "cost2_mean": -26.472123632058285, "outflow_rate_max": 997.9173859704154, "system_level_velocity_min": 11.64834910563908, "cost2_max": -11.049384360771862, "cost2_min": -47.0029266781461, "system_level_velocity_mean": 15.681631253410574, "cost1_min": 17.602554436077238, "cost1_max": 443.17834457201957, "cost1_mean": 384.9264313006594, "system_level_velocity_max": 17.80208303047994}, "timesteps_total": 19164992, "training_iteration": 190, "date": "2019-04-29_12-50-54", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c7f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6c438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ffd0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 190, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 702.3974668991451, "time_total_s": 7012.178552150726, "info": {"grad_time_ms": 21464.914, "default": {"total_loss": 36.3616943359375, "kl": 0.015575076453387737, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01531450729817152, "vf_loss": 36.3691291809082, "entropy": 2.130841016769409, "vf_explained_var": 0.35665303468704224, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 19164992, "load_time_ms": 15.639, "update_time_ms": 11.348, "sample_time_ms": 15166.985, "num_steps_sampled": 19164992}, "episode_reward_max": 826.9446034635017, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 39.631411786408066, "episodes_total": 14788, "episodes_this_iter": 82, "time_this_iter_s": 37.23176288604736, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99393, "timestamp": 1556542289, "episode_len_mean": 680.85, "timesteps_since_restore": 19264385, "time_since_restore": 7046.760376214981, "done": false, "custom_metrics": {"outflow_rate_min": 502.7282416547235, "outflow_rate_mean": 834.3817911621461, "cost2_mean": -26.835494042646964, "outflow_rate_max": 959.5141900192692, "system_level_velocity_min": 8.398810434952663, "cost2_max": -12.590657251391328, "cost2_min": -62.023951549506215, "system_level_velocity_mean": 15.650378414390024, "cost1_min": 19.48262729409108, "cost1_max": 444.55450373004055, "cost1_mean": 386.160651501816, "system_level_velocity_max": 17.780234231072424}, "timesteps_total": 19264385, "training_iteration": 191, "date": "2019-04-29_12-51-29", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fa20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f278>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 191, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 702.5907053803646, "time_total_s": 7046.760376214981, "info": {"grad_time_ms": 21362.242, "default": {"total_loss": 31.6373233795166, "kl": 0.014178536832332611, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015240699984133244, "vf_loss": 31.645383834838867, "entropy": 2.103395700454712, "vf_explained_var": 0.3499611020088196, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 19264385, "load_time_ms": 17.106, "update_time_ms": 11.362, "sample_time_ms": 15169.448, "num_steps_sampled": 19264385}, "episode_reward_max": 826.9446034635017, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 35.56911526879937, "episodes_total": 14865, "episodes_this_iter": 77, "time_this_iter_s": 34.58182406425476, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100123, "timestamp": 1556542326, "episode_len_mean": 695.35, "timesteps_since_restore": 19364508, "time_since_restore": 7083.563601493835, "done": false, "custom_metrics": {"outflow_rate_min": 731.8851870486038, "outflow_rate_mean": 851.0009999633196, "cost2_mean": -26.824370563172778, "outflow_rate_max": 982.7933693497677, "system_level_velocity_min": 13.427972645689339, "cost2_max": -14.781684822549758, "cost2_min": -43.27446367601178, "system_level_velocity_mean": 15.820539901496518, "cost1_min": 220.22296113586188, "cost1_max": 440.945704610862, "cost1_mean": 398.5400168007789, "system_level_velocity_max": 17.745666126101238}, "timesteps_total": 19364508, "training_iteration": 192, "date": "2019-04-29_12-52-06", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fd68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fe10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 192, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 720.0631963429632, "time_total_s": 7083.563601493835, "info": {"grad_time_ms": 21537.903, "default": {"total_loss": 39.23815155029297, "kl": 0.0147132882848382, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01581761986017227, "vf_loss": 39.246517181396484, "entropy": 2.117213726043701, "vf_explained_var": 0.302715539932251, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 19364508, "load_time_ms": 17.705, "update_time_ms": 11.62, "sample_time_ms": 15206.229, "num_steps_sampled": 19364508}, "episode_reward_max": 810.1962634589847, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 374.16291950812524, "episodes_total": 14949, "episodes_this_iter": 84, "time_this_iter_s": 36.80322527885437, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100073, "timestamp": 1556542363, "episode_len_mean": 694.13, "timesteps_since_restore": 19464581, "time_since_restore": 7120.559794187546, "done": false, "custom_metrics": {"outflow_rate_min": 760.1502151315875, "outflow_rate_mean": 847.7318619779944, "cost2_mean": -29.31415227743447, "outflow_rate_max": 970.3582837738513, "system_level_velocity_min": 12.700183272363955, "cost2_max": -16.224332137771764, "cost2_min": -50.736081480327705, "system_level_velocity_mean": 15.744104456728671, "cost1_min": 220.22296113586188, "cost1_max": 444.27268189290766, "cost1_mean": 395.7432539823374, "system_level_velocity_max": 17.832651205350963}, "timesteps_total": 19464581, "training_iteration": 193, "date": "2019-04-29_12-52-43", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fdd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fe80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fe48>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 193, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 718.1114239568935, "time_total_s": 7120.559794187546, "info": {"grad_time_ms": 21616.128, "default": {"total_loss": 30.942934036254883, "kl": 0.01501241885125637, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016651829704642296, "vf_loss": 30.95198631286621, "entropy": 2.1305160522460938, "vf_explained_var": 0.3587888479232788, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 19464581, "load_time_ms": 17.616, "update_time_ms": 11.684, "sample_time_ms": 15198.286, "num_steps_sampled": 19464581}, "episode_reward_max": 809.409438963862, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 374.16291950812524, "episodes_total": 15027, "episodes_this_iter": 78, "time_this_iter_s": 36.99619269371033, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99726, "timestamp": 1556542399, "episode_len_mean": 690.9, "timesteps_since_restore": 19564307, "time_since_restore": 7156.375827789307, "done": false, "custom_metrics": {"outflow_rate_min": 502.88459449330645, "outflow_rate_mean": 842.1584164613213, "cost2_mean": -28.730813865686443, "outflow_rate_max": 968.0519993766078, "system_level_velocity_min": 11.024087065615571, "cost2_max": -13.59970577739511, "cost2_min": -52.51290888094625, "system_level_velocity_mean": 15.522695318937823, "cost1_min": 21.701362951047653, "cost1_max": 433.8009949889588, "cost1_mean": 388.75396545787225, "system_level_velocity_max": 17.55399388006761}, "timesteps_total": 19564307, "training_iteration": 194, "date": "2019-04-29_12-53-19", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6ffd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f9e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 194, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 716.5698699389627, "time_total_s": 7156.375827789307, "info": {"grad_time_ms": 21509.792, "default": {"total_loss": 35.43883514404297, "kl": 0.014674074947834015, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016426706686615944, "vf_loss": 35.44783401489258, "entropy": 2.139033317565918, "vf_explained_var": 0.31812024116516113, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 19564307, "load_time_ms": 16.959, "update_time_ms": 11.646, "sample_time_ms": 15074.813, "num_steps_sampled": 19564307}, "episode_reward_max": 807.2627394987632, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 44.6655366458548, "episodes_total": 15104, "episodes_this_iter": 77, "time_this_iter_s": 35.816033601760864, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99929, "timestamp": 1556542436, "episode_len_mean": 686.56, "timesteps_since_restore": 19664236, "time_since_restore": 7193.512337684631, "done": false, "custom_metrics": {"outflow_rate_min": 470.6106698001805, "outflow_rate_mean": 838.3670935158899, "cost2_mean": -26.688625663179423, "outflow_rate_max": 969.1056439037947, "system_level_velocity_min": 11.024087065615571, "cost2_max": -12.165347623788488, "cost2_min": -42.28938520318812, "system_level_velocity_mean": 15.725004389389929, "cost1_min": 12.74848332318899, "cost1_max": 449.5019615004415, "cost1_mean": 392.054973824747, "system_level_velocity_max": 17.95316735826852}, "timesteps_total": 19664236, "training_iteration": 195, "date": "2019-04-29_12-53-56", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f198>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 195, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 707.981731597994, "time_total_s": 7193.512337684631, "info": {"grad_time_ms": 21490.815, "default": {"total_loss": 40.80185317993164, "kl": 0.015156921930611134, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01606033556163311, "vf_loss": 40.810237884521484, "entropy": 2.111304521560669, "vf_explained_var": 0.29373764991760254, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 19664236, "load_time_ms": 16.891, "update_time_ms": 11.435, "sample_time_ms": 15126.791, "num_steps_sampled": 19664236}, "episode_reward_max": 828.330027750389, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 23.991803423379984, "episodes_total": 15188, "episodes_this_iter": 84, "time_this_iter_s": 37.13650989532471, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99922, "timestamp": 1556542472, "episode_len_mean": 683.86, "timesteps_since_restore": 19764158, "time_since_restore": 7230.058533191681, "done": false, "custom_metrics": {"outflow_rate_min": 503.3867637682112, "outflow_rate_mean": 825.943365803202, "cost2_mean": -25.19041641274798, "outflow_rate_max": 969.1056439037947, "system_level_velocity_min": 12.842621225004189, "cost2_max": -12.165347623788488, "cost2_min": -45.68136317277233, "system_level_velocity_mean": 15.610412804469368, "cost1_min": 21.062813466215978, "cost1_max": 443.4322529388613, "cost1_mean": 387.51342715538345, "system_level_velocity_max": 17.71106666671108}, "timesteps_total": 19764158, "training_iteration": 196, "date": "2019-04-29_12-54-32", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f978>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 196, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 704.4897846991142, "time_total_s": 7230.058533191681, "info": {"grad_time_ms": 21393.349, "default": {"total_loss": 41.28334045410156, "kl": 0.015126354061067104, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014001092873513699, "vf_loss": 41.2896842956543, "entropy": 2.1241812705993652, "vf_explained_var": 0.23067954182624817, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 19764158, "load_time_ms": 16.452, "update_time_ms": 11.486, "sample_time_ms": 15088.871, "num_steps_sampled": 19764158}, "episode_reward_max": 819.4466724098793, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 33.762063277992006, "episodes_total": 15270, "episodes_this_iter": 82, "time_this_iter_s": 36.54619550704956, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100358, "timestamp": 1556542511, "episode_len_mean": 697.17, "timesteps_since_restore": 19864516, "time_since_restore": 7268.449882984161, "done": false, "custom_metrics": {"outflow_rate_min": 705.6435572966999, "outflow_rate_mean": 837.8783591169394, "cost2_mean": -26.630434558453963, "outflow_rate_max": 963.6217628002643, "system_level_velocity_min": 13.343297775249837, "cost2_max": -17.516529893140476, "cost2_min": -43.47838218546964, "system_level_velocity_mean": 15.479550961501225, "cost1_min": 222.97004756307092, "cost1_max": 435.90974217984353, "cost1_mean": 393.5234593829817, "system_level_velocity_max": 17.346397452870022}, "timesteps_total": 19864516, "training_iteration": 197, "date": "2019-04-29_12-55-11", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d739b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d73a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d73f98>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 197, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 721.2701240786362, "time_total_s": 7268.449882984161, "info": {"grad_time_ms": 21554.512, "default": {"total_loss": 38.14665985107422, "kl": 0.014868049882352352, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016184749081730843, "vf_loss": 38.15531921386719, "entropy": 2.1406750679016113, "vf_explained_var": 0.250249445438385, "cur_kl_coeff": 0.5062499642372131}, "num_steps_trained": 19864516, "load_time_ms": 15.388, "update_time_ms": 11.535, "sample_time_ms": 15094.282, "num_steps_sampled": 19864516}, "episode_reward_max": 819.4466724098793, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 422.73365821583354, "episodes_total": 15348, "episodes_this_iter": 78, "time_this_iter_s": 38.39134979248047, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100277, "timestamp": 1556542548, "episode_len_mean": 693.18, "timesteps_since_restore": 19964793, "time_since_restore": 7305.624311923981, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 844.7788314686806, "cost2_mean": -27.924180408707468, "outflow_rate_max": 1006.4869533866178, "system_level_velocity_min": 12.988317104196092, "cost2_max": -11.82788030711772, "cost2_min": -54.296067616316755, "system_level_velocity_mean": 15.441235186048239, "cost1_min": 11.399966809726225, "cost1_max": 436.32691131067816, "cost1_mean": 390.67263896650786, "system_level_velocity_max": 17.48466182606252}, "timesteps_total": 19964793, "training_iteration": 198, "date": "2019-04-29_12-55-48", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f160>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 198, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 722.8433278449971, "time_total_s": 7305.624311923981, "info": {"grad_time_ms": 21610.741, "default": {"total_loss": 35.68447494506836, "kl": 0.01476974319666624, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01533953845500946, "vf_loss": 35.69233322143555, "entropy": 2.1418590545654297, "vf_explained_var": 0.30779507756233215, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 19964793, "load_time_ms": 16.838, "update_time_ms": 11.547, "sample_time_ms": 15068.428, "num_steps_sampled": 19964793}, "episode_reward_max": 808.9836829082094, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 16.59725723830045, "episodes_total": 15422, "episodes_this_iter": 74, "time_this_iter_s": 37.174428939819336, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 99948, "timestamp": 1556542585, "episode_len_mean": 693.18, "timesteps_since_restore": 20064741, "time_since_restore": 7342.229218959808, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 840.2696795139934, "cost2_mean": -28.835016185751876, "outflow_rate_max": 1006.4869533866178, "system_level_velocity_min": 10.840843648768796, "cost2_max": -11.82788030711772, "cost2_min": -86.13486885542312, "system_level_velocity_mean": 15.309343653831444, "cost1_min": 11.399966809726225, "cost1_max": 437.32252254659704, "cost1_mean": 386.42261120817136, "system_level_velocity_max": 17.400472360747244}, "timesteps_total": 20064741, "training_iteration": 199, "date": "2019-04-29_12-56-25", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6fcf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f7f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 199, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 713.4406069685832, "time_total_s": 7342.229218959808, "info": {"grad_time_ms": 21535.559, "default": {"total_loss": 36.19340133666992, "kl": 0.01437348872423172, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016191938892006874, "vf_loss": 36.20232009887695, "entropy": 2.1682348251342773, "vf_explained_var": 0.3175548017024994, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 20064741, "load_time_ms": 15.597, "update_time_ms": 11.256, "sample_time_ms": 14940.476, "num_steps_sampled": 20064741}, "episode_reward_max": 810.3098907891601, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 16.59725723830045, "episodes_total": 15503, "episodes_this_iter": 81, "time_this_iter_s": 36.60490703582764, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 100337, "timestamp": 1556542621, "episode_len_mean": 700.0, "timesteps_since_restore": 20165078, "time_since_restore": 7378.378887653351, "done": true, "custom_metrics": {"outflow_rate_min": 749.5959330876789, "outflow_rate_mean": 844.706789388883, "cost2_mean": -27.66553532412641, "outflow_rate_max": 965.0574637437093, "system_level_velocity_min": 12.124456072744527, "cost2_max": -16.70158775245477, "cost2_min": -62.06653093972521, "system_level_velocity_mean": 15.423013612759776, "cost1_min": 306.4951943388561, "cost1_max": 436.7846886985138, "cost1_mean": 393.2033711497014, "system_level_velocity_max": 17.747183810925538}, "timesteps_total": 20165078, "training_iteration": 200, "date": "2019-04-29_12-57-01", "config": {"model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "custom_options": {}, "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_workers": 60, "horizon": 1500, "synchronize_filters": true, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "use_gae": true, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d6f1d0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "vf_loss_coeff": 1.0, "clip_param": 0.3, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "collect_metrics_timeout": 180, "output": null, "custom_resources_per_worker": {}}, "iterations_since_restore": 200, "experiment_id": "5a186d9179ea49f09d0957a724e389eb", "episode_reward_mean": 720.509456865922, "time_total_s": 7378.378887653351, "info": {"grad_time_ms": 21445.693, "default": {"total_loss": 33.47175216674805, "kl": 0.01588955894112587, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016395756974816322, "vf_loss": 33.480106353759766, "entropy": 2.1549718379974365, "vf_explained_var": 0.29838627576828003, "cur_kl_coeff": 0.5062499046325684}, "num_steps_trained": 20165078, "load_time_ms": 15.663, "update_time_ms": 11.296, "sample_time_ms": 14923.55, "num_steps_sampled": 20165078}, "episode_reward_max": 814.7822301599381, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 8017, "hostname": "flow-main", "episode_reward_min": 607.3462540601295, "episodes_total": 15581, "episodes_this_iter": 78, "time_this_iter_s": 36.14966869354248, "num_metric_batches_dropped": 0}

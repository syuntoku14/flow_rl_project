{"timesteps_since_restore": 120002, "episode_reward_min": 44040.69182969779, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f66194c1b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33568d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3356668>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 1, "node_ip": "10.138.0.2", "date": "2019-04-30_04-33-29", "num_metric_batches_dropped": 0, "timesteps_total": 120002, "episodes_total": 19, "hostname": "flow-main", "info": {"num_steps_trained": 120002, "num_steps_sampled": 120002, "grad_time_ms": 26921.141, "update_time_ms": 407.694, "load_time_ms": 68.911, "default": {"entropy": 1.4175200462341309, "cur_kl_coeff": 0.20000004768371582, "total_loss": 356847.1875, "vf_explained_var": 0.0, "vf_loss": 356847.15625, "kl": 0.002083249855786562, "policy_loss": -0.0009083656477741897, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 14529.756}, "custom_metrics": {"cost2_min": -62.94231651279381, "system_level_velocity_mean": 7.875271368913411, "outflow_rate_max": 709.7985088076317, "outflow_rate_min": 546.0888752532775, "system_level_velocity_min": 6.650918301290181, "outflow_rate_mean": 617.4066720306012, "cost2_max": -29.09245655762578, "cost1_max": 229.3152863922523, "cost1_min": 165.30692077340277, "cost1_mean": 200.45191090609688, "system_level_velocity_max": 9.072049701160257, "cost2_mean": -42.244981345492526}, "episode_len_mean": 700.0, "episode_reward_mean": 59139.861960815484, "pid": 31719, "episodes_this_iter": 19, "episode_reward_max": 72875.88362865351, "timestamp": 1556598809, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 42.18337607383728, "time_total_s": 42.18337607383728, "time_this_iter_s": 42.18337607383728, "training_iteration": 1, "timesteps_this_iter": 120002, "done": false}
{"timesteps_since_restore": 238082, "episode_reward_min": 42129.715884560224, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335dd8>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 2, "node_ip": "10.138.0.2", "date": "2019-04-30_04-34-12", "num_metric_batches_dropped": 0, "timesteps_total": 238082, "episodes_total": 85, "hostname": "flow-main", "info": {"num_steps_trained": 238082, "num_steps_sampled": 238082, "grad_time_ms": 26450.746, "update_time_ms": 209.462, "load_time_ms": 48.928, "default": {"entropy": 1.4100655317306519, "cur_kl_coeff": 0.10000001639127731, "total_loss": 265364.1875, "vf_explained_var": 3.1995023164199665e-05, "vf_loss": 265364.1875, "kl": 0.005635724402964115, "policy_loss": -0.0022896421141922474, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15325.614}, "custom_metrics": {"cost2_min": -83.04645115982807, "system_level_velocity_mean": 7.612827107380604, "outflow_rate_max": 817.8058483008328, "outflow_rate_min": 368.5570897146213, "system_level_velocity_min": 5.05599936695933, "outflow_rate_mean": 593.2112911121396, "cost2_max": -29.09245655762578, "cost1_max": 249.88181884301028, "cost1_min": 127.99856480958259, "cost1_mean": 195.60520250839335, "system_level_velocity_max": 9.631272068692471, "cost2_mean": -52.07967010697178}, "episode_len_mean": 700.0, "episode_reward_mean": 66942.9241725549, "pid": 31719, "episodes_this_iter": 66, "episode_reward_max": 91894.80926319893, "timestamp": 1556598852, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 84.54519581794739, "time_total_s": 84.54519581794739, "time_this_iter_s": 42.36181974411011, "training_iteration": 2, "timesteps_this_iter": 118080, "done": false}
{"timesteps_since_restore": 348420, "episode_reward_min": 938.7707031361241, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33349e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334128>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 3, "node_ip": "10.138.0.2", "date": "2019-04-30_04-34-51", "num_metric_batches_dropped": 0, "timesteps_total": 348420, "episodes_total": 144, "hostname": "flow-main", "info": {"num_steps_trained": 348420, "num_steps_sampled": 348420, "grad_time_ms": 25657.524, "update_time_ms": 143.505, "load_time_ms": 39.714, "default": {"entropy": 1.410315752029419, "cur_kl_coeff": 0.10000001639127731, "total_loss": 256864.1875, "vf_explained_var": -3.4573460760967123e-10, "vf_loss": 256864.1875, "kl": 0.006618133746087551, "policy_loss": -0.0037054207641631365, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15036.252}, "custom_metrics": {"cost2_min": -86.82646334975422, "system_level_velocity_mean": 7.619641561473166, "outflow_rate_max": 817.8058483008328, "outflow_rate_min": 230.64241390800484, "system_level_velocity_min": 2.557145240202813, "outflow_rate_mean": 576.9755185594953, "cost2_max": -13.351640769844366, "cost1_max": 249.88181884301028, "cost1_min": 12.876992626180119, "cost1_mean": 191.1278090501779, "system_level_velocity_max": 16.846135161476504, "cost2_mean": -51.08323801450804}, "episode_len_mean": 693.2, "episode_reward_mean": 63482.3735376994, "pid": 31719, "episodes_this_iter": 59, "episode_reward_max": 91894.80926319893, "timestamp": 1556598891, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 123.29955720901489, "time_total_s": 123.29955720901489, "time_this_iter_s": 38.754361391067505, "training_iteration": 3, "timesteps_this_iter": 110338, "done": false}
{"timesteps_since_restore": 461632, "episode_reward_min": 938.7707031361241, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33359b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335eb8>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 4, "node_ip": "10.138.0.2", "date": "2019-04-30_04-35-30", "num_metric_batches_dropped": 0, "timesteps_total": 461632, "episodes_total": 209, "hostname": "flow-main", "info": {"num_steps_trained": 461632, "num_steps_sampled": 461632, "grad_time_ms": 25314.595, "update_time_ms": 110.301, "load_time_ms": 35.938, "default": {"entropy": 1.4077593088150024, "cur_kl_coeff": 0.10000001639127731, "total_loss": 236534.25, "vf_explained_var": -9.439650172637926e-10, "vf_loss": 236534.25, "kl": 0.009926331229507923, "policy_loss": -0.004979696590453386, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15093.206}, "custom_metrics": {"cost2_min": -108.21001317463363, "system_level_velocity_mean": 7.911827511735598, "outflow_rate_max": 814.7844141529562, "outflow_rate_min": 155.2122764659337, "system_level_velocity_min": 1.9655996274805034, "outflow_rate_mean": 588.4299100758493, "cost2_max": -13.351640769844366, "cost1_max": 280.7966344537122, "cost1_min": 12.876992626180119, "cost1_mean": 196.6750635580338, "system_level_velocity_max": 16.846135161476504, "cost2_mean": -44.52774964399429}, "episode_len_mean": 693.2, "episode_reward_mean": 57260.46686205684, "pid": 31719, "episodes_this_iter": 65, "episode_reward_max": 109040.88813412495, "timestamp": 1556598930, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 163.08461046218872, "time_total_s": 163.08461046218872, "time_this_iter_s": 39.78505325317383, "training_iteration": 4, "timesteps_this_iter": 113212, "done": false}
{"timesteps_since_restore": 578266, "episode_reward_min": 29526.34929844449, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334fd0>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 5, "node_ip": "10.138.0.2", "date": "2019-04-30_04-36-11", "num_metric_batches_dropped": 0, "timesteps_total": 578266, "episodes_total": 262, "hostname": "flow-main", "info": {"num_steps_trained": 578266, "num_steps_sampled": 578266, "grad_time_ms": 25391.467, "update_time_ms": 90.581, "load_time_ms": 33.333, "default": {"entropy": 1.401262879371643, "cur_kl_coeff": 0.10000002384185791, "total_loss": 200712.328125, "vf_explained_var": -4.3836565488675205e-09, "vf_loss": 200712.34375, "kl": 0.013214794918894768, "policy_loss": -0.006727042607963085, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15081.665}, "custom_metrics": {"cost2_min": -108.21001317463363, "system_level_velocity_mean": 7.716203481626792, "outflow_rate_max": 833.974722578563, "outflow_rate_min": 155.2122764659337, "system_level_velocity_min": 1.9655996274805034, "outflow_rate_mean": 586.7122909176883, "cost2_max": -23.459290662390206, "cost1_max": 273.74945892439746, "cost1_min": 49.95594133646358, "cost1_mean": 195.67304877476, "system_level_velocity_max": 10.855441009017314, "cost2_mean": -47.46652216970878}, "episode_len_mean": 700.0, "episode_reward_mean": 59475.912338098635, "pid": 31719, "episodes_this_iter": 53, "episode_reward_max": 109040.88813412495, "timestamp": 1556598971, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 204.06058716773987, "time_total_s": 204.06058716773987, "time_this_iter_s": 40.97597670555115, "training_iteration": 5, "timesteps_this_iter": 116634, "done": false}
{"timesteps_since_restore": 698589, "episode_reward_min": 36052.218429353474, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335be0>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 6, "node_ip": "10.138.0.2", "date": "2019-04-30_04-36-55", "num_metric_batches_dropped": 0, "timesteps_total": 698589, "episodes_total": 315, "hostname": "flow-main", "info": {"num_steps_trained": 698589, "num_steps_sampled": 698589, "grad_time_ms": 25666.428, "update_time_ms": 77.295, "load_time_ms": 31.44, "default": {"entropy": 1.3995883464813232, "cur_kl_coeff": 0.10000001639127731, "total_loss": 200937.1875, "vf_explained_var": -6.594556456462897e-09, "vf_loss": 200937.1875, "kl": 0.01487759593874216, "policy_loss": -0.006884612608700991, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15192.024}, "custom_metrics": {"cost2_min": -107.44839231358654, "system_level_velocity_mean": 7.86079098276053, "outflow_rate_max": 954.0631354745044, "outflow_rate_min": 351.5150217263972, "system_level_velocity_min": 5.139334418215846, "outflow_rate_mean": 603.3386184673614, "cost2_max": -22.303028076404654, "cost1_max": 318.374369576444, "cost1_min": 129.95779894539416, "cost1_mean": 200.83448640918377, "system_level_velocity_max": 12.243012768416156, "cost2_mean": -51.4183680697115}, "episode_len_mean": 700.0, "episode_reward_mean": 64638.38175297538, "pid": 31719, "episodes_this_iter": 53, "episode_reward_max": 107613.2631296337, "timestamp": 1556599015, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 247.0977120399475, "time_total_s": 247.0977120399475, "time_this_iter_s": 43.03712487220764, "training_iteration": 6, "timesteps_this_iter": 120323, "done": false}
{"timesteps_since_restore": 819869, "episode_reward_min": 32260.93889259643, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33340f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334470>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 7, "node_ip": "10.138.0.2", "date": "2019-04-30_04-37-37", "num_metric_batches_dropped": 0, "timesteps_total": 819869, "episodes_total": 368, "hostname": "flow-main", "info": {"num_steps_trained": 819869, "num_steps_sampled": 819869, "grad_time_ms": 25786.113, "update_time_ms": 67.98, "load_time_ms": 30.26, "default": {"entropy": 1.422200322151184, "cur_kl_coeff": 0.10000001639127731, "total_loss": 165229.828125, "vf_explained_var": -5.979346795470519e-09, "vf_loss": 165229.84375, "kl": 0.017072806134819984, "policy_loss": -0.00762965576723218, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15277.277}, "custom_metrics": {"cost2_min": -107.44839231358654, "system_level_velocity_mean": 7.6469862976106215, "outflow_rate_max": 1043.7799458848656, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.0672616798672685, "outflow_rate_mean": 581.1712760097703, "cost2_max": -22.303028076404654, "cost1_max": 343.8392473928267, "cost1_min": 52.68603985668038, "cost1_mean": 196.28345884926068, "system_level_velocity_max": 13.177128674708106, "cost2_mean": -54.08514857971603}, "episode_len_mean": 700.0, "episode_reward_mean": 67789.39398999688, "pid": 31719, "episodes_this_iter": 53, "episode_reward_max": 115870.62757883228, "timestamp": 1556599057, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 289.6394627094269, "time_total_s": 289.6394627094269, "time_this_iter_s": 42.54175066947937, "training_iteration": 7, "timesteps_this_iter": 121280, "done": false}
{"timesteps_since_restore": 941496, "episode_reward_min": 32260.93889259643, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a332e898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a332e6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3378e80>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 8, "node_ip": "10.138.0.2", "date": "2019-04-30_04-38-18", "num_metric_batches_dropped": 0, "timesteps_total": 941496, "episodes_total": 415, "hostname": "flow-main", "info": {"num_steps_trained": 941496, "num_steps_sampled": 941496, "grad_time_ms": 25668.342, "update_time_ms": 60.906, "load_time_ms": 29.169, "default": {"entropy": 1.42155122756958, "cur_kl_coeff": 0.10000001639127731, "total_loss": 154038.84375, "vf_explained_var": -4.76837147544984e-09, "vf_loss": 154038.84375, "kl": 0.021741215139627457, "policy_loss": -0.00837789662182331, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15325.91}, "custom_metrics": {"cost2_min": -109.86676456666089, "system_level_velocity_mean": 7.449707081874672, "outflow_rate_max": 1043.7799458848656, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.0672616798672685, "outflow_rate_mean": 562.85207545856, "cost2_max": -23.77891719860979, "cost1_max": 343.8392473928267, "cost1_min": 52.68603985668038, "cost1_mean": 191.7586857803305, "system_level_velocity_max": 13.177128674708106, "cost2_mean": -55.13605086148202}, "episode_len_mean": 700.0, "episode_reward_mean": 68397.43561484065, "pid": 31719, "episodes_this_iter": 47, "episode_reward_max": 125239.35713559763, "timestamp": 1556599098, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 330.3922939300537, "time_total_s": 330.3922939300537, "time_this_iter_s": 40.75283122062683, "training_iteration": 8, "timesteps_this_iter": 121627, "done": false}
{"timesteps_since_restore": 1060528, "episode_reward_min": 34003.493294531065, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33344e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a332e5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a332e518>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 9, "node_ip": "10.138.0.2", "date": "2019-04-30_04-38-59", "num_metric_batches_dropped": 0, "timesteps_total": 1060528, "episodes_total": 468, "hostname": "flow-main", "info": {"num_steps_trained": 1060528, "num_steps_sampled": 1060528, "grad_time_ms": 25535.315, "update_time_ms": 55.418, "load_time_ms": 27.325, "default": {"entropy": 1.4485381841659546, "cur_kl_coeff": 0.15000000596046448, "total_loss": 139803.28125, "vf_explained_var": -5.581920259345452e-09, "vf_loss": 139803.296875, "kl": 0.018297703936696053, "policy_loss": -0.009259717538952827, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15419.711}, "custom_metrics": {"cost2_min": -109.86676456666089, "system_level_velocity_mean": 7.177367043046409, "outflow_rate_max": 1020.6217384710437, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.4027952343092065, "outflow_rate_mean": 538.0994287812281, "cost2_max": -20.849179653326466, "cost1_max": 336.0446631414831, "cost1_min": 60.41442120208707, "cost1_mean": 185.31371468207556, "system_level_velocity_max": 12.880120301152123, "cost2_mean": -53.59327460777364}, "episode_len_mean": 700.0, "episode_reward_mean": 66009.15313147845, "pid": 31719, "episodes_this_iter": 53, "episode_reward_max": 125239.35713559763, "timestamp": 1556599139, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 371.29444098472595, "time_total_s": 371.29444098472595, "time_this_iter_s": 40.90214705467224, "training_iteration": 9, "timesteps_this_iter": 119032, "done": false}
{"timesteps_since_restore": 1187119, "episode_reward_min": 1302.7545253719322, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335940>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 10, "node_ip": "10.138.0.2", "date": "2019-04-30_04-39-44", "num_metric_batches_dropped": 0, "timesteps_total": 1187119, "episodes_total": 514, "hostname": "flow-main", "info": {"num_steps_trained": 1187119, "num_steps_sampled": 1187119, "grad_time_ms": 25754.678, "update_time_ms": 50.986, "load_time_ms": 27.371, "default": {"entropy": 1.4406838417053223, "cur_kl_coeff": 0.14999999105930328, "total_loss": 131267.546875, "vf_explained_var": 9.733414572110632e-07, "vf_loss": 131267.546875, "kl": 0.02345905266702175, "policy_loss": -0.010207751765847206, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15564.48}, "custom_metrics": {"cost2_min": -105.0405896124829, "system_level_velocity_mean": 7.1930075904485316, "outflow_rate_max": 1070.182228449482, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.4027952343092065, "outflow_rate_mean": 520.0912100533108, "cost2_max": -14.738709712965193, "cost1_max": 358.9702884980162, "cost1_min": 14.732695535801888, "cost1_mean": 181.03080503736695, "system_level_velocity_max": 17.886551621897077, "cost2_mean": -49.65490294465985}, "episode_len_mean": 693.24, "episode_reward_mean": 62190.515622355444, "pid": 31719, "episodes_this_iter": 46, "episode_reward_max": 113487.29031939794, "timestamp": 1556599184, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 416.19382333755493, "time_total_s": 416.19382333755493, "time_this_iter_s": 44.89938235282898, "training_iteration": 10, "timesteps_this_iter": 126591, "done": false}
{"timesteps_since_restore": 1311556, "episode_reward_min": 1302.7545253719322, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33340f0>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 11, "node_ip": "10.138.0.2", "date": "2019-04-30_04-40-29", "num_metric_batches_dropped": 0, "timesteps_total": 1311556, "episodes_total": 565, "hostname": "flow-main", "info": {"num_steps_trained": 1311556, "num_steps_sampled": 1311556, "grad_time_ms": 25795.856, "update_time_ms": 11.268, "load_time_ms": 22.155, "default": {"entropy": 1.407679557800293, "cur_kl_coeff": 0.22499997913837433, "total_loss": 184565.0625, "vf_explained_var": -6.1321649980072834e-09, "vf_loss": 184565.09375, "kl": 0.016832074150443077, "policy_loss": -0.008201385848224163, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15852.462}, "custom_metrics": {"cost2_min": -110.45573381034518, "system_level_velocity_mean": 7.44534197299895, "outflow_rate_max": 1070.182228449482, "outflow_rate_min": 146.24348909227248, "system_level_velocity_min": 2.4574350426585703, "outflow_rate_mean": 542.2838636564144, "cost2_max": -14.738709712965193, "cost1_max": 358.9702884980162, "cost1_min": 14.732695535801888, "cost1_mean": 187.67183288809858, "system_level_velocity_max": 17.886551621897077, "cost2_mean": -56.0808341413435}, "episode_len_mean": 693.24, "episode_reward_mean": 68004.16923921215, "pid": 31719, "episodes_this_iter": 51, "episode_reward_max": 122584.6844136707, "timestamp": 1556599229, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 461.16926622390747, "time_total_s": 461.16926622390747, "time_this_iter_s": 44.97544288635254, "training_iteration": 11, "timesteps_this_iter": 124437, "done": false}
{"timesteps_since_restore": 1432088, "episode_reward_min": 2800.982023151095, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335cc0>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 12, "node_ip": "10.138.0.2", "date": "2019-04-30_04-41-12", "num_metric_batches_dropped": 0, "timesteps_total": 1432088, "episodes_total": 617, "hostname": "flow-main", "info": {"num_steps_trained": 1432088, "num_steps_sampled": 1432088, "grad_time_ms": 25714.258, "update_time_ms": 11.116, "load_time_ms": 21.346, "default": {"entropy": 1.4278578758239746, "cur_kl_coeff": 0.22499997913837433, "total_loss": 155313.421875, "vf_explained_var": -0.001103788148611784, "vf_loss": 155313.4375, "kl": 0.015519924461841583, "policy_loss": -0.0072242142632603645, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 15951.459}, "custom_metrics": {"cost2_min": -129.99365705289097, "system_level_velocity_mean": 7.608770937814672, "outflow_rate_max": 1058.2656629815838, "outflow_rate_min": 146.24348909227248, "system_level_velocity_min": 2.144210015337134, "outflow_rate_mean": 577.3366340196061, "cost2_max": -22.1952989227581, "cost1_max": 346.969967270485, "cost1_min": 31.5824169539952, "cost1_mean": 192.34587513485508, "system_level_velocity_max": 17.976691878353755, "cost2_mean": -65.54075024729684}, "episode_len_mean": 693.49, "episode_reward_mean": 76016.7948644344, "pid": 31719, "episodes_this_iter": 52, "episode_reward_max": 157272.94749731667, "timestamp": 1556599272, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 503.6826169490814, "time_total_s": 503.6826169490814, "time_this_iter_s": 42.51335072517395, "training_iteration": 12, "timesteps_this_iter": 120532, "done": false}
{"timesteps_since_restore": 1553634, "episode_reward_min": 802.7282295088403, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334be0>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 13, "node_ip": "10.138.0.2", "date": "2019-04-30_04-41-55", "num_metric_batches_dropped": 0, "timesteps_total": 1553634, "episodes_total": 674, "hostname": "flow-main", "info": {"num_steps_trained": 1553634, "num_steps_sampled": 1553634, "grad_time_ms": 25966.346, "update_time_ms": 11.041, "load_time_ms": 21.508, "default": {"entropy": 1.456510305404663, "cur_kl_coeff": 0.22499996423721313, "total_loss": 170231.15625, "vf_explained_var": -6.971670796218632e-09, "vf_loss": 170231.15625, "kl": 0.019611867144703865, "policy_loss": -0.009763484820723534, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16177.016}, "custom_metrics": {"cost2_min": -129.99365705289097, "system_level_velocity_mean": 7.8852239013091765, "outflow_rate_max": 1058.2656629815838, "outflow_rate_min": 214.1440811220731, "system_level_velocity_min": 2.144210015337134, "outflow_rate_mean": 575.8815472333893, "cost2_max": -12.907607175003811, "cost1_max": 336.3025428403832, "cost1_min": 11.532952997843392, "cost1_mean": 190.54957657595972, "system_level_velocity_max": 18.022530631275686, "cost2_mean": -57.253772737849985}, "episode_len_mean": 680.01, "episode_reward_mean": 69571.89860079651, "pid": 31719, "episodes_this_iter": 57, "episode_reward_max": 157272.94749731667, "timestamp": 1556599315, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 547.2601346969604, "time_total_s": 547.2601346969604, "time_this_iter_s": 43.57751774787903, "training_iteration": 13, "timesteps_this_iter": 121546, "done": false}
{"timesteps_since_restore": 1675996, "episode_reward_min": 802.7282295088403, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3340cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335be0>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 14, "node_ip": "10.138.0.2", "date": "2019-04-30_04-42-37", "num_metric_batches_dropped": 0, "timesteps_total": 1675996, "episodes_total": 726, "hostname": "flow-main", "info": {"num_steps_trained": 1675996, "num_steps_sampled": 1675996, "grad_time_ms": 26093.844, "update_time_ms": 11.193, "load_time_ms": 21.382, "default": {"entropy": 1.4953970909118652, "cur_kl_coeff": 0.22499996423721313, "total_loss": 145038.234375, "vf_explained_var": -3.1830753588479865e-09, "vf_loss": 145038.234375, "kl": 0.0166062843054533, "policy_loss": -0.009013217873871326, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16198.479}, "custom_metrics": {"cost2_min": -132.95941202230293, "system_level_velocity_mean": 7.61342668035769, "outflow_rate_max": 1084.1047616105704, "outflow_rate_min": 330.69290594267505, "system_level_velocity_min": 4.774450024340419, "outflow_rate_mean": 547.2004867515088, "cost2_max": -12.907607175003811, "cost1_max": 343.1613740549417, "cost1_min": 11.532952997843392, "cost1_mean": 187.06404727527544, "system_level_velocity_max": 18.022530631275686, "cost2_mean": -50.78827521198946}, "episode_len_mean": 686.52, "episode_reward_mean": 64792.79734712418, "pid": 31719, "episodes_this_iter": 52, "episode_reward_max": 138263.88756953183, "timestamp": 1556599357, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 588.5860893726349, "time_total_s": 588.5860893726349, "time_this_iter_s": 41.32595467567444, "training_iteration": 14, "timesteps_this_iter": 122362, "done": false}
{"timesteps_since_restore": 1799763, "episode_reward_min": 1591.4813418256267, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334978>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 15, "node_ip": "10.138.0.2", "date": "2019-04-30_04-43-19", "num_metric_batches_dropped": 0, "timesteps_total": 1799763, "episodes_total": 778, "hostname": "flow-main", "info": {"num_steps_trained": 1799763, "num_steps_sampled": 1799763, "grad_time_ms": 26065.452, "update_time_ms": 11.223, "load_time_ms": 21.237, "default": {"entropy": 1.4859707355499268, "cur_kl_coeff": 0.22499997913837433, "total_loss": 174362.15625, "vf_explained_var": -1.851075959180548e-10, "vf_loss": 174362.15625, "kl": 0.017649779096245766, "policy_loss": -0.009580586105585098, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16353.05}, "custom_metrics": {"cost2_min": -117.55613156205584, "system_level_velocity_mean": 7.586381000644691, "outflow_rate_max": 972.3052855657173, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 1.8579798054335668, "outflow_rate_mean": 532.9633333018842, "cost2_max": -19.016986169537326, "cost1_max": 322.7185096382319, "cost1_min": 20.710407542997892, "cost1_mean": 180.74171237483512, "system_level_velocity_max": 18.6577343498168, "cost2_mean": -49.55094975675798}, "episode_len_mean": 679.99, "episode_reward_mean": 62097.87910162873, "pid": 31719, "episodes_this_iter": 52, "episode_reward_max": 134177.43859779305, "timestamp": 1556599399, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 630.836480140686, "time_total_s": 630.836480140686, "time_this_iter_s": 42.25039076805115, "training_iteration": 15, "timesteps_this_iter": 123767, "done": false}
{"timesteps_since_restore": 1920517, "episode_reward_min": 1591.4813418256267, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3356278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334e48>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 16, "node_ip": "10.138.0.2", "date": "2019-04-30_04-44-00", "num_metric_batches_dropped": 0, "timesteps_total": 1920517, "episodes_total": 835, "hostname": "flow-main", "info": {"num_steps_trained": 1920517, "num_steps_sampled": 1920517, "grad_time_ms": 25877.205, "update_time_ms": 11.279, "load_time_ms": 21.749, "default": {"entropy": 1.4804885387420654, "cur_kl_coeff": 0.22499999403953552, "total_loss": 211280.671875, "vf_explained_var": 0.02317545749247074, "vf_loss": 211280.671875, "kl": 0.017224062234163284, "policy_loss": -0.008844391442835331, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16370.308}, "custom_metrics": {"cost2_min": -119.05029303713718, "system_level_velocity_mean": 7.721570172220079, "outflow_rate_max": 1068.3167895338227, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 1.8579798054335668, "outflow_rate_mean": 543.4697726109438, "cost2_max": -18.72345238127783, "cost1_max": 350.8045615489789, "cost1_min": 20.710407542997892, "cost1_mean": 180.5393580302376, "system_level_velocity_max": 18.6577343498168, "cost2_mean": -53.93404828943909}, "episode_len_mean": 673.33, "episode_reward_mean": 65187.32781882133, "pid": 31719, "episodes_this_iter": 57, "episode_reward_max": 135710.58967322457, "timestamp": 1556599440, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 672.1998608112335, "time_total_s": 672.1998608112335, "time_this_iter_s": 41.363380670547485, "training_iteration": 16, "timesteps_this_iter": 120754, "done": false}
{"timesteps_since_restore": 2046618, "episode_reward_min": 2074.9276159273636, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33340f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334c18>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 17, "node_ip": "10.138.0.2", "date": "2019-04-30_04-44-44", "num_metric_batches_dropped": 0, "timesteps_total": 2046618, "episodes_total": 877, "hostname": "flow-main", "info": {"num_steps_trained": 2046618, "num_steps_sampled": 2046618, "grad_time_ms": 25934.212, "update_time_ms": 11.117, "load_time_ms": 22.055, "default": {"entropy": 1.450823426246643, "cur_kl_coeff": 0.22499996423721313, "total_loss": 117338.7578125, "vf_explained_var": 0.34491416811943054, "vf_loss": 117338.7734375, "kl": 0.020903389900922775, "policy_loss": -0.010893657803535461, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16428.746}, "custom_metrics": {"cost2_min": -140.9571039603488, "system_level_velocity_mean": 7.798519170988155, "outflow_rate_max": 1188.2081646487825, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.240386416707901, "outflow_rate_mean": 573.8822710838123, "cost2_max": -18.72345238127783, "cost1_max": 399.7091670097773, "cost1_min": 21.43238819172112, "cost1_mean": 196.1790889458913, "system_level_velocity_max": 17.791946071892387, "cost2_mean": -59.17006974963861}, "episode_len_mean": 693.34, "episode_reward_mean": 70253.24969949195, "pid": 31719, "episodes_this_iter": 42, "episode_reward_max": 146377.39073705615, "timestamp": 1556599484, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 715.9024240970612, "time_total_s": 715.9024240970612, "time_this_iter_s": 43.70256328582764, "training_iteration": 17, "timesteps_this_iter": 126101, "done": false}
{"timesteps_since_restore": 2169120, "episode_reward_min": 32206.2783009807, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334208>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 18, "node_ip": "10.138.0.2", "date": "2019-04-30_04-45-27", "num_metric_batches_dropped": 0, "timesteps_total": 2169120, "episodes_total": 932, "hostname": "flow-main", "info": {"num_steps_trained": 2169120, "num_steps_sampled": 2169120, "grad_time_ms": 26080.742, "update_time_ms": 11.102, "load_time_ms": 22.106, "default": {"entropy": 1.4719332456588745, "cur_kl_coeff": 0.33750006556510925, "total_loss": 122038.6875, "vf_explained_var": 0.5584601759910583, "vf_loss": 122038.6875, "kl": 0.01354153361171484, "policy_loss": -0.008327513933181763, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16497.928}, "custom_metrics": {"cost2_min": -140.9571039603488, "system_level_velocity_mean": 7.661928266079229, "outflow_rate_max": 1188.2081646487825, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.002500166219089, "outflow_rate_mean": 576.4494544988966, "cost2_max": -19.534988672271037, "cost1_max": 399.7091670097773, "cost1_min": 50.269770136647956, "cost1_mean": 196.65374240761386, "system_level_velocity_max": 14.999960861296861, "cost2_mean": -61.078280954475616}, "episode_len_mean": 700.0, "episode_reward_mean": 71798.97606502716, "pid": 31719, "episodes_this_iter": 55, "episode_reward_max": 146377.39073705615, "timestamp": 1556599527, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 758.8242065906525, "time_total_s": 758.8242065906525, "time_this_iter_s": 42.92178249359131, "training_iteration": 18, "timesteps_this_iter": 122502, "done": false}
{"timesteps_since_restore": 2293267, "episode_reward_min": 1178.7418998569706, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334e80>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 19, "node_ip": "10.138.0.2", "date": "2019-04-30_04-46-08", "num_metric_batches_dropped": 0, "timesteps_total": 2293267, "episodes_total": 978, "hostname": "flow-main", "info": {"num_steps_trained": 2293267, "num_steps_sampled": 2293267, "grad_time_ms": 26113.628, "update_time_ms": 11.288, "load_time_ms": 23.198, "default": {"entropy": 1.4384846687316895, "cur_kl_coeff": 0.33750006556510925, "total_loss": 85091.4765625, "vf_explained_var": 0.7280895709991455, "vf_loss": 85091.4765625, "kl": 0.012590080499649048, "policy_loss": -0.008034424856305122, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16446.62}, "custom_metrics": {"cost2_min": -140.3566569046321, "system_level_velocity_mean": 7.507273859463993, "outflow_rate_max": 1089.4253209400943, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.002500166219089, "outflow_rate_mean": 561.6368427696817, "cost2_max": -15.15922296445875, "cost1_max": 351.8154547512657, "cost1_min": 14.942241635952831, "cost1_mean": 188.73811312197984, "system_level_velocity_max": 17.227623759130868, "cost2_mean": -58.75727916807103}, "episode_len_mean": 693.23, "episode_reward_mean": 69481.70939984999, "pid": 31719, "episodes_this_iter": 46, "episode_reward_max": 138786.7059169174, "timestamp": 1556599568, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 799.5328855514526, "time_total_s": 799.5328855514526, "time_this_iter_s": 40.70867896080017, "training_iteration": 19, "timesteps_this_iter": 124147, "done": false}
{"timesteps_since_restore": 2415539, "episode_reward_min": 1178.7418998569706, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334160>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 20, "node_ip": "10.138.0.2", "date": "2019-04-30_04-46-50", "num_metric_batches_dropped": 0, "timesteps_total": 2415539, "episodes_total": 1037, "hostname": "flow-main", "info": {"num_steps_trained": 2415539, "num_steps_sampled": 2415539, "grad_time_ms": 25920.433, "update_time_ms": 11.166, "load_time_ms": 22.768, "default": {"entropy": 1.4702396392822266, "cur_kl_coeff": 0.33750006556510925, "total_loss": 101595.8984375, "vf_explained_var": 0.7540280818939209, "vf_loss": 101595.890625, "kl": 0.011755007319152355, "policy_loss": -0.0069186752662062645, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16372.593}, "custom_metrics": {"cost2_min": -135.87447090591508, "system_level_velocity_mean": 7.811031357591297, "outflow_rate_max": 1089.4253209400943, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.502216813453077, "outflow_rate_mean": 566.9707950787722, "cost2_max": -14.494003826565196, "cost1_max": 351.8154547512657, "cost1_min": 14.190582525808965, "cost1_mean": 188.62313544079535, "system_level_velocity_max": 18.136184202167698, "cost2_mean": -59.29375469069865}, "episode_len_mean": 679.88, "episode_reward_mean": 69925.73455881994, "pid": 31719, "episodes_this_iter": 59, "episode_reward_max": 159183.54409770248, "timestamp": 1556599610, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 841.707522392273, "time_total_s": 841.707522392273, "time_this_iter_s": 42.17463684082031, "training_iteration": 20, "timesteps_this_iter": 122272, "done": false}
{"timesteps_since_restore": 2540012, "episode_reward_min": 1403.453675569431, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334d68>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 21, "node_ip": "10.138.0.2", "date": "2019-04-30_04-47-36", "num_metric_batches_dropped": 0, "timesteps_total": 2540012, "episodes_total": 1087, "hostname": "flow-main", "info": {"num_steps_trained": 2540012, "num_steps_sampled": 2540012, "grad_time_ms": 25913.763, "update_time_ms": 11.228, "load_time_ms": 24.154, "default": {"entropy": 1.4648674726486206, "cur_kl_coeff": 0.33750003576278687, "total_loss": 93407.953125, "vf_explained_var": 0.7803400158882141, "vf_loss": 93407.9609375, "kl": 0.012303237803280354, "policy_loss": -0.007964890450239182, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16462.708}, "custom_metrics": {"cost2_min": -143.49828295930266, "system_level_velocity_mean": 7.796247193238296, "outflow_rate_max": 1043.140152238203, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.502216813453077, "outflow_rate_mean": 562.6720450689647, "cost2_max": -14.494003826565196, "cost1_max": 340.985710761031, "cost1_min": 14.190582525808965, "cost1_mean": 187.86910857762973, "system_level_velocity_max": 18.136184202167698, "cost2_mean": -59.66945295353523}, "episode_len_mean": 680.15, "episode_reward_mean": 71072.63394487729, "pid": 31719, "episodes_this_iter": 50, "episode_reward_max": 159183.54409770248, "timestamp": 1556599656, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 887.5866198539734, "time_total_s": 887.5866198539734, "time_this_iter_s": 45.87909746170044, "training_iteration": 21, "timesteps_this_iter": 124473, "done": false}
{"timesteps_since_restore": 2659742, "episode_reward_min": 857.6246880366627, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33345f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334320>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 22, "node_ip": "10.138.0.2", "date": "2019-04-30_04-48-17", "num_metric_batches_dropped": 0, "timesteps_total": 2659742, "episodes_total": 1144, "hostname": "flow-main", "info": {"num_steps_trained": 2659742, "num_steps_sampled": 2659742, "grad_time_ms": 25918.036, "update_time_ms": 11.359, "load_time_ms": 23.409, "default": {"entropy": 1.4465222358703613, "cur_kl_coeff": 0.33750006556510925, "total_loss": 84391.0, "vf_explained_var": 0.8276492953300476, "vf_loss": 84391.0, "kl": 0.013225133530795574, "policy_loss": -0.00987433735281229, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16306.776}, "custom_metrics": {"cost2_min": -143.49828295930266, "system_level_velocity_mean": 7.9276985119239445, "outflow_rate_max": 1015.154845786779, "outflow_rate_min": 151.14004455032165, "system_level_velocity_min": 1.9674820705798344, "outflow_rate_mean": 579.7136662140746, "cost2_max": -13.295995631751692, "cost1_max": 340.985710761031, "cost1_min": 12.324804949848309, "cost1_mean": 191.0440068048464, "system_level_velocity_max": 17.86031620191536, "cost2_mean": -57.06775470485364}, "episode_len_mean": 680.0, "episode_reward_mean": 69621.8340411732, "pid": 31719, "episodes_this_iter": 57, "episode_reward_max": 154539.29395968452, "timestamp": 1556599697, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 928.6076548099518, "time_total_s": 928.6076548099518, "time_this_iter_s": 41.021034955978394, "training_iteration": 22, "timesteps_this_iter": 119730, "done": false}
{"timesteps_since_restore": 2776794, "episode_reward_min": 926.0934058415094, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33349e8>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 23, "node_ip": "10.138.0.2", "date": "2019-04-30_04-48-59", "num_metric_batches_dropped": 0, "timesteps_total": 2776794, "episodes_total": 1201, "hostname": "flow-main", "info": {"num_steps_trained": 2776794, "num_steps_sampled": 2776794, "grad_time_ms": 25804.945, "update_time_ms": 11.331, "load_time_ms": 23.584, "default": {"entropy": 1.504943609237671, "cur_kl_coeff": 0.33750006556510925, "total_loss": 79502.8515625, "vf_explained_var": 0.8508450388908386, "vf_loss": 79502.859375, "kl": 0.011840351857244968, "policy_loss": -0.007536597084254026, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16245.447}, "custom_metrics": {"cost2_min": -134.99184712352684, "system_level_velocity_mean": 7.32798969585267, "outflow_rate_max": 1015.154845786779, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 1.9674820705798344, "outflow_rate_mean": 538.9307652498329, "cost2_max": -12.308928361568782, "cost1_max": 312.94638057824557, "cost1_min": 11.011868077207456, "cost1_mean": 179.86090246669485, "system_level_velocity_max": 16.904227977681867, "cost2_mean": -51.931834282633446}, "episode_len_mean": 686.48, "episode_reward_mean": 64066.57365958388, "pid": 31719, "episodes_this_iter": 57, "episode_reward_max": 131274.7415635281, "timestamp": 1556599739, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 970.4490303993225, "time_total_s": 970.4490303993225, "time_this_iter_s": 41.84137558937073, "training_iteration": 23, "timesteps_this_iter": 117052, "done": false}
{"timesteps_since_restore": 2895442, "episode_reward_min": 926.0934058415094, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335438>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 24, "node_ip": "10.138.0.2", "date": "2019-04-30_04-49-43", "num_metric_batches_dropped": 0, "timesteps_total": 2895442, "episodes_total": 1256, "hostname": "flow-main", "info": {"num_steps_trained": 2895442, "num_steps_sampled": 2895442, "grad_time_ms": 25842.643, "update_time_ms": 11.307, "load_time_ms": 22.52, "default": {"entropy": 1.428343653678894, "cur_kl_coeff": 0.33750009536743164, "total_loss": 82149.78125, "vf_explained_var": 0.8674006462097168, "vf_loss": 82149.7890625, "kl": 0.01206685695797205, "policy_loss": -0.0077494410797953606, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16453.561}, "custom_metrics": {"cost2_min": -134.99184712352684, "system_level_velocity_mean": 7.768834424540901, "outflow_rate_max": 1072.0640908602195, "outflow_rate_min": 325.15424010970025, "system_level_velocity_min": 4.799396526024532, "outflow_rate_mean": 550.7722115891927, "cost2_max": -12.308928361568782, "cost1_max": 340.52240250827526, "cost1_min": 11.011868077207456, "cost1_mean": 183.4518756243686, "system_level_velocity_max": 18.167607371528653, "cost2_mean": -49.12379298287261}, "episode_len_mean": 673.58, "episode_reward_mean": 61962.90959001994, "pid": 31719, "episodes_this_iter": 55, "episode_reward_max": 137510.9039102481, "timestamp": 1556599783, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1014.2082386016846, "time_total_s": 1014.2082386016846, "time_this_iter_s": 43.75920820236206, "training_iteration": 24, "timesteps_this_iter": 118648, "done": false}
{"timesteps_since_restore": 3014527, "episode_reward_min": 1091.9460320379442, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33344e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33342e8>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 25, "node_ip": "10.138.0.2", "date": "2019-04-30_04-50-25", "num_metric_batches_dropped": 0, "timesteps_total": 3014527, "episodes_total": 1313, "hostname": "flow-main", "info": {"num_steps_trained": 3014527, "num_steps_sampled": 3014527, "grad_time_ms": 25792.178, "update_time_ms": 11.256, "load_time_ms": 22.557, "default": {"entropy": 1.4654556512832642, "cur_kl_coeff": 0.33750006556510925, "total_loss": 78463.6875, "vf_explained_var": 0.8701014518737793, "vf_loss": 78463.6953125, "kl": 0.012460493482649326, "policy_loss": -0.0078772297129035, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16458.989}, "custom_metrics": {"cost2_min": -121.26338029011009, "system_level_velocity_mean": 8.076740739632562, "outflow_rate_max": 1072.0640908602195, "outflow_rate_min": 233.06669247294116, "system_level_velocity_min": 2.691990006070623, "outflow_rate_mean": 569.5904824097023, "cost2_max": -13.594960381562732, "cost1_max": 340.52240250827526, "cost1_min": 11.620390894224398, "cost1_mean": 187.04241374208956, "system_level_velocity_max": 18.167607371528653, "cost2_mean": -49.44443447865424}, "episode_len_mean": 666.9, "episode_reward_mean": 62696.213513390634, "pid": 31719, "episodes_this_iter": 57, "episode_reward_max": 137510.9039102481, "timestamp": 1556599825, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1055.9954771995544, "time_total_s": 1055.9954771995544, "time_this_iter_s": 41.78723859786987, "training_iteration": 25, "timesteps_this_iter": 119085, "done": false}
{"timesteps_since_restore": 3132771, "episode_reward_min": 1168.6045116731493, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a332e748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335a20>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 26, "node_ip": "10.138.0.2", "date": "2019-04-30_04-51-05", "num_metric_batches_dropped": 0, "timesteps_total": 3132771, "episodes_total": 1366, "hostname": "flow-main", "info": {"num_steps_trained": 3132771, "num_steps_sampled": 3132771, "grad_time_ms": 25714.8, "update_time_ms": 11.106, "load_time_ms": 22.014, "default": {"entropy": 1.3953644037246704, "cur_kl_coeff": 0.33750006556510925, "total_loss": 81439.921875, "vf_explained_var": 0.8832309246063232, "vf_loss": 81439.9296875, "kl": 0.014557207003235817, "policy_loss": -0.00995936430990696, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16409.598}, "custom_metrics": {"cost2_min": -124.00829947658173, "system_level_velocity_mean": 7.929445365192355, "outflow_rate_max": 1076.290839744224, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.5871254971916744, "outflow_rate_mean": 583.5616429221013, "cost2_max": -14.589761887117819, "cost1_max": 349.3903755843058, "cost1_min": 12.786513643013853, "cost1_mean": 195.8118612030131, "system_level_velocity_max": 17.857100697788198, "cost2_mean": -50.63455150018535}, "episode_len_mean": 686.49, "episode_reward_mean": 62887.6871295684, "pid": 31719, "episodes_this_iter": 53, "episode_reward_max": 123299.11002311796, "timestamp": 1556599865, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1096.045627117157, "time_total_s": 1096.045627117157, "time_this_iter_s": 40.05014991760254, "training_iteration": 26, "timesteps_this_iter": 118244, "done": false}
{"timesteps_since_restore": 3247365, "episode_reward_min": 25966.37343312364, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334a58>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 27, "node_ip": "10.138.0.2", "date": "2019-04-30_04-51-47", "num_metric_batches_dropped": 0, "timesteps_total": 3247365, "episodes_total": 1420, "hostname": "flow-main", "info": {"num_steps_trained": 3247365, "num_steps_sampled": 3247365, "grad_time_ms": 25524.496, "update_time_ms": 11.168, "load_time_ms": 20.889, "default": {"entropy": 1.4352962970733643, "cur_kl_coeff": 0.33750006556510925, "total_loss": 71589.71875, "vf_explained_var": 0.9061102867126465, "vf_loss": 71589.71875, "kl": 0.013692404143512249, "policy_loss": -0.009606871753931046, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16435.775}, "custom_metrics": {"cost2_min": -124.00829947658173, "system_level_velocity_mean": 7.865301022314629, "outflow_rate_max": 1076.290839744224, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.5871254971916744, "outflow_rate_mean": 590.5279816677294, "cost2_max": -19.462550207009368, "cost1_max": 349.3903755843058, "cost1_min": 62.216453895239574, "cost1_mean": 202.46837322972905, "system_level_velocity_max": 13.372529248312462, "cost2_mean": -51.55838434290663}, "episode_len_mean": 700.0, "episode_reward_mean": 65676.17604843917, "pid": 31719, "episodes_this_iter": 54, "episode_reward_max": 148772.7618769523, "timestamp": 1556599907, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1138.104189157486, "time_total_s": 1138.104189157486, "time_this_iter_s": 42.05856204032898, "training_iteration": 27, "timesteps_this_iter": 114594, "done": false}
{"timesteps_since_restore": 3362500, "episode_reward_min": 1519.460414765439, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33355f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335470>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 28, "node_ip": "10.138.0.2", "date": "2019-04-30_04-52-30", "num_metric_batches_dropped": 0, "timesteps_total": 3362500, "episodes_total": 1481, "hostname": "flow-main", "info": {"num_steps_trained": 3362500, "num_steps_sampled": 3362500, "grad_time_ms": 25548.61, "update_time_ms": 11.251, "load_time_ms": 21.41, "default": {"entropy": 1.440353274345398, "cur_kl_coeff": 0.33750003576278687, "total_loss": 78958.0546875, "vf_explained_var": 0.8976626992225647, "vf_loss": 78958.0546875, "kl": 0.013457460328936577, "policy_loss": -0.009721040725708008, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16460.918}, "custom_metrics": {"cost2_min": -133.44104726282842, "system_level_velocity_mean": 8.001140932824057, "outflow_rate_max": 1108.3195787821905, "outflow_rate_min": 147.01852751496614, "system_level_velocity_min": 2.106947204873989, "outflow_rate_mean": 583.322002531935, "cost2_max": -16.59515513813397, "cost1_max": 351.65116340784584, "cost1_min": 16.84064042304388, "cost1_mean": 197.05215674647016, "system_level_velocity_max": 17.273171175128297, "cost2_mean": -47.59552958840674}, "episode_len_mean": 686.67, "episode_reward_mean": 63177.83303740726, "pid": 31719, "episodes_this_iter": 61, "episode_reward_max": 160262.85639043295, "timestamp": 1556599950, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1181.5076699256897, "time_total_s": 1181.5076699256897, "time_this_iter_s": 43.403480768203735, "training_iteration": 28, "timesteps_this_iter": 115135, "done": false}
{"timesteps_since_restore": 3476812, "episode_reward_min": 1519.460414765439, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33346a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334198>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 29, "node_ip": "10.138.0.2", "date": "2019-04-30_04-53-10", "num_metric_batches_dropped": 0, "timesteps_total": 3476812, "episodes_total": 1538, "hostname": "flow-main", "info": {"num_steps_trained": 3476812, "num_steps_sampled": 3476812, "grad_time_ms": 25548.568, "update_time_ms": 10.894, "load_time_ms": 20.299, "default": {"entropy": 1.4582771062850952, "cur_kl_coeff": 0.33750009536743164, "total_loss": 67118.9609375, "vf_explained_var": 0.9012527465820312, "vf_loss": 67118.9609375, "kl": 0.014268043451011181, "policy_loss": -0.01099618524312973, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16370.878}, "custom_metrics": {"cost2_min": -121.70665732470238, "system_level_velocity_mean": 7.983941074532529, "outflow_rate_max": 1027.91207980237, "outflow_rate_min": 147.01852751496614, "system_level_velocity_min": 2.106947204873989, "outflow_rate_mean": 582.9903377098665, "cost2_max": -15.984261379403673, "cost1_max": 323.8725905354115, "cost1_min": 16.84064042304388, "cost1_mean": 200.87211795316398, "system_level_velocity_max": 17.009540209106962, "cost2_mean": -46.61993939406282}, "episode_len_mean": 693.26, "episode_reward_mean": 61240.676649028144, "pid": 31719, "episodes_this_iter": 57, "episode_reward_max": 160262.85639043295, "timestamp": 1556599990, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1221.3249776363373, "time_total_s": 1221.3249776363373, "time_this_iter_s": 39.81730771064758, "training_iteration": 29, "timesteps_this_iter": 114312, "done": false}
{"timesteps_since_restore": 3592068, "episode_reward_min": 1899.3103885090923, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33356d8>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 30, "node_ip": "10.138.0.2", "date": "2019-04-30_04-53-53", "num_metric_batches_dropped": 0, "timesteps_total": 3592068, "episodes_total": 1598, "hostname": "flow-main", "info": {"num_steps_trained": 3592068, "num_steps_sampled": 3592068, "grad_time_ms": 25516.063, "update_time_ms": 11.25, "load_time_ms": 20.341, "default": {"entropy": 1.4877692461013794, "cur_kl_coeff": 0.33750006556510925, "total_loss": 66315.09375, "vf_explained_var": 0.9039528369903564, "vf_loss": 66315.1015625, "kl": 0.013832304626703262, "policy_loss": -0.010331683792173862, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16455.945}, "custom_metrics": {"cost2_min": -121.70665732470238, "system_level_velocity_mean": 7.853236932879988, "outflow_rate_max": 1027.91207980237, "outflow_rate_min": 362.10432487247544, "system_level_velocity_min": 5.178814442689494, "outflow_rate_mean": 564.9047871287931, "cost2_max": -17.784947240385904, "cost1_max": 323.82059523327064, "cost1_min": 19.800274966907065, "cost1_mean": 196.28305039364776, "system_level_velocity_max": 17.911328416911147, "cost2_mean": -42.708259050591636}, "episode_len_mean": 693.31, "episode_reward_mean": 56757.5451043081, "pid": 31719, "episodes_this_iter": 60, "episode_reward_max": 142466.96319335213, "timestamp": 1556600033, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1264.022526025772, "time_total_s": 1264.022526025772, "time_this_iter_s": 42.697548389434814, "training_iteration": 30, "timesteps_this_iter": 115256, "done": false}
{"timesteps_since_restore": 3711301, "episode_reward_min": 1789.4658491138998, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33345f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33347f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334160>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 31, "node_ip": "10.138.0.2", "date": "2019-04-30_04-54-34", "num_metric_batches_dropped": 0, "timesteps_total": 3711301, "episodes_total": 1651, "hostname": "flow-main", "info": {"num_steps_trained": 3711301, "num_steps_sampled": 3711301, "grad_time_ms": 25280.64, "update_time_ms": 11.209, "load_time_ms": 19.403, "default": {"entropy": 1.4793938398361206, "cur_kl_coeff": 0.33750009536743164, "total_loss": 74370.59375, "vf_explained_var": 0.8981735706329346, "vf_loss": 74370.6015625, "kl": 0.014340280555188656, "policy_loss": -0.010005254298448563, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16180.22}, "custom_metrics": {"cost2_min": -116.40377887877548, "system_level_velocity_mean": 7.719235845791543, "outflow_rate_max": 1039.9277241202212, "outflow_rate_min": 345.10988281288905, "system_level_velocity_min": 5.208499195455487, "outflow_rate_mean": 560.8772700440663, "cost2_max": -17.784947240385904, "cost1_max": 333.56100891518815, "cost1_min": 21.336195817922867, "cost1_mean": 193.47389040534182, "system_level_velocity_max": 17.804210774282257, "cost2_mean": -44.243265289063466}, "episode_len_mean": 693.33, "episode_reward_mean": 59344.784213347695, "pid": 31719, "episodes_this_iter": 53, "episode_reward_max": 130400.66062259019, "timestamp": 1556600074, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1304.7346975803375, "time_total_s": 1304.7346975803375, "time_this_iter_s": 40.71217155456543, "training_iteration": 31, "timesteps_this_iter": 119233, "done": false}
{"timesteps_since_restore": 3827590, "episode_reward_min": 1789.4658491138998, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33348d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334630>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 32, "node_ip": "10.138.0.2", "date": "2019-04-30_04-55-13", "num_metric_batches_dropped": 0, "timesteps_total": 3827590, "episodes_total": 1711, "hostname": "flow-main", "info": {"num_steps_trained": 3827590, "num_steps_sampled": 3827590, "grad_time_ms": 25056.419, "update_time_ms": 11.19, "load_time_ms": 20.164, "default": {"entropy": 1.452775478363037, "cur_kl_coeff": 0.33750009536743164, "total_loss": 79814.890625, "vf_explained_var": 0.8875848054885864, "vf_loss": 79814.890625, "kl": 0.014354187063872814, "policy_loss": -0.009942400269210339, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16201.943}, "custom_metrics": {"cost2_min": -126.1417781886765, "system_level_velocity_mean": 8.085850841598607, "outflow_rate_max": 1112.5500689986911, "outflow_rate_min": 257.3188485529056, "system_level_velocity_min": 2.55951987706554, "outflow_rate_mean": 608.7051648473282, "cost2_max": -15.129915767515095, "cost1_max": 356.50392671812233, "cost1_min": 21.336195817922867, "cost1_mean": 200.1286457391613, "system_level_velocity_max": 17.804210774282257, "cost2_mean": -52.446435448322326}, "episode_len_mean": 686.81, "episode_reward_mean": 68428.14287609003, "pid": 31719, "episodes_this_iter": 60, "episode_reward_max": 156582.48684578284, "timestamp": 1556600113, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1343.7435457706451, "time_total_s": 1343.7435457706451, "time_this_iter_s": 39.00884819030762, "training_iteration": 32, "timesteps_this_iter": 116289, "done": false}
{"timesteps_since_restore": 3944448, "episode_reward_min": 1255.0994398040611, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334518>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 33, "node_ip": "10.138.0.2", "date": "2019-04-30_04-55-53", "num_metric_batches_dropped": 0, "timesteps_total": 3944448, "episodes_total": 1769, "hostname": "flow-main", "info": {"num_steps_trained": 3944448, "num_steps_sampled": 3944448, "grad_time_ms": 24938.773, "update_time_ms": 11.206, "load_time_ms": 20.099, "default": {"entropy": 1.4373713731765747, "cur_kl_coeff": 0.33750006556510925, "total_loss": 84003.2890625, "vf_explained_var": 0.9046139717102051, "vf_loss": 84003.296875, "kl": 0.01358787715435028, "policy_loss": -0.009550082497298717, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16176.261}, "custom_metrics": {"cost2_min": -135.42740608241127, "system_level_velocity_mean": 8.334844366465312, "outflow_rate_max": 1157.383489033855, "outflow_rate_min": 367.15243461646844, "system_level_velocity_min": 5.321124396205509, "outflow_rate_mean": 623.2506158912312, "cost2_max": -14.265312599291853, "cost1_max": 356.50392671812233, "cost1_min": 12.906063806208392, "cost1_mean": 205.81578201800963, "system_level_velocity_max": 16.762711200501894, "cost2_mean": -52.33229535448481}, "episode_len_mean": 686.68, "episode_reward_mean": 67585.12878113368, "pid": 31719, "episodes_this_iter": 58, "episode_reward_max": 166111.5739283863, "timestamp": 1556600153, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1384.1448204517365, "time_total_s": 1384.1448204517365, "time_this_iter_s": 40.40127468109131, "training_iteration": 33, "timesteps_this_iter": 116858, "done": false}
{"timesteps_since_restore": 4059944, "episode_reward_min": 32138.299711654738, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334198>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 34, "node_ip": "10.138.0.2", "date": "2019-04-30_04-56-35", "num_metric_batches_dropped": 0, "timesteps_total": 4059944, "episodes_total": 1826, "hostname": "flow-main", "info": {"num_steps_trained": 4059944, "num_steps_sampled": 4059944, "grad_time_ms": 24846.45, "update_time_ms": 11.113, "load_time_ms": 20.069, "default": {"entropy": 1.5418565273284912, "cur_kl_coeff": 0.33750006556510925, "total_loss": 76448.1875, "vf_explained_var": 0.9056904911994934, "vf_loss": 76448.1953125, "kl": 0.014212888665497303, "policy_loss": -0.010487517341971397, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16101.636}, "custom_metrics": {"cost2_min": -135.42740608241127, "system_level_velocity_mean": 7.8607353373945905, "outflow_rate_max": 1157.383489033855, "outflow_rate_min": 144.299037682812, "system_level_velocity_min": 2.0997276898566635, "outflow_rate_mean": 592.6746527796919, "cost2_max": -15.224923191737297, "cost1_max": 356.29925586752535, "cost1_min": 53.731685377559344, "cost1_mean": 201.40708781480546, "system_level_velocity_max": 13.50038143171911, "cost2_mean": -47.31350696838949}, "episode_len_mean": 700.0, "episode_reward_mean": 64265.296268014325, "pid": 31719, "episodes_this_iter": 57, "episode_reward_max": 166111.5739283863, "timestamp": 1556600195, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1426.2119040489197, "time_total_s": 1426.2119040489197, "time_this_iter_s": 42.06708359718323, "training_iteration": 34, "timesteps_this_iter": 115496, "done": false}
{"timesteps_since_restore": 4178883, "episode_reward_min": 1073.5505368280158, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3335be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a331fda0>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 35, "node_ip": "10.138.0.2", "date": "2019-04-30_04-57-20", "num_metric_batches_dropped": 0, "timesteps_total": 4178883, "episodes_total": 1881, "hostname": "flow-main", "info": {"num_steps_trained": 4178883, "num_steps_sampled": 4178883, "grad_time_ms": 25139.962, "update_time_ms": 11.153, "load_time_ms": 20.073, "default": {"entropy": 1.444858431816101, "cur_kl_coeff": 0.33750006556510925, "total_loss": 69604.1171875, "vf_explained_var": 0.9200491905212402, "vf_loss": 69604.125, "kl": 0.015132158063352108, "policy_loss": -0.010536398738622665, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16091.702}, "custom_metrics": {"cost2_min": -127.16727512718981, "system_level_velocity_mean": 7.8079039867412225, "outflow_rate_max": 1069.2125477640143, "outflow_rate_min": 141.0895270168767, "system_level_velocity_min": 2.0997276898566635, "outflow_rate_mean": 581.2553307054626, "cost2_max": -17.719511748747895, "cost1_max": 348.2611334116924, "cost1_min": 14.27766681963882, "cost1_mean": 196.0691491347377, "system_level_velocity_max": 16.60755733882567, "cost2_mean": -48.04931852302293}, "episode_len_mean": 693.22, "episode_reward_mean": 62955.3774685462, "pid": 31719, "episodes_this_iter": 55, "episode_reward_max": 133045.41538365322, "timestamp": 1556600240, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1470.8528118133545, "time_total_s": 1470.8528118133545, "time_this_iter_s": 44.640907764434814, "training_iteration": 35, "timesteps_this_iter": 118939, "done": false}
{"timesteps_since_restore": 4293174, "episode_reward_min": 1020.8940999651871, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339dd8>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 36, "node_ip": "10.138.0.2", "date": "2019-04-30_04-58-00", "num_metric_batches_dropped": 0, "timesteps_total": 4293174, "episodes_total": 1939, "hostname": "flow-main", "info": {"num_steps_trained": 4293174, "num_steps_sampled": 4293174, "grad_time_ms": 25087.983, "update_time_ms": 11.426, "load_time_ms": 20.046, "default": {"entropy": 1.4421931505203247, "cur_kl_coeff": 0.33750006556510925, "total_loss": 85023.21875, "vf_explained_var": 0.8881394863128662, "vf_loss": 85023.21875, "kl": 0.01463086623698473, "policy_loss": -0.012264005839824677, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16130.849}, "custom_metrics": {"cost2_min": -128.6104651817517, "system_level_velocity_mean": 8.309462363252036, "outflow_rate_max": 1061.9262470872056, "outflow_rate_min": 353.4806708406273, "system_level_velocity_min": 3.4033703770398773, "outflow_rate_mean": 609.6594946215552, "cost2_max": -13.818725857280793, "cost1_max": 348.2611334116924, "cost1_min": 12.250976734420155, "cost1_mean": 201.1404630005157, "system_level_velocity_max": 16.8435642537317, "cost2_mean": -54.331524874926664}, "episode_len_mean": 679.63, "episode_reward_mean": 67327.77891319456, "pid": 31719, "episodes_this_iter": 58, "episode_reward_max": 138413.87312842943, "timestamp": 1556600280, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1510.8036289215088, "time_total_s": 1510.8036289215088, "time_this_iter_s": 39.9508171081543, "training_iteration": 36, "timesteps_this_iter": 114291, "done": false}
{"timesteps_since_restore": 4406243, "episode_reward_min": 1020.8940999651871, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339748>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 37, "node_ip": "10.138.0.2", "date": "2019-04-30_04-58-40", "num_metric_batches_dropped": 0, "timesteps_total": 4406243, "episodes_total": 1999, "hostname": "flow-main", "info": {"num_steps_trained": 4406243, "num_steps_sampled": 4406243, "grad_time_ms": 24885.519, "update_time_ms": 11.4, "load_time_ms": 20.598, "default": {"entropy": 1.5018508434295654, "cur_kl_coeff": 0.33750009536743164, "total_loss": 64883.37890625, "vf_explained_var": 0.9129866361618042, "vf_loss": 64883.38671875, "kl": 0.014918527565896511, "policy_loss": -0.011927473358809948, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16057.036}, "custom_metrics": {"cost2_min": -134.23179951029678, "system_level_velocity_mean": 8.181783193299957, "outflow_rate_max": 1026.501678477199, "outflow_rate_min": 353.4806708406273, "system_level_velocity_min": 4.6565161601760074, "outflow_rate_mean": 607.2080590606967, "cost2_max": -13.670845347417949, "cost1_max": 331.81711321848803, "cost1_min": 14.28624172030463, "cost1_mean": 201.4112442271337, "system_level_velocity_max": 17.995303191219545, "cost2_mean": -50.828231756799305}, "episode_len_mean": 686.55, "episode_reward_mean": 65327.47092838397, "pid": 31719, "episodes_this_iter": 60, "episode_reward_max": 138413.87312842943, "timestamp": 1556600320, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1550.0971965789795, "time_total_s": 1550.0971965789795, "time_this_iter_s": 39.2935676574707, "training_iteration": 37, "timesteps_this_iter": 113069, "done": false}
{"timesteps_since_restore": 4519996, "episode_reward_min": 28096.344421029153, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334828>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 38, "node_ip": "10.138.0.2", "date": "2019-04-30_04-59-20", "num_metric_batches_dropped": 0, "timesteps_total": 4519996, "episodes_total": 2056, "hostname": "flow-main", "info": {"num_steps_trained": 4519996, "num_steps_sampled": 4519996, "grad_time_ms": 24595.956, "update_time_ms": 11.339, "load_time_ms": 19.804, "default": {"entropy": 1.4690606594085693, "cur_kl_coeff": 0.33750009536743164, "total_loss": 77610.9765625, "vf_explained_var": 0.8985661268234253, "vf_loss": 77610.9921875, "kl": 0.014861542731523514, "policy_loss": -0.01086004450917244, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16014.438}, "custom_metrics": {"cost2_min": -134.23179951029678, "system_level_velocity_mean": 8.117449849447786, "outflow_rate_max": 1029.8338570749227, "outflow_rate_min": 369.09350493685156, "system_level_velocity_min": 5.365066289240853, "outflow_rate_mean": 610.4751424409266, "cost2_max": -13.670845347417949, "cost1_max": 323.86735238728096, "cost1_min": 134.95642897719898, "cost1_mean": 208.17855434813976, "system_level_velocity_max": 12.466818401124288, "cost2_mean": -47.71327249741177}, "episode_len_mean": 700.0, "episode_reward_mean": 63999.569163438544, "pid": 31719, "episodes_this_iter": 57, "episode_reward_max": 146018.33575313474, "timestamp": 1556600360, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1590.1682636737823, "time_total_s": 1590.1682636737823, "time_this_iter_s": 40.071067094802856, "training_iteration": 38, "timesteps_this_iter": 113753, "done": false}
{"timesteps_since_restore": 4632494, "episode_reward_min": 1955.2809484841098, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339208>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 39, "node_ip": "10.138.0.2", "date": "2019-04-30_04-59-59", "num_metric_batches_dropped": 0, "timesteps_total": 4632494, "episodes_total": 2120, "hostname": "flow-main", "info": {"num_steps_trained": 4632494, "num_steps_sampled": 4632494, "grad_time_ms": 24496.473, "update_time_ms": 11.6, "load_time_ms": 19.95, "default": {"entropy": 1.5610491037368774, "cur_kl_coeff": 0.33750003576278687, "total_loss": 63574.05859375, "vf_explained_var": 0.9189561605453491, "vf_loss": 63574.0625, "kl": 0.014229720458388329, "policy_loss": -0.01122964732348919, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16066.612}, "custom_metrics": {"cost2_min": -156.40772244501707, "system_level_velocity_mean": 8.012580088620023, "outflow_rate_max": 1062.8090377164212, "outflow_rate_min": 303.07011935660023, "system_level_velocity_min": 2.351533382168577, "outflow_rate_mean": 587.6306408867767, "cost2_max": -17.21580850876369, "cost1_max": 331.3665912751112, "cost1_min": 20.139940433596067, "cost1_mean": 200.16705876723444, "system_level_velocity_max": 18.360346167531194, "cost2_mean": -45.11475002410794}, "episode_len_mean": 693.32, "episode_reward_mean": 61000.65442059784, "pid": 31719, "episodes_this_iter": 64, "episode_reward_max": 146018.33575313474, "timestamp": 1556600399, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1629.4886646270752, "time_total_s": 1629.4886646270752, "time_this_iter_s": 39.32040095329285, "training_iteration": 39, "timesteps_this_iter": 112498, "done": false}
{"timesteps_since_restore": 4745449, "episode_reward_min": 1911.887635127916, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33347f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334198>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 40, "node_ip": "10.138.0.2", "date": "2019-04-30_05-00-40", "num_metric_batches_dropped": 0, "timesteps_total": 4745449, "episodes_total": 2176, "hostname": "flow-main", "info": {"num_steps_trained": 4745449, "num_steps_sampled": 4745449, "grad_time_ms": 24330.253, "update_time_ms": 11.471, "load_time_ms": 18.777, "default": {"entropy": 1.4863171577453613, "cur_kl_coeff": 0.33750006556510925, "total_loss": 67594.0390625, "vf_explained_var": 0.9264310598373413, "vf_loss": 67594.0390625, "kl": 0.014919457025825977, "policy_loss": -0.010375219397246838, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16053.624}, "custom_metrics": {"cost2_min": -129.44697440164285, "system_level_velocity_mean": 7.980388627370125, "outflow_rate_max": 1131.3100394435771, "outflow_rate_min": 248.87154966990641, "system_level_velocity_min": 2.1427268898989014, "outflow_rate_mean": 575.323523753, "cost2_max": -17.083631055106373, "cost1_max": 370.2052844381779, "cost1_min": 19.847344505957075, "cost1_mean": 194.68805865215344, "system_level_velocity_max": 18.471812405881597, "cost2_mean": -43.58948190372148}, "episode_len_mean": 686.63, "episode_reward_mean": 58807.68096347502, "pid": 31719, "episodes_this_iter": 56, "episode_reward_max": 146674.0625067969, "timestamp": 1556600440, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1670.3820934295654, "time_total_s": 1670.3820934295654, "time_this_iter_s": 40.893428802490234, "training_iteration": 40, "timesteps_this_iter": 112955, "done": false}
{"timesteps_since_restore": 4857972, "episode_reward_min": 29348.75150565273, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3339d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a33395f8>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 41, "node_ip": "10.138.0.2", "date": "2019-04-30_05-01-20", "num_metric_batches_dropped": 0, "timesteps_total": 4857972, "episodes_total": 2236, "hostname": "flow-main", "info": {"num_steps_trained": 4857972, "num_steps_sampled": 4857972, "grad_time_ms": 24171.778, "update_time_ms": 11.584, "load_time_ms": 18.717, "default": {"entropy": 1.4592915773391724, "cur_kl_coeff": 0.33750003576278687, "total_loss": 74193.3125, "vf_explained_var": 0.9164928197860718, "vf_loss": 74193.3125, "kl": 0.0239421334117651, "policy_loss": -0.007972462102770805, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16111.671}, "custom_metrics": {"cost2_min": -136.2115337079331, "system_level_velocity_mean": 7.906083161679041, "outflow_rate_max": 1072.424118837317, "outflow_rate_min": 248.87154966990641, "system_level_velocity_min": 2.1427268898989014, "outflow_rate_mean": 596.1718925904831, "cost2_max": -14.024559254068874, "cost1_max": 339.5468666966766, "cost1_min": 54.60978166024144, "cost1_mean": 202.83099647698972, "system_level_velocity_max": 12.799457661978964, "cost2_mean": -48.283140423838915}, "episode_len_mean": 700.0, "episode_reward_mean": 63111.97139583805, "pid": 31719, "episodes_this_iter": 60, "episode_reward_max": 160240.0494970942, "timestamp": 1556600480, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1710.114759683609, "time_total_s": 1710.114759683609, "time_this_iter_s": 39.73266625404358, "training_iteration": 41, "timesteps_this_iter": 112523, "done": false}
{"timesteps_since_restore": 4969602, "episode_reward_min": 30076.226494912517, "config": {"kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "compress_observations": false, "num_sgd_iter": 10, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "num_envs_per_worker": 1, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "num_workers": 60, "monitor": false, "num_gpus_per_worker": 0, "lambda": 0.97, "train_batch_size": 90000, "log_level": "INFO", "horizon": 1500, "vf_share_layers": false, "output": null, "batch_mode": "truncate_episodes", "synchronize_filters": true, "lr_schedule": null, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "vf_clip_param": 1000000.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 100.0]_t_min:10.0", "optimizer": {}, "output_max_file_size": 67108864, "straggler_mitigation": false, "entropy_coeff": 0.0, "kl_target": 0.01, "clip_param": 0.3, "clip_rewards": null, "model": {"custom_model": null, "conv_activation": "relu", "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "use_lstm": false, "conv_filters": null, "max_seq_len": 20, "channel_major": false, "fcnet_activation": "tanh", "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "fcnet_hiddens": [128, 64, 32], "free_log_std": false, "framestack": true, "zero_mean": true, "squash_to_range": false}, "preprocessor_pref": "deepmind", "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "intra_op_parallelism_threads": 2}, "use_gae": true, "num_cpus_for_driver": 1, "lr": 0.0005, "simple_optimizer": false, "input_evaluation": null, "sample_async": false, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f65a3334c88>", "on_train_result": null}, "num_gpus": 0, "vf_loss_coeff": 1.0, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 10.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_cpus_per_worker": 1}, "iterations_since_restore": 42, "node_ip": "10.138.0.2", "date": "2019-04-30_05-01-59", "num_metric_batches_dropped": 0, "timesteps_total": 4969602, "episodes_total": 2299, "hostname": "flow-main", "info": {"num_steps_trained": 4969602, "num_steps_sampled": 4969602, "grad_time_ms": 24264.304, "update_time_ms": 11.824, "load_time_ms": 18.365, "default": {"entropy": 1.5337566137313843, "cur_kl_coeff": 0.5062499642372131, "total_loss": 79376.640625, "vf_explained_var": 0.9138095378875732, "vf_loss": 79376.6484375, "kl": 0.011736685410141945, "policy_loss": -0.010167835280299187, "cur_lr": 0.0005000000237487257}, "sample_time_ms": 16024.724}, "custom_metrics": {"cost2_min": -133.20268807990368, "system_level_velocity_mean": 7.9670941531327495, "outflow_rate_max": 1120.9491312650418, "outflow_rate_min": 367.16229760290435, "system_level_velocity_min": 4.89619326474054, "outflow_rate_mean": 593.4333420757046, "cost2_max": -14.024559254068874, "cost1_max": 357.997100605724, "cost1_min": 125.87116421751016, "cost1_mean": 204.40860649388185, "system_level_velocity_max": 13.334403568949913, "cost2_mean": -45.78330180107694}, "episode_len_mean": 700.0, "episode_reward_mean": 61481.40532062523, "pid": 31719, "episodes_this_iter": 63, "episode_reward_max": 160240.0494970942, "timestamp": 1556600519, "policy_reward_mean": {}, "experiment_id": "13153b41d7f043878f02add18be55bf6", "time_since_restore": 1749.144504070282, "time_total_s": 1749.144504070282, "time_this_iter_s": 39.029744386672974, "training_iteration": 42, "timesteps_this_iter": 111630, "done": false}

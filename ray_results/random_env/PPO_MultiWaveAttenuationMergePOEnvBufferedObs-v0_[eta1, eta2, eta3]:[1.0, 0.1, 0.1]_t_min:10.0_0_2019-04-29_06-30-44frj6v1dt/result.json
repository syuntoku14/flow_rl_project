{"timesteps_this_iter": 120024, "timestamp": 1556519533, "episode_len_mean": 658.875, "time_since_restore": 41.75742745399475, "done": false, "custom_metrics": {"outflow_rate_min": 522.7032192852737, "outflow_rate_mean": 590.1038224463525, "cost2_mean": -39.189519539821994, "outflow_rate_max": 692.374099329461, "system_level_velocity_min": 6.937930757254741, "cost2_max": -22.375358537789214, "cost2_min": -56.596829089642554, "system_level_velocity_mean": 8.528405166018358, "cost1_min": 27.61370597232678, "cost1_max": 221.84655353544915, "cost1_mean": 190.44716265996837, "system_level_velocity_max": 17.687453969394497}, "timesteps_total": 120024, "training_iteration": 1, "date": "2019-04-29_06-32-13", "timesteps_since_restore": 120024, "episode_reward_max": 355.582073657038, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 271.5006148906001, "iterations_since_restore": 1, "time_this_iter_s": 41.75742745399475, "info": {"grad_time_ms": 26123.909, "default": {"entropy": 1.416216492652893, "kl": 0.00316104874946177, "cur_lr": 0.0005000000237487257, "vf_loss": 1.2563669681549072, "vf_explained_var": 0.883489191532135, "total_loss": 1.2555112838745117, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.0014880166854709387}, "num_steps_trained": 120024, "load_time_ms": 80.657, "update_time_ms": 531.076, "sample_time_ms": 14740.944, "num_steps_sampled": 120024}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871936a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193630>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 54.83807221330135, "episodes_total": 16, "episodes_this_iter": 16, "time_total_s": 41.75742745399475, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 122460, "timestamp": 1556519577, "episode_len_mean": 691.6708860759494, "time_since_restore": 85.51421761512756, "done": false, "custom_metrics": {"outflow_rate_min": 273.4382291472084, "outflow_rate_mean": 605.6335178291117, "cost2_mean": -53.43720797738319, "outflow_rate_max": 783.4355611032366, "system_level_velocity_min": 2.9020434553161367, "cost2_max": -22.375358537789214, "cost2_min": -96.26973332340746, "system_level_velocity_mean": 7.873814385048402, "cost1_min": 27.61370597232678, "cost1_max": 251.963071355618, "cost1_mean": 197.75097177601015, "system_level_velocity_max": 17.687453969394497}, "timesteps_total": 242484, "training_iteration": 2, "date": "2019-04-29_06-32-57", "timesteps_since_restore": 242484, "episode_reward_max": 513.4664520621841, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 344.04320796257235, "iterations_since_restore": 2, "time_this_iter_s": 43.75679016113281, "info": {"grad_time_ms": 26380.045, "default": {"entropy": 1.4061886072158813, "kl": 0.007161885499954224, "cur_lr": 0.0005000000237487257, "vf_loss": 1.2752960920333862, "vf_explained_var": 0.9095878005027771, "total_loss": 1.2725753784179688, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.003436863888055086}, "num_steps_trained": 242484, "load_time_ms": 51.49, "update_time_ms": 270.922, "sample_time_ms": 15805.075, "num_steps_sampled": 242484}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193f98>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 54.83807221330135, "episodes_total": 79, "episodes_this_iter": 63, "time_total_s": 85.51421761512756, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 116620, "timestamp": 1556519617, "episode_len_mean": 700.0, "time_since_restore": 125.97745633125305, "done": false, "custom_metrics": {"outflow_rate_min": 287.4443329349181, "outflow_rate_mean": 596.6327077691616, "cost2_mean": -58.04272208187072, "outflow_rate_max": 783.4355611032366, "system_level_velocity_mean": 7.604744794363187, "system_level_velocity_min": 2.932535711751724, "cost2_max": -31.5949089702546, "cost2_min": -107.00803670709375, "cost1_min": 75.76622607341511, "cost1_max": 251.963071355618, "cost1_mean": 196.57297682633177, "system_level_velocity_max": 10.22446360878549}, "timesteps_total": 359104, "training_iteration": 3, "date": "2019-04-29_06-33-37", "timesteps_since_restore": 359104, "episode_reward_max": 576.4108071109368, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 368.4663441390922, "iterations_since_restore": 3, "time_this_iter_s": 40.46323871612549, "info": {"grad_time_ms": 26045.732, "default": {"entropy": 1.3876845836639404, "kl": 0.009842601604759693, "cur_lr": 0.0005000000237487257, "vf_loss": 2.6412930488586426, "vf_explained_var": 0.9258029460906982, "total_loss": 2.636936902999878, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.005340200383216143}, "num_steps_trained": 359104, "load_time_ms": 41.311, "update_time_ms": 184.702, "sample_time_ms": 15484.182, "num_steps_sampled": 359104}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2908>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 190.6914188120959, "episodes_total": 129, "episodes_this_iter": 50, "time_total_s": 125.97745633125305, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 118614, "timestamp": 1556519660, "episode_len_mean": 693.16, "time_since_restore": 168.74538779258728, "done": false, "custom_metrics": {"outflow_rate_min": 167.19255110309854, "outflow_rate_mean": 651.7999792204174, "cost2_mean": -68.66205098988561, "outflow_rate_max": 1059.7868507185208, "system_level_velocity_min": 2.3960454729241167, "cost2_max": -11.503210751817114, "cost2_min": -148.10232904514532, "system_level_velocity_mean": 8.40529695244243, "cost1_min": 10.281252598481114, "cost1_max": 345.3886982409096, "cost1_mean": 214.38161509524124, "system_level_velocity_max": 16.00784614646895}, "timesteps_total": 477718, "training_iteration": 4, "date": "2019-04-29_06-34-20", "timesteps_since_restore": 477718, "episode_reward_max": 975.374925286293, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 456.8880398094792, "iterations_since_restore": 4, "time_this_iter_s": 42.76793146133423, "info": {"grad_time_ms": 26045.769, "default": {"entropy": 1.3802626132965088, "kl": 0.010815408080816269, "cur_lr": 0.0005000000237487257, "vf_loss": 4.428755760192871, "vf_explained_var": 0.9039207696914673, "total_loss": 4.42409086227417, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.005746460519731045}, "num_steps_trained": 477718, "load_time_ms": 35.863, "update_time_ms": 141.83, "sample_time_ms": 15733.041, "num_steps_sampled": 477718}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871f3f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871939b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 22.909710433848787, "episodes_total": 191, "episodes_this_iter": 62, "time_total_s": 168.74538779258728, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 125514, "timestamp": 1556519704, "episode_len_mean": 700.0, "time_since_restore": 212.39990997314453, "done": false, "custom_metrics": {"outflow_rate_min": 167.19255110309854, "outflow_rate_mean": 748.4737054609132, "cost2_mean": -85.43227229549146, "outflow_rate_max": 1034.6662027014497, "system_level_velocity_min": 2.3960454729241167, "cost2_max": -28.82855593940249, "cost2_min": -151.1933355065137, "system_level_velocity_mean": 9.16457210252188, "cost1_min": 61.48876807380044, "cost1_max": 330.16636378283533, "cost1_mean": 239.92836586669438, "system_level_velocity_max": 12.370257987536835}, "timesteps_total": 603232, "training_iteration": 5, "date": "2019-04-29_06-35-04", "timesteps_since_restore": 603232, "episode_reward_max": 921.2281174183507, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 571.3819994977757, "iterations_since_restore": 5, "time_this_iter_s": 43.65452218055725, "info": {"grad_time_ms": 26258.118, "default": {"entropy": 1.3745176792144775, "kl": 0.01122091244906187, "cur_lr": 0.0005000000237487257, "vf_loss": 5.202785968780518, "vf_explained_var": 0.9030947685241699, "total_loss": 5.19827938079834, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0056287492625415325}, "num_steps_trained": 603232, "load_time_ms": 32.983, "update_time_ms": 115.718, "sample_time_ms": 15840.302, "num_steps_sampled": 603232}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2dd8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 189.75225627866575, "episodes_total": 246, "episodes_this_iter": 55, "time_total_s": 212.39990997314453, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 119827, "timestamp": 1556519745, "episode_len_mean": 700.0, "time_since_restore": 253.14510035514832, "done": false, "custom_metrics": {"outflow_rate_min": 228.75076438929594, "outflow_rate_mean": 828.2615964309193, "cost2_mean": -90.80593281980748, "outflow_rate_max": 1088.9190558147354, "system_level_velocity_min": 2.9280981442703933, "cost2_max": -37.25406108602885, "cost2_min": -153.87000102450997, "system_level_velocity_mean": 9.971765725409888, "cost1_min": 74.17431307694129, "cost1_max": 374.83850722029797, "cost1_mean": 263.2882829759249, "system_level_velocity_max": 14.077584918900278}, "timesteps_total": 723059, "training_iteration": 6, "date": "2019-04-29_06-35-45", "timesteps_since_restore": 723059, "episode_reward_max": 927.2851687525227, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 661.4961590741551, "iterations_since_restore": 6, "time_this_iter_s": 40.745190382003784, "info": {"grad_time_ms": 26052.602, "default": {"entropy": 1.360658049583435, "kl": 0.01172887347638607, "cur_lr": 0.0005000000237487257, "vf_loss": 6.073208332061768, "vf_explained_var": 0.9037397503852844, "total_loss": 6.068000316619873, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.006381003186106682}, "num_steps_trained": 723059, "load_time_ms": 31.526, "update_time_ms": 98.283, "sample_time_ms": 15781.042, "num_steps_sampled": 723059}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1ff300c18>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 337.85600135970145, "episodes_total": 295, "episodes_this_iter": 49, "time_total_s": 253.14510035514832, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 132574, "timestamp": 1556519793, "episode_len_mean": 700.0, "time_since_restore": 300.97123169898987, "done": false, "custom_metrics": {"outflow_rate_min": 416.693661053792, "outflow_rate_mean": 858.3125527849231, "cost2_mean": -98.4718619259385, "outflow_rate_max": 1088.9190558147354, "system_level_velocity_min": 3.711025916241221, "cost2_max": -43.78019059742133, "cost2_min": -153.87000102450997, "system_level_velocity_mean": 10.27300180999899, "cost1_min": 92.79631211510423, "cost1_max": 374.83850722029797, "cost1_mean": 272.46534217657535, "system_level_velocity_max": 14.077584918900278}, "timesteps_total": 855633, "training_iteration": 7, "date": "2019-04-29_06-36-33", "timesteps_since_restore": 855633, "episode_reward_max": 927.2851687525227, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 711.5156527547277, "iterations_since_restore": 7, "time_this_iter_s": 47.82613134384155, "info": {"grad_time_ms": 26641.477, "default": {"entropy": 1.3892979621887207, "kl": 0.01092876773327589, "cur_lr": 0.0005000000237487257, "vf_loss": 7.728167533874512, "vf_explained_var": 0.8925613760948181, "total_loss": 7.723738670349121, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.005521718412637711}, "num_steps_trained": 855633, "load_time_ms": 31.611, "update_time_ms": 85.703, "sample_time_ms": 16007.052, "num_steps_sampled": 855633}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2978>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 413.23736299036807, "episodes_total": 349, "episodes_this_iter": 54, "time_total_s": 300.97123169898987, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 127085, "timestamp": 1556519837, "episode_len_mean": 700.0, "time_since_restore": 345.53226137161255, "done": false, "custom_metrics": {"outflow_rate_min": 175.43429295583158, "outflow_rate_mean": 843.411762191273, "cost2_mean": -101.28996494251734, "outflow_rate_max": 1088.9190558147354, "system_level_velocity_min": 2.7427700589543167, "cost2_max": -43.78019059742133, "cost2_min": -151.9825802504559, "system_level_velocity_mean": 10.023794538131867, "cost1_min": 69.32417335807705, "cost1_max": 374.83850722029797, "cost1_mean": 265.98590323773965, "system_level_velocity_max": 14.077584918900278}, "timesteps_total": 982718, "training_iteration": 8, "date": "2019-04-29_06-37-17", "timesteps_since_restore": 982718, "episode_reward_max": 922.1998168902002, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 706.1750624325292, "iterations_since_restore": 8, "time_this_iter_s": 44.56102967262268, "info": {"grad_time_ms": 26839.824, "default": {"entropy": 1.375728726387024, "kl": 0.010809271596372128, "cur_lr": 0.0005000000237487257, "vf_loss": 6.263171672821045, "vf_explained_var": 0.9172713756561279, "total_loss": 6.258254051208496, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.005998512264341116}, "num_steps_trained": 982718, "load_time_ms": 29.776, "update_time_ms": 76.515, "sample_time_ms": 16015.78, "num_steps_sampled": 982718}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2eb8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 282.71899373218696, "episodes_total": 381, "episodes_this_iter": 32, "time_total_s": 345.53226137161255, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 124846, "timestamp": 1556519881, "episode_len_mean": 700.0, "time_since_restore": 388.69120931625366, "done": false, "custom_metrics": {"outflow_rate_min": 175.43429295583158, "outflow_rate_mean": 846.567269066968, "cost2_mean": -107.98281208375705, "outflow_rate_max": 1084.4745170405972, "system_level_velocity_min": 2.7427700589543167, "cost2_max": -60.206805138714586, "cost2_min": -151.9825802504559, "system_level_velocity_mean": 9.856553974528621, "cost1_min": 69.32417335807705, "cost1_max": 349.2978614678986, "cost1_mean": 261.94702594270086, "system_level_velocity_max": 12.95016272779076}, "timesteps_total": 1107564, "training_iteration": 9, "date": "2019-04-29_06-38-01", "timesteps_since_restore": 1107564, "episode_reward_max": 1036.0744182124515, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 714.0523635802057, "iterations_since_restore": 9, "time_this_iter_s": 43.15894794464111, "info": {"grad_time_ms": 26809.17, "default": {"entropy": 1.363398790359497, "kl": 0.013299044221639633, "cur_lr": 0.0005000000237487257, "vf_loss": 7.803882122039795, "vf_explained_var": 0.8992961049079895, "total_loss": 7.797337532043457, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.007874924689531326}, "num_steps_trained": 1107564, "load_time_ms": 29.007, "update_time_ms": 69.264, "sample_time_ms": 16051.948, "num_steps_sampled": 1107564}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2518>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 282.71899373218696, "episodes_total": 437, "episodes_this_iter": 56, "time_total_s": 388.69120931625366, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 123785, "timestamp": 1556519923, "episode_len_mean": 686.83, "time_since_restore": 430.89480996131897, "done": false, "custom_metrics": {"outflow_rate_min": 228.6866875286916, "outflow_rate_mean": 878.3801242980243, "cost2_mean": -112.67027087932131, "outflow_rate_max": 1084.4745170405972, "system_level_velocity_mean": 10.369367547724785, "system_level_velocity_min": 2.9559451482306778, "cost2_max": -18.120807518313214, "cost2_min": -147.79760983276202, "cost1_min": 24.750992608800352, "cost1_max": 365.5895684972344, "cost1_mean": 266.9730737867814, "system_level_velocity_max": 18.64775204422694}, "timesteps_total": 1231349, "training_iteration": 10, "date": "2019-04-29_06-38-43", "timesteps_since_restore": 1231349, "episode_reward_max": 1073.5062524688567, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 745.4243484365578, "iterations_since_restore": 10, "time_this_iter_s": 42.20360064506531, "info": {"grad_time_ms": 26711.123, "default": {"entropy": 1.3579144477844238, "kl": 0.01327859703451395, "cur_lr": 0.0005000000237487257, "vf_loss": 8.464470863342285, "vf_explained_var": 0.8816980123519897, "total_loss": 8.458144187927246, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.007654887158423662}, "num_steps_trained": 1231349, "load_time_ms": 28.539, "update_time_ms": 63.33, "sample_time_ms": 16056.341, "num_steps_sampled": 1231349}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2668>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 53.506044562741394, "episodes_total": 488, "episodes_this_iter": 51, "time_total_s": 430.89480996131897, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 118978, "timestamp": 1556519963, "episode_len_mean": 686.83, "time_since_restore": 470.5704574584961, "done": false, "custom_metrics": {"outflow_rate_min": 408.6816538413187, "outflow_rate_mean": 895.5547578560657, "cost2_mean": -112.64596358453242, "outflow_rate_max": 1077.0155940384402, "system_level_velocity_min": 6.0750260628832775, "cost2_max": -18.120807518313214, "cost2_min": -173.11681901260803, "system_level_velocity_mean": 10.653840434413816, "cost1_min": 24.750992608800352, "cost1_max": 374.50170129502584, "cost1_mean": 274.2085025843209, "system_level_velocity_max": 18.64775204422694}, "timesteps_total": 1350327, "training_iteration": 11, "date": "2019-04-29_06-39-23", "timesteps_since_restore": 1350327, "episode_reward_max": 1073.5062524688567, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 766.463366020051, "iterations_since_restore": 11, "time_this_iter_s": 39.675647497177124, "info": {"grad_time_ms": 26518.557, "default": {"entropy": 1.3487781286239624, "kl": 0.014329723082482815, "cur_lr": 0.0005000000237487257, "vf_loss": 8.822175025939941, "vf_explained_var": 0.8685898780822754, "total_loss": 8.815261840820312, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.008346149697899818}, "num_steps_trained": 1350327, "load_time_ms": 22.555, "update_time_ms": 11.506, "sample_time_ms": 16105.465, "num_steps_sampled": 1350327}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2cf8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 53.506044562741394, "episodes_total": 535, "episodes_this_iter": 47, "time_total_s": 470.5704574584961, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 119481, "timestamp": 1556520004, "episode_len_mean": 700.0, "time_since_restore": 511.84360122680664, "done": false, "custom_metrics": {"outflow_rate_min": 711.1100992638725, "outflow_rate_mean": 905.6968084781854, "cost2_mean": -111.38070343814037, "outflow_rate_max": 1071.3547057220887, "system_level_velocity_min": 6.9133616861418234, "cost2_max": -44.64870977695625, "cost2_min": -173.11681901260803, "system_level_velocity_mean": 10.660741852138472, "cost1_min": 176.14171393297423, "cost1_max": 374.50170129502584, "cost1_mean": 283.22250860027003, "system_level_velocity_max": 14.019384096947622}, "timesteps_total": 1469808, "training_iteration": 12, "date": "2019-04-29_06-40-04", "timesteps_since_restore": 1469808, "episode_reward_max": 1016.3155044116515, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 781.1645860852024, "iterations_since_restore": 12, "time_this_iter_s": 41.27314376831055, "info": {"grad_time_ms": 26401.025, "default": {"entropy": 1.3389142751693726, "kl": 0.014990412630140781, "cur_lr": 0.0005000000237487257, "vf_loss": 10.142202377319336, "vf_explained_var": 0.8341051340103149, "total_loss": 10.134469985961914, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.009231235831975937}, "num_steps_trained": 1469808, "load_time_ms": 22.892, "update_time_ms": 11.472, "sample_time_ms": 15973.124, "num_steps_sampled": 1469808}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871939e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 540.9889584322787, "episodes_total": 591, "episodes_this_iter": 56, "time_total_s": 511.84360122680664, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 117975, "timestamp": 1556520045, "episode_len_mean": 700.0, "time_since_restore": 552.7954981327057, "done": false, "custom_metrics": {"outflow_rate_min": 739.6371280268896, "outflow_rate_mean": 925.8225832799249, "cost2_mean": -112.1982415864529, "outflow_rate_max": 1071.3547057220887, "system_level_velocity_min": 7.073855396923526, "cost2_max": -57.93954647312262, "cost2_min": -157.4901220274802, "system_level_velocity_mean": 10.957839380392384, "cost1_min": 186.60152395570157, "cost1_max": 353.563719405355, "cost1_mean": 291.45148266866426, "system_level_velocity_max": 13.198879962366835}, "timesteps_total": 1587783, "training_iteration": 13, "date": "2019-04-29_06-40-45", "timesteps_since_restore": 1587783, "episode_reward_max": 1016.3155044116515, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 800.4561893097406, "iterations_since_restore": 13, "time_this_iter_s": 40.95189690589905, "info": {"grad_time_ms": 26409.092, "default": {"entropy": 1.3362846374511719, "kl": 0.01636766642332077, "cur_lr": 0.0005000000237487257, "vf_loss": 8.782756805419922, "vf_explained_var": 0.8520472049713135, "total_loss": 8.776204109191895, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.008189494721591473}, "num_steps_trained": 1587783, "load_time_ms": 22.78, "update_time_ms": 11.505, "sample_time_ms": 16012.606, "num_steps_sampled": 1587783}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b20f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2208>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 540.9889584322787, "episodes_total": 638, "episodes_this_iter": 47, "time_total_s": 552.7954981327057, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 120946, "timestamp": 1556520086, "episode_len_mean": 700.0, "time_since_restore": 594.3145895004272, "done": false, "custom_metrics": {"outflow_rate_min": 641.8073408577145, "outflow_rate_mean": 945.8662029757913, "cost2_mean": -117.93821917711415, "outflow_rate_max": 1078.8392906715753, "system_level_velocity_min": 5.987132080088638, "cost2_max": -60.925801016442584, "cost2_min": -168.48308051794652, "system_level_velocity_mean": 11.1511874679216, "cost1_min": 153.57071696923487, "cost1_max": 353.74453620318184, "cost1_mean": 296.73115082700923, "system_level_velocity_max": 13.145418059913778}, "timesteps_total": 1708729, "training_iteration": 14, "date": "2019-04-29_06-41-26", "timesteps_since_restore": 1708729, "episode_reward_max": 1039.4983960630414, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 827.5878511191027, "iterations_since_restore": 14, "time_this_iter_s": 41.51909136772156, "info": {"grad_time_ms": 26382.093, "default": {"entropy": 1.3466466665267944, "kl": 0.01938270777463913, "cur_lr": 0.0005000000237487257, "vf_loss": 10.885708808898926, "vf_explained_var": 0.811637282371521, "total_loss": 10.877192497253418, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.010454480536282063}, "num_steps_trained": 1708729, "load_time_ms": 22.146, "update_time_ms": 11.165, "sample_time_ms": 15914.635, "num_steps_sampled": 1708729}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2fd0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 584.6617032532357, "episodes_total": 692, "episodes_this_iter": 54, "time_total_s": 594.3145895004272, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 118731, "timestamp": 1556520131, "episode_len_mean": 693.38, "time_since_restore": 638.4785740375519, "done": false, "custom_metrics": {"outflow_rate_min": 513.4251148892347, "outflow_rate_mean": 939.2314238354681, "cost2_mean": -114.41930642835065, "outflow_rate_max": 1121.4254497409133, "system_level_velocity_min": 5.987132080088638, "cost2_max": -19.67655375328104, "cost2_min": -168.48308051794652, "system_level_velocity_mean": 11.223052081739581, "cost1_min": 24.764502369145138, "cost1_max": 363.5661494564886, "cost1_mean": 294.081670933083, "system_level_velocity_max": 17.743283683985723}, "timesteps_total": 1827460, "training_iteration": 15, "date": "2019-04-29_06-42-11", "timesteps_since_restore": 1827460, "episode_reward_max": 1039.4983960630414, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 826.7334468444934, "iterations_since_restore": 15, "time_this_iter_s": 44.163984537124634, "info": {"grad_time_ms": 26463.34, "default": {"entropy": 1.3272050619125366, "kl": 0.019608808681368828, "cur_lr": 0.0005000000237487257, "vf_loss": 10.418188095092773, "vf_explained_var": 0.8238480091094971, "total_loss": 10.409090042114258, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.011058550328016281}, "num_steps_trained": 1827460, "load_time_ms": 22.597, "update_time_ms": 11.279, "sample_time_ms": 15885.332, "num_steps_sampled": 1827460}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2cf8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 51.11628312405883, "episodes_total": 745, "episodes_this_iter": 53, "time_total_s": 638.4785740375519, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 119628, "timestamp": 1556520173, "episode_len_mean": 693.38, "time_since_restore": 680.27037525177, "done": false, "custom_metrics": {"outflow_rate_min": 513.4251148892347, "outflow_rate_mean": 935.4531896847399, "cost2_mean": -110.3709197611477, "outflow_rate_max": 1121.4254497409133, "system_level_velocity_min": 7.659816685900479, "cost2_max": -19.67655375328104, "cost2_min": -159.07673694733094, "system_level_velocity_mean": 11.187467683420728, "cost1_min": 24.764502369145138, "cost1_max": 369.9371410062395, "cost1_mean": 293.0906536959534, "system_level_velocity_max": 17.743283683985723}, "timesteps_total": 1947088, "training_iteration": 16, "date": "2019-04-29_06-42-53", "timesteps_since_restore": 1947088, "episode_reward_max": 1037.1042597764867, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 808.5810322762081, "iterations_since_restore": 16, "time_this_iter_s": 41.79180121421814, "info": {"grad_time_ms": 26566.616, "default": {"entropy": 1.3325072526931763, "kl": 0.01987004280090332, "cur_lr": 0.0005000000237487257, "vf_loss": 10.186334609985352, "vf_explained_var": 0.8308412432670593, "total_loss": 10.177879333496094, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.010441298596560955}, "num_steps_trained": 1947088, "load_time_ms": 22.127, "update_time_ms": 11.204, "sample_time_ms": 15886.055, "num_steps_sampled": 1947088}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2e48>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 51.11628312405883, "episodes_total": 799, "episodes_this_iter": 54, "time_total_s": 680.27037525177, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 119539, "timestamp": 1556520216, "episode_len_mean": 700.0, "time_since_restore": 723.4607033729553, "done": false, "custom_metrics": {"outflow_rate_min": 612.6887346579949, "outflow_rate_mean": 924.8141241722633, "cost2_mean": -107.37967031956602, "outflow_rate_max": 1105.8897846466573, "system_level_velocity_mean": 11.00633840231526, "system_level_velocity_min": 6.16324051956859, "cost2_max": -48.94575071855418, "cost2_min": -159.07673694733094, "cost1_min": 158.42020115065785, "cost1_max": 369.9371410062395, "cost1_mean": 292.5771520576597, "system_level_velocity_max": 13.94580226995194}, "timesteps_total": 2066627, "training_iteration": 17, "date": "2019-04-29_06-43-36", "timesteps_since_restore": 2066627, "episode_reward_max": 1019.5086413085525, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 803.56173234031, "iterations_since_restore": 17, "time_this_iter_s": 43.1903281211853, "info": {"grad_time_ms": 26235.106, "default": {"entropy": 1.334755778312683, "kl": 0.018654385581612587, "cur_lr": 0.0005000000237487257, "vf_loss": 9.413311004638672, "vf_explained_var": 0.8529931902885437, "total_loss": 9.404764175415039, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.010411365889012814}, "num_steps_trained": 2066627, "load_time_ms": 21.534, "update_time_ms": 11.212, "sample_time_ms": 15756.953, "num_steps_sampled": 2066627}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1ff300c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871939e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193ac8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 547.7109758256166, "episodes_total": 847, "episodes_this_iter": 48, "time_total_s": 723.4607033729553, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 118632, "timestamp": 1556520258, "episode_len_mean": 700.0, "time_since_restore": 765.3707201480865, "done": false, "custom_metrics": {"outflow_rate_min": 602.9763884432631, "outflow_rate_mean": 920.8459617919316, "cost2_mean": -102.50867352335791, "outflow_rate_max": 1110.1141275719442, "system_level_velocity_min": 5.938904460877922, "cost2_max": -53.87936569016068, "cost2_min": -157.76878222589664, "system_level_velocity_mean": 11.079765190937524, "cost1_min": 151.50632056772122, "cost1_max": 392.3173846378142, "cost1_mean": 294.50938668649576, "system_level_velocity_max": 14.879024628727445}, "timesteps_total": 2185259, "training_iteration": 18, "date": "2019-04-29_06-44-18", "timesteps_since_restore": 2185259, "episode_reward_max": 1034.435366121856, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 799.5496631439679, "iterations_since_restore": 18, "time_this_iter_s": 41.910016775131226, "info": {"grad_time_ms": 26030.078, "default": {"entropy": 1.326947569847107, "kl": 0.021874912083148956, "cur_lr": 0.0005000000237487257, "vf_loss": 10.953941345214844, "vf_explained_var": 0.8353562355041504, "total_loss": 10.945002555847168, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0111265042796731}, "num_steps_trained": 2185259, "load_time_ms": 21.812, "update_time_ms": 11.135, "sample_time_ms": 15698.512, "num_steps_sampled": 2185259}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b24e0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 562.042757085574, "episodes_total": 896, "episodes_this_iter": 49, "time_total_s": 765.3707201480865, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 115046, "timestamp": 1556520297, "episode_len_mean": 700.0, "time_since_restore": 804.6947572231293, "done": false, "custom_metrics": {"outflow_rate_min": 453.3542893828221, "outflow_rate_mean": 934.0264056964462, "cost2_mean": -105.25921544599969, "outflow_rate_max": 1156.5254493516825, "system_level_velocity_min": 5.01486610914592, "cost2_max": -49.71166786354451, "cost2_min": -177.78357601662947, "system_level_velocity_mean": 11.282817109729711, "cost1_min": 129.11214889958939, "cost1_max": 392.3173846378142, "cost1_mean": 299.3512496218811, "system_level_velocity_max": 14.879024628727445}, "timesteps_total": 2300305, "training_iteration": 19, "date": "2019-04-29_06-44-57", "timesteps_since_restore": 2300305, "episode_reward_max": 1060.262278461215, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 810.6425399298761, "iterations_since_restore": 19, "time_this_iter_s": 39.324037075042725, "info": {"grad_time_ms": 25794.182, "default": {"entropy": 1.3102697134017944, "kl": 0.01843954622745514, "cur_lr": 0.0005000000237487257, "vf_loss": 12.264967918395996, "vf_explained_var": 0.819796621799469, "total_loss": 12.256311416625977, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.011420932598412037}, "num_steps_trained": 2300305, "load_time_ms": 22.041, "update_time_ms": 11.103, "sample_time_ms": 15550.957, "num_steps_sampled": 2300305}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871f3f60>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 562.042757085574, "episodes_total": 955, "episodes_this_iter": 59, "time_total_s": 804.6947572231293, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114204, "timestamp": 1556520336, "episode_len_mean": 700.0, "time_since_restore": 843.8507425785065, "done": false, "custom_metrics": {"outflow_rate_min": 706.8161708814586, "outflow_rate_mean": 960.8713843844436, "cost2_mean": -101.97981516386322, "outflow_rate_max": 1156.5254493516825, "system_level_velocity_min": 7.696065369722161, "cost2_max": -44.85148906010451, "cost2_min": -189.50215255313896, "system_level_velocity_mean": 11.863901563350037, "cost1_min": 193.76329307189104, "cost1_max": 379.30894879574834, "cost1_mean": 314.44362458687095, "system_level_velocity_max": 14.325761771190626}, "timesteps_total": 2414509, "training_iteration": 20, "date": "2019-04-29_06-45-36", "timesteps_since_restore": 2414509, "episode_reward_max": 1060.262278461215, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 840.8429222512231, "iterations_since_restore": 20, "time_this_iter_s": 39.1559853553772, "info": {"grad_time_ms": 25578.776, "default": {"entropy": 1.3166024684906006, "kl": 0.01885186694562435, "cur_lr": 0.0005000000237487257, "vf_loss": 13.082906723022461, "vf_explained_var": 0.8066166639328003, "total_loss": 13.074223518371582, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.011511142365634441}, "num_steps_trained": 2414509, "load_time_ms": 21.469, "update_time_ms": 11.125, "sample_time_ms": 15463.312, "num_steps_sampled": 2414509}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193e80>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 607.8022791984016, "episodes_total": 1013, "episodes_this_iter": 58, "time_total_s": 843.8507425785065, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111943, "timestamp": 1556520376, "episode_len_mean": 700.0, "time_since_restore": 883.8609318733215, "done": false, "custom_metrics": {"outflow_rate_min": 725.0529361558024, "outflow_rate_mean": 965.789304731376, "cost2_mean": -93.15984174620185, "outflow_rate_max": 1122.773581968006, "system_level_velocity_min": 6.98594655902018, "cost2_max": -48.07630934224593, "cost2_min": -189.50215255313896, "system_level_velocity_mean": 12.094261010588493, "cost1_min": 184.7467053066589, "cost1_max": 393.07050882995327, "cost1_mean": 320.5443103355094, "system_level_velocity_max": 14.85258180219501}, "timesteps_total": 2526452, "training_iteration": 21, "date": "2019-04-29_06-46-16", "timesteps_since_restore": 2526452, "episode_reward_max": 1025.4889386987136, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 850.9963766126856, "iterations_since_restore": 21, "time_this_iter_s": 40.01018929481506, "info": {"grad_time_ms": 25588.126, "default": {"entropy": 1.31661856174469, "kl": 0.021875005215406418, "cur_lr": 0.0005000000237487257, "vf_loss": 13.037277221679688, "vf_explained_var": 0.7888968586921692, "total_loss": 13.027155876159668, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.013402165845036507}, "num_steps_trained": 2526452, "load_time_ms": 22.153, "update_time_ms": 10.92, "sample_time_ms": 15486.614, "num_steps_sampled": 2526452}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b20b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2c88>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 605.3170863709325, "episodes_total": 1067, "episodes_this_iter": 54, "time_total_s": 883.8609318733215, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113246, "timestamp": 1556520416, "episode_len_mean": 700.0, "time_since_restore": 923.821168422699, "done": false, "custom_metrics": {"outflow_rate_min": 756.994473734408, "outflow_rate_mean": 965.7755087738781, "cost2_mean": -87.32857759174578, "outflow_rate_max": 1125.1095798562062, "system_level_velocity_min": 8.646222005395366, "cost2_max": -41.6994093940904, "cost2_min": -157.8303306764481, "system_level_velocity_mean": 12.253016391719012, "cost1_min": 231.9434770421222, "cost1_max": 398.53032833922384, "cost1_mean": 324.794298104249, "system_level_velocity_max": 15.034460818998289}, "timesteps_total": 2639698, "training_iteration": 22, "date": "2019-04-29_06-46-56", "timesteps_since_restore": 2639698, "episode_reward_max": 1090.7061526381362, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 852.0790693452744, "iterations_since_restore": 22, "time_this_iter_s": 39.96023654937744, "info": {"grad_time_ms": 25449.95, "default": {"entropy": 1.3092443943023682, "kl": 0.01736813597381115, "cur_lr": 0.0005000000237487257, "vf_loss": 14.180595397949219, "vf_explained_var": 0.7880231142044067, "total_loss": 14.172277450561523, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012225966900587082}, "num_steps_trained": 2639698, "load_time_ms": 22.057, "update_time_ms": 10.918, "sample_time_ms": 15493.117, "num_steps_sampled": 2639698}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b23c8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 619.5190148679598, "episodes_total": 1124, "episodes_this_iter": 57, "time_total_s": 923.821168422699, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114918, "timestamp": 1556520456, "episode_len_mean": 700.0, "time_since_restore": 963.2808041572571, "done": false, "custom_metrics": {"outflow_rate_min": 739.9893734887314, "outflow_rate_mean": 951.045654723925, "cost2_mean": -91.23570563682601, "outflow_rate_max": 1116.0753198001573, "system_level_velocity_min": 8.407016632161088, "cost2_max": -41.6994093940904, "cost2_min": -157.8303306764481, "system_level_velocity_mean": 11.872094879165415, "cost1_min": 220.88014149100343, "cost1_max": 398.53032833922384, "cost1_mean": 314.8667976659626, "system_level_velocity_max": 15.034460818998289}, "timesteps_total": 2754616, "training_iteration": 23, "date": "2019-04-29_06-47-36", "timesteps_since_restore": 2754616, "episode_reward_max": 1090.7061526381362, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 830.5595682713622, "iterations_since_restore": 23, "time_this_iter_s": 39.459635734558105, "info": {"grad_time_ms": 25201.042, "default": {"entropy": 1.3281946182250977, "kl": 0.017154308035969734, "cur_lr": 0.0005000000237487257, "vf_loss": 14.496721267700195, "vf_explained_var": 0.8014799356460571, "total_loss": 14.488043785095215, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012536024674773216}, "num_steps_trained": 2754616, "load_time_ms": 22.153, "update_time_ms": 10.863, "sample_time_ms": 15593.232, "num_steps_sampled": 2754616}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193a90>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 619.5190148679598, "episodes_total": 1184, "episodes_this_iter": 60, "time_total_s": 963.2808041572571, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112776, "timestamp": 1556520496, "episode_len_mean": 700.0, "time_since_restore": 1002.9003224372864, "done": false, "custom_metrics": {"outflow_rate_min": 607.1696199739538, "outflow_rate_mean": 942.8911322372238, "cost2_mean": -86.46788686789525, "outflow_rate_max": 1098.9742938081683, "system_level_velocity_min": 8.407016632161088, "cost2_max": -36.71235103451562, "cost2_min": -152.57162257846252, "system_level_velocity_mean": 12.112209929394908, "cost1_min": 219.6564896883292, "cost1_max": 396.94315088587723, "cost1_mean": 320.78895232412555, "system_level_velocity_max": 15.417537307078177}, "timesteps_total": 2867392, "training_iteration": 24, "date": "2019-04-29_06-48-16", "timesteps_since_restore": 2867392, "episode_reward_max": 996.1157707419154, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 827.2540179556652, "iterations_since_restore": 24, "time_this_iter_s": 39.6195182800293, "info": {"grad_time_ms": 25054.064, "default": {"entropy": 1.3005095720291138, "kl": 0.016474319621920586, "cur_lr": 0.0005000000237487257, "vf_loss": 14.29350757598877, "vf_explained_var": 0.8018869757652283, "total_loss": 14.285369873046875, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011843249201774597}, "num_steps_trained": 2867392, "load_time_ms": 22.901, "update_time_ms": 10.952, "sample_time_ms": 15547.263, "num_steps_sampled": 2867392}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2e48>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 518.7562750946835, "episodes_total": 1238, "episodes_this_iter": 54, "time_total_s": 1002.9003224372864, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111322, "timestamp": 1556520537, "episode_len_mean": 693.43, "time_since_restore": 1044.3163750171661, "done": false, "custom_metrics": {"outflow_rate_min": 532.2933220216632, "outflow_rate_mean": 943.188567232088, "cost2_mean": -76.03334716289535, "outflow_rate_max": 1097.6025953789917, "system_level_velocity_min": 8.463443181000802, "cost2_max": -22.28563286937556, "cost2_min": -152.57162257846252, "system_level_velocity_mean": 12.78273463682257, "cost1_min": 28.707555656590625, "cost1_max": 413.47698572087245, "cost1_mean": 333.42692990371256, "system_level_velocity_max": 18.2655332347326}, "timesteps_total": 2978714, "training_iteration": 25, "date": "2019-04-29_06-48-57", "timesteps_since_restore": 2978714, "episode_reward_max": 1003.4344702036585, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 836.7885452067867, "iterations_since_restore": 25, "time_this_iter_s": 41.41605257987976, "info": {"grad_time_ms": 24727.994, "default": {"entropy": 1.3198416233062744, "kl": 0.01781514473259449, "cur_lr": 0.0005000000237487257, "vf_loss": 16.93596839904785, "vf_explained_var": 0.7374731302261353, "total_loss": 16.927616119384766, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.012361949309706688}, "num_steps_trained": 2978714, "load_time_ms": 22.498, "update_time_ms": 11.168, "sample_time_ms": 15599.096, "num_steps_sampled": 2978714}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871f3f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 57.4323909172414, "episodes_total": 1299, "episodes_this_iter": 61, "time_total_s": 1044.3163750171661, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111081, "timestamp": 1556520576, "episode_len_mean": 686.71, "time_since_restore": 1083.2136750221252, "done": false, "custom_metrics": {"outflow_rate_min": 489.92596116141834, "outflow_rate_mean": 929.8148397137946, "cost2_mean": -72.93507539936566, "outflow_rate_max": 1105.116642637951, "system_level_velocity_min": 8.147634974092316, "cost2_max": -17.549696603771153, "cost2_min": -159.28428491477163, "system_level_velocity_mean": 12.714582657588187, "cost1_min": 18.478005305053017, "cost1_max": 415.6581341338832, "cost1_mean": 326.35070363922716, "system_level_velocity_max": 18.2655332347326}, "timesteps_total": 3089795, "training_iteration": 26, "date": "2019-04-29_06-49-36", "timesteps_since_restore": 3089795, "episode_reward_max": 980.691724725791, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 815.8877213351273, "iterations_since_restore": 26, "time_this_iter_s": 38.897300004959106, "info": {"grad_time_ms": 24444.458, "default": {"entropy": 1.2964266538619995, "kl": 0.017486976459622383, "cur_lr": 0.0005000000237487257, "vf_loss": 17.45829200744629, "vf_explained_var": 0.7777178883552551, "total_loss": 17.44940948486328, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012817362323403358}, "num_steps_trained": 3089795, "load_time_ms": 22.56, "update_time_ms": 11.223, "sample_time_ms": 15593.602, "num_steps_sampled": 3089795}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbda0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1ff300c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b25f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 40.08526443131835, "episodes_total": 1357, "episodes_this_iter": 58, "time_total_s": 1083.2136750221252, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112487, "timestamp": 1556520616, "episode_len_mean": 680.91, "time_since_restore": 1122.546284198761, "done": false, "custom_metrics": {"outflow_rate_min": 470.6106698001805, "outflow_rate_mean": 928.5539136982143, "cost2_mean": -74.78156792653124, "outflow_rate_max": 1075.8585548468661, "system_level_velocity_min": 8.147634974092316, "cost2_max": -12.752813969044519, "cost2_min": -141.945811627813, "system_level_velocity_mean": 12.677021975295546, "cost1_min": 12.853963627714421, "cost1_max": 415.6581341338832, "cost1_mean": 321.217382493713, "system_level_velocity_max": 18.007942316731}, "timesteps_total": 3202282, "training_iteration": 27, "date": "2019-04-29_06-50-16", "timesteps_since_restore": 3202282, "episode_reward_max": 995.9331476623605, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 804.3271789326368, "iterations_since_restore": 27, "time_this_iter_s": 39.33260917663574, "info": {"grad_time_ms": 24066.541, "default": {"entropy": 1.3110952377319336, "kl": 0.01825167052447796, "cur_lr": 0.0005000000237487257, "vf_loss": 17.342086791992188, "vf_explained_var": 0.7725463509559631, "total_loss": 17.332340240478516, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.01385310385376215}, "num_steps_trained": 3202282, "load_time_ms": 22.116, "update_time_ms": 11.423, "sample_time_ms": 15586.759, "num_steps_sampled": 3202282}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 24.78196630855123, "episodes_total": 1414, "episodes_this_iter": 57, "time_total_s": 1122.546284198761, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110839, "timestamp": 1556520655, "episode_len_mean": 687.63, "time_since_restore": 1162.3293228149414, "done": false, "custom_metrics": {"outflow_rate_min": 470.6106698001805, "outflow_rate_mean": 945.9594217496879, "cost2_mean": -80.12149747186801, "outflow_rate_max": 1090.9257333611683, "system_level_velocity_min": 8.392177994396937, "cost2_max": -12.752813969044519, "cost2_min": -168.53831321519647, "system_level_velocity_mean": 12.871413124403864, "cost1_min": 12.853963627714421, "cost1_max": 405.91484786933546, "cost1_mean": 330.7334889184963, "system_level_velocity_max": 17.94893418881127}, "timesteps_total": 3313121, "training_iteration": 28, "date": "2019-04-29_06-50-55", "timesteps_since_restore": 3313121, "episode_reward_max": 995.9331476623605, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 820.0883958353968, "iterations_since_restore": 28, "time_this_iter_s": 39.78303861618042, "info": {"grad_time_ms": 23827.013, "default": {"entropy": 1.2910608053207397, "kl": 0.018738115206360817, "cur_lr": 0.0005000000237487257, "vf_loss": 15.833357810974121, "vf_explained_var": 0.80479896068573, "total_loss": 15.824065208435059, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.01350821740925312}, "num_steps_trained": 3313121, "load_time_ms": 22.317, "update_time_ms": 11.321, "sample_time_ms": 15612.009, "num_steps_sampled": 3313121}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbf28>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 24.78196630855123, "episodes_total": 1469, "episodes_this_iter": 55, "time_total_s": 1162.3293228149414, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110763, "timestamp": 1556520695, "episode_len_mean": 693.33, "time_since_restore": 1202.3259444236755, "done": false, "custom_metrics": {"outflow_rate_min": 497.51150295452504, "outflow_rate_mean": 958.1770943636329, "cost2_mean": -78.05167596298352, "outflow_rate_max": 1189.0362119718723, "system_level_velocity_min": 8.392177994396937, "cost2_max": -19.132770998844617, "cost2_min": -168.53831321519647, "system_level_velocity_mean": 13.269910557511361, "cost1_min": 21.262660444680748, "cost1_max": 421.99157874057346, "cost1_mean": 344.33768898864383, "system_level_velocity_max": 18.354655827071554}, "timesteps_total": 3423884, "training_iteration": 29, "date": "2019-04-29_06-51-35", "timesteps_since_restore": 3423884, "episode_reward_max": 969.8361169772576, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 835.4455036900035, "iterations_since_restore": 29, "time_this_iter_s": 39.99662160873413, "info": {"grad_time_ms": 23843.09, "default": {"entropy": 1.3072333335876465, "kl": 0.01890694536268711, "cur_lr": 0.0005000000237487257, "vf_loss": 19.028194427490234, "vf_explained_var": 0.785979151725769, "total_loss": 19.017927169799805, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.014523102901875973}, "num_steps_trained": 3423884, "load_time_ms": 21.546, "update_time_ms": 11.312, "sample_time_ms": 15662.72, "num_steps_sampled": 3423884}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbf60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb358>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 46.672350795883055, "episodes_total": 1532, "episodes_this_iter": 63, "time_total_s": 1202.3259444236755, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109396, "timestamp": 1556520734, "episode_len_mean": 686.69, "time_since_restore": 1240.9577541351318, "done": false, "custom_metrics": {"outflow_rate_min": 497.51150295452504, "outflow_rate_mean": 945.3151056139612, "cost2_mean": -68.98739627829468, "outflow_rate_max": 1189.0362119718723, "system_level_velocity_min": 9.756726928469769, "cost2_max": -19.00754002221233, "cost2_min": -193.05677451264478, "system_level_velocity_mean": 13.54824178712972, "cost1_min": 21.262660444680748, "cost1_max": 421.99157874057346, "cost1_mean": 346.62190167095133, "system_level_velocity_max": 18.354655827071554}, "timesteps_total": 3533280, "training_iteration": 30, "date": "2019-04-29_06-52-14", "timesteps_since_restore": 3533280, "episode_reward_max": 1002.1834219614019, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 819.2292132426306, "iterations_since_restore": 30, "time_this_iter_s": 38.6318097114563, "info": {"grad_time_ms": 23790.275, "default": {"entropy": 1.3068023920059204, "kl": 0.01913999393582344, "cur_lr": 0.0005000000237487257, "vf_loss": 19.237028121948242, "vf_explained_var": 0.7622767090797424, "total_loss": 19.227317810058594, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.014016155153512955}, "num_steps_trained": 3533280, "load_time_ms": 21.834, "update_time_ms": 11.555, "sample_time_ms": 15665.005, "num_steps_sampled": 3533280}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2908>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 46.672350795883055, "episodes_total": 1595, "episodes_this_iter": 63, "time_total_s": 1240.9577541351318, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109306, "timestamp": 1556520774, "episode_len_mean": 693.36, "time_since_restore": 1280.8218591213226, "done": false, "custom_metrics": {"outflow_rate_min": 500.489045692075, "outflow_rate_mean": 934.9263166574618, "cost2_mean": -68.47089384783311, "outflow_rate_max": 1059.8019022572557, "system_level_velocity_min": 9.006234437620146, "cost2_max": -19.00754002221233, "cost2_min": -193.05677451264478, "system_level_velocity_mean": 13.215362811925884, "cost1_min": 24.03073851953212, "cost1_max": 421.03548292590426, "cost1_mean": 342.6675567240021, "system_level_velocity_max": 18.003858507436473}, "timesteps_total": 3642586, "training_iteration": 31, "date": "2019-04-29_06-52-54", "timesteps_since_restore": 3642586, "episode_reward_max": 970.6806447165537, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 815.30902906664, "iterations_since_restore": 31, "time_this_iter_s": 39.864104986190796, "info": {"grad_time_ms": 23686.277, "default": {"entropy": 1.312389850616455, "kl": 0.019237151369452477, "cur_lr": 0.0005000000237487257, "vf_loss": 18.550884246826172, "vf_explained_var": 0.7784585356712341, "total_loss": 18.541397094726562, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.013815863057971}, "num_steps_trained": 3642586, "load_time_ms": 21.415, "update_time_ms": 11.783, "sample_time_ms": 15752.639, "num_steps_sampled": 3642586}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb940>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 54.19229945374981, "episodes_total": 1655, "episodes_this_iter": 60, "time_total_s": 1280.8218591213226, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109566, "timestamp": 1556520814, "episode_len_mean": 700.0, "time_since_restore": 1321.1341998577118, "done": false, "custom_metrics": {"outflow_rate_min": 749.3189962661918, "outflow_rate_mean": 951.0648881496055, "cost2_mean": -71.70740816212678, "outflow_rate_max": 1127.498839897442, "system_level_velocity_min": 9.006234437620146, "cost2_max": -29.580597484844866, "cost2_min": -148.41234133050375, "system_level_velocity_mean": 13.098668921553717, "cost1_min": 240.25910676590587, "cost1_max": 420.2752759983274, "cost1_mean": 344.41842885143774, "system_level_velocity_max": 16.243191147081713}, "timesteps_total": 3752152, "training_iteration": 32, "date": "2019-04-29_06-53-34", "timesteps_since_restore": 3752152, "episode_reward_max": 987.7951067535274, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 829.2456220851326, "iterations_since_restore": 32, "time_this_iter_s": 40.31234073638916, "info": {"grad_time_ms": 23680.898, "default": {"entropy": 1.3218886852264404, "kl": 0.019957683980464935, "cur_lr": 0.0005000000237487257, "vf_loss": 20.129798889160156, "vf_explained_var": 0.7716094255447388, "total_loss": 20.119630813598633, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.014658372849225998}, "num_steps_trained": 3752152, "load_time_ms": 20.871, "update_time_ms": 11.817, "sample_time_ms": 15796.631, "num_steps_sampled": 3752152}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b27b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b23c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2eb8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 616.0381700808523, "episodes_total": 1715, "episodes_this_iter": 60, "time_total_s": 1321.1341998577118, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109987, "timestamp": 1556520855, "episode_len_mean": 700.0, "time_since_restore": 1361.8209643363953, "done": false, "custom_metrics": {"outflow_rate_min": 820.8855877801417, "outflow_rate_mean": 976.6978870824796, "cost2_mean": -76.99177662238544, "outflow_rate_max": 1158.9709121338842, "system_level_velocity_min": 9.811680970129874, "cost2_max": -32.3107105569272, "cost2_min": -148.97966083718276, "system_level_velocity_mean": 13.386475111210876, "cost1_min": 252.94887430969038, "cost1_max": 416.4605845226552, "cost1_mean": 351.3218858828171, "system_level_velocity_max": 16.243191147081713}, "timesteps_total": 3862139, "training_iteration": 33, "date": "2019-04-29_06-54-15", "timesteps_since_restore": 3862139, "episode_reward_max": 1033.1423824555325, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 844.4166854189416, "iterations_since_restore": 33, "time_this_iter_s": 40.68676447868347, "info": {"grad_time_ms": 23784.333, "default": {"entropy": 1.3338779211044312, "kl": 0.019435198977589607, "cur_lr": 0.0005000000237487257, "vf_loss": 21.569766998291016, "vf_explained_var": 0.7976356744766235, "total_loss": 21.55936622619629, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.01477343775331974}, "num_steps_trained": 3862139, "load_time_ms": 20.872, "update_time_ms": 11.985, "sample_time_ms": 15815.615, "num_steps_sampled": 3862139}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb550>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 609.403252905532, "episodes_total": 1777, "episodes_this_iter": 62, "time_total_s": 1361.8209643363953, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109500, "timestamp": 1556520895, "episode_len_mean": 693.36, "time_since_restore": 1401.307680606842, "done": false, "custom_metrics": {"outflow_rate_min": 507.1740941880211, "outflow_rate_mean": 981.9806311228568, "cost2_mean": -70.87159350075622, "outflow_rate_max": 1158.9709121338842, "system_level_velocity_min": 9.015946004414639, "cost2_max": -20.588512878991427, "cost2_min": -146.09072689048986, "system_level_velocity_mean": 13.950793844897982, "cost1_min": 24.003057701987697, "cost1_max": 417.95685615039844, "cost1_mean": 360.45909859768307, "system_level_velocity_max": 17.919693636594708}, "timesteps_total": 3971639, "training_iteration": 34, "date": "2019-04-29_06-54-55", "timesteps_since_restore": 3971639, "episode_reward_max": 1014.3063560538815, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 851.7950103764659, "iterations_since_restore": 34, "time_this_iter_s": 39.48671627044678, "info": {"grad_time_ms": 23683.185, "default": {"entropy": 1.3282138109207153, "kl": 0.01995771937072277, "cur_lr": 0.0005000000237487257, "vf_loss": 21.574846267700195, "vf_explained_var": 0.765814483165741, "total_loss": 21.56572914123535, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.01360610406845808}, "num_steps_trained": 3971639, "load_time_ms": 20.753, "update_time_ms": 11.993, "sample_time_ms": 15907.493, "num_steps_sampled": 3971639}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 49.45358982902134, "episodes_total": 1839, "episodes_this_iter": 62, "time_total_s": 1401.307680606842, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107312, "timestamp": 1556520934, "episode_len_mean": 679.9, "time_since_restore": 1440.4072089195251, "done": false, "custom_metrics": {"outflow_rate_min": 478.85323924047754, "outflow_rate_mean": 953.7062107874726, "cost2_mean": -62.4893558571645, "outflow_rate_max": 1098.3971734756115, "system_level_velocity_min": 8.968697036750847, "cost2_max": -15.73383959999358, "cost2_min": -155.93016968650002, "system_level_velocity_mean": 14.034038612932209, "cost1_min": 16.260185781971302, "cost1_max": 422.6847149323104, "cost1_mean": 352.2470599869069, "system_level_velocity_max": 18.091616238688843}, "timesteps_total": 4078951, "training_iteration": 35, "date": "2019-04-29_06-55-34", "timesteps_since_restore": 4078951, "episode_reward_max": 1045.342412524009, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 817.0386489559822, "iterations_since_restore": 35, "time_this_iter_s": 39.099528312683105, "info": {"grad_time_ms": 23534.914, "default": {"entropy": 1.3381307125091553, "kl": 0.02033885195851326, "cur_lr": 0.0005000000237487257, "vf_loss": 21.09905433654785, "vf_explained_var": 0.7840608954429626, "total_loss": 21.088775634765625, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.014853297732770443}, "num_steps_trained": 4078951, "load_time_ms": 20.544, "update_time_ms": 11.631, "sample_time_ms": 15825.047, "num_steps_sampled": 4078951}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bba90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbc88>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 40.316209196292824, "episodes_total": 1904, "episodes_this_iter": 65, "time_total_s": 1440.4072089195251, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109548, "timestamp": 1556520975, "episode_len_mean": 681.73, "time_since_restore": 1481.1183931827545, "done": false, "custom_metrics": {"outflow_rate_min": 478.85323924047754, "outflow_rate_mean": 962.5337219079248, "cost2_mean": -63.72048434764277, "outflow_rate_max": 1136.3957278108826, "system_level_velocity_min": 8.968697036750847, "cost2_max": -15.73383959999358, "cost2_min": -142.2490358088104, "system_level_velocity_mean": 14.202824349014131, "cost1_min": 16.260185781971302, "cost1_max": 427.69388286892894, "cost1_mean": 357.41634715116123, "system_level_velocity_max": 18.091616238688843}, "timesteps_total": 4188499, "training_iteration": 36, "date": "2019-04-29_06-56-15", "timesteps_since_restore": 4188499, "episode_reward_max": 1045.342412524009, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 827.0620926755894, "iterations_since_restore": 36, "time_this_iter_s": 40.71118426322937, "info": {"grad_time_ms": 23674.727, "default": {"entropy": 1.3347471952438354, "kl": 0.01656898856163025, "cur_lr": 0.0005000000237487257, "vf_loss": 22.857940673828125, "vf_explained_var": 0.7697858214378357, "total_loss": 22.849443435668945, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014087560586631298}, "num_steps_trained": 4188499, "load_time_ms": 20.343, "update_time_ms": 11.757, "sample_time_ms": 15864.349, "num_steps_sampled": 4188499}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ba8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 40.316209196292824, "episodes_total": 1968, "episodes_this_iter": 64, "time_total_s": 1481.1183931827545, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106477, "timestamp": 1556521014, "episode_len_mean": 695.19, "time_since_restore": 1519.9422042369843, "done": false, "custom_metrics": {"outflow_rate_min": 706.0162070786076, "outflow_rate_mean": 957.6419835626011, "cost2_mean": -65.09953239604651, "outflow_rate_max": 1099.324990410984, "system_level_velocity_min": 9.053947012011177, "cost2_max": -31.78169152594873, "cost2_min": -142.2490358088104, "system_level_velocity_mean": 13.867099252169504, "cost1_min": 133.86269346495288, "cost1_max": 431.3668324654003, "cost1_mean": 357.92660103904217, "system_level_velocity_max": 16.997880746955165}, "timesteps_total": 4294976, "training_iteration": 37, "date": "2019-04-29_06-56-54", "timesteps_since_restore": 4294976, "episode_reward_max": 1004.2841543400137, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 825.8153801027096, "iterations_since_restore": 37, "time_this_iter_s": 38.823811054229736, "info": {"grad_time_ms": 23727.597, "default": {"entropy": 1.3472899198532104, "kl": 0.015965789556503296, "cur_lr": 0.0005000000237487257, "vf_loss": 20.41714096069336, "vf_explained_var": 0.7540400624275208, "total_loss": 20.408802032470703, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.013724904507398605}, "num_steps_trained": 4294976, "load_time_ms": 20.224, "update_time_ms": 11.616, "sample_time_ms": 15761.818, "num_steps_sampled": 4294976}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb7b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 291.9179352543008, "episodes_total": 2028, "episodes_this_iter": 60, "time_total_s": 1519.9422042369843, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106727, "timestamp": 1556521053, "episode_len_mean": 700.0, "time_since_restore": 1559.4743039608002, "done": false, "custom_metrics": {"outflow_rate_min": 706.0162070786076, "outflow_rate_mean": 950.8719474805105, "cost2_mean": -60.99159397721655, "outflow_rate_max": 1092.7652359717754, "system_level_velocity_min": 9.50212530916254, "cost2_max": -31.391251731093227, "cost2_min": -121.37157229364472, "system_level_velocity_mean": 13.89965989175452, "cost1_min": 253.67346808218556, "cost1_max": 424.07027622663816, "cost1_mean": 362.60408907526113, "system_level_velocity_max": 16.86444728945475}, "timesteps_total": 4401703, "training_iteration": 38, "date": "2019-04-29_06-57-33", "timesteps_since_restore": 4401703, "episode_reward_max": 1001.503603366657, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 825.237217338682, "iterations_since_restore": 38, "time_this_iter_s": 39.53209972381592, "info": {"grad_time_ms": 23797.639, "default": {"entropy": 1.3568439483642578, "kl": 0.015463508665561676, "cur_lr": 0.0005000000237487257, "vf_loss": 22.27927589416504, "vf_explained_var": 0.7381057143211365, "total_loss": 22.271024703979492, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.013470890931785107}, "num_steps_trained": 4401703, "load_time_ms": 20.054, "update_time_ms": 11.78, "sample_time_ms": 15665.651, "num_steps_sampled": 4401703}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c50>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 598.71834968044, "episodes_total": 2089, "episodes_this_iter": 61, "time_total_s": 1559.4743039608002, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104923, "timestamp": 1556521091, "episode_len_mean": 693.97, "time_since_restore": 1597.7442827224731, "done": false, "custom_metrics": {"outflow_rate_min": 675.7699166793204, "outflow_rate_mean": 942.5311075886991, "cost2_mean": -56.68428039584477, "outflow_rate_max": 1120.6983779013246, "system_level_velocity_min": 10.057287680570042, "cost2_max": -27.174737284498747, "cost2_min": -121.37157229364472, "system_level_velocity_mean": 14.392992422273215, "cost1_min": 64.87581752274859, "cost1_max": 434.30467389613483, "cost1_mean": 369.9093788160574, "system_level_velocity_max": 18.265017861512362}, "timesteps_total": 4506626, "training_iteration": 39, "date": "2019-04-29_06-58-11", "timesteps_since_restore": 4506626, "episode_reward_max": 1005.3089033611919, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 813.8866353210296, "iterations_since_restore": 39, "time_this_iter_s": 38.269978761672974, "info": {"grad_time_ms": 23625.17, "default": {"entropy": 1.3483000993728638, "kl": 0.015870848670601845, "cur_lr": 0.0005000000237487257, "vf_loss": 21.357786178588867, "vf_explained_var": 0.7021520137786865, "total_loss": 21.349924087524414, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.013219036161899567}, "num_steps_trained": 4506626, "load_time_ms": 20.533, "update_time_ms": 12.095, "sample_time_ms": 15665.387, "num_steps_sampled": 4506626}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bba90>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 132.6148494153423, "episodes_total": 2152, "episodes_this_iter": 63, "time_total_s": 1597.7442827224731, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105558, "timestamp": 1556521129, "episode_len_mean": 695.15, "time_since_restore": 1635.38796043396, "done": false, "custom_metrics": {"outflow_rate_min": 711.6025697049027, "outflow_rate_mean": 949.0319358613867, "cost2_mean": -56.41912645578162, "outflow_rate_max": 1131.0024783979504, "system_level_velocity_min": 10.30032714796708, "cost2_max": -25.03063215831938, "cost2_min": -124.91832667352062, "system_level_velocity_mean": 14.599708231260909, "cost1_min": 159.7271580835749, "cost1_max": 437.95374410458584, "cost1_mean": 377.1473761662326, "system_level_velocity_max": 17.859089041665573}, "timesteps_total": 4612184, "training_iteration": 40, "date": "2019-04-29_06-58-49", "timesteps_since_restore": 4612184, "episode_reward_max": 1005.3089033611919, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 821.5687730882036, "iterations_since_restore": 40, "time_this_iter_s": 37.643677711486816, "info": {"grad_time_ms": 23591.766, "default": {"entropy": 1.3495887517929077, "kl": 0.016281649470329285, "cur_lr": 0.0005000000237487257, "vf_loss": 24.84251594543457, "vf_explained_var": 0.7056192755699158, "total_loss": 24.83338165283203, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.01462593860924244}, "num_steps_trained": 4612184, "load_time_ms": 20.566, "update_time_ms": 12.043, "sample_time_ms": 15599.998, "num_steps_sampled": 4612184}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ba8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 363.66800046581176, "episodes_total": 2220, "episodes_this_iter": 68, "time_total_s": 1635.38796043396, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105775, "timestamp": 1556521169, "episode_len_mean": 686.28, "time_since_restore": 1674.854693889618, "done": false, "custom_metrics": {"outflow_rate_min": 475.59678422127865, "outflow_rate_mean": 933.8583204907798, "cost2_mean": -56.807445033555865, "outflow_rate_max": 1131.0024783979504, "system_level_velocity_min": 10.440230231983666, "cost2_max": -18.60584784565263, "cost2_min": -156.29879061692907, "system_level_velocity_mean": 14.641926954421317, "cost1_min": 19.948936123558177, "cost1_max": 433.6614672305292, "cost1_mean": 370.1085123354878, "system_level_velocity_max": 18.17831480017295}, "timesteps_total": 4717959, "training_iteration": 41, "date": "2019-04-29_06-59-29", "timesteps_since_restore": 4717959, "episode_reward_max": 995.4657273829273, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 797.6629670471732, "iterations_since_restore": 41, "time_this_iter_s": 39.46673345565796, "info": {"grad_time_ms": 23609.598, "default": {"entropy": 1.3539161682128906, "kl": 0.016104497015476227, "cur_lr": 0.0005000000237487257, "vf_loss": 26.63079261779785, "vf_explained_var": 0.6977994441986084, "total_loss": 26.621925354003906, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014302100986242294}, "num_steps_trained": 4717959, "load_time_ms": 20.468, "update_time_ms": 12.036, "sample_time_ms": 15543.475, "num_steps_sampled": 4717959}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb780>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 43.32353959092831, "episodes_total": 2292, "episodes_this_iter": 72, "time_total_s": 1674.854693889618, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106168, "timestamp": 1556521207, "episode_len_mean": 693.4, "time_since_restore": 1713.004489660263, "done": false, "custom_metrics": {"outflow_rate_min": 489.26327253910375, "outflow_rate_mean": 918.4647328260113, "cost2_mean": -60.42950574242081, "outflow_rate_max": 1105.3739836627433, "system_level_velocity_min": 9.83418759660385, "cost2_max": -19.524455161178537, "cost2_min": -156.29879061692907, "system_level_velocity_mean": 14.322601201585819, "cost1_min": 26.16638348287912, "cost1_max": 433.3315637930165, "cost1_mean": 366.20334750761845, "system_level_velocity_max": 18.17435870862005}, "timesteps_total": 4824127, "training_iteration": 42, "date": "2019-04-29_07-00-07", "timesteps_since_restore": 4824127, "episode_reward_max": 987.2643736773682, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 794.4057736656681, "iterations_since_restore": 42, "time_this_iter_s": 38.14979577064514, "info": {"grad_time_ms": 23506.616, "default": {"entropy": 1.365833044052124, "kl": 0.016164297237992287, "cur_lr": 0.0005000000237487257, "vf_loss": 23.307573318481445, "vf_explained_var": 0.7400722503662109, "total_loss": 23.298297882080078, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014728670008480549}, "num_steps_trained": 4824127, "load_time_ms": 20.21, "update_time_ms": 12.304, "sample_time_ms": 15428.538, "num_steps_sampled": 4824127}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41a20>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 58.94471769519908, "episodes_total": 2360, "episodes_this_iter": 68, "time_total_s": 1713.004489660263, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103537, "timestamp": 1556521245, "episode_len_mean": 680.16, "time_since_restore": 1750.7933344841003, "done": false, "custom_metrics": {"outflow_rate_min": 489.26327253910375, "outflow_rate_mean": 918.7783641839486, "cost2_mean": -56.14729677849561, "outflow_rate_max": 1089.1641599482143, "system_level_velocity_min": 10.756724550557008, "cost2_max": -17.424852973883688, "cost2_min": -128.50906917775274, "system_level_velocity_mean": 14.748257093652034, "cost1_min": 22.73052347903117, "cost1_max": 433.3315637930165, "cost1_mean": 368.4370732564846, "system_level_velocity_max": 18.17435870862005}, "timesteps_total": 4927664, "training_iteration": 43, "date": "2019-04-29_07-00-45", "timesteps_since_restore": 4927664, "episode_reward_max": 991.0079051082528, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 787.5035084343502, "iterations_since_restore": 43, "time_this_iter_s": 37.78884482383728, "info": {"grad_time_ms": 23280.064, "default": {"entropy": 1.3707058429718018, "kl": 0.016184328123927116, "cur_lr": 0.0005000000237487257, "vf_loss": 28.382295608520508, "vf_explained_var": 0.6588214039802551, "total_loss": 28.374547958374023, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01321083027869463}, "num_steps_trained": 4927664, "load_time_ms": 20.296, "update_time_ms": 12.035, "sample_time_ms": 15365.316, "num_steps_sampled": 4927664}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbc18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb240>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 52.79337201967142, "episodes_total": 2434, "episodes_this_iter": 74, "time_total_s": 1750.7933344841003, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104335, "timestamp": 1556521280, "episode_len_mean": 669.97, "time_since_restore": 1786.1741659641266, "done": false, "custom_metrics": {"outflow_rate_min": 472.47706369188825, "outflow_rate_mean": 887.6498561284927, "cost2_mean": -48.53445983815635, "outflow_rate_max": 1082.5660519937442, "system_level_velocity_min": 10.771361602406582, "cost2_max": -14.8389361050001, "cost2_min": -104.70619628136669, "system_level_velocity_mean": 15.171074764838856, "cost1_min": 15.964977316445497, "cost1_max": 437.6558387544927, "cost1_mean": 370.80319616512776, "system_level_velocity_max": 18.5408387172701}, "timesteps_total": 5031999, "training_iteration": 44, "date": "2019-04-29_07-01-20", "timesteps_since_restore": 5031999, "episode_reward_max": 1008.6915575513882, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 753.1485585979048, "iterations_since_restore": 44, "time_this_iter_s": 35.380831480026245, "info": {"grad_time_ms": 22983.963, "default": {"entropy": 1.3850396871566772, "kl": 0.016793495044112206, "cur_lr": 0.0005000000237487257, "vf_loss": 27.568477630615234, "vf_explained_var": 0.635377824306488, "total_loss": 27.559873580932617, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01427449844777584}, "num_steps_trained": 5031999, "load_time_ms": 20.147, "update_time_ms": 12.031, "sample_time_ms": 15251.248, "num_steps_sampled": 5031999}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d415c0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 39.541026135756326, "episodes_total": 2507, "episodes_this_iter": 73, "time_total_s": 1786.1741659641266, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105498, "timestamp": 1556521316, "episode_len_mean": 680.61, "time_since_restore": 1822.3501238822937, "done": false, "custom_metrics": {"outflow_rate_min": 472.47706369188825, "outflow_rate_mean": 905.8563747966618, "cost2_mean": -51.489114602627005, "outflow_rate_max": 1096.0154995183827, "system_level_velocity_min": 9.973515115096589, "cost2_max": -14.8389361050001, "cost2_min": -115.64612240463495, "system_level_velocity_mean": 14.92861086207294, "cost1_min": 15.964977316445497, "cost1_max": 437.6558387544927, "cost1_mean": 371.08312689959143, "system_level_velocity_max": 18.5408387172701}, "timesteps_total": 5137497, "training_iteration": 45, "date": "2019-04-29_07-01-56", "timesteps_since_restore": 5137497, "episode_reward_max": 1019.8279745650271, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 763.6402355895552, "iterations_since_restore": 45, "time_this_iter_s": 36.175957918167114, "info": {"grad_time_ms": 22748.622, "default": {"entropy": 1.3873412609100342, "kl": 0.015898173674941063, "cur_lr": 0.0005000000237487257, "vf_loss": 22.893007278442383, "vf_explained_var": 0.7402219176292419, "total_loss": 22.883817672729492, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014555373229086399}, "num_steps_trained": 5137497, "load_time_ms": 20.005, "update_time_ms": 12.041, "sample_time_ms": 15197.068, "num_steps_sampled": 5137497}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbef0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 39.541026135756326, "episodes_total": 2569, "episodes_this_iter": 62, "time_total_s": 1822.3501238822937, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104243, "timestamp": 1556521355, "episode_len_mean": 693.28, "time_since_restore": 1860.659863948822, "done": false, "custom_metrics": {"outflow_rate_min": 487.9519811681622, "outflow_rate_mean": 907.7620391358831, "cost2_mean": -53.231584896787346, "outflow_rate_max": 1112.4266570432244, "system_level_velocity_min": 10.530927220340704, "cost2_max": -17.276446948427836, "cost2_min": -117.1960223594462, "system_level_velocity_mean": 14.678279401000864, "cost1_min": 18.67212419848804, "cost1_max": 443.73737924490746, "cost1_mean": 373.95843985100805, "system_level_velocity_max": 18.154750054792213}, "timesteps_total": 5241740, "training_iteration": 46, "date": "2019-04-29_07-02-35", "timesteps_since_restore": 5241740, "episode_reward_max": 1019.8279745650271, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 774.033287908663, "iterations_since_restore": 46, "time_this_iter_s": 38.30974006652832, "info": {"grad_time_ms": 22549.471, "default": {"entropy": 1.3933618068695068, "kl": 0.016187766566872597, "cur_lr": 0.0005000000237487257, "vf_loss": 25.841341018676758, "vf_explained_var": 0.6960537433624268, "total_loss": 25.83280372619629, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.014001505449414253}, "num_steps_trained": 5241740, "load_time_ms": 20.297, "update_time_ms": 11.77, "sample_time_ms": 15158.971, "num_steps_sampled": 5241740}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41eb8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 38.662166334599505, "episodes_total": 2638, "episodes_this_iter": 69, "time_total_s": 1860.659863948822, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103710, "timestamp": 1556521395, "episode_len_mean": 687.14, "time_since_restore": 1900.3968741893768, "done": false, "custom_metrics": {"outflow_rate_min": 487.9519811681622, "outflow_rate_mean": 880.7550635308397, "cost2_mean": -50.988363937850835, "outflow_rate_max": 1112.4266570432244, "system_level_velocity_min": 8.991454195186197, "cost2_max": -17.276446948427836, "cost2_min": -132.52356161794228, "system_level_velocity_mean": 14.841573869859854, "cost1_min": 18.67212419848804, "cost1_max": 436.8147786650394, "cost1_mean": 373.1947634971709, "system_level_velocity_max": 18.07930672085764}, "timesteps_total": 5345450, "training_iteration": 47, "date": "2019-04-29_07-03-15", "timesteps_since_restore": 5345450, "episode_reward_max": 1012.2790519518078, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 742.1301027140347, "iterations_since_restore": 47, "time_this_iter_s": 39.73701024055481, "info": {"grad_time_ms": 22509.945, "default": {"entropy": 1.3909194469451904, "kl": 0.015420056879520416, "cur_lr": 0.0005000000237487257, "vf_loss": 26.811716079711914, "vf_explained_var": 0.6917169094085693, "total_loss": 26.80288314819336, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014037766493856907}, "num_steps_trained": 5345450, "load_time_ms": 20.834, "update_time_ms": 11.788, "sample_time_ms": 15288.823, "num_steps_sampled": 5345450}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbc88>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 38.662166334599505, "episodes_total": 2719, "episodes_this_iter": 81, "time_total_s": 1900.3968741893768, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103784, "timestamp": 1556521433, "episode_len_mean": 684.42, "time_since_restore": 1938.5904712677002, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 868.9777174772271, "cost2_mean": -49.229605439134495, "outflow_rate_max": 1084.654100464925, "system_level_velocity_min": 10.097671221123958, "cost2_max": -13.093970968233187, "cost2_min": -117.99631481216576, "system_level_velocity_mean": 14.89987721728532, "cost1_min": 11.645698781199908, "cost1_max": 433.51881386843206, "cost1_mean": 372.1700357120497, "system_level_velocity_max": 17.70883467653482}, "timesteps_total": 5449234, "training_iteration": 48, "date": "2019-04-29_07-03-53", "timesteps_since_restore": 5449234, "episode_reward_max": 1019.7655535906671, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 727.205550889559, "iterations_since_restore": 48, "time_this_iter_s": 38.193597078323364, "info": {"grad_time_ms": 22310.318, "default": {"entropy": 1.3867015838623047, "kl": 0.016589203849434853, "cur_lr": 0.0005000000237487257, "vf_loss": 29.411727905273438, "vf_explained_var": 0.6877637505531311, "total_loss": 29.402502059936523, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014823004603385925}, "num_steps_trained": 5449234, "load_time_ms": 20.095, "update_time_ms": 11.821, "sample_time_ms": 15359.05, "num_steps_sampled": 5449234}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d416a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41908>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 26.661439433406148, "episodes_total": 2798, "episodes_this_iter": 79, "time_total_s": 1938.5904712677002, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103177, "timestamp": 1556521471, "episode_len_mean": 686.02, "time_since_restore": 1976.1468920707703, "done": false, "custom_metrics": {"outflow_rate_min": 485.8629864444024, "outflow_rate_mean": 881.3435018507058, "cost2_mean": -49.4168063488613, "outflow_rate_max": 1119.7095092114453, "system_level_velocity_min": 10.58955551967821, "cost2_max": -16.17234269991583, "cost2_min": -124.41342784440127, "system_level_velocity_mean": 15.153818049947633, "cost1_min": 17.159713605426248, "cost1_max": 430.06800344819374, "cost1_mean": 378.9810092272101, "system_level_velocity_max": 18.38191897917018}, "timesteps_total": 5552411, "training_iteration": 49, "date": "2019-04-29_07-04-31", "timesteps_since_restore": 5552411, "episode_reward_max": 982.1817199797439, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 744.1905948361466, "iterations_since_restore": 49, "time_this_iter_s": 37.55642080307007, "info": {"grad_time_ms": 22269.711, "default": {"entropy": 1.398000717163086, "kl": 0.016291029751300812, "cur_lr": 0.0005000000237487257, "vf_loss": 25.59115982055664, "vf_explained_var": 0.6778023838996887, "total_loss": 25.582075119018555, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.014582096599042416}, "num_steps_trained": 5552411, "load_time_ms": 19.666, "update_time_ms": 11.428, "sample_time_ms": 15329.592, "num_steps_sampled": 5552411}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbef0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 35.45747137671341, "episodes_total": 2872, "episodes_this_iter": 74, "time_total_s": 1976.1468920707703, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103367, "timestamp": 1556521508, "episode_len_mean": 682.1, "time_since_restore": 2014.0332114696503, "done": false, "custom_metrics": {"outflow_rate_min": 482.093396169334, "outflow_rate_mean": 898.2565333192068, "cost2_mean": -53.85748200025777, "outflow_rate_max": 1200.7818566199105, "system_level_velocity_min": 10.58955551967821, "cost2_max": -15.376258454071948, "cost2_min": -124.41342784440127, "system_level_velocity_mean": 15.137499210948198, "cost1_min": 16.071079655727488, "cost1_max": 451.45871606616714, "cost1_mean": 375.81979054666044, "system_level_velocity_max": 18.036388465621652}, "timesteps_total": 5655778, "training_iteration": 50, "date": "2019-04-29_07-05-08", "timesteps_since_restore": 5655778, "episode_reward_max": 997.8089560459432, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 753.4936395067957, "iterations_since_restore": 50, "time_this_iter_s": 37.886319398880005, "info": {"grad_time_ms": 22235.263, "default": {"entropy": 1.3927067518234253, "kl": 0.016723789274692535, "cur_lr": 0.0005000000237487257, "vf_loss": 25.936363220214844, "vf_explained_var": 0.6663101315498352, "total_loss": 25.927173614501953, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014833060093224049}, "num_steps_trained": 5655778, "load_time_ms": 19.881, "update_time_ms": 11.341, "sample_time_ms": 15386.546, "num_steps_sampled": 5655778}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41fd0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 38.316358805382585, "episodes_total": 2940, "episodes_this_iter": 68, "time_total_s": 2014.0332114696503, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102775, "timestamp": 1556521546, "episode_len_mean": 687.27, "time_since_restore": 2051.44154214859, "done": false, "custom_metrics": {"outflow_rate_min": 439.04893109694206, "outflow_rate_mean": 919.2690812285978, "cost2_mean": -53.38809842352674, "outflow_rate_max": 1119.6693166608643, "system_level_velocity_min": 10.376826081240713, "cost2_max": -19.1359291235689, "cost2_min": -112.66335933442556, "system_level_velocity_mean": 15.185674000375524, "cost1_min": 19.45426074323492, "cost1_max": 445.3289280688574, "cost1_mean": 381.14167558982297, "system_level_velocity_max": 18.24537569877426}, "timesteps_total": 5758553, "training_iteration": 51, "date": "2019-04-29_07-05-46", "timesteps_since_restore": 5758553, "episode_reward_max": 997.8089560459432, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 772.7850092991991, "iterations_since_restore": 51, "time_this_iter_s": 37.40833067893982, "info": {"grad_time_ms": 22069.6, "default": {"entropy": 1.408922553062439, "kl": 0.017306173220276833, "cur_lr": 0.0005000000237487257, "vf_loss": 27.828927993774414, "vf_explained_var": 0.6639717221260071, "total_loss": 27.820322036743164, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014446795918047428}, "num_steps_trained": 5758553, "load_time_ms": 19.566, "update_time_ms": 11.324, "sample_time_ms": 15348.242, "num_steps_sampled": 5758553}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2588>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 48.48584928224352, "episodes_total": 3007, "episodes_this_iter": 67, "time_total_s": 2051.44154214859, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104553, "timestamp": 1556521584, "episode_len_mean": 697.86, "time_since_restore": 2088.9435420036316, "done": false, "custom_metrics": {"outflow_rate_min": 701.3688676894519, "outflow_rate_mean": 917.042268586433, "cost2_mean": -52.60721737001001, "outflow_rate_max": 1115.0799633099216, "system_level_velocity_min": 10.376826081240713, "cost2_max": -28.116686223830197, "cost2_min": -119.04648379885265, "system_level_velocity_mean": 15.111546711368335, "cost1_min": 270.7574734818122, "cost1_max": 438.87460094245387, "cost1_mean": 385.96232179502147, "system_level_velocity_max": 18.018170879040934}, "timesteps_total": 5863106, "training_iteration": 52, "date": "2019-04-29_07-06-24", "timesteps_since_restore": 5863106, "episode_reward_max": 987.2502534883291, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 774.7391502170716, "iterations_since_restore": 52, "time_this_iter_s": 37.501999855041504, "info": {"grad_time_ms": 21987.906, "default": {"entropy": 1.425095558166504, "kl": 0.017390739172697067, "cur_lr": 0.0005000000237487257, "vf_loss": 26.044769287109375, "vf_explained_var": 0.6713885068893433, "total_loss": 26.034801483154297, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.015836350619792938}, "num_steps_trained": 5863106, "load_time_ms": 19.529, "update_time_ms": 10.969, "sample_time_ms": 15365.771, "num_steps_sampled": 5863106}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d418d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d417f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 438.72928400142547, "episodes_total": 3079, "episodes_this_iter": 72, "time_total_s": 2088.9435420036316, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104801, "timestamp": 1556521622, "episode_len_mean": 699.99, "time_since_restore": 2127.5922224521637, "done": false, "custom_metrics": {"outflow_rate_min": 710.193337384976, "outflow_rate_mean": 922.4510603320928, "cost2_mean": -53.679972798448546, "outflow_rate_max": 1167.6626897163935, "system_level_velocity_min": 9.123773482547048, "cost2_max": -25.76736924029395, "cost2_min": -133.9838893161319, "system_level_velocity_mean": 15.052792168152417, "cost1_min": 235.3036338431328, "cost1_max": 446.03754936520045, "cost1_mean": 385.8540398547873, "system_level_velocity_max": 18.018170879040934}, "timesteps_total": 5967907, "training_iteration": 53, "date": "2019-04-29_07-07-02", "timesteps_since_restore": 5967907, "episode_reward_max": 1005.0117406797324, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 777.9213216499095, "iterations_since_restore": 53, "time_this_iter_s": 38.648680448532104, "info": {"grad_time_ms": 22067.064, "default": {"entropy": 1.422387719154358, "kl": 0.017281029373407364, "cur_lr": 0.0005000000237487257, "vf_loss": 27.410764694213867, "vf_explained_var": 0.6692112684249878, "total_loss": 27.40131187438965, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01528317853808403}, "num_steps_trained": 5967907, "load_time_ms": 19.425, "update_time_ms": 10.942, "sample_time_ms": 15372.38, "num_steps_sampled": 5967907}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41be0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 568.64954606665, "episodes_total": 3153, "episodes_this_iter": 74, "time_total_s": 2127.5922224521637, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102711, "timestamp": 1556521660, "episode_len_mean": 693.24, "time_since_restore": 2165.1370239257812, "done": false, "custom_metrics": {"outflow_rate_min": 482.093396169334, "outflow_rate_mean": 925.1053454974826, "cost2_mean": -56.59892623341005, "outflow_rate_max": 1128.0525683811243, "system_level_velocity_min": 10.809318923975784, "cost2_max": -15.580152861397481, "cost2_min": -122.86574264488698, "system_level_velocity_mean": 14.94931082447951, "cost1_min": 15.989295389610348, "cost1_max": 446.03754936520045, "cost1_mean": 380.540306619792, "system_level_velocity_max": 17.87584834547943}, "timesteps_total": 6070618, "training_iteration": 54, "date": "2019-04-29_07-07-40", "timesteps_since_restore": 6070618, "episode_reward_max": 1005.0117406797324, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 783.3342017294594, "iterations_since_restore": 54, "time_this_iter_s": 37.544801473617554, "info": {"grad_time_ms": 22278.4, "default": {"entropy": 1.427999496459961, "kl": 0.01692361943423748, "cur_lr": 0.0005000000237487257, "vf_loss": 27.80401611328125, "vf_explained_var": 0.6727127432823181, "total_loss": 27.794578552246094, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.015148546546697617}, "num_steps_trained": 6070618, "load_time_ms": 19.671, "update_time_ms": 11.307, "sample_time_ms": 15375.449, "num_steps_sampled": 6070618}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871f3f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 38.04183633772404, "episodes_total": 3226, "episodes_this_iter": 73, "time_total_s": 2165.1370239257812, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104272, "timestamp": 1556521698, "episode_len_mean": 693.19, "time_since_restore": 2203.306146144867, "done": false, "custom_metrics": {"outflow_rate_min": 450.9267471876343, "outflow_rate_mean": 921.5671937682195, "cost2_mean": -54.57110828187299, "outflow_rate_max": 1132.4029004181793, "system_level_velocity_min": 10.573799850695591, "cost2_max": -14.691464591925733, "cost2_min": -139.13574794724101, "system_level_velocity_mean": 15.121776603781568, "cost1_min": 12.394084547145226, "cost1_max": 437.19435606118327, "cost1_mean": 384.02876308451414, "system_level_velocity_max": 17.579149583261344}, "timesteps_total": 6174890, "training_iteration": 55, "date": "2019-04-29_07-08-18", "timesteps_since_restore": 6174890, "episode_reward_max": 983.7709022119246, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 768.5346388620814, "iterations_since_restore": 55, "time_this_iter_s": 38.16912221908569, "info": {"grad_time_ms": 22382.653, "default": {"entropy": 1.4420937299728394, "kl": 0.01655847579240799, "cur_lr": 0.0005000000237487257, "vf_loss": 28.083120346069336, "vf_explained_var": 0.6756086349487305, "total_loss": 28.073902130126953, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01480619702488184}, "num_steps_trained": 6174890, "load_time_ms": 19.893, "update_time_ms": 11.349, "sample_time_ms": 15469.042, "num_steps_sampled": 6174890}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2d30>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 25.31480369163933, "episodes_total": 3295, "episodes_this_iter": 69, "time_total_s": 2203.306146144867, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104922, "timestamp": 1556521736, "episode_len_mean": 682.2, "time_since_restore": 2240.8452451229095, "done": false, "custom_metrics": {"outflow_rate_min": 450.9267471876343, "outflow_rate_mean": 921.5179702367261, "cost2_mean": -58.54191226163787, "outflow_rate_max": 1154.8238490851284, "system_level_velocity_min": 10.155286159224964, "cost2_max": -14.403199485012957, "cost2_min": -135.42353466420667, "system_level_velocity_mean": 14.907859185394125, "cost1_min": 12.394084547145226, "cost1_max": 437.19435606118327, "cost1_mean": 372.1147287389467, "system_level_velocity_max": 19.485904425545336}, "timesteps_total": 6279812, "training_iteration": 56, "date": "2019-04-29_07-08-56", "timesteps_since_restore": 6279812, "episode_reward_max": 998.6002139676136, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 780.28002619341, "iterations_since_restore": 56, "time_this_iter_s": 37.5390989780426, "info": {"grad_time_ms": 22304.169, "default": {"entropy": 1.4289882183074951, "kl": 0.016803868114948273, "cur_lr": 0.0005000000237487257, "vf_loss": 26.107166290283203, "vf_explained_var": 0.7355216145515442, "total_loss": 26.09769058227539, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015145864337682724}, "num_steps_trained": 6279812, "load_time_ms": 19.777, "update_time_ms": 11.453, "sample_time_ms": 15467.739, "num_steps_sampled": 6279812}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ef0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 25.31480369163933, "episodes_total": 3364, "episodes_this_iter": 69, "time_total_s": 2240.8452451229095, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103265, "timestamp": 1556521773, "episode_len_mean": 686.82, "time_since_restore": 2277.6329669952393, "done": false, "custom_metrics": {"outflow_rate_min": 503.26867819688556, "outflow_rate_mean": 930.0842089719459, "cost2_mean": -62.14811228157571, "outflow_rate_max": 1120.2911154685446, "system_level_velocity_min": 9.820415129177452, "cost2_max": -17.822948366434055, "cost2_min": -138.83463316611846, "system_level_velocity_mean": 14.878902192976, "cost1_min": 24.673090612480667, "cost1_max": 434.123093888296, "cost1_mean": 374.2198606003453, "system_level_velocity_max": 18.552627273347337}, "timesteps_total": 6383077, "training_iteration": 57, "date": "2019-04-29_07-09-33", "timesteps_since_restore": 6383077, "episode_reward_max": 1037.8461557316546, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 787.3433367014728, "iterations_since_restore": 57, "time_this_iter_s": 36.78772187232971, "info": {"grad_time_ms": 22121.639, "default": {"entropy": 1.4506349563598633, "kl": 0.01764286495745182, "cur_lr": 0.0005000000237487257, "vf_loss": 24.852275848388672, "vf_explained_var": 0.7058399319648743, "total_loss": 24.841520309448242, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.016711736097931862}, "num_steps_trained": 6383077, "load_time_ms": 18.99, "update_time_ms": 11.483, "sample_time_ms": 15354.829, "num_steps_sampled": 6383077}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b21d0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 58.40861063070132, "episodes_total": 3432, "episodes_this_iter": 68, "time_total_s": 2277.6329669952393, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105829, "timestamp": 1556521809, "episode_len_mean": 693.36, "time_since_restore": 2313.705825805664, "done": false, "custom_metrics": {"outflow_rate_min": 493.9611821471112, "outflow_rate_mean": 930.8846069559878, "cost2_mean": -62.195737247588134, "outflow_rate_max": 1118.4709820034755, "system_level_velocity_min": 10.09268769171452, "cost2_max": -20.377651680630013, "cost2_min": -126.01213714473289, "system_level_velocity_mean": 14.832994050076513, "cost1_min": 23.813623782965834, "cost1_max": 435.39219803739854, "cost1_mean": 377.5584204085832, "system_level_velocity_max": 17.69839013885543}, "timesteps_total": 6488906, "training_iteration": 58, "date": "2019-04-29_07-10-09", "timesteps_since_restore": 6488906, "episode_reward_max": 1037.8461557316546, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 792.0313284862725, "iterations_since_restore": 58, "time_this_iter_s": 36.072858810424805, "info": {"grad_time_ms": 21909.659, "default": {"entropy": 1.444136381149292, "kl": 0.017301123589277267, "cur_lr": 0.0005000000237487257, "vf_loss": 28.105792999267578, "vf_explained_var": 0.6923822164535522, "total_loss": 28.096954345703125, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014678874053061008}, "num_steps_trained": 6488906, "load_time_ms": 19.748, "update_time_ms": 11.363, "sample_time_ms": 15352.972, "num_steps_sampled": 6488906}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b25c0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 49.17654650130506, "episodes_total": 3504, "episodes_this_iter": 72, "time_total_s": 2313.705825805664, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105562, "timestamp": 1556521845, "episode_len_mean": 693.36, "time_since_restore": 2349.737900018692, "done": false, "custom_metrics": {"outflow_rate_min": 493.9611821471112, "outflow_rate_mean": 946.2369594890915, "cost2_mean": -64.14162495692996, "outflow_rate_max": 1141.796652714199, "system_level_velocity_min": 9.579289058578873, "cost2_max": -20.377651680630013, "cost2_min": -167.7431129125702, "system_level_velocity_mean": 14.70968002433648, "cost1_min": 23.813623782965834, "cost1_max": 452.81593352166897, "cost1_mean": 375.42905266019477, "system_level_velocity_max": 17.69839013885543}, "timesteps_total": 6594468, "training_iteration": 59, "date": "2019-04-29_07-10-45", "timesteps_since_restore": 6594468, "episode_reward_max": 1009.7161987601172, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 799.4420717561244, "iterations_since_restore": 59, "time_this_iter_s": 36.032074213027954, "info": {"grad_time_ms": 21796.891, "default": {"entropy": 1.4463527202606201, "kl": 0.01644284464418888, "cur_lr": 0.0005000000237487257, "vf_loss": 29.176292419433594, "vf_explained_var": 0.714542031288147, "total_loss": 29.167091369628906, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014752856455743313}, "num_steps_trained": 6594468, "load_time_ms": 19.824, "update_time_ms": 11.487, "sample_time_ms": 15312.327, "num_steps_sampled": 6594468}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2f28>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 49.17654650130506, "episodes_total": 3573, "episodes_this_iter": 69, "time_total_s": 2349.737900018692, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105423, "timestamp": 1556521884, "episode_len_mean": 693.29, "time_since_restore": 2388.4824390411377, "done": false, "custom_metrics": {"outflow_rate_min": 489.846591981012, "outflow_rate_mean": 940.1071738761041, "cost2_mean": -64.44157188081286, "outflow_rate_max": 1108.965413255471, "system_level_velocity_min": 9.579289058578873, "cost2_max": -17.98262556679358, "cost2_min": -153.08194487951914, "system_level_velocity_mean": 14.712359501455184, "cost1_min": 19.594494662328746, "cost1_max": 434.07295981626135, "cost1_mean": 375.0041289879605, "system_level_velocity_max": 18.325473413295867}, "timesteps_total": 6699891, "training_iteration": 60, "date": "2019-04-29_07-11-24", "timesteps_since_restore": 6699891, "episode_reward_max": 1009.7161987601172, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 798.6748957937485, "iterations_since_restore": 60, "time_this_iter_s": 38.74453902244568, "info": {"grad_time_ms": 21858.162, "default": {"entropy": 1.4596143960952759, "kl": 0.018060114234685898, "cur_lr": 0.0005000000237487257, "vf_loss": 28.968460083007812, "vf_explained_var": 0.7035831212997437, "total_loss": 28.95806884765625, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01648922823369503}, "num_steps_trained": 6699891, "load_time_ms": 19.39, "update_time_ms": 11.451, "sample_time_ms": 15339.661, "num_steps_sampled": 6699891}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 46.3233641021509, "episodes_total": 3640, "episodes_this_iter": 67, "time_total_s": 2388.4824390411377, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105122, "timestamp": 1556521922, "episode_len_mean": 690.49, "time_since_restore": 2426.819977760315, "done": false, "custom_metrics": {"outflow_rate_min": 459.89176419980913, "outflow_rate_mean": 942.0201700306948, "cost2_mean": -62.66847923822553, "outflow_rate_max": 1143.1790996960895, "system_level_velocity_min": 9.884646442447192, "cost2_max": -17.65780927087183, "cost2_min": -160.44128074956674, "system_level_velocity_mean": 14.745741029154761, "cost1_min": 16.473232098166967, "cost1_max": 442.7761216875432, "cost1_mean": 374.08483166504334, "system_level_velocity_max": 17.668833967843845}, "timesteps_total": 6805013, "training_iteration": 61, "date": "2019-04-29_07-12-02", "timesteps_since_restore": 6805013, "episode_reward_max": 1001.7102631605085, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 790.5339110863148, "iterations_since_restore": 61, "time_this_iter_s": 38.337538719177246, "info": {"grad_time_ms": 21950.823, "default": {"entropy": 1.4589285850524902, "kl": 0.018489578738808632, "cur_lr": 0.0005000000237487257, "vf_loss": 27.89995765686035, "vf_explained_var": 0.7070796489715576, "total_loss": 27.889326095581055, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.016871266067028046}, "num_steps_trained": 6805013, "load_time_ms": 19.393, "update_time_ms": 11.293, "sample_time_ms": 15341.496, "num_steps_sampled": 6805013}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b20f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2e80>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.59757419786904, "episodes_total": 3713, "episodes_this_iter": 73, "time_total_s": 2426.819977760315, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105677, "timestamp": 1556521959, "episode_len_mean": 686.2, "time_since_restore": 2463.754929304123, "done": false, "custom_metrics": {"outflow_rate_min": 459.89176419980913, "outflow_rate_mean": 940.5839635969248, "cost2_mean": -62.2290369442118, "outflow_rate_max": 1109.7228231029608, "system_level_velocity_min": 9.884646442447192, "cost2_max": -17.65780927087183, "cost2_min": -160.44128074956674, "system_level_velocity_mean": 14.531132569638793, "cost1_min": 16.473232098166967, "cost1_max": 437.93848917847663, "cost1_mean": 366.9060626507802, "system_level_velocity_max": 17.52373857035162}, "timesteps_total": 6910690, "training_iteration": 62, "date": "2019-04-29_07-12-39", "timesteps_since_restore": 6910690, "episode_reward_max": 981.849603375363, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 784.4547427257545, "iterations_since_restore": 62, "time_this_iter_s": 36.93495154380798, "info": {"grad_time_ms": 21876.513, "default": {"entropy": 1.4501320123672485, "kl": 0.017809631302952766, "cur_lr": 0.0005000000237487257, "vf_loss": 27.196979522705078, "vf_explained_var": 0.6880456805229187, "total_loss": 27.187177658081055, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.015811370685696602}, "num_steps_trained": 6910690, "load_time_ms": 19.724, "update_time_ms": 11.303, "sample_time_ms": 15358.532, "num_steps_sampled": 6910690}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d410b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.59757419786904, "episodes_total": 3775, "episodes_this_iter": 62, "time_total_s": 2463.754929304123, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106714, "timestamp": 1556521997, "episode_len_mean": 700.0, "time_since_restore": 2502.150090932846, "done": false, "custom_metrics": {"outflow_rate_min": 702.5297058948905, "outflow_rate_mean": 960.7181343537449, "cost2_mean": -67.44805119281295, "outflow_rate_max": 1113.0436146543286, "system_level_velocity_min": 10.048426057511213, "cost2_max": -25.988543026965527, "cost2_min": -152.93826311665651, "system_level_velocity_mean": 14.583428326568368, "cost1_min": 256.617305761686, "cost1_max": 432.6177379579735, "cost1_mean": 376.0302677891283, "system_level_velocity_max": 17.25364986898026}, "timesteps_total": 7017404, "training_iteration": 63, "date": "2019-04-29_07-13-17", "timesteps_since_restore": 7017404, "episode_reward_max": 993.9628699647991, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 816.3388297355554, "iterations_since_restore": 63, "time_this_iter_s": 38.395161628723145, "info": {"grad_time_ms": 21932.182, "default": {"entropy": 1.470631718635559, "kl": 0.01701917126774788, "cur_lr": 0.0005000000237487257, "vf_loss": 28.290225982666016, "vf_explained_var": 0.7056488990783691, "total_loss": 28.280536651611328, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.015432112850248814}, "num_steps_trained": 7017404, "load_time_ms": 19.535, "update_time_ms": 11.332, "sample_time_ms": 15280.141, "num_steps_sampled": 7017404}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 528.3473566891715, "episodes_total": 3839, "episodes_this_iter": 64, "time_total_s": 2502.150090932846, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106199, "timestamp": 1556522034, "episode_len_mean": 700.0, "time_since_restore": 2539.141216993332, "done": false, "custom_metrics": {"outflow_rate_min": 737.1347771841383, "outflow_rate_mean": 957.3104556138456, "cost2_mean": -69.12117421547306, "outflow_rate_max": 1156.9874429562608, "system_level_velocity_min": 8.64749915287412, "cost2_max": -25.957771657361373, "cost2_min": -144.53272951238102, "system_level_velocity_mean": 14.439540087816805, "cost1_min": 224.73097918310881, "cost1_max": 443.78466343126064, "cost1_mean": 372.87374190937606, "system_level_velocity_max": 17.710214685406537}, "timesteps_total": 7123603, "training_iteration": 64, "date": "2019-04-29_07-13-54", "timesteps_since_restore": 7123603, "episode_reward_max": 993.9628699647991, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 823.9852110156913, "iterations_since_restore": 64, "time_this_iter_s": 36.99112606048584, "info": {"grad_time_ms": 21897.198, "default": {"entropy": 1.4749828577041626, "kl": 0.017264770343899727, "cur_lr": 0.0005000000237487257, "vf_loss": 26.793209075927734, "vf_explained_var": 0.6888695955276489, "total_loss": 26.783784866333008, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015250112861394882}, "num_steps_trained": 7123603, "load_time_ms": 19.716, "update_time_ms": 10.998, "sample_time_ms": 15262.087, "num_steps_sampled": 7123603}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c50>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 528.3473566891715, "episodes_total": 3901, "episodes_this_iter": 62, "time_total_s": 2539.141216993332, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106848, "timestamp": 1556522073, "episode_len_mean": 679.9, "time_since_restore": 2577.7190701961517, "done": false, "custom_metrics": {"outflow_rate_min": 481.0028128682593, "outflow_rate_mean": 939.8209355472379, "cost2_mean": -64.94513686428255, "outflow_rate_max": 1131.6457295694167, "system_level_velocity_min": 8.64749915287412, "cost2_max": -15.903872713288623, "cost2_min": -148.41369181658388, "system_level_velocity_mean": 14.506116839966047, "cost1_min": 15.204873549145967, "cost1_max": 437.8908114010371, "cost1_mean": 361.6639551944148, "system_level_velocity_max": 18.06530555515974}, "timesteps_total": 7230451, "training_iteration": 65, "date": "2019-04-29_07-14-33", "timesteps_since_restore": 7230451, "episode_reward_max": 1004.8876834487426, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 796.0244000785023, "iterations_since_restore": 65, "time_this_iter_s": 38.577853202819824, "info": {"grad_time_ms": 21978.478, "default": {"entropy": 1.4959022998809814, "kl": 0.017772527411580086, "cur_lr": 0.0005000000237487257, "vf_loss": 29.018356323242188, "vf_explained_var": 0.7101186513900757, "total_loss": 29.008909225463867, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015442237257957458}, "num_steps_trained": 7230451, "load_time_ms": 19.701, "update_time_ms": 10.9, "sample_time_ms": 15222.292, "num_steps_sampled": 7230451}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b25c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b27b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2eb8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 35.585518517436604, "episodes_total": 3972, "episodes_this_iter": 71, "time_total_s": 2577.7190701961517, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106117, "timestamp": 1556522110, "episode_len_mean": 673.15, "time_since_restore": 2614.5455396175385, "done": false, "custom_metrics": {"outflow_rate_min": 459.15445055145744, "outflow_rate_mean": 943.7132236960389, "cost2_mean": -63.77430868100398, "outflow_rate_max": 1127.5379048077766, "system_level_velocity_min": 10.194268753233718, "cost2_max": -12.919775921757159, "cost2_min": -131.8899052981737, "system_level_velocity_mean": 14.595919015625638, "cost1_min": 11.452096696217133, "cost1_max": 433.55897501755123, "cost1_mean": 359.5503253233652, "system_level_velocity_max": 18.61352401395497}, "timesteps_total": 7336568, "training_iteration": 66, "date": "2019-04-29_07-15-10", "timesteps_since_restore": 7336568, "episode_reward_max": 1004.8876834487426, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 794.8515413594193, "iterations_since_restore": 66, "time_this_iter_s": 36.82646942138672, "info": {"grad_time_ms": 21918.702, "default": {"entropy": 1.481604814529419, "kl": 0.01754634641110897, "cur_lr": 0.0005000000237487257, "vf_loss": 29.982572555541992, "vf_explained_var": 0.6661466956138611, "total_loss": 29.973203659057617, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015293080359697342}, "num_steps_trained": 7336568, "load_time_ms": 19.71, "update_time_ms": 10.954, "sample_time_ms": 15213.042, "num_steps_sampled": 7336568}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d414e0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 23.075417712986695, "episodes_total": 4044, "episodes_this_iter": 72, "time_total_s": 2614.5455396175385, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106772, "timestamp": 1556522148, "episode_len_mean": 679.77, "time_since_restore": 2652.3315382003784, "done": false, "custom_metrics": {"outflow_rate_min": 459.15445055145744, "outflow_rate_mean": 959.5899130791418, "cost2_mean": -68.22145590709336, "outflow_rate_max": 1184.1338607097716, "system_level_velocity_min": 9.517807679284795, "cost2_max": -12.919775921757159, "cost2_min": -150.16990117713246, "system_level_velocity_mean": 14.536461591681544, "cost1_min": 11.452096696217133, "cost1_max": 433.55897501755123, "cost1_mean": 362.47556539196063, "system_level_velocity_max": 18.61352401395497}, "timesteps_total": 7443340, "training_iteration": 67, "date": "2019-04-29_07-15-48", "timesteps_since_restore": 7443340, "episode_reward_max": 1036.8190766288858, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 805.617786478454, "iterations_since_restore": 67, "time_this_iter_s": 37.785998582839966, "info": {"grad_time_ms": 21919.054, "default": {"entropy": 1.5069036483764648, "kl": 0.017015637829899788, "cur_lr": 0.0005000000237487257, "vf_loss": 28.31447982788086, "vf_explained_var": 0.7260757684707642, "total_loss": 28.303693771362305, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.016531137749552727}, "num_steps_trained": 7443340, "load_time_ms": 20.158, "update_time_ms": 10.85, "sample_time_ms": 15313.817, "num_steps_sampled": 7443340}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 23.075417712986695, "episodes_total": 4113, "episodes_this_iter": 69, "time_total_s": 2652.3315382003784, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107175, "timestamp": 1556522184, "episode_len_mean": 686.63, "time_since_restore": 2688.589146375656, "done": false, "custom_metrics": {"outflow_rate_min": 459.9727280552308, "outflow_rate_mean": 968.668894848364, "cost2_mean": -68.6339129365574, "outflow_rate_max": 1184.1338607097716, "system_level_velocity_min": 9.268896950943963, "cost2_max": -17.007392417527768, "cost2_min": -173.33921123251247, "system_level_velocity_mean": 14.441356567227487, "cost1_min": 16.173215200921597, "cost1_max": 436.05124327686747, "cost1_mean": 366.0541235454813, "system_level_velocity_max": 18.355360717173717}, "timesteps_total": 7550515, "training_iteration": 68, "date": "2019-04-29_07-16-24", "timesteps_since_restore": 7550515, "episode_reward_max": 999.478360896526, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 823.2086607251767, "iterations_since_restore": 68, "time_this_iter_s": 36.25760817527771, "info": {"grad_time_ms": 21939.21, "default": {"entropy": 1.4986649751663208, "kl": 0.018402481451630592, "cur_lr": 0.0005000000237487257, "vf_loss": 28.189199447631836, "vf_explained_var": 0.704109787940979, "total_loss": 28.1799259185791, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01548251323401928}, "num_steps_trained": 7550515, "load_time_ms": 20.264, "update_time_ms": 10.645, "sample_time_ms": 15312.461, "num_steps_sampled": 7550515}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c50>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 36.54699602238029, "episodes_total": 4180, "episodes_this_iter": 67, "time_total_s": 2688.589146375656, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106691, "timestamp": 1556522221, "episode_len_mean": 693.06, "time_since_restore": 2724.896285057068, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 982.8043871229285, "cost2_mean": -67.86477499966372, "outflow_rate_max": 1165.7718809740172, "system_level_velocity_min": 10.676502441703368, "cost2_max": -13.737819535934984, "cost2_min": -131.28818813736777, "system_level_velocity_mean": 14.502411375241538, "cost1_min": 12.314472213257165, "cost1_max": 436.05124327686747, "cost1_mean": 372.0017477307508, "system_level_velocity_max": 17.315423692431843}, "timesteps_total": 7657206, "training_iteration": 69, "date": "2019-04-29_07-17-01", "timesteps_since_restore": 7657206, "episode_reward_max": 1063.5742549343615, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 841.9348727186073, "iterations_since_restore": 69, "time_this_iter_s": 36.30713868141174, "info": {"grad_time_ms": 21930.683, "default": {"entropy": 1.486106276512146, "kl": 0.018842492252588272, "cur_lr": 0.0005000000237487257, "vf_loss": 26.83543586730957, "vf_explained_var": 0.743037760257721, "total_loss": 26.82686424255371, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014932272024452686}, "num_steps_trained": 7657206, "load_time_ms": 20.672, "update_time_ms": 10.564, "sample_time_ms": 15347.856, "num_steps_sampled": 7657206}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871f3ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b26d8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 28.58604099146905, "episodes_total": 4242, "episodes_this_iter": 62, "time_total_s": 2724.896285057068, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108043, "timestamp": 1556522259, "episode_len_mean": 686.66, "time_since_restore": 2763.0826954841614, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 972.1147629227172, "cost2_mean": -67.02761672501741, "outflow_rate_max": 1165.7718809740172, "system_level_velocity_min": 10.093151217463861, "cost2_max": -13.737819535934984, "cost2_min": -144.1964772995115, "system_level_velocity_mean": 14.473707155838756, "cost1_min": 12.314472213257165, "cost1_max": 437.88683834284626, "cost1_mean": 366.4679875774468, "system_level_velocity_max": 18.50250389837499}, "timesteps_total": 7765249, "training_iteration": 70, "date": "2019-04-29_07-17-39", "timesteps_since_restore": 7765249, "episode_reward_max": 1063.5742549343615, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 820.6941629923869, "iterations_since_restore": 70, "time_this_iter_s": 38.186410427093506, "info": {"grad_time_ms": 21839.801, "default": {"entropy": 1.497430682182312, "kl": 0.01803750917315483, "cur_lr": 0.0005000000237487257, "vf_loss": 28.399404525756836, "vf_explained_var": 0.7270395159721375, "total_loss": 28.389789581298828, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015702886506915092}, "num_steps_trained": 7765249, "load_time_ms": 21.148, "update_time_ms": 10.544, "sample_time_ms": 15381.559, "num_steps_sampled": 7765249}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b21d0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 28.58604099146905, "episodes_total": 4307, "episodes_this_iter": 65, "time_total_s": 2763.0826954841614, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108368, "timestamp": 1556522299, "episode_len_mean": 682.2, "time_since_restore": 2803.7044031620026, "done": false, "custom_metrics": {"outflow_rate_min": 493.3571373213481, "outflow_rate_mean": 979.2339984428161, "cost2_mean": -71.89384330392703, "outflow_rate_max": 1172.2483385083, "system_level_velocity_min": 10.093151217463861, "cost2_max": -17.528464322324623, "cost2_min": -144.1964772995115, "system_level_velocity_mean": 14.647968632268409, "cost1_min": 19.150128334628743, "cost1_max": 444.5087862260614, "cost1_mean": 366.19595464040185, "system_level_velocity_max": 18.50250389837499}, "timesteps_total": 7873617, "training_iteration": 71, "date": "2019-04-29_07-18-19", "timesteps_since_restore": 7873617, "episode_reward_max": 1054.2521933484384, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 822.319522217182, "iterations_since_restore": 71, "time_this_iter_s": 40.62170767784119, "info": {"grad_time_ms": 22110.804, "default": {"entropy": 1.5348798036575317, "kl": 0.017558841034770012, "cur_lr": 0.0005000000237487257, "vf_loss": 29.306407928466797, "vf_explained_var": 0.6893017888069153, "total_loss": 29.295637130737305, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01669563166797161}, "num_steps_trained": 7873617, "load_time_ms": 21.274, "update_time_ms": 10.553, "sample_time_ms": 15335.167, "num_steps_sampled": 7873617}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d413c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 41.22819653229104, "episodes_total": 4369, "episodes_this_iter": 62, "time_total_s": 2803.7044031620026, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106255, "timestamp": 1556522338, "episode_len_mean": 700.0, "time_since_restore": 2842.4941029548645, "done": false, "custom_metrics": {"outflow_rate_min": 820.1611062294221, "outflow_rate_mean": 992.7416482395408, "cost2_mean": -75.03260756591493, "outflow_rate_max": 1172.2483385083, "system_level_velocity_min": 9.80427296031736, "cost2_max": -38.48463717021629, "cost2_min": -156.99835338709332, "system_level_velocity_mean": 14.477527565107012, "cost1_min": 250.46420675454516, "cost1_max": 448.6202282082437, "cost1_mean": 374.3360865620213, "system_level_velocity_max": 17.52619499407634}, "timesteps_total": 7979872, "training_iteration": 72, "date": "2019-04-29_07-18-58", "timesteps_since_restore": 7979872, "episode_reward_max": 1054.2521933484384, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 854.7308373131555, "iterations_since_restore": 72, "time_this_iter_s": 38.78969979286194, "info": {"grad_time_ms": 22304.271, "default": {"entropy": 1.522250771522522, "kl": 0.018749166280031204, "cur_lr": 0.0005000000237487257, "vf_loss": 28.941640853881836, "vf_explained_var": 0.7173706889152527, "total_loss": 28.930906295776367, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.017064781859517097}, "num_steps_trained": 7979872, "load_time_ms": 21.502, "update_time_ms": 10.69, "sample_time_ms": 15328.527, "num_steps_sampled": 7979872}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 637.5021420125696, "episodes_total": 4437, "episodes_this_iter": 68, "time_total_s": 2842.4941029548645, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106999, "timestamp": 1556522378, "episode_len_mean": 694.81, "time_since_restore": 2882.119309902191, "done": false, "custom_metrics": {"outflow_rate_min": 767.2297411370524, "outflow_rate_mean": 975.583223135089, "cost2_mean": -72.70917795494942, "outflow_rate_max": 1143.6858924563821, "system_level_velocity_min": 9.80427296031736, "cost2_max": -35.97526451377213, "cost2_min": -156.99835338709332, "system_level_velocity_mean": 14.26994289980422, "cost1_min": 116.44645891100262, "cost1_max": 448.6202282082437, "cost1_mean": 366.08298488142236, "system_level_velocity_max": 17.738474904383732}, "timesteps_total": 8086871, "training_iteration": 73, "date": "2019-04-29_07-19-38", "timesteps_since_restore": 8086871, "episode_reward_max": 986.2383142783259, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 831.8633272058344, "iterations_since_restore": 73, "time_this_iter_s": 39.62520694732666, "info": {"grad_time_ms": 22372.728, "default": {"entropy": 1.5359113216400146, "kl": 0.018748031929135323, "cur_lr": 0.0005000000237487257, "vf_loss": 29.310863494873047, "vf_explained_var": 0.7185795307159424, "total_loss": 29.300870895385742, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01631750538945198}, "num_steps_trained": 8086871, "load_time_ms": 22.259, "update_time_ms": 10.664, "sample_time_ms": 15379.305, "num_steps_sampled": 8086871}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbf60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2240>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 251.3913389425326, "episodes_total": 4500, "episodes_this_iter": 63, "time_total_s": 2882.119309902191, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108206, "timestamp": 1556522418, "episode_len_mean": 694.81, "time_since_restore": 2921.72439289093, "done": false, "custom_metrics": {"outflow_rate_min": 767.2297411370524, "outflow_rate_mean": 971.6040907373083, "cost2_mean": -70.7369662397818, "outflow_rate_max": 1118.3837297212613, "system_level_velocity_min": 9.248698484762713, "cost2_max": -31.06250820373481, "cost2_min": -153.38269981468224, "system_level_velocity_mean": 14.239973362165788, "cost1_min": 116.44645891100262, "cost1_max": 436.2792398957893, "cost1_mean": 365.334211539206, "system_level_velocity_max": 17.738474904383732}, "timesteps_total": 8195077, "training_iteration": 74, "date": "2019-04-29_07-20-18", "timesteps_since_restore": 8195077, "episode_reward_max": 978.5890357959792, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 826.1222246452182, "iterations_since_restore": 74, "time_this_iter_s": 39.605082988739014, "info": {"grad_time_ms": 22530.905, "default": {"entropy": 1.561076283454895, "kl": 0.018596112728118896, "cur_lr": 0.0005000000237487257, "vf_loss": 27.628721237182617, "vf_explained_var": 0.7675918340682983, "total_loss": 27.618310928344727, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01668551005423069}, "num_steps_trained": 8195077, "load_time_ms": 22.392, "update_time_ms": 10.635, "sample_time_ms": 15478.875, "num_steps_sampled": 8195077}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb908>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 251.3913389425326, "episodes_total": 4565, "episodes_this_iter": 65, "time_total_s": 2921.72439289093, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105652, "timestamp": 1556522456, "episode_len_mean": 700.0, "time_since_restore": 2959.9321508407593, "done": false, "custom_metrics": {"outflow_rate_min": 792.3560690696384, "outflow_rate_mean": 964.1495391029462, "cost2_mean": -75.03251324032588, "outflow_rate_max": 1151.986105524064, "system_level_velocity_min": 9.248698484762713, "cost2_max": -31.06250820373481, "cost2_min": -153.38269981468224, "system_level_velocity_mean": 14.105341556131485, "cost1_min": 244.70115144219147, "cost1_max": 450.5812485175776, "cost1_mean": 363.88280335071926, "system_level_velocity_max": 17.55935460815325}, "timesteps_total": 8300729, "training_iteration": 75, "date": "2019-04-29_07-20-56", "timesteps_since_restore": 8300729, "episode_reward_max": 1009.5866183086844, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 824.5564771425736, "iterations_since_restore": 75, "time_this_iter_s": 38.2077579498291, "info": {"grad_time_ms": 22568.7, "default": {"entropy": 1.5415222644805908, "kl": 0.01889955811202526, "cur_lr": 0.0005000000237487257, "vf_loss": 27.43333625793457, "vf_explained_var": 0.7040300369262695, "total_loss": 27.422571182250977, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.017143698409199715}, "num_steps_trained": 8300729, "load_time_ms": 22.993, "update_time_ms": 10.882, "sample_time_ms": 15400.326, "num_steps_sampled": 8300729}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbf60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bba58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb128>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 642.8564538484593, "episodes_total": 4628, "episodes_this_iter": 63, "time_total_s": 2959.9321508407593, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106623, "timestamp": 1556522494, "episode_len_mean": 693.25, "time_since_restore": 2998.157873392105, "done": false, "custom_metrics": {"outflow_rate_min": 472.47706369188825, "outflow_rate_mean": 947.0492445270519, "cost2_mean": -65.28889670434954, "outflow_rate_max": 1151.986105524064, "system_level_velocity_min": 10.810870719769078, "cost2_max": -14.491936899477333, "cost2_min": -141.69749946526508, "system_level_velocity_mean": 14.355212279431955, "cost1_min": 16.267268649939904, "cost1_max": 450.5812485175776, "cost1_mean": 366.5927322290781, "system_level_velocity_max": 17.55935460815325}, "timesteps_total": 8407352, "training_iteration": 76, "date": "2019-04-29_07-21-34", "timesteps_since_restore": 8407352, "episode_reward_max": 1009.5866183086844, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 800.9545003668685, "iterations_since_restore": 76, "time_this_iter_s": 38.225722551345825, "info": {"grad_time_ms": 22699.747, "default": {"entropy": 1.5554860830307007, "kl": 0.017813783138990402, "cur_lr": 0.0005000000237487257, "vf_loss": 28.963930130004883, "vf_explained_var": 0.675585150718689, "total_loss": 28.95539665222168, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014546636492013931}, "num_steps_trained": 8407352, "load_time_ms": 23.337, "update_time_ms": 11.0, "sample_time_ms": 15408.715, "num_steps_sampled": 8407352}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 40.610593863341926, "episodes_total": 4695, "episodes_this_iter": 67, "time_total_s": 2998.157873392105, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107378, "timestamp": 1556522532, "episode_len_mean": 700.0, "time_since_restore": 3036.0733954906464, "done": false, "custom_metrics": {"outflow_rate_min": 701.9811961895058, "outflow_rate_mean": 961.401492258819, "cost2_mean": -65.13219103353768, "outflow_rate_max": 1146.955146423094, "system_level_velocity_min": 10.316626932620915, "cost2_max": -22.69568132199935, "cost2_min": -148.01639745872657, "system_level_velocity_mean": 14.471689874163017, "cost1_min": 261.13238290457264, "cost1_max": 438.74469740752215, "cost1_mean": 374.22609929472657, "system_level_velocity_max": 17.13496093313038}, "timesteps_total": 8514730, "training_iteration": 77, "date": "2019-04-29_07-22-12", "timesteps_since_restore": 8514730, "episode_reward_max": 989.8528011690748, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 817.5114238330078, "iterations_since_restore": 77, "time_this_iter_s": 37.91552209854126, "info": {"grad_time_ms": 22799.921, "default": {"entropy": 1.5616405010223389, "kl": 0.01767369918525219, "cur_lr": 0.0005000000237487257, "vf_loss": 27.44891357421875, "vf_explained_var": 0.7148122787475586, "total_loss": 27.44013214111328, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01474793441593647}, "num_steps_trained": 8514730, "load_time_ms": 23.306, "update_time_ms": 11.086, "sample_time_ms": 15318.981, "num_steps_sampled": 8514730}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb470>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 595.7116343825926, "episodes_total": 4759, "episodes_this_iter": 64, "time_total_s": 3036.0733954906464, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106557, "timestamp": 1556522571, "episode_len_mean": 700.0, "time_since_restore": 3075.045897245407, "done": false, "custom_metrics": {"outflow_rate_min": 701.9811961895058, "outflow_rate_mean": 949.5614239396235, "cost2_mean": -65.04399213469557, "outflow_rate_max": 1146.955146423094, "system_level_velocity_min": 10.023091728657533, "cost2_max": -22.69568132199935, "cost2_min": -148.01639745872657, "system_level_velocity_mean": 14.184811848270531, "cost1_min": 257.64315685753587, "cost1_max": 434.50525854588074, "cost1_mean": 367.0525714657608, "system_level_velocity_max": 17.342989498970855}, "timesteps_total": 8621287, "training_iteration": 78, "date": "2019-04-29_07-22-51", "timesteps_since_restore": 8621287, "episode_reward_max": 930.9045947217771, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 810.8918193073409, "iterations_since_restore": 78, "time_this_iter_s": 38.97250175476074, "info": {"grad_time_ms": 23090.8, "default": {"entropy": 1.5679399967193604, "kl": 0.01928231492638588, "cur_lr": 0.0005000000237487257, "vf_loss": 26.898143768310547, "vf_explained_var": 0.7136923670768738, "total_loss": 26.888751983642578, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.0159011073410511}, "num_steps_trained": 8621287, "load_time_ms": 23.766, "update_time_ms": 11.344, "sample_time_ms": 15295.967, "num_steps_sampled": 8621287}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d415f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 595.7116343825926, "episodes_total": 4823, "episodes_this_iter": 64, "time_total_s": 3075.045897245407, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106516, "timestamp": 1556522612, "episode_len_mean": 693.34, "time_since_restore": 3116.1318349838257, "done": false, "custom_metrics": {"outflow_rate_min": 497.96338035008074, "outflow_rate_mean": 941.4076754360982, "cost2_mean": -65.8914490718832, "outflow_rate_max": 1119.8691130871903, "system_level_velocity_min": 10.422324120080853, "cost2_max": -16.22538615594028, "cost2_min": -124.87963719058487, "system_level_velocity_mean": 14.177892160208906, "cost1_min": 21.772460654836138, "cost1_max": 433.7047644171495, "cost1_mean": 362.0516864196444, "system_level_velocity_max": 18.39564831943382}, "timesteps_total": 8727803, "training_iteration": 79, "date": "2019-04-29_07-23-32", "timesteps_since_restore": 8727803, "episode_reward_max": 969.7232546935421, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 804.4516766364097, "iterations_since_restore": 79, "time_this_iter_s": 41.08593773841858, "info": {"grad_time_ms": 23539.097, "default": {"entropy": 1.5622318983078003, "kl": 0.018795978277921677, "cur_lr": 0.0005000000237487257, "vf_loss": 27.383586883544922, "vf_explained_var": 0.7304738759994507, "total_loss": 27.373390197753906, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01654317043721676}, "num_steps_trained": 8727803, "load_time_ms": 22.994, "update_time_ms": 11.349, "sample_time_ms": 15328.524, "num_steps_sampled": 8727803}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe48>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 49.03286063593537, "episodes_total": 4891, "episodes_this_iter": 68, "time_total_s": 3116.1318349838257, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104888, "timestamp": 1556522650, "episode_len_mean": 693.43, "time_since_restore": 3153.351145505905, "done": false, "custom_metrics": {"outflow_rate_min": 537.1506484981597, "outflow_rate_mean": 960.0038234581226, "cost2_mean": -65.82294983299843, "outflow_rate_max": 1138.2751377190973, "system_level_velocity_min": 10.443070530929806, "cost2_max": -25.65813128421707, "cost2_min": -139.2186764004228, "system_level_velocity_mean": 14.479909281550599, "cost1_min": 28.545729954741297, "cost1_max": 436.53474864429774, "cost1_mean": 369.38037222997, "system_level_velocity_max": 18.142299090743627}, "timesteps_total": 8832691, "training_iteration": 80, "date": "2019-04-29_07-24-10", "timesteps_since_restore": 8832691, "episode_reward_max": 947.0429191248064, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 811.4874753462584, "iterations_since_restore": 80, "time_this_iter_s": 37.21931052207947, "info": {"grad_time_ms": 23473.876, "default": {"entropy": 1.5790112018585205, "kl": 0.01886100508272648, "cur_lr": 0.0005000000237487257, "vf_loss": 28.3234920501709, "vf_explained_var": 0.6406369805335999, "total_loss": 28.314117431640625, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015739690512418747}, "num_steps_trained": 8832691, "load_time_ms": 22.7, "update_time_ms": 11.383, "sample_time_ms": 15298.655, "num_steps_sampled": 8832691}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d412b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 55.53581805344834, "episodes_total": 4957, "episodes_this_iter": 66, "time_total_s": 3153.351145505905, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106074, "timestamp": 1556522688, "episode_len_mean": 693.51, "time_since_restore": 3191.5361227989197, "done": false, "custom_metrics": {"outflow_rate_min": 532.5453406950198, "outflow_rate_mean": 955.3627564125048, "cost2_mean": -61.152639772940574, "outflow_rate_max": 1111.8048964867396, "system_level_velocity_min": 10.852117200880478, "cost2_max": -27.859406701245586, "cost2_min": -139.2186764004228, "system_level_velocity_mean": 14.749671149816981, "cost1_min": 34.04446752403861, "cost1_max": 435.6521712151877, "cost1_mean": 375.5488650765107, "system_level_velocity_max": 18.705734491510228}, "timesteps_total": 8938765, "training_iteration": 81, "date": "2019-04-29_07-24-48", "timesteps_since_restore": 8938765, "episode_reward_max": 933.0126846050415, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 816.1617462331764, "iterations_since_restore": 81, "time_this_iter_s": 38.184977293014526, "info": {"grad_time_ms": 23187.098, "default": {"entropy": 1.5795549154281616, "kl": 0.018880754709243774, "cur_lr": 0.0005000000237487257, "vf_loss": 28.74085235595703, "vf_explained_var": 0.5826390981674194, "total_loss": 28.73076629638672, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01645779423415661}, "num_steps_trained": 8938765, "load_time_ms": 23.074, "update_time_ms": 11.372, "sample_time_ms": 15343.161, "num_steps_sampled": 8938765}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 68.47358278927518, "episodes_total": 5024, "episodes_this_iter": 67, "time_total_s": 3191.5361227989197, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106252, "timestamp": 1556522727, "episode_len_mean": 693.17, "time_since_restore": 3230.2864739894867, "done": false, "custom_metrics": {"outflow_rate_min": 427.4899087978455, "outflow_rate_mean": 964.6704005172959, "cost2_mean": -61.754067950748414, "outflow_rate_max": 1155.5481653768607, "system_level_velocity_min": 10.57953942251434, "cost2_max": -12.277922484329364, "cost2_min": -136.28565395999982, "system_level_velocity_mean": 14.848586194609425, "cost1_min": 10.942590012886043, "cost1_max": 439.76151027220334, "cost1_mean": 378.56099249062646, "system_level_velocity_max": 17.17338900274554}, "timesteps_total": 9045017, "training_iteration": 82, "date": "2019-04-29_07-25-27", "timesteps_since_restore": 9045017, "episode_reward_max": 994.0780731574571, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 818.8306300861985, "iterations_since_restore": 82, "time_this_iter_s": 38.75035119056702, "info": {"grad_time_ms": 23162.811, "default": {"entropy": 1.5850086212158203, "kl": 0.019597752019762993, "cur_lr": 0.0005000000237487257, "vf_loss": 29.400903701782227, "vf_explained_var": 0.6662900447845459, "total_loss": 29.390380859375, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.017138035967946053}, "num_steps_trained": 9045017, "load_time_ms": 23.16, "update_time_ms": 11.301, "sample_time_ms": 15361.432, "num_steps_sampled": 9045017}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 24.69284349488669, "episodes_total": 5093, "episodes_this_iter": 69, "time_total_s": 3230.2864739894867, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106194, "timestamp": 1556522763, "episode_len_mean": 693.19, "time_since_restore": 3266.6118955612183, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 949.6850163927907, "cost2_mean": -62.17952264763065, "outflow_rate_max": 1121.17665683163, "system_level_velocity_min": 9.837199417328822, "cost2_max": -13.491377283571357, "cost2_min": -117.35942272768577, "system_level_velocity_mean": 14.572123062041147, "cost1_min": 12.239550677466882, "cost1_max": 447.3534387885191, "cost1_mean": 371.546214489068, "system_level_velocity_max": 17.455622459509797}, "timesteps_total": 9151211, "training_iteration": 83, "date": "2019-04-29_07-26-03", "timesteps_since_restore": 9151211, "episode_reward_max": 1007.5027064405948, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 813.1702113255711, "iterations_since_restore": 83, "time_this_iter_s": 36.32542157173157, "info": {"grad_time_ms": 22920.8, "default": {"entropy": 1.6248095035552979, "kl": 0.018606454133987427, "cur_lr": 0.0005000000237487257, "vf_loss": 27.96291160583496, "vf_explained_var": 0.6747157573699951, "total_loss": 27.953195571899414, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015996053814888}, "num_steps_trained": 9151211, "load_time_ms": 22.597, "update_time_ms": 11.351, "sample_time_ms": 15275.74, "num_steps_sampled": 9151211}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbdd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb748>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 25.3124623909693, "episodes_total": 5160, "episodes_this_iter": 67, "time_total_s": 3266.6118955612183, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105464, "timestamp": 1556522802, "episode_len_mean": 673.27, "time_since_restore": 3305.354036092758, "done": false, "custom_metrics": {"outflow_rate_min": 517.0567433000954, "outflow_rate_mean": 908.4692500464636, "cost2_mean": -57.73199643079929, "outflow_rate_max": 1064.7137463980182, "system_level_velocity_min": 8.5286299502162, "cost2_max": -18.93327412137466, "cost2_min": -137.67895196043276, "system_level_velocity_mean": 14.396027978781717, "cost1_min": 28.725505484293194, "cost1_max": 437.11425735113045, "cost1_mean": 353.7499283644369, "system_level_velocity_max": 18.685821992821936}, "timesteps_total": 9256675, "training_iteration": 84, "date": "2019-04-29_07-26-42", "timesteps_since_restore": 9256675, "episode_reward_max": 992.8222606204504, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 764.0697175302956, "iterations_since_restore": 84, "time_this_iter_s": 38.74214053153992, "info": {"grad_time_ms": 22836.749, "default": {"entropy": 1.6189543008804321, "kl": 0.019780859351158142, "cur_lr": 0.0005000000237487257, "vf_loss": 28.727964401245117, "vf_explained_var": 0.6601424813270569, "total_loss": 28.71697425842285, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01766439899802208}, "num_steps_trained": 9256675, "load_time_ms": 22.612, "update_time_ms": 11.547, "sample_time_ms": 15272.797, "num_steps_sampled": 9256675}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41d68>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 62.874721458323, "episodes_total": 5233, "episodes_this_iter": 73, "time_total_s": 3305.354036092758, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105890, "timestamp": 1556522839, "episode_len_mean": 683.22, "time_since_restore": 3341.936889886856, "done": false, "custom_metrics": {"outflow_rate_min": 496.4347394101642, "outflow_rate_mean": 929.16987776854, "cost2_mean": -58.083541103020316, "outflow_rate_max": 1096.130958937298, "system_level_velocity_min": 8.5286299502162, "cost2_max": -18.785087454750126, "cost2_min": -137.8460263026385, "system_level_velocity_mean": 14.503911195025136, "cost1_min": 24.04465223908721, "cost1_max": 438.1038012610864, "cost1_mean": 363.51830801859666, "system_level_velocity_max": 18.347251359996623}, "timesteps_total": 9362565, "training_iteration": 85, "date": "2019-04-29_07-27-19", "timesteps_since_restore": 9362565, "episode_reward_max": 954.4821595614029, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 786.0660883833694, "iterations_since_restore": 85, "time_this_iter_s": 36.5828537940979, "info": {"grad_time_ms": 22614.821, "default": {"entropy": 1.628735065460205, "kl": 0.01936696469783783, "cur_lr": 0.0005000000237487257, "vf_loss": 28.27766227722168, "vf_explained_var": 0.6319224238395691, "total_loss": 28.267797470092773, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.016401102766394615}, "num_steps_trained": 9362565, "load_time_ms": 22.063, "update_time_ms": 11.371, "sample_time_ms": 15336.192, "num_steps_sampled": 9362565}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbeb8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 51.40548636746328, "episodes_total": 5300, "episodes_this_iter": 67, "time_total_s": 3341.936889886856, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105420, "timestamp": 1556522877, "episode_len_mean": 670.87, "time_since_restore": 3379.9701414108276, "done": false, "custom_metrics": {"outflow_rate_min": 464.32649368107076, "outflow_rate_mean": 910.0855247451473, "cost2_mean": -56.69245024347735, "outflow_rate_max": 1157.3120214580395, "system_level_velocity_min": 10.354597167636895, "cost2_max": -13.195524666988439, "cost2_min": -137.8460263026385, "system_level_velocity_mean": 14.55875151638844, "cost1_min": 11.774527000206392, "cost1_max": 440.72278783506476, "cost1_mean": 354.47160601798043, "system_level_velocity_max": 19.38609284630519}, "timesteps_total": 9467985, "training_iteration": 86, "date": "2019-04-29_07-27-57", "timesteps_since_restore": 9467985, "episode_reward_max": 983.6298982624648, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 757.4994033544253, "iterations_since_restore": 86, "time_this_iter_s": 38.03325152397156, "info": {"grad_time_ms": 22543.153, "default": {"entropy": 1.600939154624939, "kl": 0.019029023125767708, "cur_lr": 0.0005000000237487257, "vf_loss": 30.481870651245117, "vf_explained_var": 0.6197089552879333, "total_loss": 30.471059799194336, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.017235703766345978}, "num_steps_trained": 9467985, "load_time_ms": 21.957, "update_time_ms": 11.356, "sample_time_ms": 15388.722, "num_steps_sampled": 9467985}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41860>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 29.55411574989151, "episodes_total": 5373, "episodes_this_iter": 73, "time_total_s": 3379.9701414108276, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104532, "timestamp": 1556522915, "episode_len_mean": 684.26, "time_since_restore": 3418.3746156692505, "done": false, "custom_metrics": {"outflow_rate_min": 470.5008371641972, "outflow_rate_mean": 937.4905299680529, "cost2_mean": -56.78025507680371, "outflow_rate_max": 1157.3120214580395, "system_level_velocity_min": 9.996479231169499, "cost2_max": -13.485228772619655, "cost2_min": -118.9227964506297, "system_level_velocity_mean": 14.67816774502326, "cost1_min": 12.845390529522525, "cost1_max": 440.72278783506476, "cost1_mean": 367.91661639502547, "system_level_velocity_max": 19.38609284630519}, "timesteps_total": 9572517, "training_iteration": 87, "date": "2019-04-29_07-28-35", "timesteps_since_restore": 9572517, "episode_reward_max": 983.6298982624648, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 790.639045194309, "iterations_since_restore": 87, "time_this_iter_s": 38.40447425842285, "info": {"grad_time_ms": 22646.386, "default": {"entropy": 1.6109161376953125, "kl": 0.0199327040463686, "cur_lr": 0.0005000000237487257, "vf_loss": 28.39212417602539, "vf_explained_var": 0.6527891159057617, "total_loss": 28.382137298583984, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.016711929813027382}, "num_steps_trained": 9572517, "load_time_ms": 22.185, "update_time_ms": 11.198, "sample_time_ms": 15333.726, "num_steps_sampled": 9572517}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb748>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 27.17111312330244, "episodes_total": 5438, "episodes_this_iter": 65, "time_total_s": 3418.3746156692505, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104438, "timestamp": 1556522953, "episode_len_mean": 682.87, "time_since_restore": 3455.8149280548096, "done": false, "custom_metrics": {"outflow_rate_min": 470.5008371641972, "outflow_rate_mean": 926.7276275031384, "cost2_mean": -57.12391670057465, "outflow_rate_max": 1098.4106211084993, "system_level_velocity_min": 9.996479231169499, "cost2_max": -13.411455992123411, "cost2_min": -119.62999595844761, "system_level_velocity_mean": 14.654945744095999, "cost1_min": 12.845390529522525, "cost1_max": 444.55565422173197, "cost1_mean": 366.14046138406195, "system_level_velocity_max": 18.17641542540005}, "timesteps_total": 9676955, "training_iteration": 88, "date": "2019-04-29_07-29-13", "timesteps_since_restore": 9676955, "episode_reward_max": 989.163460150715, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 771.9073965467652, "iterations_since_restore": 88, "time_this_iter_s": 37.44031238555908, "info": {"grad_time_ms": 22498.855, "default": {"entropy": 1.6161288022994995, "kl": 0.020474225282669067, "cur_lr": 0.0005000000237487257, "vf_loss": 28.506759643554688, "vf_explained_var": 0.5696250200271606, "total_loss": 28.49589729309082, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.017772996798157692}, "num_steps_trained": 9676955, "load_time_ms": 22.406, "update_time_ms": 11.411, "sample_time_ms": 15327.545, "num_steps_sampled": 9676955}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41cc0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 27.17111312330244, "episodes_total": 5508, "episodes_this_iter": 70, "time_total_s": 3455.8149280548096, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104774, "timestamp": 1556522990, "episode_len_mean": 693.21, "time_since_restore": 3493.473595380783, "done": false, "custom_metrics": {"outflow_rate_min": 446.8176758061846, "outflow_rate_mean": 932.6094436698268, "cost2_mean": -56.86949461598641, "outflow_rate_max": 1133.4571312079086, "system_level_velocity_min": 10.875023243781932, "cost2_max": -13.850076812684812, "cost2_min": -107.93090086540502, "system_level_velocity_mean": 14.843036950621494, "cost1_min": 13.487549124467211, "cost1_max": 444.55565422173197, "cost1_mean": 377.0315943354454, "system_level_velocity_max": 17.662684210509205}, "timesteps_total": 9781729, "training_iteration": 89, "date": "2019-04-29_07-29-50", "timesteps_since_restore": 9781729, "episode_reward_max": 980.7134880288762, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 790.6383318376115, "iterations_since_restore": 89, "time_this_iter_s": 37.65866732597351, "info": {"grad_time_ms": 22171.46, "default": {"entropy": 1.621099591255188, "kl": 0.01506728958338499, "cur_lr": 0.0005000000237487257, "vf_loss": 29.955501556396484, "vf_explained_var": 0.6026853322982788, "total_loss": 29.947710037231445, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015420797280967236}, "num_steps_trained": 9781729, "load_time_ms": 23.326, "update_time_ms": 11.544, "sample_time_ms": 15309.838, "num_steps_sampled": 9781729}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193f28>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.68881046112641, "episodes_total": 5582, "episodes_this_iter": 74, "time_total_s": 3493.473595380783, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104361, "timestamp": 1556523029, "episode_len_mean": 686.56, "time_since_restore": 3532.4157745838165, "done": false, "custom_metrics": {"outflow_rate_min": 446.8176758061846, "outflow_rate_mean": 925.5908197483473, "cost2_mean": -58.366423940808936, "outflow_rate_max": 1111.4222303324416, "system_level_velocity_min": 9.655646128546485, "cost2_max": -13.850076812684812, "cost2_min": -116.25069850001381, "system_level_velocity_mean": 14.569990288192855, "cost1_min": 13.487549124467211, "cost1_max": 440.01935888999407, "cost1_mean": 366.29697337585065, "system_level_velocity_max": 18.278212438952856}, "timesteps_total": 9886090, "training_iteration": 90, "date": "2019-04-29_07-30-29", "timesteps_since_restore": 9886090, "episode_reward_max": 970.4997035313554, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 776.7458748775877, "iterations_since_restore": 90, "time_this_iter_s": 38.94217920303345, "info": {"grad_time_ms": 22346.813, "default": {"entropy": 1.666525959968567, "kl": 0.014962660148739815, "cur_lr": 0.0005000000237487257, "vf_loss": 28.116252899169922, "vf_explained_var": 0.6491374373435974, "total_loss": 28.10715103149414, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016674194484949112}, "num_steps_trained": 9886090, "load_time_ms": 23.449, "update_time_ms": 11.588, "sample_time_ms": 15304.81, "num_steps_sampled": 9886090}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d410f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41358>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.68881046112641, "episodes_total": 5649, "episodes_this_iter": 67, "time_total_s": 3532.4157745838165, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104290, "timestamp": 1556523067, "episode_len_mean": 690.91, "time_since_restore": 3570.359549999237, "done": false, "custom_metrics": {"outflow_rate_min": 459.0990897381932, "outflow_rate_mean": 919.5737649002741, "cost2_mean": -56.365106128581125, "outflow_rate_max": 1110.654658178124, "system_level_velocity_min": 10.132261091600792, "cost2_max": -17.694311981457318, "cost2_min": -117.12925744386087, "system_level_velocity_mean": 14.58514859586883, "cost1_min": 18.180465824383024, "cost1_max": 440.88891751186975, "cost1_mean": 368.7204905582896, "system_level_velocity_max": 18.74044941828951}, "timesteps_total": 9990380, "training_iteration": 91, "date": "2019-04-29_07-31-07", "timesteps_since_restore": 9990380, "episode_reward_max": 952.0187157829243, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 774.2716373912148, "iterations_since_restore": 91, "time_this_iter_s": 37.94377541542053, "info": {"grad_time_ms": 22317.878, "default": {"entropy": 1.6533430814743042, "kl": 0.014880883507430553, "cur_lr": 0.0005000000237487257, "vf_loss": 29.2097110748291, "vf_explained_var": 0.6181751489639282, "total_loss": 29.20203971862793, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015201719477772713}, "num_steps_trained": 9990380, "load_time_ms": 23.29, "update_time_ms": 11.538, "sample_time_ms": 15310.714, "num_steps_sampled": 9990380}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 46.905791261109115, "episodes_total": 5724, "episodes_this_iter": 75, "time_total_s": 3570.359549999237, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104039, "timestamp": 1556523105, "episode_len_mean": 697.95, "time_since_restore": 3608.2890119552612, "done": false, "custom_metrics": {"outflow_rate_min": 717.7859615920232, "outflow_rate_mean": 928.7779928460003, "cost2_mean": -55.74288424198473, "outflow_rate_max": 1127.9159623102498, "system_level_velocity_min": 10.413059316829875, "cost2_max": -21.131482401827075, "cost2_min": -117.12925744386087, "system_level_velocity_mean": 14.629640461623222, "cost1_min": 237.70493106954484, "cost1_max": 449.6239259623515, "cost1_mean": 375.371745514914, "system_level_velocity_max": 17.612760505623}, "timesteps_total": 10094419, "training_iteration": 92, "date": "2019-04-29_07-31-45", "timesteps_since_restore": 10094419, "episode_reward_max": 971.6599334976886, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 785.7440962630347, "iterations_since_restore": 92, "time_this_iter_s": 37.92946195602417, "info": {"grad_time_ms": 22248.975, "default": {"entropy": 1.6528130769729614, "kl": 0.014739247970283031, "cur_lr": 0.0005000000237487257, "vf_loss": 25.873729705810547, "vf_explained_var": 0.617729127407074, "total_loss": 25.864397048950195, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016793739050626755}, "num_steps_trained": 10094419, "load_time_ms": 23.371, "update_time_ms": 11.735, "sample_time_ms": 15299.803, "num_steps_sampled": 10094419}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41198>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 437.5564620224005, "episodes_total": 5790, "episodes_this_iter": 66, "time_total_s": 3608.2890119552612, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104205, "timestamp": 1556523143, "episode_len_mean": 686.37, "time_since_restore": 3646.293298482895, "done": false, "custom_metrics": {"outflow_rate_min": 455.34447721462936, "outflow_rate_mean": 911.5097799829828, "cost2_mean": -53.340058170792275, "outflow_rate_max": 1127.9159623102498, "system_level_velocity_min": 10.02897101571069, "cost2_max": -13.186439977844909, "cost2_min": -105.7823718120206, "system_level_velocity_mean": 14.531512898481092, "cost1_min": 11.70059659988879, "cost1_max": 449.6239259623515, "cost1_mean": 365.4798599709574, "system_level_velocity_max": 17.605442704240005}, "timesteps_total": 10198624, "training_iteration": 93, "date": "2019-04-29_07-32-23", "timesteps_since_restore": 10198624, "episode_reward_max": 985.7485653267876, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 762.8760283462526, "iterations_since_restore": 93, "time_this_iter_s": 38.00428652763367, "info": {"grad_time_ms": 22362.264, "default": {"entropy": 1.661739706993103, "kl": 0.015359810553491116, "cur_lr": 0.0005000000237487257, "vf_loss": 28.121408462524414, "vf_explained_var": 0.641168475151062, "total_loss": 28.112756729125977, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016428904607892036}, "num_steps_trained": 10198624, "load_time_ms": 23.226, "update_time_ms": 11.763, "sample_time_ms": 15352.891, "num_steps_sampled": 10198624}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 26.607737535999824, "episodes_total": 5860, "episodes_this_iter": 70, "time_total_s": 3646.293298482895, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104086, "timestamp": 1556523181, "episode_len_mean": 692.28, "time_since_restore": 3684.2277987003326, "done": false, "custom_metrics": {"outflow_rate_min": 519.4160618927161, "outflow_rate_mean": 925.3528036902112, "cost2_mean": -54.40686159785967, "outflow_rate_max": 1120.141299672465, "system_level_velocity_min": 10.465165507652586, "cost2_max": -18.324280912718347, "cost2_min": -95.66305705426228, "system_level_velocity_mean": 14.949797597330736, "cost1_min": 26.505312550315505, "cost1_max": 446.731304531064, "cost1_mean": 377.3263309046831, "system_level_velocity_max": 18.452642045534876}, "timesteps_total": 10302710, "training_iteration": 94, "date": "2019-04-29_07-33-01", "timesteps_since_restore": 10302710, "episode_reward_max": 937.9042022804654, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 777.8937384500376, "iterations_since_restore": 94, "time_this_iter_s": 37.934500217437744, "info": {"grad_time_ms": 22331.033, "default": {"entropy": 1.6788723468780518, "kl": 0.014466186054050922, "cur_lr": 0.0005000000237487257, "vf_loss": 28.105405807495117, "vf_explained_var": 0.6397685408592224, "total_loss": 28.09671401977539, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01601431518793106}, "num_steps_trained": 10302710, "load_time_ms": 23.131, "update_time_ms": 11.657, "sample_time_ms": 15304.458, "num_steps_sampled": 10302710}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d416a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41320>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 54.82461291977283, "episodes_total": 5932, "episodes_this_iter": 72, "time_total_s": 3684.2277987003326, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105638, "timestamp": 1556523219, "episode_len_mean": 700.0, "time_since_restore": 3721.2321467399597, "done": false, "custom_metrics": {"outflow_rate_min": 717.8365524767092, "outflow_rate_mean": 916.2290243689548, "cost2_mean": -57.22833647269263, "outflow_rate_max": 1135.8189115503442, "system_level_velocity_min": 9.416291935084933, "cost2_max": -27.234099026438606, "cost2_min": -97.72600401987646, "system_level_velocity_mean": 14.524175608940613, "cost1_min": 252.2655183869886, "cost1_max": 446.731304531064, "cost1_mean": 372.3088575501653, "system_level_velocity_max": 17.514228023100593}, "timesteps_total": 10408348, "training_iteration": 95, "date": "2019-04-29_07-33-39", "timesteps_since_restore": 10408348, "episode_reward_max": 992.0592332543628, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 782.1011742910417, "iterations_since_restore": 95, "time_this_iter_s": 37.004348039627075, "info": {"grad_time_ms": 22465.687, "default": {"entropy": 1.6966062784194946, "kl": 0.014467306435108185, "cur_lr": 0.0005000000237487257, "vf_loss": 27.019981384277344, "vf_explained_var": 0.6705160737037659, "total_loss": 27.011249542236328, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016054324805736542}, "num_steps_trained": 10408348, "load_time_ms": 23.394, "update_time_ms": 11.647, "sample_time_ms": 15211.575, "num_steps_sampled": 10408348}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d413c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41390>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 617.2764576740514, "episodes_total": 5998, "episodes_this_iter": 66, "time_total_s": 3721.2321467399597, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105618, "timestamp": 1556523257, "episode_len_mean": 689.98, "time_since_restore": 3759.9677307605743, "done": false, "custom_metrics": {"outflow_rate_min": 712.4868695989272, "outflow_rate_mean": 917.2848649720884, "cost2_mean": -57.90585415402454, "outflow_rate_max": 1135.8189115503442, "system_level_velocity_min": 9.416291935084933, "cost2_max": -26.614636847914852, "cost2_min": -126.3123134608577, "system_level_velocity_mean": 14.20801059013363, "cost1_min": 118.3242433700822, "cost1_max": 437.4039645419233, "cost1_mean": 360.0127903454083, "system_level_velocity_max": 17.301967612181404}, "timesteps_total": 10513966, "training_iteration": 96, "date": "2019-04-29_07-34-17", "timesteps_since_restore": 10513966, "episode_reward_max": 985.6454259717341, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 774.6521729468955, "iterations_since_restore": 96, "time_this_iter_s": 38.735584020614624, "info": {"grad_time_ms": 22569.528, "default": {"entropy": 1.6869049072265625, "kl": 0.014913132414221764, "cur_lr": 0.0005000000237487257, "vf_loss": 25.130046844482422, "vf_explained_var": 0.6550454497337341, "total_loss": 25.121356964111328, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01624120958149433}, "num_steps_trained": 10513966, "load_time_ms": 22.56, "update_time_ms": 11.579, "sample_time_ms": 15179.357, "num_steps_sampled": 10513966}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41d68>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 224.1971815770124, "episodes_total": 6067, "episodes_this_iter": 69, "time_total_s": 3759.9677307605743, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105059, "timestamp": 1556523296, "episode_len_mean": 688.29, "time_since_restore": 3798.3105280399323, "done": false, "custom_metrics": {"outflow_rate_min": 501.8032230195665, "outflow_rate_mean": 934.7280092840981, "cost2_mean": -60.33024924852242, "outflow_rate_max": 1152.3616484895515, "system_level_velocity_min": 9.434336929694709, "cost2_max": -18.672519941402903, "cost2_min": -111.48772704747111, "system_level_velocity_mean": 14.49399013733299, "cost1_min": 20.981131596745954, "cost1_max": 442.9829796445581, "cost1_mean": 365.3351907720816, "system_level_velocity_max": 19.116954411149237}, "timesteps_total": 10619025, "training_iteration": 97, "date": "2019-04-29_07-34-56", "timesteps_since_restore": 10619025, "episode_reward_max": 993.9077876725607, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 788.7749248945031, "iterations_since_restore": 97, "time_this_iter_s": 38.34279727935791, "info": {"grad_time_ms": 22477.006, "default": {"entropy": 1.692427158355713, "kl": 0.01446575578302145, "cur_lr": 0.0005000000237487257, "vf_loss": 26.198320388793945, "vf_explained_var": 0.64445561170578, "total_loss": 26.189733505249023, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015909787267446518}, "num_steps_trained": 10619025, "load_time_ms": 22.095, "update_time_ms": 11.728, "sample_time_ms": 15267.573, "num_steps_sampled": 10619025}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193da0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 48.15405140674415, "episodes_total": 6133, "episodes_this_iter": 66, "time_total_s": 3798.3105280399323, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104263, "timestamp": 1556523333, "episode_len_mean": 679.84, "time_since_restore": 3835.621992111206, "done": false, "custom_metrics": {"outflow_rate_min": 473.23710656994973, "outflow_rate_mean": 939.3713299347246, "cost2_mean": -58.20497482881432, "outflow_rate_max": 1152.3616484895515, "system_level_velocity_min": 10.62686752452326, "cost2_max": -16.859813397558792, "cost2_min": -118.98986463045867, "system_level_velocity_mean": 14.956609161065714, "cost1_min": 15.985175062318337, "cost1_max": 450.17678743771364, "cost1_mean": 370.2437583429946, "system_level_velocity_max": 19.116954411149237}, "timesteps_total": 10723288, "training_iteration": 98, "date": "2019-04-29_07-35-33", "timesteps_since_restore": 10723288, "episode_reward_max": 993.9077876725607, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 782.6153165667641, "iterations_since_restore": 98, "time_this_iter_s": 37.311464071273804, "info": {"grad_time_ms": 22480.907, "default": {"entropy": 1.6897660493850708, "kl": 0.014724787324666977, "cur_lr": 0.0005000000237487257, "vf_loss": 28.78520393371582, "vf_explained_var": 0.6292448043823242, "total_loss": 28.77686882019043, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015790250152349472}, "num_steps_trained": 10723288, "load_time_ms": 22.162, "update_time_ms": 11.448, "sample_time_ms": 15251.375, "num_steps_sampled": 10723288}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b00>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 38.39797133362229, "episodes_total": 6205, "episodes_this_iter": 72, "time_total_s": 3835.621992111206, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104242, "timestamp": 1556523369, "episode_len_mean": 688.83, "time_since_restore": 3871.5680792331696, "done": false, "custom_metrics": {"outflow_rate_min": 473.23710656994973, "outflow_rate_mean": 917.9278265237039, "cost2_mean": -55.54735712783612, "outflow_rate_max": 1106.661687929367, "system_level_velocity_min": 9.813405111925187, "cost2_max": -16.99635132505029, "cost2_min": -112.06809804637979, "system_level_velocity_mean": 14.871246349581803, "cost1_min": 15.985175062318337, "cost1_max": 437.25777597381386, "cost1_mean": 374.1229760056183, "system_level_velocity_max": 17.72067694977232}, "timesteps_total": 10827530, "training_iteration": 99, "date": "2019-04-29_07-36-09", "timesteps_since_restore": 10827530, "episode_reward_max": 994.6524394174961, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 777.7914962433626, "iterations_since_restore": 99, "time_this_iter_s": 35.9460871219635, "info": {"grad_time_ms": 22259.967, "default": {"entropy": 1.6691858768463135, "kl": 0.015665823593735695, "cur_lr": 0.0005000000237487257, "vf_loss": 26.783517837524414, "vf_explained_var": 0.6142659783363342, "total_loss": 26.773874282836914, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017574874684214592}, "num_steps_trained": 10827530, "load_time_ms": 21.206, "update_time_ms": 11.512, "sample_time_ms": 15301.774, "num_steps_sampled": 10827530}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41828>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 38.39797133362229, "episodes_total": 6279, "episodes_this_iter": 74, "time_total_s": 3871.5680792331696, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105263, "timestamp": 1556523406, "episode_len_mean": 689.97, "time_since_restore": 3908.2758433818817, "done": false, "custom_metrics": {"outflow_rate_min": 731.4259750924139, "outflow_rate_mean": 938.8185821152251, "cost2_mean": -58.4652358489648, "outflow_rate_max": 1109.658278135417, "system_level_velocity_min": 9.966041555448166, "cost2_max": -29.839212907763432, "cost2_min": -135.50842361591674, "system_level_velocity_mean": 14.960518395657045, "cost1_min": 90.9560662163165, "cost1_max": 439.1238936283907, "cost1_mean": 376.5757608132359, "system_level_velocity_max": 18.018135372478294}, "timesteps_total": 10932793, "training_iteration": 100, "date": "2019-04-29_07-36-46", "timesteps_since_restore": 10932793, "episode_reward_max": 947.7918412666347, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 786.8918233744133, "iterations_since_restore": 100, "time_this_iter_s": 36.70776414871216, "info": {"grad_time_ms": 22027.969, "default": {"entropy": 1.6969131231307983, "kl": 0.014904575422406197, "cur_lr": 0.0005000000237487257, "vf_loss": 29.377178192138672, "vf_explained_var": 0.6564682722091675, "total_loss": 29.36783790588379, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016885755583643913}, "num_steps_trained": 10932793, "load_time_ms": 20.978, "update_time_ms": 11.558, "sample_time_ms": 15311.226, "num_steps_sampled": 10932793}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41d68>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 184.39259682516882, "episodes_total": 6349, "episodes_this_iter": 70, "time_total_s": 3908.2758433818817, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103851, "timestamp": 1556523443, "episode_len_mean": 697.16, "time_since_restore": 3945.8086137771606, "done": false, "custom_metrics": {"outflow_rate_min": 715.6669749090855, "outflow_rate_mean": 944.1334300681488, "cost2_mean": -60.33096945171965, "outflow_rate_max": 1200.954465595634, "system_level_velocity_min": 9.966041555448166, "cost2_max": -21.04794076744105, "cost2_min": -135.50842361591674, "system_level_velocity_mean": 14.754080530927673, "cost1_min": 220.77095595156896, "cost1_max": 446.1868709928094, "cost1_mean": 377.23720722756536, "system_level_velocity_max": 17.70594626364699}, "timesteps_total": 11036644, "training_iteration": 101, "date": "2019-04-29_07-37-23", "timesteps_since_restore": 11036644, "episode_reward_max": 977.7041292671344, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 791.7222852401577, "iterations_since_restore": 101, "time_this_iter_s": 37.53277039527893, "info": {"grad_time_ms": 21978.061, "default": {"entropy": 1.678551435470581, "kl": 0.01484939455986023, "cur_lr": 0.0005000000237487257, "vf_loss": 26.549821853637695, "vf_explained_var": 0.6342250108718872, "total_loss": 26.540102005004883, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017239684239029884}, "num_steps_trained": 11036644, "load_time_ms": 21.227, "update_time_ms": 11.794, "sample_time_ms": 15317.302, "num_steps_sampled": 11036644}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d414a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e48>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 367.93363061181196, "episodes_total": 6417, "episodes_this_iter": 68, "time_total_s": 3945.8086137771606, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105644, "timestamp": 1556523482, "episode_len_mean": 683.91, "time_since_restore": 3983.8173229694366, "done": false, "custom_metrics": {"outflow_rate_min": 501.3286226252164, "outflow_rate_mean": 929.5916654834023, "cost2_mean": -56.14334307726465, "outflow_rate_max": 1200.954465595634, "system_level_velocity_min": 10.268599474041865, "cost2_max": -18.432612030101367, "cost2_min": -121.23010755760603, "system_level_velocity_mean": 14.898449160227244, "cost1_min": 24.405091151457068, "cost1_max": 450.2368924983249, "cost1_mean": 372.98242344090727, "system_level_velocity_max": 18.340406634331938}, "timesteps_total": 11142288, "training_iteration": 102, "date": "2019-04-29_07-38-02", "timesteps_since_restore": 11142288, "episode_reward_max": 977.7041292671344, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 778.6350491712657, "iterations_since_restore": 102, "time_this_iter_s": 38.008709192276, "info": {"grad_time_ms": 21942.558, "default": {"entropy": 1.714747428894043, "kl": 0.014789611101150513, "cur_lr": 0.0005000000237487257, "vf_loss": 31.51943588256836, "vf_explained_var": 0.6124532222747803, "total_loss": 31.510421752929688, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01650012657046318}, "num_steps_trained": 11142288, "load_time_ms": 20.544, "update_time_ms": 11.719, "sample_time_ms": 15360.005, "num_steps_sampled": 11142288}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb5f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 51.13205449431575, "episodes_total": 6485, "episodes_this_iter": 68, "time_total_s": 3983.8173229694366, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104028, "timestamp": 1556523518, "episode_len_mean": 683.33, "time_since_restore": 4020.6197504997253, "done": false, "custom_metrics": {"outflow_rate_min": 501.3286226252164, "outflow_rate_mean": 932.3218591073845, "cost2_mean": -60.14800156662345, "outflow_rate_max": 1145.719995101346, "system_level_velocity_min": 10.204879744183472, "cost2_max": -18.432612030101367, "cost2_min": -121.23010755760603, "system_level_velocity_mean": 14.706596089187682, "cost1_min": 24.405091151457068, "cost1_max": 450.2368924983249, "cost1_mean": 368.0611134831969, "system_level_velocity_max": 18.340406634331938}, "timesteps_total": 11246316, "training_iteration": 103, "date": "2019-04-29_07-38-38", "timesteps_since_restore": 11246316, "episode_reward_max": 989.8862398511765, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 787.902553130267, "iterations_since_restore": 103, "time_this_iter_s": 36.802427530288696, "info": {"grad_time_ms": 21865.045, "default": {"entropy": 1.704897403717041, "kl": 0.014505745843052864, "cur_lr": 0.0005000000237487257, "vf_loss": 28.71536636352539, "vf_explained_var": 0.6137351989746094, "total_loss": 28.70628547668457, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016421759501099586}, "num_steps_trained": 11246316, "load_time_ms": 20.615, "update_time_ms": 11.845, "sample_time_ms": 15320.482, "num_steps_sampled": 11246316}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d414a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e48>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 51.13205449431575, "episodes_total": 6553, "episodes_this_iter": 68, "time_total_s": 4020.6197504997253, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105697, "timestamp": 1556523558, "episode_len_mean": 696.58, "time_since_restore": 4059.6535539627075, "done": false, "custom_metrics": {"outflow_rate_min": 766.1605787378179, "outflow_rate_mean": 949.2673568137419, "cost2_mean": -61.17448681219693, "outflow_rate_max": 1145.719995101346, "system_level_velocity_min": 10.204879744183472, "cost2_max": -31.108311328187455, "cost2_min": -114.03197332440901, "system_level_velocity_mean": 14.577942593609487, "cost1_min": 224.20471356455909, "cost1_max": 449.86833425364557, "cost1_mean": 374.04011794429715, "system_level_velocity_max": 17.78859933458092}, "timesteps_total": 11352013, "training_iteration": 104, "date": "2019-04-29_07-39-18", "timesteps_since_restore": 11352013, "episode_reward_max": 989.8862398511765, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 805.8019391744679, "iterations_since_restore": 104, "time_this_iter_s": 39.03380346298218, "info": {"grad_time_ms": 21955.42, "default": {"entropy": 1.7202184200286865, "kl": 0.014361846260726452, "cur_lr": 0.0005000000237487257, "vf_loss": 27.254987716674805, "vf_explained_var": 0.6759520173072815, "total_loss": 27.246017456054688, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01623913086950779}, "num_steps_trained": 11352013, "load_time_ms": 20.655, "update_time_ms": 11.767, "sample_time_ms": 15338.836, "num_steps_sampled": 11352013}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb160>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 417.7579376227234, "episodes_total": 6621, "episodes_this_iter": 68, "time_total_s": 4059.6535539627075, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105076, "timestamp": 1556523595, "episode_len_mean": 686.73, "time_since_restore": 4097.32608962059, "done": false, "custom_metrics": {"outflow_rate_min": 497.94829530916195, "outflow_rate_mean": 940.8022383291781, "cost2_mean": -59.53713818006411, "outflow_rate_max": 1133.4299098603617, "system_level_velocity_min": 9.818115824991915, "cost2_max": -18.038139116509583, "cost2_min": -114.03197332440901, "system_level_velocity_mean": 14.556998560024283, "cost1_min": 21.8214973726688, "cost1_max": 435.7399462613677, "cost1_mean": 365.522462604803, "system_level_velocity_max": 18.202505963949918}, "timesteps_total": 11457089, "training_iteration": 105, "date": "2019-04-29_07-39-55", "timesteps_since_restore": 11457089, "episode_reward_max": 961.9833132439157, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 792.4324459418503, "iterations_since_restore": 105, "time_this_iter_s": 37.67253565788269, "info": {"grad_time_ms": 21978.616, "default": {"entropy": 1.7235503196716309, "kl": 0.0144851915538311, "cur_lr": 0.0005000000237487257, "vf_loss": 25.34414291381836, "vf_explained_var": 0.6827009916305542, "total_loss": 25.334543228149414, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016933733597397804}, "num_steps_trained": 11457089, "load_time_ms": 20.479, "update_time_ms": 11.846, "sample_time_ms": 15382.727, "num_steps_sampled": 11457089}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41828>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 44.905136870932665, "episodes_total": 6686, "episodes_this_iter": 65, "time_total_s": 4097.32608962059, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104645, "timestamp": 1556523633, "episode_len_mean": 692.12, "time_since_restore": 4134.783565998077, "done": false, "custom_metrics": {"outflow_rate_min": 497.94829530916195, "outflow_rate_mean": 946.5190078985003, "cost2_mean": -59.63625662318741, "outflow_rate_max": 1103.9409885052257, "system_level_velocity_min": 9.818115824991915, "cost2_max": -18.038139116509583, "cost2_min": -109.62968515477712, "system_level_velocity_mean": 14.62416914774394, "cost1_min": 26.88201086853502, "cost1_max": 439.7974688542279, "cost1_mean": 371.2667886498761, "system_level_velocity_max": 18.102950769652363}, "timesteps_total": 11561734, "training_iteration": 106, "date": "2019-04-29_07-40-33", "timesteps_since_restore": 11561734, "episode_reward_max": 974.5494107175291, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 799.4109813773409, "iterations_since_restore": 106, "time_this_iter_s": 37.45747637748718, "info": {"grad_time_ms": 21908.164, "default": {"entropy": 1.7214460372924805, "kl": 0.014727110043168068, "cur_lr": 0.0005000000237487257, "vf_loss": 27.277524948120117, "vf_explained_var": 0.6292450428009033, "total_loss": 27.26837730407715, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01660296507179737}, "num_steps_trained": 11561734, "load_time_ms": 21.384, "update_time_ms": 11.811, "sample_time_ms": 15320.287, "num_steps_sampled": 11561734}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb898>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 65.58706287423209, "episodes_total": 6751, "episodes_this_iter": 65, "time_total_s": 4134.783565998077, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104829, "timestamp": 1556523670, "episode_len_mean": 698.72, "time_since_restore": 4172.0937349796295, "done": false, "custom_metrics": {"outflow_rate_min": 787.190192274993, "outflow_rate_mean": 965.498338242753, "cost2_mean": -59.45109363296807, "outflow_rate_max": 1126.7567667832714, "system_level_velocity_min": 10.588119057840217, "cost2_max": -28.90973127211358, "cost2_min": -97.74249715773958, "system_level_velocity_mean": 14.83972112803243, "cost1_min": 269.68561952422147, "cost1_max": 441.3884235367094, "cost1_mean": 381.6212162395001, "system_level_velocity_max": 17.6034359527656}, "timesteps_total": 11666563, "training_iteration": 107, "date": "2019-04-29_07-41-10", "timesteps_since_restore": 11666563, "episode_reward_max": 1016.6596211592803, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 817.212641440133, "iterations_since_restore": 107, "time_this_iter_s": 37.310168981552124, "info": {"grad_time_ms": 21833.119, "default": {"entropy": 1.7344187498092651, "kl": 0.014988820999860764, "cur_lr": 0.0005000000237487257, "vf_loss": 28.708934783935547, "vf_explained_var": 0.6144343614578247, "total_loss": 28.6995906829834, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016929099336266518}, "num_steps_trained": 11666563, "load_time_ms": 21.753, "update_time_ms": 11.759, "sample_time_ms": 15292.49, "num_steps_sampled": 11666563}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 602.8289612014993, "episodes_total": 6821, "episodes_this_iter": 70, "time_total_s": 4172.0937349796295, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105491, "timestamp": 1556523707, "episode_len_mean": 700.0, "time_since_restore": 4209.264468431473, "done": false, "custom_metrics": {"outflow_rate_min": 686.3592619083812, "outflow_rate_mean": 965.6514659784999, "cost2_mean": -59.15109139694964, "outflow_rate_max": 1126.7567667832714, "system_level_velocity_min": 9.713497472232362, "cost2_max": -33.74401503225758, "cost2_min": -115.11933236150881, "system_level_velocity_mean": 14.673591673848726, "cost1_min": 244.14332749931467, "cost1_max": 440.4256303399012, "cost1_mean": 378.78530322810855, "system_level_velocity_max": 17.427750563531294}, "timesteps_total": 11772054, "training_iteration": 108, "date": "2019-04-29_07-41-47", "timesteps_since_restore": 11772054, "episode_reward_max": 975.340791772923, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 815.1924459684359, "iterations_since_restore": 108, "time_this_iter_s": 37.17073345184326, "info": {"grad_time_ms": 21755.298, "default": {"entropy": 1.738145112991333, "kl": 0.01580478809773922, "cur_lr": 0.0005000000237487257, "vf_loss": 27.998592376708984, "vf_explained_var": 0.65308678150177, "total_loss": 27.989015579223633, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017575880512595177}, "num_steps_trained": 11772054, "load_time_ms": 21.201, "update_time_ms": 11.837, "sample_time_ms": 15359.656, "num_steps_sampled": 11772054}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbbe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bba58>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 591.6895291081985, "episodes_total": 6892, "episodes_this_iter": 71, "time_total_s": 4209.264468431473, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104904, "timestamp": 1556523745, "episode_len_mean": 679.99, "time_since_restore": 4247.124581575394, "done": false, "custom_metrics": {"outflow_rate_min": 482.93475289541203, "outflow_rate_mean": 939.5037148349552, "cost2_mean": -56.970942197765915, "outflow_rate_max": 1149.6370307669308, "system_level_velocity_min": 9.713497472232362, "cost2_max": -14.313995082959757, "cost2_min": -115.11933236150881, "system_level_velocity_mean": 14.78739948286895, "cost1_min": 16.82287131285382, "cost1_max": 444.41207709398145, "cost1_mean": 366.7415991711785, "system_level_velocity_max": 19.240078585567822}, "timesteps_total": 11876958, "training_iteration": 109, "date": "2019-04-29_07-42-25", "timesteps_since_restore": 11876958, "episode_reward_max": 951.2675618191386, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 788.1425732480639, "iterations_since_restore": 109, "time_this_iter_s": 37.8601131439209, "info": {"grad_time_ms": 21902.264, "default": {"entropy": 1.7491313219070435, "kl": 0.015057321637868881, "cur_lr": 0.0005000000237487257, "vf_loss": 27.76268768310547, "vf_explained_var": 0.6338257789611816, "total_loss": 27.75370979309082, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016598818823695183}, "num_steps_trained": 11876958, "load_time_ms": 21.813, "update_time_ms": 11.813, "sample_time_ms": 15402.74, "num_steps_sampled": 11876958}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b20f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b26d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b27b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 43.442967018253576, "episodes_total": 6964, "episodes_this_iter": 72, "time_total_s": 4247.124581575394, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105871, "timestamp": 1556523783, "episode_len_mean": 682.26, "time_since_restore": 4284.59424161911, "done": false, "custom_metrics": {"outflow_rate_min": 503.2680667695665, "outflow_rate_mean": 938.7289809930342, "cost2_mean": -57.52650499369079, "outflow_rate_max": 1111.61827974196, "system_level_velocity_min": 9.591265389522265, "cost2_max": -17.285468745970853, "cost2_min": -114.43389153054105, "system_level_velocity_mean": 14.599836053305358, "cost1_min": 20.86331174136062, "cost1_max": 452.2735901666805, "cost1_mean": 363.566899870446, "system_level_velocity_max": 19.240078585567822}, "timesteps_total": 11982829, "training_iteration": 110, "date": "2019-04-29_07-43-03", "timesteps_since_restore": 11982829, "episode_reward_max": 985.42404361444, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 784.2388707338621, "iterations_since_restore": 110, "time_this_iter_s": 37.46966004371643, "info": {"grad_time_ms": 21991.745, "default": {"entropy": 1.7674193382263184, "kl": 0.016358492895960808, "cur_lr": 0.0005000000237487257, "vf_loss": 25.900850296020508, "vf_explained_var": 0.7081283926963806, "total_loss": 25.893760681152344, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.015372243709862232}, "num_steps_trained": 11982829, "load_time_ms": 21.876, "update_time_ms": 11.842, "sample_time_ms": 15389.912, "num_steps_sampled": 11982829}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb2e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 47.96405517788708, "episodes_total": 7033, "episodes_this_iter": 69, "time_total_s": 4284.59424161911, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105754, "timestamp": 1556523819, "episode_len_mean": 688.91, "time_since_restore": 4320.891748428345, "done": false, "custom_metrics": {"outflow_rate_min": 532.2886603579709, "outflow_rate_mean": 949.8840506332764, "cost2_mean": -59.71935051214516, "outflow_rate_max": 1134.0920095462557, "system_level_velocity_min": 9.591265389522265, "cost2_max": -15.718872329231433, "cost2_min": -112.16686284885722, "system_level_velocity_mean": 14.568190703450773, "cost1_min": 25.785204848437697, "cost1_max": 452.2735901666805, "cost1_mean": 368.10740833076363, "system_level_velocity_max": 18.44714382006532}, "timesteps_total": 12088583, "training_iteration": 111, "date": "2019-04-29_07-43-39", "timesteps_since_restore": 12088583, "episode_reward_max": 999.7653068228212, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 794.1556251271526, "iterations_since_restore": 111, "time_this_iter_s": 36.29750680923462, "info": {"grad_time_ms": 21898.612, "default": {"entropy": 1.7976882457733154, "kl": 0.015589142218232155, "cur_lr": 0.0005000000237487257, "vf_loss": 24.88311004638672, "vf_explained_var": 0.6977566480636597, "total_loss": 24.87465476989746, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01634732261300087}, "num_steps_trained": 12088583, "load_time_ms": 20.532, "update_time_ms": 11.561, "sample_time_ms": 15363.709, "num_steps_sampled": 12088583}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2be0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 60.00535750789939, "episodes_total": 7097, "episodes_this_iter": 64, "time_total_s": 4320.891748428345, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104785, "timestamp": 1556523858, "episode_len_mean": 679.61, "time_since_restore": 4359.574646234512, "done": false, "custom_metrics": {"outflow_rate_min": 430.2982331770539, "outflow_rate_mean": 938.9616062458849, "cost2_mean": -55.72189406114584, "outflow_rate_max": 1134.0920095462557, "system_level_velocity_min": 9.378817824257846, "cost2_max": -11.566538656881729, "cost2_min": -110.81104608939519, "system_level_velocity_mean": 14.680659277963203, "cost1_min": 10.250529494718615, "cost1_max": 444.5358958909736, "cost1_mean": 365.69684688195827, "system_level_velocity_max": 19.229509808068016}, "timesteps_total": 12193368, "training_iteration": 112, "date": "2019-04-29_07-44-18", "timesteps_since_restore": 12193368, "episode_reward_max": 995.9999308659877, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 776.643798721466, "iterations_since_restore": 112, "time_this_iter_s": 38.6828978061676, "info": {"grad_time_ms": 22023.39, "default": {"entropy": 1.7792834043502808, "kl": 0.015154276974499226, "cur_lr": 0.0005000000237487257, "vf_loss": 29.600292205810547, "vf_explained_var": 0.6365518569946289, "total_loss": 29.591032028198242, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01693255826830864}, "num_steps_trained": 12193368, "load_time_ms": 21.082, "update_time_ms": 11.579, "sample_time_ms": 15304.96, "num_steps_sampled": 12193368}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d415c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41cc0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 21.517492940252158, "episodes_total": 7168, "episodes_this_iter": 71, "time_total_s": 4359.574646234512, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106420, "timestamp": 1556523895, "episode_len_mean": 686.43, "time_since_restore": 4396.685307741165, "done": false, "custom_metrics": {"outflow_rate_min": 430.2982331770539, "outflow_rate_mean": 948.1500354230781, "cost2_mean": -58.29838186301954, "outflow_rate_max": 1146.2969157378645, "system_level_velocity_min": 10.314030965443063, "cost2_max": -11.566538656881729, "cost2_min": -134.95274769043044, "system_level_velocity_mean": 14.634316628754213, "cost1_min": 10.250529494718615, "cost1_max": 445.1945643631264, "cost1_mean": 368.79339400399033, "system_level_velocity_max": 19.229509808068016}, "timesteps_total": 12299788, "training_iteration": 113, "date": "2019-04-29_07-44-55", "timesteps_since_restore": 12299788, "episode_reward_max": 1000.2607787352283, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 789.1860668109049, "iterations_since_restore": 113, "time_this_iter_s": 37.11066150665283, "info": {"grad_time_ms": 22061.357, "default": {"entropy": 1.781618595123291, "kl": 0.015019849874079227, "cur_lr": 0.0005000000237487257, "vf_loss": 24.212072372436523, "vf_explained_var": 0.6686275005340576, "total_loss": 24.203857421875, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015817472711205482}, "num_steps_trained": 12299788, "load_time_ms": 21.085, "update_time_ms": 11.39, "sample_time_ms": 15297.442, "num_steps_sampled": 12299788}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2be0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 22.835484571258316, "episodes_total": 7232, "episodes_this_iter": 64, "time_total_s": 4396.685307741165, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106180, "timestamp": 1556523933, "episode_len_mean": 692.66, "time_since_restore": 4434.3477602005005, "done": false, "custom_metrics": {"outflow_rate_min": 712.7245202488492, "outflow_rate_mean": 951.191367061751, "cost2_mean": -62.71850874102702, "outflow_rate_max": 1146.2969157378645, "system_level_velocity_min": 9.884574445652854, "cost2_max": -33.19073904524687, "cost2_min": -134.95274769043044, "system_level_velocity_mean": 14.507359711945071, "cost1_min": 82.74957626538, "cost1_max": 449.1227982313469, "cost1_mean": 368.9532064530633, "system_level_velocity_max": 17.90019136965071}, "timesteps_total": 12405968, "training_iteration": 114, "date": "2019-04-29_07-45-33", "timesteps_since_restore": 12405968, "episode_reward_max": 970.9230945169556, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 804.7094224987155, "iterations_since_restore": 114, "time_this_iter_s": 37.66245245933533, "info": {"grad_time_ms": 21967.095, "default": {"entropy": 1.8020246028900146, "kl": 0.014715648256242275, "cur_lr": 0.0005000000237487257, "vf_loss": 26.892087936401367, "vf_explained_var": 0.6691174507141113, "total_loss": 26.882919311523438, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016618261113762856}, "num_steps_trained": 12405968, "load_time_ms": 21.22, "update_time_ms": 11.406, "sample_time_ms": 15256.161, "num_steps_sampled": 12405968}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b27b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b20f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2668>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 188.53800065792137, "episodes_total": 7299, "episodes_this_iter": 67, "time_total_s": 4434.3477602005005, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105911, "timestamp": 1556523970, "episode_len_mean": 691.76, "time_since_restore": 4471.822452068329, "done": false, "custom_metrics": {"outflow_rate_min": 496.46866915285005, "outflow_rate_mean": 940.9799188574261, "cost2_mean": -62.76789460138365, "outflow_rate_max": 1133.3267629317654, "system_level_velocity_min": 9.653455140602064, "cost2_max": -23.535472481362593, "cost2_min": -119.93906138805042, "system_level_velocity_mean": 14.33429381593004, "cost1_min": 25.631769309889513, "cost1_max": 454.6547484975246, "cost1_mean": 363.98084827509774, "system_level_velocity_max": 17.962590401897305}, "timesteps_total": 12511879, "training_iteration": 115, "date": "2019-04-29_07-46-10", "timesteps_since_restore": 12511879, "episode_reward_max": 1008.946453025171, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 792.2655924622308, "iterations_since_restore": 115, "time_this_iter_s": 37.47469186782837, "info": {"grad_time_ms": 21926.239, "default": {"entropy": 1.8200405836105347, "kl": 0.014868476428091526, "cur_lr": 0.0005000000237487257, "vf_loss": 26.275665283203125, "vf_explained_var": 0.671845018863678, "total_loss": 26.265535354614258, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017654476687312126}, "num_steps_trained": 12511879, "load_time_ms": 21.024, "update_time_ms": 11.477, "sample_time_ms": 15276.304, "num_steps_sampled": 12511879}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d414e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 54.387856540741495, "episodes_total": 7367, "episodes_this_iter": 68, "time_total_s": 4471.822452068329, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105536, "timestamp": 1556524008, "episode_len_mean": 686.8, "time_since_restore": 4509.681704282761, "done": false, "custom_metrics": {"outflow_rate_min": 524.8643733316616, "outflow_rate_mean": 917.4548675568828, "cost2_mean": -59.68768981544818, "outflow_rate_max": 1073.2455823588537, "system_level_velocity_min": 8.688871413098386, "cost2_max": -21.323542194514506, "cost2_min": -119.93906138805042, "system_level_velocity_mean": 14.28942840929089, "cost1_min": 25.308059822309357, "cost1_max": 445.41209122335704, "cost1_mean": 358.1210519265114, "system_level_velocity_max": 18.75402068180428}, "timesteps_total": 12617415, "training_iteration": 116, "date": "2019-04-29_07-46-48", "timesteps_since_restore": 12617415, "episode_reward_max": 958.8841899263188, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 769.4993315992739, "iterations_since_restore": 116, "time_this_iter_s": 37.85925221443176, "info": {"grad_time_ms": 21926.627, "default": {"entropy": 1.8153373003005981, "kl": 0.015176319517195225, "cur_lr": 0.0005000000237487257, "vf_loss": 27.45854377746582, "vf_explained_var": 0.6137579679489136, "total_loss": 27.449472427368164, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016753457486629486}, "num_steps_trained": 12617415, "load_time_ms": 20.861, "update_time_ms": 11.501, "sample_time_ms": 15318.441, "num_steps_sampled": 12617415}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b20b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 52.402676159205065, "episodes_total": 7437, "episodes_this_iter": 70, "time_total_s": 4509.681704282761, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107794, "timestamp": 1556524046, "episode_len_mean": 680.27, "time_since_restore": 4546.9047384262085, "done": false, "custom_metrics": {"outflow_rate_min": 524.8643733316616, "outflow_rate_mean": 922.8548906713904, "cost2_mean": -60.296578414844674, "outflow_rate_max": 1156.0033738347547, "system_level_velocity_min": 8.688871413098386, "cost2_max": -19.74268850932616, "cost2_min": -121.8251619379899, "system_level_velocity_mean": 14.391806949493926, "cost1_min": 25.308059822309357, "cost1_max": 440.4663147718601, "cost1_mean": 355.6713660831498, "system_level_velocity_max": 18.90763840000976}, "timesteps_total": 12725209, "training_iteration": 117, "date": "2019-04-29_07-47-26", "timesteps_since_restore": 12725209, "episode_reward_max": 1072.2927994652412, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 761.3911565174241, "iterations_since_restore": 117, "time_this_iter_s": 37.223034143447876, "info": {"grad_time_ms": 21929.431, "default": {"entropy": 1.8305963277816772, "kl": 0.015107317827641964, "cur_lr": 0.0005000000237487257, "vf_loss": 25.274457931518555, "vf_explained_var": 0.6819037795066833, "total_loss": 25.264951705932617, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01715204305946827}, "num_steps_trained": 12725209, "load_time_ms": 20.825, "update_time_ms": 11.53, "sample_time_ms": 15306.976, "num_steps_sampled": 12725209}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d412e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d414a8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 52.402676159205065, "episodes_total": 7507, "episodes_this_iter": 70, "time_total_s": 4546.9047384262085, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104288, "timestamp": 1556524082, "episode_len_mean": 693.47, "time_since_restore": 4583.2032923698425, "done": false, "custom_metrics": {"outflow_rate_min": 546.5224738656838, "outflow_rate_mean": 920.9299642344864, "cost2_mean": -62.418191664682844, "outflow_rate_max": 1223.2396191498246, "system_level_velocity_min": 10.274941447065931, "cost2_max": -19.74268850932616, "cost2_min": -152.57537838424676, "system_level_velocity_mean": 13.980506177998661, "cost1_min": 30.742897648696, "cost1_max": 445.33152369266304, "cost1_mean": 354.6142141812366, "system_level_velocity_max": 18.90763840000976}, "timesteps_total": 12829497, "training_iteration": 118, "date": "2019-04-29_07-48-02", "timesteps_since_restore": 12829497, "episode_reward_max": 1012.2206552435291, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 767.4444090575046, "iterations_since_restore": 118, "time_this_iter_s": 36.29855394363403, "info": {"grad_time_ms": 21884.92, "default": {"entropy": 1.8057564496994019, "kl": 0.015440968796610832, "cur_lr": 0.0005000000237487257, "vf_loss": 24.170886993408203, "vf_explained_var": 0.6763964295387268, "total_loss": 24.161598205566406, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017105329781770706}, "num_steps_trained": 12829497, "load_time_ms": 20.76, "update_time_ms": 11.424, "sample_time_ms": 15263.458, "num_steps_sampled": 12829497}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d413c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871f3ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2a20>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 64.61282922802005, "episodes_total": 7572, "episodes_this_iter": 65, "time_total_s": 4583.2032923698425, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105042, "timestamp": 1556524120, "episode_len_mean": 693.28, "time_since_restore": 4620.7847583293915, "done": false, "custom_metrics": {"outflow_rate_min": 493.7011947654558, "outflow_rate_mean": 924.7407699211752, "cost2_mean": -57.60448757656101, "outflow_rate_max": 1176.862286204454, "system_level_velocity_min": 10.028156977886175, "cost2_max": -16.54794693816585, "cost2_min": -107.99185014273276, "system_level_velocity_mean": 14.479130034521022, "cost1_min": 18.557580910608323, "cost1_max": 440.4793326448437, "cost1_mean": 367.62930736218317, "system_level_velocity_max": 18.1230406822821}, "timesteps_total": 12934539, "training_iteration": 119, "date": "2019-04-29_07-48-40", "timesteps_since_restore": 12934539, "episode_reward_max": 1042.4648005844833, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 778.0919121036075, "iterations_since_restore": 119, "time_this_iter_s": 37.58146595954895, "info": {"grad_time_ms": 21934.198, "default": {"entropy": 1.7855092287063599, "kl": 0.015507066622376442, "cur_lr": 0.0005000000237487257, "vf_loss": 25.367130279541016, "vf_explained_var": 0.6502000689506531, "total_loss": 25.358360290527344, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016621530055999756}, "num_steps_trained": 12934539, "load_time_ms": 20.889, "update_time_ms": 11.158, "sample_time_ms": 15188.412, "num_steps_sampled": 12934539}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41438>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 39.84925243466379, "episodes_total": 7642, "episodes_this_iter": 70, "time_total_s": 4620.7847583293915, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105731, "timestamp": 1556524159, "episode_len_mean": 692.86, "time_since_restore": 4660.264757871628, "done": false, "custom_metrics": {"outflow_rate_min": 493.7011947654558, "outflow_rate_mean": 939.3989068360777, "cost2_mean": -60.415381875851054, "outflow_rate_max": 1107.750220983857, "system_level_velocity_min": 10.012613112275883, "cost2_max": -16.54794693816585, "cost2_min": -140.8479440096201, "system_level_velocity_mean": 14.665718756835119, "cost1_min": 18.557580910608323, "cost1_max": 450.3498946398298, "cost1_mean": 371.5704492296478, "system_level_velocity_max": 18.1230406822821}, "timesteps_total": 13040270, "training_iteration": 120, "date": "2019-04-29_07-49-19", "timesteps_since_restore": 13040270, "episode_reward_max": 964.5282725082382, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 789.2437669957349, "iterations_since_restore": 120, "time_this_iter_s": 39.47999954223633, "info": {"grad_time_ms": 22124.714, "default": {"entropy": 1.8083034753799438, "kl": 0.01580146700143814, "cur_lr": 0.0005000000237487257, "vf_loss": 26.24747085571289, "vf_explained_var": 0.6948955059051514, "total_loss": 26.238510131835938, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01695878803730011}, "num_steps_trained": 13040270, "load_time_ms": 21.156, "update_time_ms": 11.08, "sample_time_ms": 15196.866, "num_steps_sampled": 13040270}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d413c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2cc0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 39.84925243466379, "episodes_total": 7707, "episodes_this_iter": 65, "time_total_s": 4660.264757871628, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105258, "timestamp": 1556524197, "episode_len_mean": 675.56, "time_since_restore": 4697.799754619598, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 929.3664203144145, "cost2_mean": -59.79590010661747, "outflow_rate_max": 1136.5308422281798, "system_level_velocity_min": 10.44272116794063, "cost2_max": -13.363396074302202, "cost2_min": -116.99261626073698, "system_level_velocity_mean": 14.732766639004321, "cost1_min": 11.710640512705703, "cost1_max": 452.96883140346245, "cost1_mean": 361.54362291876197, "system_level_velocity_max": 19.047839158507283}, "timesteps_total": 13145528, "training_iteration": 121, "date": "2019-04-29_07-49-57", "timesteps_since_restore": 13145528, "episode_reward_max": 1014.0549794729851, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 768.6459636201383, "iterations_since_restore": 121, "time_this_iter_s": 37.53499674797058, "info": {"grad_time_ms": 22209.524, "default": {"entropy": 1.8166218996047974, "kl": 0.014908815734088421, "cur_lr": 0.0005000000237487257, "vf_loss": 27.18595314025879, "vf_explained_var": 0.6833795309066772, "total_loss": 27.17761993408203, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.015879755839705467}, "num_steps_trained": 13145528, "load_time_ms": 22.243, "update_time_ms": 11.461, "sample_time_ms": 15232.208, "num_steps_sampled": 13145528}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d414a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d412e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 26.78567174313677, "episodes_total": 7779, "episodes_this_iter": 72, "time_total_s": 4697.799754619598, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106074, "timestamp": 1556524235, "episode_len_mean": 676.08, "time_since_restore": 4736.367702960968, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 937.4785470934105, "cost2_mean": -60.855540345381954, "outflow_rate_max": 1150.539855020516, "system_level_velocity_min": 9.098633156817247, "cost2_max": -13.363396074302202, "cost2_min": -116.99261626073698, "system_level_velocity_mean": 14.73570007453207, "cost1_min": 11.710640512705703, "cost1_max": 452.96883140346245, "cost1_mean": 361.85412575667766, "system_level_velocity_max": 19.047839158507283}, "timesteps_total": 13251602, "training_iteration": 122, "date": "2019-04-29_07-50-35", "timesteps_since_restore": 13251602, "episode_reward_max": 1014.0549794729851, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 785.1978533610562, "iterations_since_restore": 122, "time_this_iter_s": 38.56794834136963, "info": {"grad_time_ms": 22179.588, "default": {"entropy": 1.8094980716705322, "kl": 0.014935302548110485, "cur_lr": 0.0005000000237487257, "vf_loss": 24.51372528076172, "vf_explained_var": 0.6554371118545532, "total_loss": 24.50493049621582, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016358593478798866}, "num_steps_trained": 13251602, "load_time_ms": 22.426, "update_time_ms": 11.482, "sample_time_ms": 15250.799, "num_steps_sampled": 13251602}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 26.78567174313677, "episodes_total": 7845, "episodes_this_iter": 66, "time_total_s": 4736.367702960968, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104868, "timestamp": 1556524273, "episode_len_mean": 680.57, "time_since_restore": 4773.914813995361, "done": false, "custom_metrics": {"outflow_rate_min": 487.90790141812573, "outflow_rate_mean": 940.1011171836078, "cost2_mean": -59.01509484889594, "outflow_rate_max": 1178.5138493715122, "system_level_velocity_min": 9.675736371966204, "cost2_max": -15.77671214920172, "cost2_min": -107.66298324987986, "system_level_velocity_mean": 14.6899118985504, "cost1_min": 19.12898406160366, "cost1_max": 444.89244194528635, "cost1_mean": 363.6730475222046, "system_level_velocity_max": 18.913741097959395}, "timesteps_total": 13356470, "training_iteration": 123, "date": "2019-04-29_07-51-13", "timesteps_since_restore": 13356470, "episode_reward_max": 1012.1874722812239, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 774.8067796718592, "iterations_since_restore": 123, "time_this_iter_s": 37.54711103439331, "info": {"grad_time_ms": 22145.298, "default": {"entropy": 1.831801414489746, "kl": 0.015194147825241089, "cur_lr": 0.0005000000237487257, "vf_loss": 28.76712417602539, "vf_explained_var": 0.6573912501335144, "total_loss": 28.757688522338867, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017128977924585342}, "num_steps_trained": 13356470, "load_time_ms": 22.357, "update_time_ms": 11.599, "sample_time_ms": 15326.723, "num_steps_sampled": 13356470}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d411d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d410b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 42.77431143884313, "episodes_total": 7920, "episodes_this_iter": 75, "time_total_s": 4773.914813995361, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104432, "timestamp": 1556524310, "episode_len_mean": 687.33, "time_since_restore": 4810.682476758957, "done": false, "custom_metrics": {"outflow_rate_min": 508.0519436229788, "outflow_rate_mean": 942.2435309415218, "cost2_mean": -59.09545238833965, "outflow_rate_max": 1110.7167571858, "system_level_velocity_min": 9.675736371966204, "cost2_max": -18.255803231528898, "cost2_min": -105.98035121500978, "system_level_velocity_mean": 14.582775002885647, "cost1_min": 25.1755191946011, "cost1_max": 447.3391375406212, "cost1_mean": 365.47838039956616, "system_level_velocity_max": 18.913741097959395}, "timesteps_total": 13460902, "training_iteration": 124, "date": "2019-04-29_07-51-50", "timesteps_since_restore": 13460902, "episode_reward_max": 972.9399735703422, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 781.1980542245332, "iterations_since_restore": 124, "time_this_iter_s": 36.76766276359558, "info": {"grad_time_ms": 21980.972, "default": {"entropy": 1.8268022537231445, "kl": 0.015571552328765392, "cur_lr": 0.0005000000237487257, "vf_loss": 25.829702377319336, "vf_explained_var": 0.6498474478721619, "total_loss": 25.821626663208008, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015957187861204147}, "num_steps_trained": 13460902, "load_time_ms": 22.106, "update_time_ms": 11.592, "sample_time_ms": 15401.705, "num_steps_sampled": 13460902}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871930f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbb00>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 57.859365293681044, "episodes_total": 7988, "episodes_this_iter": 68, "time_total_s": 4810.682476758957, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105450, "timestamp": 1556524348, "episode_len_mean": 673.29, "time_since_restore": 4848.568420886993, "done": false, "custom_metrics": {"outflow_rate_min": 469.4322526242091, "outflow_rate_mean": 931.3980529229016, "cost2_mean": -57.68006462158838, "outflow_rate_max": 1110.7167571858, "system_level_velocity_min": 10.551335961805695, "cost2_max": -12.276772826551667, "cost2_min": -107.42014503066501, "system_level_velocity_mean": 14.850177469941686, "cost1_min": 16.94925003680672, "cost1_max": 444.6096445038179, "cost1_mean": 362.8676143662121, "system_level_velocity_max": 18.902303923230722}, "timesteps_total": 13566352, "training_iteration": 125, "date": "2019-04-29_07-52-28", "timesteps_since_restore": 13566352, "episode_reward_max": 972.9399735703422, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 774.9398508807708, "iterations_since_restore": 125, "time_this_iter_s": 37.8859441280365, "info": {"grad_time_ms": 22020.887, "default": {"entropy": 1.8359041213989258, "kl": 0.015454662032425404, "cur_lr": 0.0005000000237487257, "vf_loss": 27.033641815185547, "vf_explained_var": 0.6056923270225525, "total_loss": 27.025341033935547, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016127372160553932}, "num_steps_trained": 13566352, "load_time_ms": 22.513, "update_time_ms": 11.396, "sample_time_ms": 15400.087, "num_steps_sampled": 13566352}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b27b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb160>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.75401375175271, "episodes_total": 8054, "episodes_this_iter": 66, "time_total_s": 4848.568420886993, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104949, "timestamp": 1556524386, "episode_len_mean": 673.33, "time_since_restore": 4886.921456813812, "done": false, "custom_metrics": {"outflow_rate_min": 481.955215425478, "outflow_rate_mean": 935.0075292622856, "cost2_mean": -61.16579390627312, "outflow_rate_max": 1156.2433828908643, "system_level_velocity_min": 10.002822536490958, "cost2_max": -17.171210889028483, "cost2_min": -120.55259140946669, "system_level_velocity_mean": 14.725516404427962, "cost1_min": 17.291392528158454, "cost1_max": 444.59915196003016, "cost1_mean": 360.087456135753, "system_level_velocity_max": 19.00657082733165}, "timesteps_total": 13671301, "training_iteration": 126, "date": "2019-04-29_07-53-06", "timesteps_since_restore": 13671301, "episode_reward_max": 1026.5963484234398, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 781.3329546276857, "iterations_since_restore": 126, "time_this_iter_s": 38.35303592681885, "info": {"grad_time_ms": 22072.953, "default": {"entropy": 1.8350670337677002, "kl": 0.0158245749771595, "cur_lr": 0.0005000000237487257, "vf_loss": 27.92156410217285, "vf_explained_var": 0.5953978896141052, "total_loss": 27.911596298217773, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017976878210902214}, "num_steps_trained": 13671301, "load_time_ms": 21.509, "update_time_ms": 11.583, "sample_time_ms": 15398.413, "num_steps_sampled": 13671301}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b20f0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.75401375175271, "episodes_total": 8121, "episodes_this_iter": 67, "time_total_s": 4886.921456813812, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105880, "timestamp": 1556524425, "episode_len_mean": 666.88, "time_since_restore": 4925.61357998848, "done": false, "custom_metrics": {"outflow_rate_min": 519.5170046697486, "outflow_rate_mean": 937.0122990006937, "cost2_mean": -60.986262930013794, "outflow_rate_max": 1156.2433828908643, "system_level_velocity_min": 10.35764798520663, "cost2_max": -20.022096351381368, "cost2_min": -106.17621741149125, "system_level_velocity_mean": 14.56816544596494, "cost1_min": 25.227313413855505, "cost1_max": 440.7187186375875, "cost1_mean": 353.2509561694313, "system_level_velocity_max": 18.411609179412217}, "timesteps_total": 13777181, "training_iteration": 127, "date": "2019-04-29_07-53-45", "timesteps_since_restore": 13777181, "episode_reward_max": 1026.5963484234398, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 771.4382974588748, "iterations_since_restore": 127, "time_this_iter_s": 38.69212317466736, "info": {"grad_time_ms": 22166.494, "default": {"entropy": 1.823424220085144, "kl": 0.01646978221833706, "cur_lr": 0.0005000000237487257, "vf_loss": 27.771434783935547, "vf_explained_var": 0.6014624834060669, "total_loss": 27.762067794799805, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017705142498016357}, "num_steps_trained": 13777181, "load_time_ms": 21.158, "update_time_ms": 11.571, "sample_time_ms": 15452.41, "num_steps_sampled": 13777181}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495c0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 54.92185792135882, "episodes_total": 8195, "episodes_this_iter": 74, "time_total_s": 4925.61357998848, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105822, "timestamp": 1556524464, "episode_len_mean": 672.44, "time_since_restore": 4964.994478225708, "done": false, "custom_metrics": {"outflow_rate_min": 512.6962231660532, "outflow_rate_mean": 939.1830008969596, "cost2_mean": -60.452753114155705, "outflow_rate_max": 1148.4301275618495, "system_level_velocity_min": 9.240480066887704, "cost2_max": -18.861461504075628, "cost2_min": -143.8411346480958, "system_level_velocity_mean": 14.657600047733279, "cost1_min": 28.84786792069382, "cost1_max": 446.0268424468279, "cost1_mean": 358.2630783488432, "system_level_velocity_max": 18.84283727078076}, "timesteps_total": 13883003, "training_iteration": 128, "date": "2019-04-29_07-54-24", "timesteps_since_restore": 13883003, "episode_reward_max": 989.7759662098366, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 772.1517581046111, "iterations_since_restore": 128, "time_this_iter_s": 39.380898237228394, "info": {"grad_time_ms": 22424.068, "default": {"entropy": 1.8219592571258545, "kl": 0.016150157898664474, "cur_lr": 0.0005000000237487257, "vf_loss": 30.57979393005371, "vf_explained_var": 0.6215794682502747, "total_loss": 30.57103157043457, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01693807542324066}, "num_steps_trained": 13883003, "load_time_ms": 21.518, "update_time_ms": 11.547, "sample_time_ms": 15499.468, "num_steps_sampled": 13883003}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 59.96311932643667, "episodes_total": 8268, "episodes_this_iter": 73, "time_total_s": 4964.994478225708, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105614, "timestamp": 1556524502, "episode_len_mean": 679.87, "time_since_restore": 5002.326242923737, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 935.2669473797207, "cost2_mean": -59.341608508601276, "outflow_rate_max": 1105.2130254244705, "system_level_velocity_min": 9.988767004193091, "cost2_max": -13.846838847998324, "cost2_min": -133.8677312764513, "system_level_velocity_mean": 14.45275497008541, "cost1_min": 11.744862675562908, "cost1_max": 433.93358936962227, "cost1_mean": 358.05835880103933, "system_level_velocity_max": 18.42851144389002}, "timesteps_total": 13988617, "training_iteration": 129, "date": "2019-04-29_07-55-02", "timesteps_since_restore": 13988617, "episode_reward_max": 1017.0274182141986, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 777.4204765324654, "iterations_since_restore": 129, "time_this_iter_s": 37.331764698028564, "info": {"grad_time_ms": 22329.922, "default": {"entropy": 1.847434639930725, "kl": 0.016295811161398888, "cur_lr": 0.0005000000237487257, "vf_loss": 27.464080810546875, "vf_explained_var": 0.6589235663414001, "total_loss": 27.455440521240234, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016893722116947174}, "num_steps_trained": 13988617, "load_time_ms": 21.808, "update_time_ms": 12.014, "sample_time_ms": 15566.386, "num_steps_sampled": 13988617}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49208>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 23.573313367279624, "episodes_total": 8334, "episodes_this_iter": 66, "time_total_s": 5002.326242923737, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104762, "timestamp": 1556524539, "episode_len_mean": 679.78, "time_since_restore": 5039.353455781937, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 936.0895784134107, "cost2_mean": -59.868891209056684, "outflow_rate_max": 1141.8875833614673, "system_level_velocity_min": 8.422355639984694, "cost2_max": -13.846838847998324, "cost2_min": -99.5007569393058, "system_level_velocity_mean": 14.536570459422382, "cost1_min": 11.744862675562908, "cost1_max": 438.58588038889474, "cost1_mean": 360.80451249710967, "system_level_velocity_max": 18.250050578232887}, "timesteps_total": 14093379, "training_iteration": 130, "date": "2019-04-29_07-55-39", "timesteps_since_restore": 14093379, "episode_reward_max": 1017.0274182141986, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 786.2519689400023, "iterations_since_restore": 130, "time_this_iter_s": 37.02721285820007, "info": {"grad_time_ms": 22074.08, "default": {"entropy": 1.8253517150878906, "kl": 0.016378384083509445, "cur_lr": 0.0005000000237487257, "vf_loss": 28.853124618530273, "vf_explained_var": 0.5955531001091003, "total_loss": 28.844572067260742, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016847092658281326}, "num_steps_trained": 14093379, "load_time_ms": 21.709, "update_time_ms": 11.932, "sample_time_ms": 15577.889, "num_steps_sampled": 14093379}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbc88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb4e0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 23.573313367279624, "episodes_total": 8401, "episodes_this_iter": 67, "time_total_s": 5039.353455781937, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105572, "timestamp": 1556524576, "episode_len_mean": 698.36, "time_since_restore": 5076.243713617325, "done": false, "custom_metrics": {"outflow_rate_min": 764.1329361380017, "outflow_rate_mean": 957.0543017959587, "cost2_mean": -55.90451678728563, "outflow_rate_max": 1195.0146150486673, "system_level_velocity_min": 9.668058736228343, "cost2_max": -27.393859757307588, "cost2_min": -107.24839814826467, "system_level_velocity_mean": 14.938999054214849, "cost1_min": 249.58409198310363, "cost1_max": 450.89673626311674, "cost1_mean": 382.2700489871397, "system_level_velocity_max": 17.93489784995287}, "timesteps_total": 14198951, "training_iteration": 131, "date": "2019-04-29_07-56-16", "timesteps_since_restore": 14198951, "episode_reward_max": 969.7087135886662, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 812.6622741588512, "iterations_since_restore": 131, "time_this_iter_s": 36.890257835388184, "info": {"grad_time_ms": 22047.652, "default": {"entropy": 1.853286623954773, "kl": 0.015211130492389202, "cur_lr": 0.0005000000237487257, "vf_loss": 26.969436645507812, "vf_explained_var": 0.6526381373405457, "total_loss": 26.960947036743164, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016191599890589714}, "num_steps_trained": 14198951, "load_time_ms": 21.478, "update_time_ms": 11.85, "sample_time_ms": 15541.128, "num_steps_sampled": 14198951}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d496a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49240>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 624.6911555818311, "episodes_total": 8468, "episodes_this_iter": 67, "time_total_s": 5076.243713617325, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105917, "timestamp": 1556524614, "episode_len_mean": 684.77, "time_since_restore": 5114.503220319748, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 954.9403689622153, "cost2_mean": -54.9973708495402, "outflow_rate_max": 1127.6037668286272, "system_level_velocity_min": 9.668058736228343, "cost2_max": -11.813726503851688, "cost2_min": -107.24839814826467, "system_level_velocity_mean": 14.908618715068888, "cost1_min": 11.637848081242236, "cost1_max": 447.5583770631309, "cost1_mean": 373.95371903075215, "system_level_velocity_max": 17.932265907400758}, "timesteps_total": 14304868, "training_iteration": 132, "date": "2019-04-29_07-56-54", "timesteps_since_restore": 14304868, "episode_reward_max": 968.5074643788515, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 809.1239060216247, "iterations_since_restore": 132, "time_this_iter_s": 38.259506702423096, "info": {"grad_time_ms": 22014.042, "default": {"entropy": 1.8425740003585815, "kl": 0.015517789870500565, "cur_lr": 0.0005000000237487257, "vf_loss": 28.897052764892578, "vf_explained_var": 0.6309581398963928, "total_loss": 28.887195587158203, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017712783068418503}, "num_steps_trained": 14304868, "load_time_ms": 20.59, "update_time_ms": 11.784, "sample_time_ms": 15543.071, "num_steps_sampled": 14304868}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbd68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 26.563861569169, "episodes_total": 8536, "episodes_this_iter": 68, "time_total_s": 5114.503220319748, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104072, "timestamp": 1556524651, "episode_len_mean": 681.13, "time_since_restore": 5151.3138654232025, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 934.4940571302885, "cost2_mean": -56.75164722546212, "outflow_rate_max": 1127.6037668286272, "system_level_velocity_min": 9.185787079219025, "cost2_max": -13.438638155744535, "cost2_min": -104.36773718349704, "system_level_velocity_mean": 14.388763873458448, "cost1_min": 11.637848081242236, "cost1_max": 453.2456333264895, "cost1_mean": 358.05486110163105, "system_level_velocity_max": 17.671881649056157}, "timesteps_total": 14408940, "training_iteration": 133, "date": "2019-04-29_07-57-31", "timesteps_since_restore": 14408940, "episode_reward_max": 974.4253027281508, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 789.893307014809, "iterations_since_restore": 133, "time_this_iter_s": 36.81064510345459, "info": {"grad_time_ms": 21960.862, "default": {"entropy": 1.857327938079834, "kl": 0.015488370321691036, "cur_lr": 0.0005000000237487257, "vf_loss": 27.039119720458984, "vf_explained_var": 0.6297253966331482, "total_loss": 27.029565811157227, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017393557354807854}, "num_steps_trained": 14408940, "load_time_ms": 20.47, "update_time_ms": 11.714, "sample_time_ms": 15522.251, "num_steps_sampled": 14408940}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d494a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49d30>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 26.571079252861185, "episodes_total": 8603, "episodes_this_iter": 67, "time_total_s": 5151.3138654232025, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103777, "timestamp": 1556524689, "episode_len_mean": 683.81, "time_since_restore": 5189.262673854828, "done": false, "custom_metrics": {"outflow_rate_min": 490.3369448649205, "outflow_rate_mean": 943.2389225456724, "cost2_mean": -54.28024012359948, "outflow_rate_max": 1155.5707942924269, "system_level_velocity_min": 9.185787079219025, "cost2_max": -16.41925802042656, "cost2_min": -106.83470926542147, "system_level_velocity_mean": 14.783918428582911, "cost1_min": 21.34406141322769, "cost1_max": 453.49454942082684, "cost1_mean": 368.9350365843175, "system_level_velocity_max": 18.625038789097673}, "timesteps_total": 14512717, "training_iteration": 134, "date": "2019-04-29_07-58-09", "timesteps_since_restore": 14512717, "episode_reward_max": 974.4253027281508, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 788.0809384880055, "iterations_since_restore": 134, "time_this_iter_s": 37.948808431625366, "info": {"grad_time_ms": 22082.258, "default": {"entropy": 1.8257462978363037, "kl": 0.017072012647986412, "cur_lr": 0.0005000000237487257, "vf_loss": 31.95180320739746, "vf_explained_var": 0.53794926404953, "total_loss": 31.94381332397461, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01663203351199627}, "num_steps_trained": 14512717, "load_time_ms": 20.498, "update_time_ms": 11.712, "sample_time_ms": 15518.29, "num_steps_sampled": 14512717}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb5f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 41.602751620567076, "episodes_total": 8678, "episodes_this_iter": 75, "time_total_s": 5189.262673854828, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104487, "timestamp": 1556524728, "episode_len_mean": 679.97, "time_since_restore": 5228.146693229675, "done": false, "custom_metrics": {"outflow_rate_min": 435.97980633183084, "outflow_rate_mean": 935.3840368192472, "cost2_mean": -52.04701149318666, "outflow_rate_max": 1174.8109430072852, "system_level_velocity_min": 10.789272715997491, "cost2_max": -15.872756865577514, "cost2_min": -106.83470926542147, "system_level_velocity_mean": 14.971332204331821, "cost1_min": 14.29703168576709, "cost1_max": 458.00868578467447, "cost1_mean": 370.62267823399685, "system_level_velocity_max": 18.700227660733535}, "timesteps_total": 14617204, "training_iteration": 135, "date": "2019-04-29_07-58-48", "timesteps_since_restore": 14617204, "episode_reward_max": 953.6537596895013, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 774.5273254834306, "iterations_since_restore": 135, "time_this_iter_s": 38.88401937484741, "info": {"grad_time_ms": 22163.782, "default": {"entropy": 1.8230032920837402, "kl": 0.01618853583931923, "cur_lr": 0.0005000000237487257, "vf_loss": 29.512035369873047, "vf_explained_var": 0.5862477421760559, "total_loss": 29.503360748291016, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016867943108081818}, "num_steps_trained": 14617204, "load_time_ms": 19.36, "update_time_ms": 11.852, "sample_time_ms": 15538.311, "num_steps_sampled": 14617204}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d490b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a58>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 36.52179302039385, "episodes_total": 8752, "episodes_this_iter": 74, "time_total_s": 5228.146693229675, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104055, "timestamp": 1556524765, "episode_len_mean": 693.2, "time_since_restore": 5264.816906929016, "done": false, "custom_metrics": {"outflow_rate_min": 443.01748075831955, "outflow_rate_mean": 941.4739204867885, "cost2_mean": -55.84505899115786, "outflow_rate_max": 1137.741494585074, "system_level_velocity_min": 10.471399576986034, "cost2_max": -15.5119092783083, "cost2_min": -113.28451810769762, "system_level_velocity_mean": 14.773167750474279, "cost1_min": 13.295701078841946, "cost1_max": 452.0183616038469, "cost1_mean": 374.0118206375371, "system_level_velocity_max": 17.729517425592643}, "timesteps_total": 14721259, "training_iteration": 136, "date": "2019-04-29_07-59-25", "timesteps_since_restore": 14721259, "episode_reward_max": 949.1415563545335, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 798.2320986216693, "iterations_since_restore": 136, "time_this_iter_s": 36.67021369934082, "info": {"grad_time_ms": 22009.636, "default": {"entropy": 1.8330483436584473, "kl": 0.015772080048918724, "cur_lr": 0.0005000000237487257, "vf_loss": 30.91583251953125, "vf_explained_var": 0.5844568014144897, "total_loss": 30.907665252685547, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01615205593407154}, "num_steps_trained": 14721259, "load_time_ms": 20.169, "update_time_ms": 11.702, "sample_time_ms": 15524.932, "num_steps_sampled": 14721259}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41f60>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 33.50358693884742, "episodes_total": 8821, "episodes_this_iter": 69, "time_total_s": 5264.816906929016, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104191, "timestamp": 1556524803, "episode_len_mean": 693.34, "time_since_restore": 5303.339452266693, "done": false, "custom_metrics": {"outflow_rate_min": 483.97672789677733, "outflow_rate_mean": 950.6222464497562, "cost2_mean": -55.70314024067679, "outflow_rate_max": 1137.741494585074, "system_level_velocity_min": 8.968367956188198, "cost2_max": -20.915352229562444, "cost2_min": -113.28451810769762, "system_level_velocity_mean": 15.08145463330697, "cost1_min": 22.291646082399666, "cost1_max": 452.0183616038469, "cost1_mean": 380.4254225282244, "system_level_velocity_max": 17.77752045118398}, "timesteps_total": 14825450, "training_iteration": 137, "date": "2019-04-29_08-00-03", "timesteps_since_restore": 14825450, "episode_reward_max": 987.229667725843, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 802.3320761599232, "iterations_since_restore": 137, "time_this_iter_s": 38.522545337677, "info": {"grad_time_ms": 21960.836, "default": {"entropy": 1.857846736907959, "kl": 0.01581442542374134, "cur_lr": 0.0005000000237487257, "vf_loss": 29.72752571105957, "vf_explained_var": 0.5831813216209412, "total_loss": 29.717496871948242, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.0180364940315485}, "num_steps_trained": 14825450, "load_time_ms": 20.567, "update_time_ms": 11.805, "sample_time_ms": 15556.812, "num_steps_sampled": 14825450}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d492e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49198>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 49.006699660574, "episodes_total": 8891, "episodes_this_iter": 70, "time_total_s": 5303.339452266693, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103042, "timestamp": 1556524840, "episode_len_mean": 691.21, "time_since_restore": 5339.845056056976, "done": false, "custom_metrics": {"outflow_rate_min": 483.97672789677733, "outflow_rate_mean": 949.0552874299605, "cost2_mean": -52.352032612940164, "outflow_rate_max": 1128.4466169478571, "system_level_velocity_min": 11.538033788991255, "cost2_max": -20.915352229562444, "cost2_min": -105.52637686769944, "system_level_velocity_mean": 15.131221810569127, "cost1_min": 22.291646082399666, "cost1_max": 446.1808839009514, "cost1_mean": 381.2310127570964, "system_level_velocity_max": 17.816417501678426}, "timesteps_total": 14928492, "training_iteration": 138, "date": "2019-04-29_08-00-40", "timesteps_since_restore": 14928492, "episode_reward_max": 987.229667725843, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 795.5034560942308, "iterations_since_restore": 138, "time_this_iter_s": 36.5056037902832, "info": {"grad_time_ms": 21751.434, "default": {"entropy": 1.8611794710159302, "kl": 0.015625089406967163, "cur_lr": 0.0005000000237487257, "vf_loss": 28.738006591796875, "vf_explained_var": 0.5617545247077942, "total_loss": 28.72958755493164, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016330275684595108}, "num_steps_trained": 14928492, "load_time_ms": 19.297, "update_time_ms": 11.826, "sample_time_ms": 15482.443, "num_steps_sampled": 14928492}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41278>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 49.006699660574, "episodes_total": 8956, "episodes_this_iter": 65, "time_total_s": 5339.845056056976, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104290, "timestamp": 1556524879, "episode_len_mean": 692.72, "time_since_restore": 5378.578876256943, "done": false, "custom_metrics": {"outflow_rate_min": 744.2123537406509, "outflow_rate_mean": 935.7986337533417, "cost2_mean": -49.437546272057105, "outflow_rate_max": 1125.2745399053101, "system_level_velocity_min": 9.779533268784942, "cost2_max": -24.557276145933585, "cost2_min": -104.97274992806994, "system_level_velocity_mean": 14.946907508667715, "cost1_min": 93.50647535433839, "cost1_max": 445.1946496669848, "cost1_mean": 377.6520951579527, "system_level_velocity_max": 18.025597635703075}, "timesteps_total": 15032782, "training_iteration": 139, "date": "2019-04-29_08-01-19", "timesteps_since_restore": 15032782, "episode_reward_max": 980.4041297367277, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 780.2726389351815, "iterations_since_restore": 139, "time_this_iter_s": 38.73382019996643, "info": {"grad_time_ms": 21926.844, "default": {"entropy": 1.8747196197509766, "kl": 0.015170050784945488, "cur_lr": 0.0005000000237487257, "vf_loss": 32.09742736816406, "vf_explained_var": 0.4922281503677368, "total_loss": 32.08933639526367, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015774253755807877}, "num_steps_trained": 15032782, "load_time_ms": 19.117, "update_time_ms": 11.468, "sample_time_ms": 15449.377, "num_steps_sampled": 15032782}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d496a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a90>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 188.72364054027432, "episodes_total": 9033, "episodes_this_iter": 77, "time_total_s": 5378.578876256943, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104107, "timestamp": 1556524917, "episode_len_mean": 689.36, "time_since_restore": 5417.187447547913, "done": false, "custom_metrics": {"outflow_rate_min": 491.93862375036906, "outflow_rate_mean": 926.527856315553, "cost2_mean": -51.629875637840975, "outflow_rate_max": 1145.775890713188, "system_level_velocity_min": 10.399048952749457, "cost2_max": -21.958091073130937, "cost2_min": -104.97274992806994, "system_level_velocity_mean": 14.577174350650992, "cost1_min": 26.43661928482473, "cost1_max": 446.65105586433026, "cost1_mean": 366.3737067662004, "system_level_velocity_max": 18.598539328960758}, "timesteps_total": 15136889, "training_iteration": 140, "date": "2019-04-29_08-01-57", "timesteps_since_restore": 15136889, "episode_reward_max": 951.1477918701484, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 774.4354207714246, "iterations_since_restore": 140, "time_this_iter_s": 38.60857129096985, "info": {"grad_time_ms": 22102.017, "default": {"entropy": 1.8974990844726562, "kl": 0.01576860435307026, "cur_lr": 0.0005000000237487257, "vf_loss": 25.68269920349121, "vf_explained_var": 0.5945149064064026, "total_loss": 25.674333572387695, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01635097526013851}, "num_steps_trained": 15136889, "load_time_ms": 19.979, "update_time_ms": 11.51, "sample_time_ms": 15430.126, "num_steps_sampled": 15136889}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 56.85450304690768, "episodes_total": 9096, "episodes_this_iter": 63, "time_total_s": 5417.187447547913, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103143, "timestamp": 1556524955, "episode_len_mean": 690.69, "time_since_restore": 5455.266868114471, "done": false, "custom_metrics": {"outflow_rate_min": 491.93862375036906, "outflow_rate_mean": 926.1652734963734, "cost2_mean": -50.76954617535586, "outflow_rate_max": 1102.586883098934, "system_level_velocity_min": 11.005637329250048, "cost2_max": -21.958091073130937, "cost2_min": -93.2073743802195, "system_level_velocity_mean": 14.570363299048672, "cost1_min": 26.43661928482473, "cost1_max": 441.8769429409683, "cost1_mean": 367.2373139968385, "system_level_velocity_max": 18.598539328960758}, "timesteps_total": 15240032, "training_iteration": 141, "date": "2019-04-29_08-02-35", "timesteps_since_restore": 15240032, "episode_reward_max": 934.3132659655507, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 777.5341986964313, "iterations_since_restore": 141, "time_this_iter_s": 38.07942056655884, "info": {"grad_time_ms": 22230.828, "default": {"entropy": 1.8875792026519775, "kl": 0.016364336013793945, "cur_lr": 0.0005000000237487257, "vf_loss": 30.02549934387207, "vf_explained_var": 0.49675798416137695, "total_loss": 30.017370223999023, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016412248834967613}, "num_steps_trained": 15240032, "load_time_ms": 20.059, "update_time_ms": 11.175, "sample_time_ms": 15421.079, "num_steps_sampled": 15240032}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 56.85450304690768, "episodes_total": 9165, "episodes_this_iter": 69, "time_total_s": 5455.266868114471, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104087, "timestamp": 1556524994, "episode_len_mean": 675.05, "time_since_restore": 5493.902321100235, "done": false, "custom_metrics": {"outflow_rate_min": 464.32649368107076, "outflow_rate_mean": 927.3066158055773, "cost2_mean": -48.682729821865934, "outflow_rate_max": 1120.680804386727, "system_level_velocity_min": 11.397296520369496, "cost2_max": -13.536967866639898, "cost2_min": -98.4783567189967, "system_level_velocity_mean": 14.9627729451903, "cost1_min": 11.812989198676009, "cost1_max": 444.7839962057392, "cost1_mean": 366.3736047275826, "system_level_velocity_max": 18.88381713431496}, "timesteps_total": 15344119, "training_iteration": 142, "date": "2019-04-29_08-03-14", "timesteps_since_restore": 15344119, "episode_reward_max": 982.8372085902262, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 764.5981020024141, "iterations_since_restore": 142, "time_this_iter_s": 38.63545298576355, "info": {"grad_time_ms": 22271.67, "default": {"entropy": 1.8983248472213745, "kl": 0.016129855066537857, "cur_lr": 0.0005000000237487257, "vf_loss": 29.347450256347656, "vf_explained_var": 0.5649595856666565, "total_loss": 29.3378849029541, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017731627449393272}, "num_steps_trained": 15344119, "load_time_ms": 19.928, "update_time_ms": 11.071, "sample_time_ms": 15420.847, "num_steps_sampled": 15344119}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41358>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 29.581119319703564, "episodes_total": 9239, "episodes_this_iter": 74, "time_total_s": 5493.902321100235, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103536, "timestamp": 1556525032, "episode_len_mean": 668.54, "time_since_restore": 5531.784950256348, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 904.1856095559247, "cost2_mean": -48.552020277863804, "outflow_rate_max": 1120.680804386727, "system_level_velocity_min": 9.703327973030778, "cost2_max": -13.309957366335057, "cost2_min": -85.11706338999181, "system_level_velocity_mean": 14.616723829067434, "cost1_min": 12.457067174684576, "cost1_max": 444.7839962057392, "cost1_mean": 353.73964932920006, "system_level_velocity_max": 18.88381713431496}, "timesteps_total": 15447655, "training_iteration": 143, "date": "2019-04-29_08-03-52", "timesteps_since_restore": 15447655, "episode_reward_max": 939.9451997033372, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 750.4951872000045, "iterations_since_restore": 143, "time_this_iter_s": 37.88262915611267, "info": {"grad_time_ms": 22293.848, "default": {"entropy": 1.9231350421905518, "kl": 0.015199059620499611, "cur_lr": 0.0005000000237487257, "vf_loss": 30.438138961791992, "vf_explained_var": 0.5867984294891357, "total_loss": 30.428449630737305, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017383355647325516}, "num_steps_trained": 15447655, "load_time_ms": 20.106, "update_time_ms": 10.986, "sample_time_ms": 15506.536, "num_steps_sampled": 15447655}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49d30>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 31.64709120442412, "episodes_total": 9314, "episodes_this_iter": 75, "time_total_s": 5531.784950256348, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104101, "timestamp": 1556525070, "episode_len_mean": 688.43, "time_since_restore": 5569.447367668152, "done": false, "custom_metrics": {"outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 920.110058527274, "cost2_mean": -49.289335000076974, "outflow_rate_max": 1095.659284056779, "system_level_velocity_min": 10.550864695940124, "cost2_max": -15.45023344594994, "cost2_min": -92.88994026658224, "system_level_velocity_mean": 14.594987422114983, "cost1_min": 15.507081365812901, "cost1_max": 443.03480536196605, "cost1_mean": 367.0208548931875, "system_level_velocity_max": 17.474317187390398}, "timesteps_total": 15551756, "training_iteration": 144, "date": "2019-04-29_08-04-30", "timesteps_since_restore": 15551756, "episode_reward_max": 995.8495064983343, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 775.5957499058771, "iterations_since_restore": 144, "time_this_iter_s": 37.6624174118042, "info": {"grad_time_ms": 22315.566, "default": {"entropy": 1.9061977863311768, "kl": 0.016535701230168343, "cur_lr": 0.0005000000237487257, "vf_loss": 26.641576766967773, "vf_explained_var": 0.5837602019309998, "total_loss": 26.63214874267578, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01779790222644806}, "num_steps_trained": 15551756, "load_time_ms": 20.093, "update_time_ms": 10.887, "sample_time_ms": 15458.289, "num_steps_sampled": 15551756}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b26d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d416d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41748>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 38.122902355356636, "episodes_total": 9383, "episodes_this_iter": 69, "time_total_s": 5569.447367668152, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103173, "timestamp": 1556525109, "episode_len_mean": 700.0, "time_since_restore": 5608.038632392883, "done": false, "custom_metrics": {"outflow_rate_min": 779.0726436128863, "outflow_rate_mean": 932.0695410031394, "cost2_mean": -50.77926540191957, "outflow_rate_max": 1083.6131610698649, "system_level_velocity_min": 10.540213648438641, "cost2_max": -24.063185549700844, "cost2_min": -99.104188257646, "system_level_velocity_mean": 14.680560536894461, "cost1_min": 268.3063676395216, "cost1_max": 444.82146543921453, "cost1_mean": 375.58987737663773, "system_level_velocity_max": 17.63313833282988}, "timesteps_total": 15654929, "training_iteration": 145, "date": "2019-04-29_08-05-09", "timesteps_since_restore": 15654929, "episode_reward_max": 963.2338520195912, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 783.9780700582512, "iterations_since_restore": 145, "time_this_iter_s": 38.591264724731445, "info": {"grad_time_ms": 22320.965, "default": {"entropy": 1.9220815896987915, "kl": 0.016620049253106117, "cur_lr": 0.0005000000237487257, "vf_loss": 28.016977310180664, "vf_explained_var": 0.5532642006874084, "total_loss": 28.00878143310547, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01660841703414917}, "num_steps_trained": 15654929, "load_time_ms": 20.996, "update_time_ms": 11.048, "sample_time_ms": 15423.358, "num_steps_sampled": 15654929}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49550>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 638.5266411693947, "episodes_total": 9448, "episodes_this_iter": 65, "time_total_s": 5608.038632392883, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103506, "timestamp": 1556525145, "episode_len_mean": 694.32, "time_since_restore": 5644.916631937027, "done": false, "custom_metrics": {"outflow_rate_min": 691.9540429329105, "outflow_rate_mean": 921.6943032463222, "cost2_mean": -51.32639473887279, "outflow_rate_max": 1097.3284999231305, "system_level_velocity_min": 10.43949505342225, "cost2_max": -26.805817368492693, "cost2_min": -99.104188257646, "system_level_velocity_mean": 14.609601148387453, "cost1_min": 83.68954838333019, "cost1_max": 444.82146543921453, "cost1_mean": 369.94087741464557, "system_level_velocity_max": 17.860429902923176}, "timesteps_total": 15758435, "training_iteration": 146, "date": "2019-04-29_08-05-45", "timesteps_since_restore": 15758435, "episode_reward_max": 911.0516562762409, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 768.8489717573303, "iterations_since_restore": 146, "time_this_iter_s": 36.87799954414368, "info": {"grad_time_ms": 22332.647, "default": {"entropy": 1.9252557754516602, "kl": 0.015694091096520424, "cur_lr": 0.0005000000237487257, "vf_loss": 28.107757568359375, "vf_explained_var": 0.5693772435188293, "total_loss": 28.099693298339844, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016008326783776283}, "num_steps_trained": 15758435, "load_time_ms": 21.483, "update_time_ms": 11.012, "sample_time_ms": 15431.541, "num_steps_sampled": 15758435}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbb00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb470>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 189.99555254830577, "episodes_total": 9518, "episodes_this_iter": 70, "time_total_s": 5644.916631937027, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103787, "timestamp": 1556525183, "episode_len_mean": 686.61, "time_since_restore": 5682.200442790985, "done": false, "custom_metrics": {"outflow_rate_min": 482.873066148424, "outflow_rate_mean": 928.4146078715447, "cost2_mean": -48.82808408737711, "outflow_rate_max": 1136.368019135925, "system_level_velocity_min": 9.844788973447688, "cost2_max": -15.61042117540922, "cost2_min": -83.05031022212614, "system_level_velocity_mean": 14.934210512996021, "cost1_min": 16.59218358863803, "cost1_max": 452.95215014087205, "cost1_mean": 372.2925967570443, "system_level_velocity_max": 17.855890164476122}, "timesteps_total": 15862222, "training_iteration": 147, "date": "2019-04-29_08-06-23", "timesteps_since_restore": 15862222, "episode_reward_max": 993.3072626262613, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 768.8833420654611, "iterations_since_restore": 147, "time_this_iter_s": 37.28381085395813, "info": {"grad_time_ms": 22257.345, "default": {"entropy": 1.9410759210586548, "kl": 0.01588515006005764, "cur_lr": 0.0005000000237487257, "vf_loss": 29.436092376708984, "vf_explained_var": 0.5235481858253479, "total_loss": 29.426755905151367, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017379581928253174}, "num_steps_trained": 15862222, "load_time_ms": 21.161, "update_time_ms": 10.897, "sample_time_ms": 15381.227, "num_steps_sampled": 15862222}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d492b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49278>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 37.373339934378826, "episodes_total": 9594, "episodes_this_iter": 76, "time_total_s": 5682.200442790985, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105711, "timestamp": 1556525220, "episode_len_mean": 688.05, "time_since_restore": 5719.5867030620575, "done": false, "custom_metrics": {"outflow_rate_min": 495.38848385431965, "outflow_rate_mean": 925.1737129452939, "cost2_mean": -50.03079332020462, "outflow_rate_max": 1136.368019135925, "system_level_velocity_min": 10.059292863063162, "cost2_max": -16.48023006577109, "cost2_min": -106.92784513870478, "system_level_velocity_mean": 14.734673555353476, "cost1_min": 18.754424832087665, "cost1_max": 450.01563134669414, "cost1_mean": 368.6047211757619, "system_level_velocity_max": 18.267195262282186}, "timesteps_total": 15967933, "training_iteration": 148, "date": "2019-04-29_08-07-00", "timesteps_since_restore": 15967933, "episode_reward_max": 993.3072626262613, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 772.3278339872224, "iterations_since_restore": 148, "time_this_iter_s": 37.38626027107239, "info": {"grad_time_ms": 22317.425, "default": {"entropy": 1.9629004001617432, "kl": 0.016872696578502655, "cur_lr": 0.0005000000237487257, "vf_loss": 27.653308868408203, "vf_explained_var": 0.6158420443534851, "total_loss": 27.643875122070312, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017976805567741394}, "num_steps_trained": 15967933, "load_time_ms": 22.27, "update_time_ms": 10.918, "sample_time_ms": 15405.071, "num_steps_sampled": 15967933}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d416d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d414e0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 43.4930913223075, "episodes_total": 9663, "episodes_this_iter": 69, "time_total_s": 5719.5867030620575, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103355, "timestamp": 1556525257, "episode_len_mean": 699.06, "time_since_restore": 5756.302577018738, "done": false, "custom_metrics": {"outflow_rate_min": 703.1791806640503, "outflow_rate_mean": 918.1712249737711, "cost2_mean": -52.51737441287692, "outflow_rate_max": 1132.6607216563061, "system_level_velocity_min": 9.843928968335158, "cost2_max": -26.30393225608767, "cost2_min": -106.92784513870478, "system_level_velocity_mean": 14.359237249927554, "cost1_min": 252.35390710982298, "cost1_max": 455.0891824566214, "cost1_mean": 367.24778132749213, "system_level_velocity_max": 17.84567219460041}, "timesteps_total": 16071288, "training_iteration": 149, "date": "2019-04-29_08-07-37", "timesteps_since_restore": 16071288, "episode_reward_max": 982.2886771080582, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 773.1526794177548, "iterations_since_restore": 149, "time_this_iter_s": 36.7158739566803, "info": {"grad_time_ms": 22208.883, "default": {"entropy": 1.9745349884033203, "kl": 0.01655103825032711, "cur_lr": 0.0005000000237487257, "vf_loss": 28.303850173950195, "vf_explained_var": 0.592496395111084, "total_loss": 28.295509338378906, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016718901693820953}, "num_steps_trained": 16071288, "load_time_ms": 22.339, "update_time_ms": 11.046, "sample_time_ms": 15309.953, "num_steps_sampled": 16071288}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49978>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 571.8782745705548, "episodes_total": 9732, "episodes_this_iter": 69, "time_total_s": 5756.302577018738, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103453, "timestamp": 1556525295, "episode_len_mean": 685.65, "time_since_restore": 5793.754085063934, "done": false, "custom_metrics": {"outflow_rate_min": 528.1883309282696, "outflow_rate_mean": 908.9078178521205, "cost2_mean": -49.55468321839658, "outflow_rate_max": 1132.6607216563061, "system_level_velocity_min": 9.968522137534672, "cost2_max": -19.828934276045402, "cost2_min": -75.29175038890419, "system_level_velocity_mean": 14.801007180094166, "cost1_min": 28.32034307704736, "cost1_max": 455.0891824566214, "cost1_mean": 368.11221418466613, "system_level_velocity_max": 18.634884227468593}, "timesteps_total": 16174741, "training_iteration": 150, "date": "2019-04-29_08-08-15", "timesteps_since_restore": 16174741, "episode_reward_max": 933.930569067921, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 767.6481843229872, "iterations_since_restore": 150, "time_this_iter_s": 37.45150804519653, "info": {"grad_time_ms": 22110.093, "default": {"entropy": 1.9625736474990845, "kl": 0.016775334253907204, "cur_lr": 0.0005000000237487257, "vf_loss": 28.97078514099121, "vf_explained_var": 0.5717828869819641, "total_loss": 28.96132469177246, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017952991649508476}, "num_steps_trained": 16174741, "load_time_ms": 21.494, "update_time_ms": 11.021, "sample_time_ms": 15294.641, "num_steps_sampled": 16174741}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb358>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 62.79257537080605, "episodes_total": 9803, "episodes_this_iter": 71, "time_total_s": 5793.754085063934, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104520, "timestamp": 1556525334, "episode_len_mean": 662.31, "time_since_restore": 5832.939359903336, "done": false, "custom_metrics": {"outflow_rate_min": 432.04939146579807, "outflow_rate_mean": 893.5668747246838, "cost2_mean": -47.396629134554566, "outflow_rate_max": 1096.5559848995906, "system_level_velocity_min": 9.968522137534672, "cost2_max": -14.125499617857985, "cost2_min": -74.52724964654938, "system_level_velocity_mean": 14.691905619344627, "cost1_min": 13.507666251794934, "cost1_max": 449.43992262283587, "cost1_mean": 351.76370155636306, "system_level_velocity_max": 18.776055055945005}, "timesteps_total": 16279261, "training_iteration": 151, "date": "2019-04-29_08-08-54", "timesteps_since_restore": 16279261, "episode_reward_max": 945.9301720420818, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 728.9955744294306, "iterations_since_restore": 151, "time_this_iter_s": 39.185274839401245, "info": {"grad_time_ms": 22071.138, "default": {"entropy": 1.9567335844039917, "kl": 0.01600220985710621, "cur_lr": 0.0005000000237487257, "vf_loss": 30.29724884033203, "vf_explained_var": 0.5656107068061829, "total_loss": 30.287384033203125, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01796576753258705}, "num_steps_trained": 16279261, "load_time_ms": 21.617, "update_time_ms": 11.234, "sample_time_ms": 15441.87, "num_steps_sampled": 16279261}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d410b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187193ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d418d0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.03927364134248, "episodes_total": 9881, "episodes_this_iter": 78, "time_total_s": 5832.939359903336, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103025, "timestamp": 1556525372, "episode_len_mean": 665.15, "time_since_restore": 5870.772208929062, "done": false, "custom_metrics": {"outflow_rate_min": 432.04939146579807, "outflow_rate_mean": 898.327662935159, "cost2_mean": -47.592831130011476, "outflow_rate_max": 1102.5051181401345, "system_level_velocity_min": 9.979003146942578, "cost2_max": -16.389754386107924, "cost2_min": -77.62341461209672, "system_level_velocity_mean": 14.774235832545536, "cost1_min": 13.507666251794934, "cost1_max": 452.2427689271551, "cost1_mean": 355.40298590201326, "system_level_velocity_max": 18.776055055945005}, "timesteps_total": 16382286, "training_iteration": 152, "date": "2019-04-29_08-09-32", "timesteps_since_restore": 16382286, "episode_reward_max": 945.3242444704774, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 736.7286719301717, "iterations_since_restore": 152, "time_this_iter_s": 37.83284902572632, "info": {"grad_time_ms": 21936.574, "default": {"entropy": 1.9521046876907349, "kl": 0.016743453219532967, "cur_lr": 0.0005000000237487257, "vf_loss": 31.127017974853516, "vf_explained_var": 0.5024950504302979, "total_loss": 31.118183135986328, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017312653362751007}, "num_steps_trained": 16382286, "load_time_ms": 22.671, "update_time_ms": 11.38, "sample_time_ms": 15492.226, "num_steps_sampled": 16382286}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49080>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.03927364134248, "episodes_total": 9952, "episodes_this_iter": 71, "time_total_s": 5870.772208929062, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104320, "timestamp": 1556525410, "episode_len_mean": 698.97, "time_since_restore": 5908.9963483810425, "done": false, "custom_metrics": {"outflow_rate_min": 707.4425921208801, "outflow_rate_mean": 924.6684690767329, "cost2_mean": -47.89234262261415, "outflow_rate_max": 1116.8277962422403, "system_level_velocity_min": 10.013209882909186, "cost2_max": -29.811968736993215, "cost2_min": -83.76353346848569, "system_level_velocity_mean": 14.823623211868144, "cost1_min": 255.91747407646997, "cost1_max": 454.9372734710515, "cost1_mean": 379.0032452266413, "system_level_velocity_max": 18.37811329348007}, "timesteps_total": 16486606, "training_iteration": 153, "date": "2019-04-29_08-10-10", "timesteps_since_restore": 16486606, "episode_reward_max": 970.1318932728041, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 784.122893324203, "iterations_since_restore": 153, "time_this_iter_s": 38.22413945198059, "info": {"grad_time_ms": 22062.107, "default": {"entropy": 1.9843140840530396, "kl": 0.015973789617419243, "cur_lr": 0.0005000000237487257, "vf_loss": 28.36770248413086, "vf_explained_var": 0.5534389615058899, "total_loss": 28.359411239624023, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01637876406311989}, "num_steps_trained": 16486606, "load_time_ms": 22.426, "update_time_ms": 11.385, "sample_time_ms": 15399.199, "num_steps_sampled": 16486606}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 566.7441473718973, "episodes_total": 10022, "episodes_this_iter": 70, "time_total_s": 5908.9963483810425, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103288, "timestamp": 1556525448, "episode_len_mean": 700.0, "time_since_restore": 5947.106163263321, "done": false, "custom_metrics": {"outflow_rate_min": 719.8931069510594, "outflow_rate_mean": 912.969812300911, "cost2_mean": -49.351739068623026, "outflow_rate_max": 1116.8277962422403, "system_level_velocity_min": 10.500590488216892, "cost2_max": -27.923432298548043, "cost2_min": -85.6153872730406, "system_level_velocity_mean": 14.420758257744257, "cost1_min": 269.3091166704371, "cost1_max": 461.38435605252226, "cost1_mean": 369.3075451358997, "system_level_velocity_max": 18.70657866484977}, "timesteps_total": 16589894, "training_iteration": 154, "date": "2019-04-29_08-10-48", "timesteps_since_restore": 16589894, "episode_reward_max": 923.5726797365808, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 757.1317157119587, "iterations_since_restore": 154, "time_this_iter_s": 38.10981488227844, "info": {"grad_time_ms": 22094.008, "default": {"entropy": 1.9906095266342163, "kl": 0.016958236694335938, "cur_lr": 0.0005000000237487257, "vf_loss": 26.855457305908203, "vf_explained_var": 0.5939099192619324, "total_loss": 26.8458251953125, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018216459080576897}, "num_steps_trained": 16589894, "load_time_ms": 22.644, "update_time_ms": 11.758, "sample_time_ms": 15409.603, "num_steps_sampled": 16589894}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49208>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 557.3703949224125, "episodes_total": 10091, "episodes_this_iter": 69, "time_total_s": 5947.106163263321, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104439, "timestamp": 1556525485, "episode_len_mean": 684.04, "time_since_restore": 5983.622757911682, "done": false, "custom_metrics": {"outflow_rate_min": 489.2517943188124, "outflow_rate_mean": 909.3613858976427, "cost2_mean": -47.927800222565104, "outflow_rate_max": 1066.2014089014501, "system_level_velocity_min": 9.643732616716742, "cost2_max": -18.155954689748466, "cost2_min": -81.74766186950725, "system_level_velocity_mean": 14.584812720043647, "cost1_min": 19.787767259278393, "cost1_max": 461.38435605252226, "cost1_mean": 363.6042198579787, "system_level_velocity_max": 18.88860278064381}, "timesteps_total": 16694333, "training_iteration": 155, "date": "2019-04-29_08-11-25", "timesteps_since_restore": 16694333, "episode_reward_max": 913.2408101392032, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 748.4740518657626, "iterations_since_restore": 155, "time_this_iter_s": 36.516594648361206, "info": {"grad_time_ms": 21865.441, "default": {"entropy": 1.998700499534607, "kl": 0.01641496829688549, "cur_lr": 0.0005000000237487257, "vf_loss": 28.188535690307617, "vf_explained_var": 0.5974987745285034, "total_loss": 28.18037223815918, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016474666073918343}, "num_steps_trained": 16694333, "load_time_ms": 22.48, "update_time_ms": 11.486, "sample_time_ms": 15431.962, "num_steps_sampled": 16694333}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d415f8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 40.66701168760215, "episodes_total": 10163, "episodes_this_iter": 72, "time_total_s": 5983.622757911682, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103925, "timestamp": 1556525523, "episode_len_mean": 675.04, "time_since_restore": 6021.585791349411, "done": false, "custom_metrics": {"outflow_rate_min": 465.40161577774745, "outflow_rate_mean": 887.589940752663, "cost2_mean": -48.353953211569326, "outflow_rate_max": 1105.3507563875787, "system_level_velocity_min": 10.272954594369805, "cost2_max": -13.637268369239644, "cost2_min": -84.93958723821106, "system_level_velocity_mean": 14.375397880512715, "cost1_min": 13.385881493440278, "cost1_max": 448.40809282389847, "cost1_mean": 352.07479120643467, "system_level_velocity_max": 19.157879577649513}, "timesteps_total": 16798258, "training_iteration": 156, "date": "2019-04-29_08-12-03", "timesteps_since_restore": 16798258, "episode_reward_max": 908.6588778535644, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 724.7392381661356, "iterations_since_restore": 156, "time_this_iter_s": 37.96303343772888, "info": {"grad_time_ms": 21928.829, "default": {"entropy": 2.0019328594207764, "kl": 0.016567973420023918, "cur_lr": 0.0005000000237487257, "vf_loss": 28.32801628112793, "vf_explained_var": 0.5758754014968872, "total_loss": 28.31910514831543, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01729573681950569}, "num_steps_trained": 16798258, "load_time_ms": 22.38, "update_time_ms": 11.67, "sample_time_ms": 15474.756, "num_steps_sampled": 16798258}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49898>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 31.95615487990166, "episodes_total": 10236, "episodes_this_iter": 73, "time_total_s": 6021.585791349411, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103522, "timestamp": 1556525560, "episode_len_mean": 679.64, "time_since_restore": 6059.210001945496, "done": false, "custom_metrics": {"outflow_rate_min": 454.74024246423585, "outflow_rate_mean": 894.7422434379622, "cost2_mean": -47.03350258534227, "outflow_rate_max": 1121.6645976421214, "system_level_velocity_min": 10.355376595004156, "cost2_max": -13.637268369239644, "cost2_min": -84.93958723821106, "system_level_velocity_mean": 14.676789063600884, "cost1_min": 13.080912659716974, "cost1_max": 458.6605953048996, "cost1_mean": 362.5010658242898, "system_level_velocity_max": 18.604659532594823}, "timesteps_total": 16901780, "training_iteration": 157, "date": "2019-04-29_08-12-40", "timesteps_since_restore": 16901780, "episode_reward_max": 977.8647107953138, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 734.4011960696746, "iterations_since_restore": 157, "time_this_iter_s": 37.624210596084595, "info": {"grad_time_ms": 21977.972, "default": {"entropy": 1.9982725381851196, "kl": 0.01640673540532589, "cur_lr": 0.0005000000237487257, "vf_loss": 30.138851165771484, "vf_explained_var": 0.5679094791412354, "total_loss": 30.131332397460938, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015824100002646446}, "num_steps_trained": 16901780, "load_time_ms": 22.427, "update_time_ms": 11.747, "sample_time_ms": 15458.749, "num_steps_sampled": 16901780}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41c88>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 24.177667103529725, "episodes_total": 10310, "episodes_this_iter": 74, "time_total_s": 6059.210001945496, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103408, "timestamp": 1556525600, "episode_len_mean": 684.93, "time_since_restore": 6098.305057764053, "done": false, "custom_metrics": {"outflow_rate_min": 454.74024246423585, "outflow_rate_mean": 902.5556264689643, "cost2_mean": -48.12640315708979, "outflow_rate_max": 1105.4701146648931, "system_level_velocity_min": 10.478616755377827, "cost2_max": -14.597226777897381, "cost2_min": -85.61386756772953, "system_level_velocity_mean": 14.553775433513229, "cost1_min": 13.080912659716974, "cost1_max": 448.1171196027168, "cost1_mean": 361.88253059426773, "system_level_velocity_max": 18.11995436140993}, "timesteps_total": 17005188, "training_iteration": 158, "date": "2019-04-29_08-13-20", "timesteps_since_restore": 17005188, "episode_reward_max": 921.4937066308271, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 733.7778295024714, "iterations_since_restore": 158, "time_this_iter_s": 39.09505581855774, "info": {"grad_time_ms": 22167.004, "default": {"entropy": 2.014317512512207, "kl": 0.01647254265844822, "cur_lr": 0.0005000000237487257, "vf_loss": 26.42118263244629, "vf_explained_var": 0.5682244896888733, "total_loss": 26.41267967224121, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016840167343616486}, "num_steps_trained": 17005188, "load_time_ms": 22.033, "update_time_ms": 12.122, "sample_time_ms": 15444.565, "num_steps_sampled": 17005188}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d490f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49588>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 24.177667103529725, "episodes_total": 10377, "episodes_this_iter": 67, "time_total_s": 6098.305057764053, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102842, "timestamp": 1556525638, "episode_len_mean": 691.84, "time_since_restore": 6136.270792961121, "done": false, "custom_metrics": {"outflow_rate_min": 487.087695360686, "outflow_rate_mean": 895.0177393660066, "cost2_mean": -49.52394209297224, "outflow_rate_max": 1091.6094990820604, "system_level_velocity_min": 9.607740440903653, "cost2_max": -18.763376366704836, "cost2_min": -76.50049163918223, "system_level_velocity_mean": 14.517115881357451, "cost1_min": 22.669819815112106, "cost1_max": 440.6167599765753, "cost1_mean": 364.53587149574724, "system_level_velocity_max": 18.049875592366504}, "timesteps_total": 17108030, "training_iteration": 159, "date": "2019-04-29_08-13-58", "timesteps_since_restore": 17108030, "episode_reward_max": 892.798065647836, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 740.4827997170592, "iterations_since_restore": 159, "time_this_iter_s": 37.96573519706726, "info": {"grad_time_ms": 22223.002, "default": {"entropy": 2.0137999057769775, "kl": 0.016161086037755013, "cur_lr": 0.0005000000237487257, "vf_loss": 27.12494468688965, "vf_explained_var": 0.564308762550354, "total_loss": 27.115869522094727, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017254255712032318}, "num_steps_trained": 17108030, "load_time_ms": 21.798, "update_time_ms": 12.118, "sample_time_ms": 15515.755, "num_steps_sampled": 17108030}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b27b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 49.781369464848055, "episodes_total": 10449, "episodes_this_iter": 72, "time_total_s": 6136.270792961121, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103717, "timestamp": 1556525676, "episode_len_mean": 693.01, "time_since_restore": 6174.312473058701, "done": false, "custom_metrics": {"outflow_rate_min": 487.087695360686, "outflow_rate_mean": 900.5007749266797, "cost2_mean": -45.43717430955712, "outflow_rate_max": 1056.145876669383, "system_level_velocity_min": 11.812479742386618, "cost2_max": -18.763376366704836, "cost2_min": -75.05836316538087, "system_level_velocity_mean": 15.01163514227912, "cost1_min": 22.669819815112106, "cost1_max": 440.6167599765753, "cost1_mean": 377.7792993515735, "system_level_velocity_max": 18.049875592366504}, "timesteps_total": 17211747, "training_iteration": 160, "date": "2019-04-29_08-14-36", "timesteps_since_restore": 17211747, "episode_reward_max": 892.1990675075249, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 753.5299140771904, "iterations_since_restore": 160, "time_this_iter_s": 38.041680097579956, "info": {"grad_time_ms": 22285.869, "default": {"entropy": 2.019742012023926, "kl": 0.016099348664283752, "cur_lr": 0.0005000000237487257, "vf_loss": 28.661272048950195, "vf_explained_var": 0.5545211434364319, "total_loss": 28.65299415588379, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01642889529466629}, "num_steps_trained": 17211747, "load_time_ms": 21.644, "update_time_ms": 12.108, "sample_time_ms": 15512.524, "num_steps_sampled": 17211747}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d492e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49518>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 49.781369464848055, "episodes_total": 10521, "episodes_this_iter": 72, "time_total_s": 6174.312473058701, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103359, "timestamp": 1556525714, "episode_len_mean": 691.25, "time_since_restore": 6212.251437425613, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 890.087409275175, "cost2_mean": -47.38453586246669, "outflow_rate_max": 1076.600938252613, "system_level_velocity_min": 9.500132817320901, "cost2_max": -12.71830614674239, "cost2_min": -82.5093678384761, "system_level_velocity_mean": 14.567783136257148, "cost1_min": 11.51308098510724, "cost1_max": 444.264251017152, "cost1_mean": 366.13107120369483, "system_level_velocity_max": 18.247969010824132}, "timesteps_total": 17315106, "training_iteration": 161, "date": "2019-04-29_08-15-14", "timesteps_since_restore": 17315106, "episode_reward_max": 940.2306045900422, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 745.1168304993053, "iterations_since_restore": 161, "time_this_iter_s": 37.93896436691284, "info": {"grad_time_ms": 22303.322, "default": {"entropy": 2.0001869201660156, "kl": 0.01673269085586071, "cur_lr": 0.0005000000237487257, "vf_loss": 29.74121856689453, "vf_explained_var": 0.5383697152137756, "total_loss": 29.73225975036621, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017430074512958527}, "num_steps_trained": 17315106, "load_time_ms": 20.604, "update_time_ms": 12.046, "sample_time_ms": 15369.934, "num_steps_sampled": 17315106}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb320>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 26.428159523152033, "episodes_total": 10593, "episodes_this_iter": 72, "time_total_s": 6212.251437425613, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102884, "timestamp": 1556525751, "episode_len_mean": 674.47, "time_since_restore": 6249.650851726532, "done": false, "custom_metrics": {"outflow_rate_min": 466.60013012053315, "outflow_rate_mean": 890.2376524872909, "cost2_mean": -46.72919620580513, "outflow_rate_max": 1098.5292952022494, "system_level_velocity_min": 9.906027881971943, "cost2_max": -16.734681130162475, "cost2_min": -69.82245031733012, "system_level_velocity_mean": 14.751893142359634, "cost1_min": 19.475582123932536, "cost1_max": 449.8040206425219, "cost1_mean": 360.14235629679314, "system_level_velocity_max": 18.26245523139216}, "timesteps_total": 17417990, "training_iteration": 162, "date": "2019-04-29_08-15-51", "timesteps_since_restore": 17417990, "episode_reward_max": 940.2306045900422, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 739.7310072904543, "iterations_since_restore": 162, "time_this_iter_s": 37.39941430091858, "info": {"grad_time_ms": 22318.41, "default": {"entropy": 1.9863934516906738, "kl": 0.016627417877316475, "cur_lr": 0.0005000000237487257, "vf_loss": 25.462003707885742, "vf_explained_var": 0.6312691569328308, "total_loss": 25.452409744262695, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.0180075503885746}, "num_steps_trained": 17417990, "load_time_ms": 20.232, "update_time_ms": 12.3, "sample_time_ms": 15313.291, "num_steps_sampled": 17417990}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f60>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 44.258514051396034, "episodes_total": 10668, "episodes_this_iter": 75, "time_total_s": 6249.650851726532, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103225, "timestamp": 1556525790, "episode_len_mean": 688.55, "time_since_restore": 6288.012821674347, "done": false, "custom_metrics": {"outflow_rate_min": 500.70758049886615, "outflow_rate_mean": 907.1369430540567, "cost2_mean": -46.50747983911392, "outflow_rate_max": 1105.0746739356825, "system_level_velocity_min": 11.257989137025373, "cost2_max": -16.734681130162475, "cost2_min": -81.29480321531668, "system_level_velocity_mean": 14.862641043711498, "cost1_min": 19.475582123932536, "cost1_max": 441.97605911539654, "cost1_mean": 371.59967731478895, "system_level_velocity_max": 18.26245523139216}, "timesteps_total": 17521215, "training_iteration": 163, "date": "2019-04-29_08-16-30", "timesteps_since_restore": 17521215, "episode_reward_max": 975.2828238540861, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 749.5603671312351, "iterations_since_restore": 163, "time_this_iter_s": 38.36196994781494, "info": {"grad_time_ms": 22356.618, "default": {"entropy": 1.9979716539382935, "kl": 0.016982892528176308, "cur_lr": 0.0005000000237487257, "vf_loss": 27.289688110351562, "vf_explained_var": 0.5763751864433289, "total_loss": 27.27970314025879, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018581384792923927}, "num_steps_trained": 17521215, "load_time_ms": 20.611, "update_time_ms": 12.266, "sample_time_ms": 15291.396, "num_steps_sampled": 17521215}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d416a0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 44.258514051396034, "episodes_total": 10739, "episodes_this_iter": 71, "time_total_s": 6288.012821674347, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102457, "timestamp": 1556525826, "episode_len_mean": 676.27, "time_since_restore": 6323.865399122238, "done": false, "custom_metrics": {"outflow_rate_min": 459.24275550364274, "outflow_rate_mean": 898.3228677383968, "cost2_mean": -44.79153114329947, "outflow_rate_max": 1104.1075654060794, "system_level_velocity_min": 9.723408686052574, "cost2_max": -14.051384985429184, "cost2_min": -77.09180992825443, "system_level_velocity_mean": 14.883878834382136, "cost1_min": 12.249946140647692, "cost1_max": 437.84147242135157, "cost1_mean": 364.7410517085253, "system_level_velocity_max": 18.14589241878069}, "timesteps_total": 17623672, "training_iteration": 164, "date": "2019-04-29_08-17-06", "timesteps_since_restore": 17623672, "episode_reward_max": 966.4018334449502, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 737.6224188943245, "iterations_since_restore": 164, "time_this_iter_s": 35.852577447891235, "info": {"grad_time_ms": 22114.838, "default": {"entropy": 2.0133559703826904, "kl": 0.017036069184541702, "cur_lr": 0.0005000000237487257, "vf_loss": 31.357080459594727, "vf_explained_var": 0.5685866475105286, "total_loss": 31.34835433959961, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01735001988708973}, "num_steps_trained": 17623672, "load_time_ms": 19.39, "update_time_ms": 12.005, "sample_time_ms": 15308.053, "num_steps_sampled": 17623672}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a90>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 22.608285088007285, "episodes_total": 10814, "episodes_this_iter": 75, "time_total_s": 6323.865399122238, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103115, "timestamp": 1556525864, "episode_len_mean": 691.18, "time_since_restore": 6361.970141887665, "done": false, "custom_metrics": {"outflow_rate_min": 459.24275550364274, "outflow_rate_mean": 898.4752244720096, "cost2_mean": -47.41982125454657, "outflow_rate_max": 1108.0355010440521, "system_level_velocity_min": 9.542337401938537, "cost2_max": -14.051384985429184, "cost2_min": -74.08401499674761, "system_level_velocity_mean": 14.620615807522913, "cost1_min": 12.249946140647692, "cost1_max": 450.5129417237529, "cost1_mean": 367.8458089139251, "system_level_velocity_max": 18.20495853223366}, "timesteps_total": 17726787, "training_iteration": 165, "date": "2019-04-29_08-17-44", "timesteps_since_restore": 17726787, "episode_reward_max": 958.0780914042006, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 741.2026842166712, "iterations_since_restore": 165, "time_this_iter_s": 38.104742765426636, "info": {"grad_time_ms": 22244.667, "default": {"entropy": 2.028040647506714, "kl": 0.016785085201263428, "cur_lr": 0.0005000000237487257, "vf_loss": 28.973480224609375, "vf_explained_var": 0.5464414358139038, "total_loss": 28.964611053466797, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017366159707307816}, "num_steps_trained": 17726787, "load_time_ms": 18.658, "update_time_ms": 12.063, "sample_time_ms": 15337.543, "num_steps_sampled": 17726787}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b2978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbf60>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 22.608285088007285, "episodes_total": 10892, "episodes_this_iter": 78, "time_total_s": 6361.970141887665, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102939, "timestamp": 1556525901, "episode_len_mean": 697.99, "time_since_restore": 6399.326126098633, "done": false, "custom_metrics": {"outflow_rate_min": 729.9007946671669, "outflow_rate_mean": 909.0088483616372, "cost2_mean": -48.409537635801634, "outflow_rate_max": 1108.0355010440521, "system_level_velocity_min": 9.542337401938537, "cost2_max": -30.039977080417117, "cost2_min": -77.80902587655297, "system_level_velocity_mean": 14.651508557880234, "cost1_min": 235.01507389136708, "cost1_max": 450.5129417237529, "cost1_mean": 372.4237418287137, "system_level_velocity_max": 17.749262987505087}, "timesteps_total": 17829726, "training_iteration": 166, "date": "2019-04-29_08-18-21", "timesteps_since_restore": 17829726, "episode_reward_max": 958.0780914042006, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 748.2901367378456, "iterations_since_restore": 166, "time_this_iter_s": 37.35598421096802, "info": {"grad_time_ms": 22260.284, "default": {"entropy": 2.0246939659118652, "kl": 0.016440635547041893, "cur_lr": 0.0005000000237487257, "vf_loss": 26.240814208984375, "vf_explained_var": 0.5800529718399048, "total_loss": 26.231739044189453, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01739698089659214}, "num_steps_trained": 17829726, "load_time_ms": 18.44, "update_time_ms": 11.766, "sample_time_ms": 15261.372, "num_steps_sampled": 17829726}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d492e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49dd8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 577.3535915021619, "episodes_total": 10961, "episodes_this_iter": 69, "time_total_s": 6399.326126098633, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103849, "timestamp": 1556525939, "episode_len_mean": 686.84, "time_since_restore": 6437.219834804535, "done": false, "custom_metrics": {"outflow_rate_min": 514.6241143808043, "outflow_rate_mean": 901.5795886270657, "cost2_mean": -46.651870630991546, "outflow_rate_max": 1101.6462177551734, "system_level_velocity_min": 10.303796876143561, "cost2_max": -17.182922781916677, "cost2_min": -77.80902587655297, "system_level_velocity_mean": 15.061903976811527, "cost1_min": 26.083420619077867, "cost1_max": 448.06032138416157, "cost1_mean": 373.79567526012084, "system_level_velocity_max": 18.380743963450225}, "timesteps_total": 17933575, "training_iteration": 167, "date": "2019-04-29_08-18-59", "timesteps_since_restore": 17933575, "episode_reward_max": 907.4359677257141, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 732.2680540983314, "iterations_since_restore": 167, "time_this_iter_s": 37.8937087059021, "info": {"grad_time_ms": 22307.654, "default": {"entropy": 2.021204948425293, "kl": 0.016845671460032463, "cur_lr": 0.0005000000237487257, "vf_loss": 28.54783821105957, "vf_explained_var": 0.6067496538162231, "total_loss": 28.537904739379883, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018463024869561195}, "num_steps_trained": 17933575, "load_time_ms": 17.699, "update_time_ms": 11.726, "sample_time_ms": 15241.274, "num_steps_sampled": 17933575}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41438>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 55.17581684726351, "episodes_total": 11033, "episodes_this_iter": 72, "time_total_s": 6437.219834804535, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102957, "timestamp": 1556525975, "episode_len_mean": 693.18, "time_since_restore": 6473.3523235321045, "done": false, "custom_metrics": {"outflow_rate_min": 464.32649368107076, "outflow_rate_mean": 894.2917076846878, "cost2_mean": -48.056126070483714, "outflow_rate_max": 1079.3798431219607, "system_level_velocity_min": 9.399405182490467, "cost2_max": -12.831312506729947, "cost2_min": -91.07346438650062, "system_level_velocity_mean": 14.701399494306848, "cost1_min": 11.571067077903933, "cost1_max": 458.48066070966183, "cost1_mean": 369.85268801953794, "system_level_velocity_max": 19.161849812664936}, "timesteps_total": 18036532, "training_iteration": 168, "date": "2019-04-29_08-19-35", "timesteps_since_restore": 18036532, "episode_reward_max": 943.2255351571216, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 730.854965116997, "iterations_since_restore": 168, "time_this_iter_s": 36.13248872756958, "info": {"grad_time_ms": 22025.445, "default": {"entropy": 2.0602879524230957, "kl": 0.016156215220689774, "cur_lr": 0.0005000000237487257, "vf_loss": 27.136266708374023, "vf_explained_var": 0.5919574499130249, "total_loss": 27.12669563293457, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017746752128005028}, "num_steps_trained": 18036532, "load_time_ms": 16.774, "update_time_ms": 11.465, "sample_time_ms": 15226.116, "num_steps_sampled": 18036532}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49278>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 29.07026178579416, "episodes_total": 11101, "episodes_this_iter": 68, "time_total_s": 6473.3523235321045, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103056, "timestamp": 1556526013, "episode_len_mean": 692.98, "time_since_restore": 6510.838711023331, "done": false, "custom_metrics": {"outflow_rate_min": 493.642108631002, "outflow_rate_mean": 895.680697711798, "cost2_mean": -46.91019677556667, "outflow_rate_max": 1079.3798431219607, "system_level_velocity_min": 8.869830214547463, "cost2_max": -16.189862534031683, "cost2_min": -92.47284681311731, "system_level_velocity_mean": 15.009684296033333, "cost1_min": 18.769088947945885, "cost1_max": 457.89793622762693, "cost1_mean": 376.94089125842123, "system_level_velocity_max": 18.590066053024305}, "timesteps_total": 18139588, "training_iteration": 169, "date": "2019-04-29_08-20-13", "timesteps_since_restore": 18139588, "episode_reward_max": 943.2255351571216, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 749.4407343191086, "iterations_since_restore": 169, "time_this_iter_s": 37.486387491226196, "info": {"grad_time_ms": 21962.074, "default": {"entropy": 2.0172181129455566, "kl": 0.016787908971309662, "cur_lr": 0.0005000000237487257, "vf_loss": 30.622514724731445, "vf_explained_var": 0.5143479108810425, "total_loss": 30.61375617980957, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01725728251039982}, "num_steps_trained": 18139588, "load_time_ms": 16.654, "update_time_ms": 11.415, "sample_time_ms": 15241.362, "num_steps_sampled": 18139588}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c18>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 43.62005208111863, "episodes_total": 11177, "episodes_this_iter": 76, "time_total_s": 6510.838711023331, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102821, "timestamp": 1556526051, "episode_len_mean": 687.0, "time_since_restore": 6549.164916753769, "done": false, "custom_metrics": {"outflow_rate_min": 525.1714990114439, "outflow_rate_mean": 900.2458959026526, "cost2_mean": -46.74744882346155, "outflow_rate_max": 1114.7841531821825, "system_level_velocity_min": 8.573189317979505, "cost2_max": -17.095743772374504, "cost2_min": -72.63735625922519, "system_level_velocity_mean": 15.144624635018335, "cost1_min": 26.75330573886111, "cost1_max": 457.89793622762693, "cost1_mean": 376.8214272023524, "system_level_velocity_max": 18.590066053024305}, "timesteps_total": 18242409, "training_iteration": 170, "date": "2019-04-29_08-20-51", "timesteps_since_restore": 18242409, "episode_reward_max": 916.9101947955018, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 739.7913185050434, "iterations_since_restore": 170, "time_this_iter_s": 38.32620573043823, "info": {"grad_time_ms": 21906.587, "default": {"entropy": 2.042496919631958, "kl": 0.01650802232325077, "cur_lr": 0.0005000000237487257, "vf_loss": 30.513351440429688, "vf_explained_var": 0.5715844631195068, "total_loss": 30.504825592041016, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016882535070180893}, "num_steps_trained": 18242409, "load_time_ms": 16.457, "update_time_ms": 11.479, "sample_time_ms": 15323.878, "num_steps_sampled": 18242409}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49b00>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 61.817488443470836, "episodes_total": 11255, "episodes_this_iter": 78, "time_total_s": 6549.164916753769, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102851, "timestamp": 1556526091, "episode_len_mean": 682.25, "time_since_restore": 6588.905426025391, "done": false, "custom_metrics": {"outflow_rate_min": 449.9786041231683, "outflow_rate_mean": 888.599205404489, "cost2_mean": -47.12173579952697, "outflow_rate_max": 1138.6670437886542, "system_level_velocity_min": 8.778537244355137, "cost2_max": -13.092771021959635, "cost2_min": -83.70987780237947, "system_level_velocity_mean": 14.873325923043964, "cost1_min": 12.308891893948935, "cost1_max": 453.82800793203194, "cost1_mean": 367.1758188833212, "system_level_velocity_max": 19.337846885850553}, "timesteps_total": 18345260, "training_iteration": 171, "date": "2019-04-29_08-21-31", "timesteps_since_restore": 18345260, "episode_reward_max": 985.1191186034165, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 734.0348509122268, "iterations_since_restore": 171, "time_this_iter_s": 39.740509271621704, "info": {"grad_time_ms": 21907.721, "default": {"entropy": 2.019326686859131, "kl": 0.016595065593719482, "cur_lr": 0.0005000000237487257, "vf_loss": 31.7814884185791, "vf_explained_var": 0.5587888360023499, "total_loss": 31.774728775024414, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015161355026066303}, "num_steps_trained": 18345260, "load_time_ms": 16.811, "update_time_ms": 11.493, "sample_time_ms": 15503.789, "num_steps_sampled": 18345260}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d491d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f98>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 28.57389972795304, "episodes_total": 11331, "episodes_this_iter": 76, "time_total_s": 6588.905426025391, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103332, "timestamp": 1556526129, "episode_len_mean": 693.23, "time_since_restore": 6626.652697324753, "done": false, "custom_metrics": {"outflow_rate_min": 478.74083587680656, "outflow_rate_mean": 896.5540956509255, "cost2_mean": -47.84655123117113, "outflow_rate_max": 1098.4711902087504, "system_level_velocity_min": 9.176895826415894, "cost2_max": -16.127941519048143, "cost2_min": -83.70987780237947, "system_level_velocity_mean": 14.660548281543635, "cost1_min": 15.390387868053352, "cost1_max": 450.650163073551, "cost1_mean": 369.20617409076885, "system_level_velocity_max": 18.477623995057403}, "timesteps_total": 18448592, "training_iteration": 172, "date": "2019-04-29_08-22-09", "timesteps_since_restore": 18448592, "episode_reward_max": 921.2650755746947, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 744.1797213938895, "iterations_since_restore": 172, "time_this_iter_s": 37.74727129936218, "info": {"grad_time_ms": 21974.242, "default": {"entropy": 2.0815818309783936, "kl": 0.016912605613470078, "cur_lr": 0.0005000000237487257, "vf_loss": 30.231876373291016, "vf_explained_var": 0.5812951922416687, "total_loss": 30.222763061523438, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017677783966064453}, "num_steps_trained": 18448592, "load_time_ms": 16.883, "update_time_ms": 11.146, "sample_time_ms": 15471.065, "num_steps_sampled": 18448592}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d490b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 33.54987187186357, "episodes_total": 11403, "episodes_this_iter": 72, "time_total_s": 6626.652697324753, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103504, "timestamp": 1556526167, "episode_len_mean": 661.13, "time_since_restore": 6664.694841384888, "done": false, "custom_metrics": {"outflow_rate_min": 478.74083587680656, "outflow_rate_mean": 875.8243750902271, "cost2_mean": -48.02969887964945, "outflow_rate_max": 1062.1522771755363, "system_level_velocity_min": 10.16118947188607, "cost2_max": -16.127941519048143, "cost2_min": -85.8858781536008, "system_level_velocity_mean": 14.886081602420191, "cost1_min": 15.390387868053352, "cost1_max": 453.7047666353814, "cost1_mean": 353.5167501886847, "system_level_velocity_max": 19.14883694466183}, "timesteps_total": 18552096, "training_iteration": 173, "date": "2019-04-29_08-22-47", "timesteps_since_restore": 18552096, "episode_reward_max": 928.4818736551254, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 709.155819470874, "iterations_since_restore": 173, "time_this_iter_s": 38.04214406013489, "info": {"grad_time_ms": 21881.703, "default": {"entropy": 2.069714307785034, "kl": 0.017805982381105423, "cur_lr": 0.0005000000237487257, "vf_loss": 27.670391082763672, "vf_explained_var": 0.574648916721344, "total_loss": 27.660289764404297, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01911880634725094}, "num_steps_trained": 18552096, "load_time_ms": 16.699, "update_time_ms": 11.474, "sample_time_ms": 15529.05, "num_steps_sampled": 18552096}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d496a0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 33.54987187186357, "episodes_total": 11473, "episodes_this_iter": 70, "time_total_s": 6664.694841384888, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104914, "timestamp": 1556526205, "episode_len_mean": 681.96, "time_since_restore": 6702.988493680954, "done": false, "custom_metrics": {"outflow_rate_min": 485.7497625021615, "outflow_rate_mean": 895.6594531920942, "cost2_mean": -48.42763803858615, "outflow_rate_max": 1108.727970488991, "system_level_velocity_min": 9.63071877890553, "cost2_max": -17.542064793127658, "cost2_min": -96.29885813481468, "system_level_velocity_mean": 14.908665090781257, "cost1_min": 23.948983092866957, "cost1_max": 453.7047666353814, "cost1_mean": 368.2925932399607, "system_level_velocity_max": 18.516825520576933}, "timesteps_total": 18657010, "training_iteration": 174, "date": "2019-04-29_08-23-25", "timesteps_since_restore": 18657010, "episode_reward_max": 899.6391600692594, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 727.1820314937414, "iterations_since_restore": 174, "time_this_iter_s": 38.293652296066284, "info": {"grad_time_ms": 22080.805, "default": {"entropy": 2.1368231773376465, "kl": 0.017006462439894676, "cur_lr": 0.0005000000237487257, "vf_loss": 29.198789596557617, "vf_explained_var": 0.6250421404838562, "total_loss": 29.190818786621094, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016580527648329735}, "num_steps_trained": 18657010, "load_time_ms": 17.046, "update_time_ms": 11.527, "sample_time_ms": 15572.012, "num_steps_sampled": 18657010}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49358>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 54.83004035043001, "episodes_total": 11542, "episodes_this_iter": 69, "time_total_s": 6702.988493680954, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103178, "timestamp": 1556526244, "episode_len_mean": 680.21, "time_since_restore": 6741.19136428833, "done": false, "custom_metrics": {"outflow_rate_min": 494.8890691420633, "outflow_rate_mean": 900.2979150031584, "cost2_mean": -50.938720031695, "outflow_rate_max": 1138.6334897777735, "system_level_velocity_min": 10.60193614376968, "cost2_max": -16.644574133611446, "cost2_min": -89.31938694471759, "system_level_velocity_mean": 14.845953256322641, "cost1_min": 23.589639082025503, "cost1_max": 449.79776274311115, "cost1_mean": 365.81844504817315, "system_level_velocity_max": 18.38834898918031}, "timesteps_total": 18760188, "training_iteration": 175, "date": "2019-04-29_08-24-04", "timesteps_since_restore": 18760188, "episode_reward_max": 978.4780151139562, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 731.9996501301979, "iterations_since_restore": 175, "time_this_iter_s": 38.2028706073761, "info": {"grad_time_ms": 22097.52, "default": {"entropy": 2.1119096279144287, "kl": 0.016566544771194458, "cur_lr": 0.0005000000237487257, "vf_loss": 30.069303512573242, "vf_explained_var": 0.5988472104072571, "total_loss": 30.059797286987305, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01789391227066517}, "num_steps_trained": 18760188, "load_time_ms": 18.092, "update_time_ms": 11.784, "sample_time_ms": 15562.494, "num_steps_sampled": 18760188}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d491d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e80>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 48.44682322065464, "episodes_total": 11619, "episodes_this_iter": 77, "time_total_s": 6741.19136428833, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102919, "timestamp": 1556526283, "episode_len_mean": 673.3, "time_since_restore": 6780.208695888519, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 869.4223071762729, "cost2_mean": -48.13517971899521, "outflow_rate_max": 1137.6465702109913, "system_level_velocity_min": 9.588888353911571, "cost2_max": -12.69983616709864, "cost2_min": -86.75018334932739, "system_level_velocity_mean": 14.701355083912272, "cost1_min": 11.630606386745917, "cost1_max": 448.782401204744, "cost1_mean": 357.02012519434146, "system_level_velocity_max": 18.494841851500837}, "timesteps_total": 18863107, "training_iteration": 176, "date": "2019-04-29_08-24-43", "timesteps_since_restore": 18863107, "episode_reward_max": 978.4780151139562, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 714.9292456978075, "iterations_since_restore": 176, "time_this_iter_s": 39.01733160018921, "info": {"grad_time_ms": 22100.323, "default": {"entropy": 2.0904650688171387, "kl": 0.016385188326239586, "cur_lr": 0.0005000000237487257, "vf_loss": 31.39339828491211, "vf_explained_var": 0.5372614860534668, "total_loss": 31.383663177490234, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018031751736998558}, "num_steps_trained": 18863107, "load_time_ms": 18.082, "update_time_ms": 11.72, "sample_time_ms": 15728.383, "num_steps_sampled": 18863107}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb240>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 29.277716776870058, "episodes_total": 11696, "episodes_this_iter": 77, "time_total_s": 6780.208695888519, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103094, "timestamp": 1556526321, "episode_len_mean": 693.18, "time_since_restore": 6818.425230026245, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 890.4427530754265, "cost2_mean": -47.86603801633537, "outflow_rate_max": 1143.3514170497385, "system_level_velocity_min": 9.226729222424824, "cost2_max": -12.69983616709864, "cost2_min": -82.56793408302931, "system_level_velocity_mean": 14.634233531358353, "cost1_min": 11.630606386745917, "cost1_max": 449.67581724797174, "cost1_mean": 368.4515174008247, "system_level_velocity_max": 17.73358503438897}, "timesteps_total": 18966201, "training_iteration": 177, "date": "2019-04-29_08-25-21", "timesteps_since_restore": 18966201, "episode_reward_max": 905.2041189722445, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 737.3049430720503, "iterations_since_restore": 177, "time_this_iter_s": 38.21653413772583, "info": {"grad_time_ms": 22104.05, "default": {"entropy": 2.0963828563690186, "kl": 0.016732530668377876, "cur_lr": 0.0005000000237487257, "vf_loss": 27.97083854675293, "vf_explained_var": 0.5996406674385071, "total_loss": 27.961206436157227, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01810365356504917}, "num_steps_trained": 18966201, "load_time_ms": 18.48, "update_time_ms": 11.75, "sample_time_ms": 15756.72, "num_steps_sampled": 18966201}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49630>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 29.277716776870058, "episodes_total": 11769, "episodes_this_iter": 73, "time_total_s": 6818.425230026245, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103377, "timestamp": 1556526359, "episode_len_mean": 700.0, "time_since_restore": 6856.716982841492, "done": false, "custom_metrics": {"outflow_rate_min": 704.5212726396559, "outflow_rate_mean": 918.9526722785029, "cost2_mean": -47.881723308829095, "outflow_rate_max": 1143.3514170497385, "system_level_velocity_min": 9.886821153538351, "cost2_max": -22.28677701598852, "cost2_min": -82.09458849854413, "system_level_velocity_mean": 15.077062386330914, "cost1_min": 251.9353282714212, "cost1_max": 459.29533433033043, "cost1_mean": 383.6390565924975, "system_level_velocity_max": 18.58767935018736}, "timesteps_total": 19069578, "training_iteration": 178, "date": "2019-04-29_08-25-59", "timesteps_since_restore": 19069578, "episode_reward_max": 912.7169025371306, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 762.6972092266061, "iterations_since_restore": 178, "time_this_iter_s": 38.29175281524658, "info": {"grad_time_ms": 22214.329, "default": {"entropy": 2.0910913944244385, "kl": 0.01700815185904503, "cur_lr": 0.0005000000237487257, "vf_loss": 28.14165687561035, "vf_explained_var": 0.6259454488754272, "total_loss": 28.1322078704834, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.018060632050037384}, "num_steps_trained": 19069578, "load_time_ms": 19.708, "update_time_ms": 11.671, "sample_time_ms": 15861.373, "num_steps_sampled": 19069578}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb4a8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 591.8739703526841, "episodes_total": 11837, "episodes_this_iter": 68, "time_total_s": 6856.716982841492, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103091, "timestamp": 1556526397, "episode_len_mean": 677.89, "time_since_restore": 6894.42427110672, "done": false, "custom_metrics": {"outflow_rate_min": 535.1996685043493, "outflow_rate_mean": 895.3182583731693, "cost2_mean": -50.91923236372556, "outflow_rate_max": 1130.5838228152395, "system_level_velocity_min": 9.67084687752911, "cost2_max": -19.926096178730468, "cost2_min": -93.64370412090517, "system_level_velocity_mean": 14.636153078875655, "cost1_min": 31.070522829409455, "cost1_max": 444.22253557936904, "cost1_mean": 359.1701986136331, "system_level_velocity_max": 18.637556362486908}, "timesteps_total": 19172669, "training_iteration": 179, "date": "2019-04-29_08-26-37", "timesteps_since_restore": 19172669, "episode_reward_max": 938.7942788696007, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 727.1642374348584, "iterations_since_restore": 179, "time_this_iter_s": 37.70728826522827, "info": {"grad_time_ms": 22243.055, "default": {"entropy": 2.133408546447754, "kl": 0.01719527505338192, "cur_lr": 0.0005000000237487257, "vf_loss": 29.647489547729492, "vf_explained_var": 0.6560652256011963, "total_loss": 29.63735008239746, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018842125311493874}, "num_steps_trained": 19172669, "load_time_ms": 19.754, "update_time_ms": 11.515, "sample_time_ms": 15851.524, "num_steps_sampled": 19172669}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49b38>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 71.87485697918757, "episodes_total": 11910, "episodes_this_iter": 73, "time_total_s": 6894.42427110672, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102420, "timestamp": 1556526434, "episode_len_mean": 677.48, "time_since_restore": 6931.68253827095, "done": false, "custom_metrics": {"outflow_rate_min": 501.8032230195665, "outflow_rate_mean": 873.0119935653172, "cost2_mean": -48.96308740619565, "outflow_rate_max": 1092.896048407999, "system_level_velocity_min": 9.67084687752911, "cost2_max": -19.294372552878613, "cost2_min": -89.9592699373652, "system_level_velocity_mean": 14.443210514167607, "cost1_min": 21.192747733148344, "cost1_max": 443.03660233705443, "cost1_mean": 354.79789609228567, "system_level_velocity_max": 18.21995841554399}, "timesteps_total": 19275089, "training_iteration": 180, "date": "2019-04-29_08-27-14", "timesteps_since_restore": 19275089, "episode_reward_max": 938.989201946385, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 717.6715802931164, "iterations_since_restore": 180, "time_this_iter_s": 37.25826716423035, "info": {"grad_time_ms": 22218.744, "default": {"entropy": 2.10549259185791, "kl": 0.017484264448285103, "cur_lr": 0.0005000000237487257, "vf_loss": 30.40347671508789, "vf_explained_var": 0.6261943578720093, "total_loss": 30.393705368041992, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01862206496298313}, "num_steps_trained": 19275089, "load_time_ms": 20.104, "update_time_ms": 11.616, "sample_time_ms": 15770.369, "num_steps_sampled": 19275089}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41e80>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 42.6642833377973, "episodes_total": 11985, "episodes_this_iter": 75, "time_total_s": 6931.68253827095, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102510, "timestamp": 1556526472, "episode_len_mean": 689.36, "time_since_restore": 6969.232793092728, "done": false, "custom_metrics": {"outflow_rate_min": 513.9686371368313, "outflow_rate_mean": 885.998776250497, "cost2_mean": -45.98111251838021, "outflow_rate_max": 1105.5150907469308, "system_level_velocity_min": 10.178571951177135, "cost2_max": -23.585607787885976, "cost2_min": -84.44995238770613, "system_level_velocity_mean": 14.776964644874184, "cost1_min": 34.796904728247156, "cost1_max": 452.43768128721297, "cost1_mean": 370.38230803683894, "system_level_velocity_max": 18.21995841554399}, "timesteps_total": 19377599, "training_iteration": 181, "date": "2019-04-29_08-27-52", "timesteps_since_restore": 19377599, "episode_reward_max": 971.072507992254, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 730.6642993411525, "iterations_since_restore": 181, "time_this_iter_s": 37.550254821777344, "info": {"grad_time_ms": 22121.996, "default": {"entropy": 2.1065709590911865, "kl": 0.016932114958763123, "cur_lr": 0.0005000000237487257, "vf_loss": 27.292430877685547, "vf_explained_var": 0.6379174590110779, "total_loss": 27.282958984375, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01804492436349392}, "num_steps_trained": 19377599, "load_time_ms": 18.975, "update_time_ms": 11.597, "sample_time_ms": 15649.468, "num_steps_sampled": 19377599}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d410f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d492b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 68.01238504834556, "episodes_total": 12054, "episodes_this_iter": 69, "time_total_s": 6969.232793092728, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103094, "timestamp": 1556526510, "episode_len_mean": 691.48, "time_since_restore": 7007.032353639603, "done": false, "custom_metrics": {"outflow_rate_min": 661.9175999679611, "outflow_rate_mean": 891.6832791069205, "cost2_mean": -46.61205319450677, "outflow_rate_max": 1095.3449024337062, "system_level_velocity_min": 9.721606837769382, "cost2_max": -11.610196489020487, "cost2_min": -84.74963603562482, "system_level_velocity_mean": 14.779517734585724, "cost1_min": 62.5976086795374, "cost1_max": 452.9719439596541, "cost1_mean": 370.3583910855825, "system_level_velocity_max": 18.636981790282718}, "timesteps_total": 19480693, "training_iteration": 182, "date": "2019-04-29_08-28-30", "timesteps_since_restore": 19480693, "episode_reward_max": 916.540871958601, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 730.7714753425312, "iterations_since_restore": 182, "time_this_iter_s": 37.799560546875, "info": {"grad_time_ms": 22081.919, "default": {"entropy": 2.1425254344940186, "kl": 0.017419349402189255, "cur_lr": 0.0005000000237487257, "vf_loss": 29.882108688354492, "vf_explained_var": 0.6317833065986633, "total_loss": 29.873044967651367, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01788400299847126}, "num_steps_trained": 19480693, "load_time_ms": 18.708, "update_time_ms": 11.602, "sample_time_ms": 15696.718, "num_steps_sampled": 19480693}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d417b8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 126.3006529584738, "episodes_total": 12126, "episodes_this_iter": 72, "time_total_s": 7007.032353639603, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104050, "timestamp": 1556526548, "episode_len_mean": 677.55, "time_since_restore": 7044.743234872818, "done": false, "custom_metrics": {"outflow_rate_min": 491.60006830427545, "outflow_rate_mean": 885.9421522986942, "cost2_mean": -49.647783397612194, "outflow_rate_max": 1117.6945734858964, "system_level_velocity_min": 8.978307365371256, "cost2_max": -17.42225380309, "cost2_min": -86.95498263861755, "system_level_velocity_mean": 14.597064985038314, "cost1_min": 18.58563394499755, "cost1_max": 443.0455543376573, "cost1_mean": 357.24236380582863, "system_level_velocity_max": 18.725531902600085}, "timesteps_total": 19584743, "training_iteration": 183, "date": "2019-04-29_08-29-08", "timesteps_since_restore": 19584743, "episode_reward_max": 873.8671384967097, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 722.8244934918895, "iterations_since_restore": 183, "time_this_iter_s": 37.71088123321533, "info": {"grad_time_ms": 22090.558, "default": {"entropy": 2.1767489910125732, "kl": 0.01688988134264946, "cur_lr": 0.0005000000237487257, "vf_loss": 26.806577682495117, "vf_explained_var": 0.6813008189201355, "total_loss": 26.79753875732422, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.017589354887604713}, "num_steps_trained": 19584743, "load_time_ms": 18.776, "update_time_ms": 11.411, "sample_time_ms": 15657.106, "num_steps_sampled": 19584743}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d494a8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 34.401738898164226, "episodes_total": 12195, "episodes_this_iter": 69, "time_total_s": 7044.743234872818, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103641, "timestamp": 1556526584, "episode_len_mean": 684.48, "time_since_restore": 7081.362426280975, "done": false, "custom_metrics": {"outflow_rate_min": 433.12568539996727, "outflow_rate_mean": 888.0229198885161, "cost2_mean": -49.381482998862694, "outflow_rate_max": 1113.8662672529993, "system_level_velocity_min": 9.408641789552568, "cost2_max": -10.424011905567903, "cost2_min": -79.72024344558845, "system_level_velocity_mean": 14.40360507304531, "cost1_min": 9.689339233628104, "cost1_max": 442.65582853717467, "cost1_mean": 357.64806789205085, "system_level_velocity_max": 17.809848529296215}, "timesteps_total": 19688384, "training_iteration": 184, "date": "2019-04-29_08-29-44", "timesteps_since_restore": 19688384, "episode_reward_max": 908.0978454748636, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 719.9941367243922, "iterations_since_restore": 184, "time_this_iter_s": 36.61919140815735, "info": {"grad_time_ms": 21977.273, "default": {"entropy": 2.174024820327759, "kl": 0.017369374632835388, "cur_lr": 0.0005000000237487257, "vf_loss": 28.448040008544922, "vf_explained_var": 0.6695574522018433, "total_loss": 28.43856430053711, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018270572647452354}, "num_steps_trained": 19688384, "load_time_ms": 19.405, "update_time_ms": 11.342, "sample_time_ms": 15606.19, "num_steps_sampled": 19688384}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d410f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d414e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b00>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 23.870964429776926, "episodes_total": 12272, "episodes_this_iter": 77, "time_total_s": 7081.362426280975, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103657, "timestamp": 1556526622, "episode_len_mean": 686.35, "time_since_restore": 7119.323502540588, "done": false, "custom_metrics": {"outflow_rate_min": 433.12568539996727, "outflow_rate_mean": 879.5448592623511, "cost2_mean": -50.25465958870936, "outflow_rate_max": 1095.202735236195, "system_level_velocity_min": 9.408641789552568, "cost2_max": -10.424011905567903, "cost2_min": -120.5023468809752, "system_level_velocity_mean": 14.32412839751842, "cost1_min": 9.689339233628104, "cost1_max": 441.91471675922617, "cost1_mean": 356.8848393299473, "system_level_velocity_max": 17.721070720328743}, "timesteps_total": 19792041, "training_iteration": 185, "date": "2019-04-29_08-30-22", "timesteps_since_restore": 19792041, "episode_reward_max": 923.87448253226, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 725.4422133906694, "iterations_since_restore": 185, "time_this_iter_s": 37.96107625961304, "info": {"grad_time_ms": 21988.538, "default": {"entropy": 2.1515893936157227, "kl": 0.017469042912125587, "cur_lr": 0.0005000000237487257, "vf_loss": 26.842185974121094, "vf_explained_var": 0.6380137205123901, "total_loss": 26.832252502441406, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018774930387735367}, "num_steps_trained": 19792041, "load_time_ms": 18.511, "update_time_ms": 10.999, "sample_time_ms": 15570.395, "num_steps_sampled": 19792041}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49908>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 23.870964429776926, "episodes_total": 12342, "episodes_this_iter": 70, "time_total_s": 7119.323502540588, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103359, "timestamp": 1556526663, "episode_len_mean": 693.48, "time_since_restore": 7159.486872911453, "done": false, "custom_metrics": {"outflow_rate_min": 510.9137862651963, "outflow_rate_mean": 893.5759566076339, "cost2_mean": -50.14175548149205, "outflow_rate_max": 1081.6645081253707, "system_level_velocity_min": 9.987493946913013, "cost2_max": -27.287155305008515, "cost2_min": -88.74437573016529, "system_level_velocity_mean": 14.566876665616173, "cost1_min": 31.48049598491459, "cost1_max": 454.2953121366304, "cost1_mean": 367.3932864140841, "system_level_velocity_max": 18.376636961319647}, "timesteps_total": 19895400, "training_iteration": 186, "date": "2019-04-29_08-31-03", "timesteps_since_restore": 19895400, "episode_reward_max": 887.6459910012942, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 741.0995372321792, "iterations_since_restore": 186, "time_this_iter_s": 40.16337037086487, "info": {"grad_time_ms": 22207.156, "default": {"entropy": 2.1445746421813965, "kl": 0.017481617629528046, "cur_lr": 0.0005000000237487257, "vf_loss": 28.99132537841797, "vf_explained_var": 0.6288303136825562, "total_loss": 28.98311424255371, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01706131175160408}, "num_steps_trained": 19895400, "load_time_ms": 17.66, "update_time_ms": 11.154, "sample_time_ms": 15465.374, "num_steps_sampled": 19895400}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41358>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 64.02453220913586, "episodes_total": 12416, "episodes_this_iter": 74, "time_total_s": 7159.486872911453, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103978, "timestamp": 1556526702, "episode_len_mean": 689.27, "time_since_restore": 7198.3502831459045, "done": false, "custom_metrics": {"outflow_rate_min": 497.19972465205865, "outflow_rate_mean": 889.8030874953504, "cost2_mean": -50.00490934885131, "outflow_rate_max": 1121.4593257117936, "system_level_velocity_min": 9.861579447400914, "cost2_max": -23.00477075946412, "cost2_min": -83.67941630378091, "system_level_velocity_mean": 14.653136888323015, "cost1_min": 33.423836088394474, "cost1_max": 438.54034732506796, "cost1_mean": 367.16289374867955, "system_level_velocity_max": 17.712669472681846}, "timesteps_total": 19999378, "training_iteration": 187, "date": "2019-04-29_08-31-42", "timesteps_since_restore": 19999378, "episode_reward_max": 934.1317836738042, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 745.4215436603184, "iterations_since_restore": 187, "time_this_iter_s": 38.863410234451294, "info": {"grad_time_ms": 22259.174, "default": {"entropy": 2.164015531539917, "kl": 0.017068972811102867, "cur_lr": 0.0005000000237487257, "vf_loss": 31.774524688720703, "vf_explained_var": 0.6250249743461609, "total_loss": 31.76460075378418, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01856459118425846}, "num_steps_trained": 19999378, "load_time_ms": 17.104, "update_time_ms": 11.35, "sample_time_ms": 15480.192, "num_steps_sampled": 19999378}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 73.55805442091338, "episodes_total": 12489, "episodes_this_iter": 73, "time_total_s": 7198.3502831459045, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104491, "timestamp": 1556526739, "episode_len_mean": 686.87, "time_since_restore": 7235.636879205704, "done": false, "custom_metrics": {"outflow_rate_min": 497.19972465205865, "outflow_rate_mean": 900.1742283961912, "cost2_mean": -50.0650895724462, "outflow_rate_max": 1066.183231196512, "system_level_velocity_min": 9.861579447400914, "cost2_max": -19.80804715094525, "cost2_min": -81.45980478195233, "system_level_velocity_mean": 14.67565290438959, "cost1_min": 23.03811845703889, "cost1_max": 443.2624168454679, "cost1_mean": 366.60865418301006, "system_level_velocity_max": 18.84998586558169}, "timesteps_total": 20103869, "training_iteration": 188, "date": "2019-04-29_08-32-19", "timesteps_since_restore": 20103869, "episode_reward_max": 954.0358317288798, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 746.1942690351541, "iterations_since_restore": 188, "time_this_iter_s": 37.286596059799194, "info": {"grad_time_ms": 22200.019, "default": {"entropy": 2.179335832595825, "kl": 0.017533570528030396, "cur_lr": 0.0005000000237487257, "vf_loss": 27.474199295043945, "vf_explained_var": 0.633705735206604, "total_loss": 27.46388816833496, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.019189845770597458}, "num_steps_trained": 20103869, "load_time_ms": 16.017, "update_time_ms": 11.219, "sample_time_ms": 15439.475, "num_steps_sampled": 20103869}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb898>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 45.877995183407116, "episodes_total": 12556, "episodes_this_iter": 67, "time_total_s": 7235.636879205704, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104108, "timestamp": 1556526774, "episode_len_mean": 680.18, "time_since_restore": 7270.7164759635925, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 892.7498122917286, "cost2_mean": -49.94602867119457, "outflow_rate_max": 1112.4956494626351, "system_level_velocity_min": 8.727933987986225, "cost2_max": -13.682273231417048, "cost2_min": -84.0482250256747, "system_level_velocity_mean": 14.329564648986985, "cost1_min": 11.699946484610342, "cost1_max": 454.13570184079055, "cost1_mean": 354.68724196557037, "system_level_velocity_max": 18.087268293957816}, "timesteps_total": 20207977, "training_iteration": 189, "date": "2019-04-29_08-32-54", "timesteps_since_restore": 20207977, "episode_reward_max": 914.4721409494339, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 727.1686529504789, "iterations_since_restore": 189, "time_this_iter_s": 35.079596757888794, "info": {"grad_time_ms": 21964.895, "default": {"entropy": 2.174825668334961, "kl": 0.01785629242658615, "cur_lr": 0.0005000000237487257, "vf_loss": 28.481746673583984, "vf_explained_var": 0.6361098885536194, "total_loss": 28.472434997558594, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018351448699831963}, "num_steps_trained": 20207977, "load_time_ms": 15.098, "update_time_ms": 11.373, "sample_time_ms": 15415.882, "num_steps_sampled": 20207977}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d498d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49978>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 29.213505981702383, "episodes_total": 12628, "episodes_this_iter": 72, "time_total_s": 7270.7164759635925, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103689, "timestamp": 1556526811, "episode_len_mean": 684.04, "time_since_restore": 7307.253632545471, "done": false, "custom_metrics": {"outflow_rate_min": 476.4898462992569, "outflow_rate_mean": 899.8072848674907, "cost2_mean": -52.05160317671757, "outflow_rate_max": 1135.4767180900205, "system_level_velocity_min": 8.727933987986225, "cost2_max": -14.498458580761145, "cost2_min": -89.15828721374974, "system_level_velocity_mean": 14.380938779537706, "cost1_min": 14.641645239017029, "cost1_max": 456.94111503338627, "cost1_mean": 358.3701913980872, "system_level_velocity_max": 18.420877928798063}, "timesteps_total": 20311666, "training_iteration": 190, "date": "2019-04-29_08-33-31", "timesteps_since_restore": 20311666, "episode_reward_max": 1004.2070476923828, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 740.2554202732575, "iterations_since_restore": 190, "time_this_iter_s": 36.53715658187866, "info": {"grad_time_ms": 21843.54, "default": {"entropy": 2.1517035961151123, "kl": 0.017334023490548134, "cur_lr": 0.0005000000237487257, "vf_loss": 30.207260131835938, "vf_explained_var": 0.6026195883750916, "total_loss": 30.198596954345703, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017435366287827492}, "num_steps_trained": 20311666, "load_time_ms": 14.179, "update_time_ms": 11.35, "sample_time_ms": 15463.952, "num_steps_sampled": 20311666}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49588>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 32.6276662690079, "episodes_total": 12701, "episodes_this_iter": 73, "time_total_s": 7307.253632545471, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105057, "timestamp": 1556526846, "episode_len_mean": 683.06, "time_since_restore": 7342.823922395706, "done": false, "custom_metrics": {"outflow_rate_min": 465.40161577774745, "outflow_rate_mean": 915.4886543930994, "cost2_mean": -52.73844337909373, "outflow_rate_max": 1141.6266059061168, "system_level_velocity_min": 10.771787086509537, "cost2_max": -14.282410740462057, "cost2_min": -91.20825347802474, "system_level_velocity_mean": 14.593981788747039, "cost1_min": 13.51799443594202, "cost1_max": 443.53315385950873, "cost1_mean": 362.9692796742745, "system_level_velocity_max": 18.839490468316487}, "timesteps_total": 20416723, "training_iteration": 191, "date": "2019-04-29_08-34-06", "timesteps_since_restore": 20416723, "episode_reward_max": 942.4773912976218, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 757.4778428472688, "iterations_since_restore": 191, "time_this_iter_s": 35.570289850234985, "info": {"grad_time_ms": 21690.747, "default": {"entropy": 2.1550445556640625, "kl": 0.01710738241672516, "cur_lr": 0.0005000000237487257, "vf_loss": 27.880186080932617, "vf_explained_var": 0.6111943125724792, "total_loss": 27.871274948120117, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.0175695288926363}, "num_steps_trained": 20416723, "load_time_ms": 15.061, "update_time_ms": 11.346, "sample_time_ms": 15419.707, "num_steps_sampled": 20416723}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49da0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 32.15936914748854, "episodes_total": 12770, "episodes_this_iter": 69, "time_total_s": 7342.823922395706, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104270, "timestamp": 1556526884, "episode_len_mean": 693.34, "time_since_restore": 7380.1176426410675, "done": false, "custom_metrics": {"outflow_rate_min": 489.4511407388373, "outflow_rate_mean": 919.3361294483428, "cost2_mean": -55.06571825970363, "outflow_rate_max": 1115.3533823044436, "system_level_velocity_min": 10.100601304074727, "cost2_max": -20.268981192462423, "cost2_min": -113.89838321503365, "system_level_velocity_mean": 14.322338512380126, "cost1_min": 22.71557451797382, "cost1_max": 447.05303612884006, "cost1_mean": 361.73409390830074, "system_level_velocity_max": 18.05828051285829}, "timesteps_total": 20520993, "training_iteration": 192, "date": "2019-04-29_08-34-44", "timesteps_since_restore": 20520993, "episode_reward_max": 1011.2657549964048, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 763.4078509338365, "iterations_since_restore": 192, "time_this_iter_s": 37.29372024536133, "info": {"grad_time_ms": 21628.7, "default": {"entropy": 2.1799123287200928, "kl": 0.017503967508673668, "cur_lr": 0.0005000000237487257, "vf_loss": 29.226722717285156, "vf_explained_var": 0.6392783522605896, "total_loss": 29.21784019470215, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017742328345775604}, "num_steps_trained": 20520993, "load_time_ms": 14.318, "update_time_ms": 11.387, "sample_time_ms": 15431.499, "num_steps_sampled": 20520993}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d417b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b00>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 46.97818249141966, "episodes_total": 12840, "episodes_this_iter": 70, "time_total_s": 7380.1176426410675, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105320, "timestamp": 1556526921, "episode_len_mean": 680.87, "time_since_restore": 7417.6300258636475, "done": false, "custom_metrics": {"outflow_rate_min": 473.6214882111825, "outflow_rate_mean": 922.8395399165762, "cost2_mean": -52.1226343268899, "outflow_rate_max": 1115.3533823044436, "system_level_velocity_min": 9.001920801576697, "cost2_max": -20.268981192462423, "cost2_min": -113.89838321503365, "system_level_velocity_mean": 14.868731207660336, "cost1_min": 22.71557451797382, "cost1_max": 444.9126624171348, "cost1_mean": 368.0719031413905, "system_level_velocity_max": 18.55996727549335}, "timesteps_total": 20626313, "training_iteration": 193, "date": "2019-04-29_08-35-21", "timesteps_since_restore": 20626313, "episode_reward_max": 906.5705160540383, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 765.4500302843745, "iterations_since_restore": 193, "time_this_iter_s": 37.512383222579956, "info": {"grad_time_ms": 21578.727, "default": {"entropy": 2.175863265991211, "kl": 0.017682509496808052, "cur_lr": 0.0005000000237487257, "vf_loss": 26.83596420288086, "vf_explained_var": 0.6623104214668274, "total_loss": 26.826780319213867, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.018134869635105133}, "num_steps_trained": 20626313, "load_time_ms": 13.505, "update_time_ms": 11.346, "sample_time_ms": 15459.229, "num_steps_sampled": 20626313}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb2e8>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 46.008854417887314, "episodes_total": 12911, "episodes_this_iter": 71, "time_total_s": 7417.6300258636475, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105521, "timestamp": 1556526961, "episode_len_mean": 684.97, "time_since_restore": 7457.791666030884, "done": false, "custom_metrics": {"outflow_rate_min": 473.6214882111825, "outflow_rate_mean": 911.4761985105606, "cost2_mean": -53.56873800422119, "outflow_rate_max": 1107.679675985257, "system_level_velocity_min": 9.001920801576697, "cost2_max": -24.268327696841666, "cost2_min": -94.80844744833381, "system_level_velocity_mean": 14.547108163833029, "cost1_min": 23.91980358383445, "cost1_max": 454.06896376883617, "cost1_mean": 362.42008060617883, "system_level_velocity_max": 18.55996727549335}, "timesteps_total": 20731834, "training_iteration": 194, "date": "2019-04-29_08-36-01", "timesteps_since_restore": 20731834, "episode_reward_max": 943.7483947101955, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 760.2095811813705, "iterations_since_restore": 194, "time_this_iter_s": 40.16164016723633, "info": {"grad_time_ms": 21908.717, "default": {"entropy": 2.2163310050964355, "kl": 0.017127681523561478, "cur_lr": 0.0005000000237487257, "vf_loss": 26.624004364013672, "vf_explained_var": 0.6754873394966125, "total_loss": 26.614349365234375, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.018324481323361397}, "num_steps_trained": 20731834, "load_time_ms": 12.916, "update_time_ms": 11.537, "sample_time_ms": 15482.426, "num_steps_sampled": 20731834}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d418d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41d68>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 46.008854417887314, "episodes_total": 12979, "episodes_this_iter": 68, "time_total_s": 7457.791666030884, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104660, "timestamp": 1556526999, "episode_len_mean": 677.09, "time_since_restore": 7495.7904279232025, "done": false, "custom_metrics": {"outflow_rate_min": 464.32649368107076, "outflow_rate_mean": 902.4433469670123, "cost2_mean": -52.53900987587124, "outflow_rate_max": 1115.5364652398644, "system_level_velocity_min": 9.695641668198178, "cost2_max": -11.342437613708304, "cost2_min": -94.80844744833381, "system_level_velocity_mean": 14.272073113388503, "cost1_min": 11.219033303814886, "cost1_max": 441.6578159629628, "cost1_mean": 350.9552605147346, "system_level_velocity_max": 18.264509138181538}, "timesteps_total": 20836494, "training_iteration": 195, "date": "2019-04-29_08-36-39", "timesteps_since_restore": 20836494, "episode_reward_max": 969.0332225809942, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 744.9676006001863, "iterations_since_restore": 195, "time_this_iter_s": 37.998761892318726, "info": {"grad_time_ms": 21852.763, "default": {"entropy": 2.205522298812866, "kl": 0.01772919110953808, "cur_lr": 0.0005000000237487257, "vf_loss": 28.8914852142334, "vf_explained_var": 0.6773902773857117, "total_loss": 28.881711959838867, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01874811388552189}, "num_steps_trained": 20836494, "load_time_ms": 12.906, "update_time_ms": 11.455, "sample_time_ms": 15542.831, "num_steps_sampled": 20836494}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe10>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 20.986518722898033, "episodes_total": 13051, "episodes_this_iter": 72, "time_total_s": 7495.7904279232025, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104554, "timestamp": 1556527036, "episode_len_mean": 699.58, "time_since_restore": 7532.420796632767, "done": false, "custom_metrics": {"outflow_rate_min": 729.2293852007438, "outflow_rate_mean": 919.1842628097235, "cost2_mean": -54.722530156459996, "outflow_rate_max": 1115.5364652398644, "system_level_velocity_min": 9.680478539088856, "cost2_max": -29.06269207507031, "cost2_min": -91.67664760587647, "system_level_velocity_mean": 14.34400602546857, "cost1_min": 249.08260380006698, "cost1_max": 441.864214373471, "cost1_mean": 366.3360204515087, "system_level_velocity_max": 17.71929077372834}, "timesteps_total": 20941048, "training_iteration": 196, "date": "2019-04-29_08-37-16", "timesteps_since_restore": 20941048, "episode_reward_max": 961.8134431361168, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 769.9310363538377, "iterations_since_restore": 196, "time_this_iter_s": 36.63036870956421, "info": {"grad_time_ms": 21560.364, "default": {"entropy": 2.1785857677459717, "kl": 0.0171869657933712, "cur_lr": 0.0005000000237487257, "vf_loss": 27.19257354736328, "vf_explained_var": 0.6650806665420532, "total_loss": 27.18330955505371, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017967090010643005}, "num_steps_trained": 20941048, "load_time_ms": 12.736, "update_time_ms": 11.438, "sample_time_ms": 15481.563, "num_steps_sampled": 20941048}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d499b0>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 586.016640989452, "episodes_total": 13118, "episodes_this_iter": 67, "time_total_s": 7532.420796632767, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104154, "timestamp": 1556527074, "episode_len_mean": 681.2, "time_since_restore": 7570.062634706497, "done": false, "custom_metrics": {"outflow_rate_min": 415.6025884327821, "outflow_rate_mean": 907.2594420168851, "cost2_mean": -54.0554179445299, "outflow_rate_max": 1106.2712283032145, "system_level_velocity_min": 9.548202538839245, "cost2_max": -12.797933666132174, "cost2_min": -95.2234412512299, "system_level_velocity_mean": 14.359447563299646, "cost1_min": 10.112032814139063, "cost1_max": 441.96402949902426, "cost1_mean": 354.64106857286845, "system_level_velocity_max": 18.318734039302452}, "timesteps_total": 21045202, "training_iteration": 197, "date": "2019-04-29_08-37-54", "timesteps_since_restore": 21045202, "episode_reward_max": 928.6300315163867, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 742.6783958717845, "iterations_since_restore": 197, "time_this_iter_s": 37.64183807373047, "info": {"grad_time_ms": 21479.011, "default": {"entropy": 2.209378480911255, "kl": 0.017721742391586304, "cur_lr": 0.0005000000237487257, "vf_loss": 29.648086547851562, "vf_explained_var": 0.6635892391204834, "total_loss": 29.638792037963867, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.018267624080181122}, "num_steps_trained": 21045202, "load_time_ms": 12.993, "update_time_ms": 11.26, "sample_time_ms": 15440.205, "num_steps_sampled": 21045202}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbe80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb048>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 19.048768945850345, "episodes_total": 13194, "episodes_this_iter": 76, "time_total_s": 7570.062634706497, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104197, "timestamp": 1556527110, "episode_len_mean": 693.43, "time_since_restore": 7606.556756258011, "done": false, "custom_metrics": {"outflow_rate_min": 537.2615726107668, "outflow_rate_mean": 937.5162003158049, "cost2_mean": -56.10021830617662, "outflow_rate_max": 1124.7321830247827, "system_level_velocity_min": 9.548202538839245, "cost2_max": -18.49048360209697, "cost2_min": -90.77934275533966, "system_level_velocity_mean": 14.686010902956452, "cost1_min": 28.39468381063658, "cost1_max": 441.96402949902426, "cost1_mean": 371.0719079810409, "system_level_velocity_max": 18.2010238287276}, "timesteps_total": 21149399, "training_iteration": 198, "date": "2019-04-29_08-38-30", "timesteps_since_restore": 21149399, "episode_reward_max": 1031.4089781774437, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 781.0819471667311, "iterations_since_restore": 198, "time_this_iter_s": 36.49412155151367, "info": {"grad_time_ms": 21473.425, "default": {"entropy": 2.1833324432373047, "kl": 0.01757902465760708, "cur_lr": 0.0005000000237487257, "vf_loss": 29.791231155395508, "vf_explained_var": 0.6309372186660767, "total_loss": 29.78229331970215, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017838889732956886}, "num_steps_trained": 21149399, "load_time_ms": 13.092, "update_time_ms": 11.414, "sample_time_ms": 15367.727, "num_steps_sampled": 21149399}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d494a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d490f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49400>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 59.87981772567531, "episodes_total": 13260, "episodes_this_iter": 66, "time_total_s": 7606.556756258011, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105411, "timestamp": 1556527149, "episode_len_mean": 677.8, "time_since_restore": 7644.824622154236, "done": false, "custom_metrics": {"outflow_rate_min": 470.5008371641972, "outflow_rate_mean": 940.0171545187388, "cost2_mean": -55.409226721419365, "outflow_rate_max": 1128.653263573778, "system_level_velocity_min": 9.717967620274885, "cost2_max": -11.32943057606817, "cost2_min": -97.77990928571869, "system_level_velocity_mean": 14.773953430324799, "cost1_min": 12.558870341618167, "cost1_max": 451.5068692260694, "cost1_mean": 365.6063405839293, "system_level_velocity_max": 18.37927327945761}, "timesteps_total": 21254810, "training_iteration": 199, "date": "2019-04-29_08-39-09", "timesteps_since_restore": 21254810, "episode_reward_max": 946.3245960562184, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 773.0794341373565, "iterations_since_restore": 199, "time_this_iter_s": 38.267865896224976, "info": {"grad_time_ms": 21732.596, "default": {"entropy": 2.217046022415161, "kl": 0.01935674250125885, "cur_lr": 0.0005000000237487257, "vf_loss": 32.49684524536133, "vf_explained_var": 0.6588433384895325, "total_loss": 32.489009857177734, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017634034156799316}, "num_steps_trained": 21254810, "load_time_ms": 13.124, "update_time_ms": 11.488, "sample_time_ms": 15426.411, "num_steps_sampled": 21254810}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41b70>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 23.758872457167257, "episodes_total": 13329, "episodes_this_iter": 69, "time_total_s": 7644.824622154236, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105423, "timestamp": 1556527187, "episode_len_mean": 696.02, "time_since_restore": 7682.9221794605255, "done": true, "custom_metrics": {"outflow_rate_min": 599.2781012710857, "outflow_rate_mean": 949.1526989370823, "cost2_mean": -57.15852065639004, "outflow_rate_max": 1139.5167505912952, "system_level_velocity_min": 9.587695073704415, "cost2_max": -30.463450847871105, "cost2_min": -80.5939966359051, "system_level_velocity_mean": 14.570687923261847, "cost1_min": 177.45732745900568, "cost1_max": 450.7706976897934, "cost1_mean": 371.5977236502459, "system_level_velocity_max": 17.727957257856797}, "timesteps_total": 21360233, "training_iteration": 200, "date": "2019-04-29_08-39-47", "timesteps_since_restore": 21360233, "episode_reward_max": 956.7088232343726, "experiment_id": "9b178520507b4656ac608c6ff2056ff7", "episode_reward_mean": 789.5543719996608, "iterations_since_restore": 200, "time_this_iter_s": 38.09755730628967, "info": {"grad_time_ms": 21961.126, "default": {"entropy": 2.2128424644470215, "kl": 0.01684361882507801, "cur_lr": 0.0005000000237487257, "vf_loss": 27.87515640258789, "vf_explained_var": 0.6720832586288452, "total_loss": 27.86627197265625, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01741190440952778}, "num_steps_trained": 21360233, "load_time_ms": 12.178, "update_time_ms": 11.461, "sample_time_ms": 15355.317, "num_steps_sampled": 21360233}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20455, "hostname": "flow-main", "config": {"clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "dim": 84, "custom_options": {}, "framestack": true, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "custom_preprocessor": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "vf_clip_param": 1000000.0, "gamma": 0.99, "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_actions": false, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "vf_share_layers": false, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "batch_mode": "truncate_episodes", "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41a58>", "on_sample_end": null}, "lr_schedule": null, "lambda": 0.97, "entropy_coeff": 0.0, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "num_gpus": 0, "clip_rewards": null, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "straggler_mitigation": false, "output": null, "collect_metrics_timeout": 180}, "episode_reward_min": 396.63059432365696, "episodes_total": 13392, "episodes_this_iter": 63, "time_total_s": 7682.9221794605255, "num_metric_batches_dropped": 0}

{"timestamp": 1557214764, "timesteps_since_restore": 50733, "training_iteration": 1, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-39-24", "episode_reward_min": 491.96558130240874, "timesteps_this_iter": 50733, "episode_reward_mean": 491.96558130240874, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 1, "custom_metrics": {"cost2_mean": -39.05837781340662, "cost2_min": -39.05837781340662, "cost1_mean": 145.26473448788101, "outflow_rate_min": 391.8994285714286, "system_level_velocity_mean": 5.4638228883125155, "cost1_max": 145.26473448788101, "cost1_min": 145.26473448788101, "cost2_max": -39.05837781340662, "outflow_rate_mean": 391.8994285714286, "system_level_velocity_min": 5.4638228883125155, "outflow_rate_max": 391.8994285714286, "system_level_velocity_max": 5.4638228883125155}, "info": {"num_steps_trained": 50733, "load_time_ms": 61.154, "grad_time_ms": 10699.282, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0021782992407679558, "total_loss": 2.6420276165008545, "vf_loss": 2.6427643299102783, "policy_loss": -0.0011721879709511995, "cur_kl_coeff": 0.20000003278255463, "vf_explained_var": 0.8871631026268005, "entropy": 1.416991114616394}, "update_time_ms": 1284.65, "num_steps_sampled": 50733, "sample_time_ms": 40429.719}, "episode_len_mean": 700.0, "time_this_iter_s": 52.61529874801636, "num_metric_batches_dropped": 0, "timesteps_total": 50733, "episodes_total": 1, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170710>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f94611706d8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 491.96558130240874, "episodes_this_iter": 1, "time_total_s": 52.61529874801636, "time_since_restore": 52.61529874801636}
{"timestamp": 1557214790, "timesteps_since_restore": 96039, "training_iteration": 2, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-39-50", "episode_reward_min": 274.36617473978146, "timesteps_this_iter": 45306, "episode_reward_mean": 696.0786471475303, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 2, "custom_metrics": {"cost2_mean": -69.9491273456262, "cost2_min": -104.14852318702623, "cost1_mean": 217.4344868700663, "outflow_rate_min": 199.34331428571429, "system_level_velocity_mean": 8.88166121302107, "cost1_max": 301.5582077365608, "cost1_min": 106.7225107756544, "cost2_max": -35.87744999887143, "outflow_rate_mean": 510.69150696957365, "system_level_velocity_min": 5.4638228883125155, "outflow_rate_max": 938.5722857142857, "system_level_velocity_max": 17.861769839642935}, "info": {"num_steps_trained": 96039, "load_time_ms": 36.011, "grad_time_ms": 9412.059, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0023358608596026897, "total_loss": 1.3152753114700317, "vf_loss": 1.315560221672058, "policy_loss": -0.0005185340414755046, "cur_kl_coeff": 0.10000000894069672, "vf_explained_var": 0.9721603393554688, "entropy": 1.4156712293624878}, "update_time_ms": 645.859, "num_steps_sampled": 96039, "sample_time_ms": 29197.002}, "episode_len_mean": 674.3333333333334, "time_this_iter_s": 26.19253182411194, "num_metric_batches_dropped": 0, "timesteps_total": 96039, "episodes_total": 21, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f4a8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f470>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 952.1062060619287, "episodes_this_iter": 20, "time_total_s": 78.8078305721283, "time_since_restore": 78.8078305721283}
{"timestamp": 1557214820, "timesteps_since_restore": 144209, "training_iteration": 3, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-40-20", "episode_reward_min": 274.36617473978146, "timesteps_this_iter": 48170, "episode_reward_mean": 617.0219986023253, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 3, "custom_metrics": {"cost2_mean": -64.98521970951096, "cost2_min": -104.14852318702623, "cost1_mean": 201.38751400730428, "outflow_rate_min": 177.03257142857143, "system_level_velocity_mean": 8.05631466151985, "cost1_max": 301.5582077365608, "cost1_min": 106.7225107756544, "cost2_max": -35.87744999887143, "outflow_rate_mean": 408.9286028751084, "system_level_velocity_min": 5.4638228883125155, "outflow_rate_max": 938.5722857142857, "system_level_velocity_max": 17.861769839642935}, "info": {"num_steps_trained": 144209, "load_time_ms": 28.026, "grad_time_ms": 9276.944, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0079101687297225, "total_loss": 0.8231881260871887, "vf_loss": 0.8257084488868713, "policy_loss": -0.0029158059041947126, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9700174331665039, "entropy": 1.4137336015701294}, "update_time_ms": 433.361, "num_steps_sampled": 144209, "sample_time_ms": 26216.86}, "episode_len_mean": 685.0277777777778, "time_this_iter_s": 29.360406398773193, "num_metric_batches_dropped": 0, "timesteps_total": 144209, "episodes_total": 36, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b470>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b438>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 952.1062060619287, "episodes_this_iter": 15, "time_total_s": 108.16823697090149, "time_since_restore": 108.16823697090149}
{"timestamp": 1557214845, "timesteps_since_restore": 188977, "training_iteration": 4, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-40-45", "episode_reward_min": 274.36617473978146, "timesteps_this_iter": 44768, "episode_reward_mean": 616.6216814900692, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 4, "custom_metrics": {"cost2_mean": -65.14826427994016, "cost2_min": -104.14852318702623, "cost1_mean": 199.30618225798, "outflow_rate_min": 177.03257142857143, "system_level_velocity_mean": 7.9344667356239045, "cost1_max": 301.5582077365608, "cost1_min": 106.7225107756544, "cost2_max": -35.87744999887143, "outflow_rate_mean": 395.70737255932863, "system_level_velocity_min": 5.4638228883125155, "outflow_rate_max": 938.5722857142857, "system_level_velocity_max": 17.861769839642935}, "info": {"num_steps_trained": 188977, "load_time_ms": 24.492, "grad_time_ms": 9231.654, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009232992306351662, "total_loss": 1.7810076475143433, "vf_loss": 1.7853707075119019, "policy_loss": -0.004824459552764893, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9697863459587097, "entropy": 1.3918352127075195}, "update_time_ms": 327.219, "num_steps_sampled": 188977, "sample_time_ms": 23665.333}, "episode_len_mean": 686.8536585365854, "time_this_iter_s": 25.211072206497192, "num_metric_batches_dropped": 0, "timesteps_total": 188977, "episodes_total": 41, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15a58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15b70>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 952.1062060619287, "episodes_this_iter": 5, "time_total_s": 133.37930917739868, "time_since_restore": 133.37930917739868}
{"timestamp": 1557214871, "timesteps_since_restore": 236039, "training_iteration": 5, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-41-11", "episode_reward_min": 274.36617473978146, "timesteps_this_iter": 47062, "episode_reward_mean": 637.7055039694513, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 5, "custom_metrics": {"cost2_mean": -65.24120363373207, "cost2_min": -104.14852318702623, "cost1_mean": 199.76910803416564, "outflow_rate_min": 177.03257142857143, "system_level_velocity_mean": 7.875294881124674, "cost1_max": 301.5582077365608, "cost1_min": 106.7225107756544, "cost2_max": -35.87744999887143, "outflow_rate_mean": 426.7983716070966, "system_level_velocity_min": 5.4638228883125155, "outflow_rate_max": 938.5722857142857, "system_level_velocity_max": 17.861769839642935}, "info": {"num_steps_trained": 236039, "load_time_ms": 22.303, "grad_time_ms": 9134.529, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005156743340194225, "total_loss": 4.315722465515137, "vf_loss": 4.316884994506836, "policy_loss": -0.001420340733602643, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9370822310447693, "entropy": 1.3939809799194336}, "update_time_ms": 263.136, "num_steps_sampled": 236039, "sample_time_ms": 22423.625}, "episode_len_mean": 690.375, "time_this_iter_s": 26.298444747924805, "num_metric_batches_dropped": 0, "timesteps_total": 236039, "episodes_total": 56, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15080>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 952.1062060619287, "episodes_this_iter": 15, "time_total_s": 159.6777539253235, "time_since_restore": 159.6777539253235}
{"timestamp": 1557214897, "timesteps_since_restore": 280475, "training_iteration": 6, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-41-37", "episode_reward_min": 274.36617473978146, "timesteps_this_iter": 44436, "episode_reward_mean": 741.7112765505403, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 6, "custom_metrics": {"cost2_mean": -73.17135310638251, "cost2_min": -111.68693703702601, "cost1_mean": 212.18323870222315, "outflow_rate_min": 177.03257142857143, "system_level_velocity_mean": 8.234736428946112, "cost1_max": 301.5582077365608, "cost1_min": 106.7225107756544, "cost2_max": -35.87744999887143, "outflow_rate_mean": 521.4290323437549, "system_level_velocity_min": 5.4638228883125155, "outflow_rate_max": 949.6215328671329, "system_level_velocity_max": 17.861769839642935}, "info": {"num_steps_trained": 280475, "load_time_ms": 21.181, "grad_time_ms": 9028.269, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006269749253988266, "total_loss": 4.838091850280762, "vf_loss": 4.840122222900391, "policy_loss": -0.0023438914213329554, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9407781362533569, "entropy": 1.3966597318649292}, "update_time_ms": 220.462, "num_steps_sampled": 280475, "sample_time_ms": 21613.063}, "episode_len_mean": 692.8133333333334, "time_this_iter_s": 26.16991901397705, "num_metric_batches_dropped": 0, "timesteps_total": 280475, "episodes_total": 75, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f4e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f438>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1230.4083268729178, "episodes_this_iter": 19, "time_total_s": 185.84767293930054, "time_since_restore": 185.84767293930054}
{"timestamp": 1557214924, "timesteps_since_restore": 329325, "training_iteration": 7, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-42-04", "episode_reward_min": 274.36617473978146, "timesteps_this_iter": 48850, "episode_reward_mean": 764.7692330313625, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 7, "custom_metrics": {"cost2_mean": -74.77543970879067, "cost2_min": -111.68693703702601, "cost1_mean": 215.0740935760923, "outflow_rate_min": 177.03257142857143, "system_level_velocity_mean": 8.316469862572923, "cost1_max": 301.5582077365608, "cost1_min": 106.7225107756544, "cost2_max": -35.87744999887143, "outflow_rate_mean": 541.5337955724202, "system_level_velocity_min": 5.4638228883125155, "outflow_rate_max": 949.6215328671329, "system_level_velocity_max": 17.861769839642935}, "info": {"num_steps_trained": 329325, "load_time_ms": 20.147, "grad_time_ms": 9258.457, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.004935783334076405, "total_loss": 1.7757689952850342, "vf_loss": 1.7767510414123535, "policy_loss": -0.0012290197191759944, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9726042747497559, "entropy": 1.3951053619384766}, "update_time_ms": 189.822, "num_steps_sampled": 329325, "sample_time_ms": 20788.296}, "episode_len_mean": 693.3456790123457, "time_this_iter_s": 26.57941961288452, "num_metric_batches_dropped": 0, "timesteps_total": 329325, "episodes_total": 81, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b588>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1230.4083268729178, "episodes_this_iter": 6, "time_total_s": 212.42709255218506, "time_since_restore": 212.42709255218506}
{"timestamp": 1557214951, "timesteps_since_restore": 376154, "training_iteration": 8, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-42-31", "episode_reward_min": 274.36617473978146, "timesteps_this_iter": 46829, "episode_reward_mean": 813.6122566057866, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 8, "custom_metrics": {"cost2_mean": -77.72410544832788, "cost2_min": -114.09549122635453, "cost1_mean": 220.24694116002547, "outflow_rate_min": 177.03257142857143, "system_level_velocity_mean": 8.457811221905962, "cost1_max": 301.5582077365608, "cost1_min": 106.7225107756544, "cost2_max": -35.87744999887143, "outflow_rate_mean": 584.3175176740698, "system_level_velocity_min": 5.4638228883125155, "outflow_rate_max": 949.6215328671329, "system_level_velocity_max": 17.861769839642935}, "info": {"num_steps_trained": 376154, "load_time_ms": 19.377, "grad_time_ms": 9236.425, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0072465152479708195, "total_loss": 3.528301239013672, "vf_loss": 3.5302252769470215, "policy_loss": -0.002105381339788437, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9661873579025269, "entropy": 1.3933955430984497}, "update_time_ms": 166.89, "num_steps_sampled": 376154, "sample_time_ms": 20407.951}, "episode_len_mean": 694.3854166666666, "time_this_iter_s": 26.93130326271057, "num_metric_batches_dropped": 0, "timesteps_total": 376154, "episodes_total": 96, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15710>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15978>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1230.4083268729178, "episodes_this_iter": 15, "time_total_s": 239.35839581489563, "time_since_restore": 239.35839581489563}
{"timestamp": 1557214979, "timesteps_since_restore": 422984, "training_iteration": 9, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-42-59", "episode_reward_min": 308.9417859806775, "timesteps_this_iter": 46830, "episode_reward_mean": 895.9808147176477, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 9, "custom_metrics": {"cost2_mean": -81.00015238606142, "cost2_min": -114.09549122635453, "cost1_mean": 228.70315155132343, "outflow_rate_min": 177.03257142857143, "system_level_velocity_mean": 8.598089545911423, "cost1_max": 286.4375365685659, "cost1_min": 152.9897744349532, "cost2_max": -39.38028456446293, "outflow_rate_mean": 657.2401563676323, "system_level_velocity_min": 6.052624217682619, "outflow_rate_max": 1004.8399288711288, "system_level_velocity_max": 10.663588069154285}, "info": {"num_steps_trained": 422984, "load_time_ms": 18.12, "grad_time_ms": 9214.695, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.005132987629622221, "total_loss": 6.464060306549072, "vf_loss": 6.465893745422363, "policy_loss": -0.001961728557944298, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9240191578865051, "entropy": 1.3832765817642212}, "update_time_ms": 149.202, "num_steps_sampled": 422984, "sample_time_ms": 20199.921}, "episode_len_mean": 700.0, "time_this_iter_s": 27.670089960098267, "num_metric_batches_dropped": 0, "timesteps_total": 422984, "episodes_total": 115, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fbe0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fb00>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1230.4083268729178, "episodes_this_iter": 19, "time_total_s": 267.0284857749939, "time_since_restore": 267.0284857749939}
{"timestamp": 1557215005, "timesteps_since_restore": 471255, "training_iteration": 10, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-43-25", "episode_reward_min": 308.9417859806775, "timesteps_this_iter": 48271, "episode_reward_mean": 925.6171280619212, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 10, "custom_metrics": {"cost2_mean": -82.0091442354923, "cost2_min": -114.09549122635453, "cost1_mean": 231.66047955196683, "outflow_rate_min": 177.03257142857143, "system_level_velocity_mean": 8.69772674154767, "cost1_max": 321.53885759022506, "cost1_min": 152.9897744349532, "cost2_max": -41.789346861248255, "outflow_rate_mean": 684.0989927832167, "system_level_velocity_min": 6.052624217682619, "outflow_rate_max": 1119.7516583416584, "system_level_velocity_max": 11.767964339228696}, "info": {"num_steps_trained": 471255, "load_time_ms": 17.724, "grad_time_ms": 9386.473, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00793397706001997, "total_loss": 3.167245388031006, "vf_loss": 3.168943405151367, "policy_loss": -0.0018964477349072695, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.969810962677002, "entropy": 1.3622914552688599}, "update_time_ms": 135.11, "num_steps_sampled": 471255, "sample_time_ms": 19697.601}, "episode_len_mean": 700.0, "time_this_iter_s": 26.218196153640747, "num_metric_batches_dropped": 0, "timesteps_total": 471255, "episodes_total": 121, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f6a0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1321.6311574581855, "episodes_this_iter": 6, "time_total_s": 293.24668192863464, "time_since_restore": 293.24668192863464}
{"timestamp": 1557215031, "timesteps_since_restore": 517910, "training_iteration": 11, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-43-51", "episode_reward_min": 428.1265428252206, "timesteps_this_iter": 46655, "episode_reward_mean": 1036.8599910071916, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 11, "custom_metrics": {"cost2_mean": -85.57552546303701, "cost2_min": -114.09549122635453, "cost1_mean": 249.37985748235414, "outflow_rate_min": 202.13005714285714, "system_level_velocity_mean": 9.312013189946155, "cost1_max": 333.20322207425005, "cost1_min": 158.81968070935096, "cost2_max": -46.110174087363596, "outflow_rate_mean": 793.6038316363636, "system_level_velocity_min": 6.2380483067816765, "outflow_rate_max": 1192.1374985014982, "system_level_velocity_max": 12.39469682325051}, "info": {"num_steps_trained": 517910, "load_time_ms": 13.048, "grad_time_ms": 9300.968, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006793181411921978, "total_loss": 5.177855491638184, "vf_loss": 5.178811550140381, "policy_loss": -0.0011257854057475924, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9634283781051636, "entropy": 1.3497464656829834}, "update_time_ms": 7.268, "num_steps_sampled": 517910, "sample_time_ms": 17294.132}, "episode_len_mean": 700.0, "time_this_iter_s": 26.345046520233154, "num_metric_batches_dropped": 0, "timesteps_total": 517910, "episodes_total": 137, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b390>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1415.421737493932, "episodes_this_iter": 16, "time_total_s": 319.5917284488678, "time_since_restore": 319.5917284488678}
{"timestamp": 1557215061, "timesteps_since_restore": 569070, "training_iteration": 12, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-44-21", "episode_reward_min": 744.4967646268603, "timesteps_this_iter": 51160, "episode_reward_mean": 1120.79620796438, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 12, "custom_metrics": {"cost2_mean": -89.09845635587895, "cost2_min": -114.09549122635453, "cost1_mean": 259.425311686448, "outflow_rate_min": 493.6013142857143, "system_level_velocity_mean": 9.64972273102644, "cost1_max": 333.20322207425005, "cost1_min": 191.2565243639701, "cost2_max": -63.491765612493246, "outflow_rate_mean": 862.7559856263736, "system_level_velocity_min": 7.394080805867717, "outflow_rate_max": 1192.1374985014982, "system_level_velocity_max": 12.39469682325051}, "info": {"num_steps_trained": 569070, "load_time_ms": 13.787, "grad_time_ms": 9565.236, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007439238019287586, "total_loss": 5.3582539558410645, "vf_loss": 5.360395431518555, "policy_loss": -0.0023281052708625793, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9341721534729004, "entropy": 1.3693366050720215}, "update_time_ms": 7.175, "num_steps_sampled": 569070, "sample_time_ms": 17362.606}, "episode_len_mean": 700.0, "time_this_iter_s": 29.533792734146118, "num_metric_batches_dropped": 0, "timesteps_total": 569070, "episodes_total": 155, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15710>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd155f8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1415.421737493932, "episodes_this_iter": 18, "time_total_s": 349.1255211830139, "time_since_restore": 349.1255211830139}
{"timestamp": 1557215087, "timesteps_since_restore": 617985, "training_iteration": 13, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-44-47", "episode_reward_min": 774.4757116509361, "timesteps_this_iter": 48915, "episode_reward_mean": 1131.9532810061398, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 13, "custom_metrics": {"cost2_mean": -88.1762369539726, "cost2_min": -114.09549122635453, "cost1_mean": 260.7659622220475, "outflow_rate_min": 546.8233142857144, "system_level_velocity_mean": 9.696298069436754, "cost1_max": 333.20322207425005, "cost1_min": 175.9302039254755, "cost2_max": -62.85451684174677, "outflow_rate_mean": 869.5805587932067, "system_level_velocity_min": 6.6798237358707775, "outflow_rate_max": 1192.1374985014982, "system_level_velocity_max": 12.39469682325051}, "info": {"num_steps_trained": 617985, "load_time_ms": 13.995, "grad_time_ms": 9697.286, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.006385674700140953, "total_loss": 2.533620595932007, "vf_loss": 2.5349156856536865, "policy_loss": -0.0014547273749485612, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9773770570755005, "entropy": 1.3328112363815308}, "update_time_ms": 7.118, "num_steps_sampled": 617985, "sample_time_ms": 16918.741}, "episode_len_mean": 700.0, "time_this_iter_s": 26.252020359039307, "num_metric_batches_dropped": 0, "timesteps_total": 617985, "episodes_total": 161, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f470>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1415.421737493932, "episodes_this_iter": 6, "time_total_s": 375.3775415420532, "time_since_restore": 375.3775415420532}
{"timestamp": 1557215114, "timesteps_since_restore": 664190, "training_iteration": 14, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-45-14", "episode_reward_min": 914.1184951400616, "timesteps_this_iter": 46205, "episode_reward_mean": 1143.0639066682784, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 14, "custom_metrics": {"cost2_mean": -85.39584674040226, "cost2_min": -114.09549122635453, "cost1_mean": 261.71171972006744, "outflow_rate_min": 574.3189454545454, "system_level_velocity_mean": 9.730484382544056, "cost1_max": 333.20322207425005, "cost1_min": 175.9302039254755, "cost2_max": -62.85451684174677, "outflow_rate_mean": 869.4451950209791, "system_level_velocity_min": 6.6798237358707775, "outflow_rate_max": 1192.1374985014982, "system_level_velocity_max": 12.39469682325051}, "info": {"num_steps_trained": 664190, "load_time_ms": 14.15, "grad_time_ms": 9782.408, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.007575710769742727, "total_loss": 4.480721950531006, "vf_loss": 4.482119560241699, "policy_loss": -0.0015869137132540345, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9686155319213867, "entropy": 1.3231507539749146}, "update_time_ms": 6.842, "num_steps_sampled": 664190, "sample_time_ms": 16969.755}, "episode_len_mean": 700.0, "time_this_iter_s": 26.56460666656494, "num_metric_batches_dropped": 0, "timesteps_total": 664190, "episodes_total": 175, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1bb70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1be48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b3c8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1415.421737493932, "episodes_this_iter": 14, "time_total_s": 401.94214820861816, "time_since_restore": 401.94214820861816}
{"timestamp": 1557215141, "timesteps_since_restore": 710614, "training_iteration": 15, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-45-41", "episode_reward_min": 914.1184951400616, "timesteps_this_iter": 46424, "episode_reward_mean": 1168.950008021891, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 15, "custom_metrics": {"cost2_mean": -81.99803401852424, "cost2_min": -114.09549122635453, "cost1_mean": 265.86010429105556, "outflow_rate_min": 574.3189454545454, "system_level_velocity_mean": 9.886543531658347, "cost1_max": 333.20322207425005, "cost1_min": 175.9302039254755, "cost2_max": -59.40016875530482, "outflow_rate_mean": 895.1977642837162, "system_level_velocity_min": 6.6798237358707775, "outflow_rate_max": 1192.1374985014982, "system_level_velocity_max": 12.39469682325051}, "info": {"num_steps_trained": 710614, "load_time_ms": 14.066, "grad_time_ms": 9873.269, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009178305976092815, "total_loss": 10.380244255065918, "vf_loss": 10.382159233093262, "policy_loss": -0.0021447166800498962, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.8916198015213013, "entropy": 1.3128048181533813}, "update_time_ms": 6.841, "num_steps_sampled": 710614, "sample_time_ms": 16925.584}, "episode_len_mean": 700.0, "time_this_iter_s": 26.76279854774475, "num_metric_batches_dropped": 0, "timesteps_total": 710614, "episodes_total": 194, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fb70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1415.421737493932, "episodes_this_iter": 19, "time_total_s": 428.7049467563629, "time_since_restore": 428.7049467563629}
{"timestamp": 1557215167, "timesteps_since_restore": 758623, "training_iteration": 16, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-46-07", "episode_reward_min": 63.41978185623442, "timesteps_this_iter": 48009, "episode_reward_mean": 1162.8937968263836, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 16, "custom_metrics": {"cost2_mean": -78.93945163599271, "cost2_min": -107.49630742436084, "cost1_mean": 265.0578519407777, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 10.0306136136238, "cost1_max": 333.20322207425005, "cost1_min": 33.70522538586089, "cost2_max": -11.985337714968782, "outflow_rate_mean": 898.4389553381003, "system_level_velocity_min": 6.6798237358707775, "outflow_rate_max": 1192.1374985014982, "system_level_velocity_max": 18.822609890612853}, "info": {"num_steps_trained": 758623, "load_time_ms": 13.943, "grad_time_ms": 10141.549, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.00937460083514452, "total_loss": 5.055255889892578, "vf_loss": 5.05744743347168, "policy_loss": -0.002425407525151968, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9461814761161804, "entropy": 1.3071441650390625}, "update_time_ms": 6.737, "num_steps_sampled": 758623, "sample_time_ms": 16654.026}, "episode_len_mean": 693.5, "time_this_iter_s": 26.1265070438385, "num_metric_batches_dropped": 0, "timesteps_total": 758623, "episodes_total": 202, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0feb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0ff60>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1415.421737493932, "episodes_this_iter": 8, "time_total_s": 454.8314538002014, "time_since_restore": 454.8314538002014}
{"timestamp": 1557215192, "timesteps_since_restore": 802589, "training_iteration": 17, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-46-32", "episode_reward_min": 63.41978185623442, "timesteps_this_iter": 43966, "episode_reward_mean": 1169.1114781808571, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 17, "custom_metrics": {"cost2_mean": -77.12559055735979, "cost2_min": -107.49630742436084, "cost1_mean": 265.98100724964115, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 10.066757983965937, "cost1_max": 333.20322207425005, "cost1_min": 33.70522538586089, "cost2_max": -11.985337714968782, "outflow_rate_mean": 899.094206011427, "system_level_velocity_min": 6.6798237358707775, "outflow_rate_max": 1192.1374985014982, "system_level_velocity_max": 18.822609890612853}, "info": {"num_steps_trained": 802589, "load_time_ms": 13.951, "grad_time_ms": 10095.035, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01117907464504242, "total_loss": 7.077791690826416, "vf_loss": 7.080476760864258, "policy_loss": -0.00296516390517354, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9440325498580933, "entropy": 1.315893530845642}, "update_time_ms": 6.833, "num_steps_sampled": 802589, "sample_time_ms": 16582.329}, "episode_len_mean": 693.5, "time_this_iter_s": 25.41163444519043, "num_metric_batches_dropped": 0, "timesteps_total": 802589, "episodes_total": 216, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15518>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1415.421737493932, "episodes_this_iter": 14, "time_total_s": 480.24308824539185, "time_since_restore": 480.24308824539185}
{"timestamp": 1557215219, "timesteps_since_restore": 847935, "training_iteration": 18, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-46-59", "episode_reward_min": 55.974796289072366, "timesteps_this_iter": 45346, "episode_reward_mean": 1155.0475209402339, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 18, "custom_metrics": {"cost2_mean": -73.15579290916588, "cost2_min": -102.70474599712693, "cost1_mean": 262.94861416206595, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 10.129892777789003, "cost1_max": 314.4779026169101, "cost1_min": 28.113593115865985, "cost2_max": -8.392877958648945, "outflow_rate_mean": 896.7909692499544, "system_level_velocity_min": 6.6798237358707775, "outflow_rate_max": 1182.1668867132869, "system_level_velocity_max": 19.01300768030222}, "info": {"num_steps_trained": 847935, "load_time_ms": 13.895, "grad_time_ms": 10263.179, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008046943694353104, "total_loss": 11.992280960083008, "vf_loss": 11.994331359863281, "policy_loss": -0.0022506399545818567, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8805422186851501, "entropy": 1.3007231950759888}, "update_time_ms": 6.834, "num_steps_sampled": 847935, "sample_time_ms": 16449.335}, "episode_len_mean": 686.93, "time_this_iter_s": 27.28877830505371, "num_metric_batches_dropped": 0, "timesteps_total": 847935, "episodes_total": 236, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f828>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f4a8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1354.0965811637527, "episodes_this_iter": 20, "time_total_s": 507.53186655044556, "time_since_restore": 507.53186655044556}
{"timestamp": 1557215243, "timesteps_since_restore": 891773, "training_iteration": 19, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-47-23", "episode_reward_min": 55.974796289072366, "timesteps_this_iter": 43838, "episode_reward_mean": 1165.6311075216045, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 19, "custom_metrics": {"cost2_mean": -72.55045749472605, "cost2_min": -102.70474599712693, "cost1_mean": 265.4868895179409, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 10.215353724449777, "cost1_max": 314.4779026169101, "cost1_min": 28.113593115865985, "cost2_max": -8.392877958648945, "outflow_rate_mean": 911.4872886305734, "system_level_velocity_min": 6.6798237358707775, "outflow_rate_max": 1182.1668867132869, "system_level_velocity_max": 19.01300768030222}, "info": {"num_steps_trained": 891773, "load_time_ms": 14.428, "grad_time_ms": 10370.236, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009258338250219822, "total_loss": 4.798194885253906, "vf_loss": 4.8002028465271, "policy_loss": -0.0022394428960978985, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9491737484931946, "entropy": 1.2946380376815796}, "update_time_ms": 6.785, "num_steps_sampled": 891773, "sample_time_ms": 15963.124}, "episode_len_mean": 686.93, "time_this_iter_s": 23.887802124023438, "num_metric_batches_dropped": 0, "timesteps_total": 891773, "episodes_total": 243, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fb00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1433.9096644911867, "episodes_this_iter": 7, "time_total_s": 531.419668674469, "time_since_restore": 531.419668674469}
{"timestamp": 1557215270, "timesteps_since_restore": 936298, "training_iteration": 20, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-47-50", "episode_reward_min": 54.43102999932598, "timesteps_this_iter": 44525, "episode_reward_mean": 1178.3079634139942, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 20, "custom_metrics": {"cost2_mean": -69.35798722355528, "cost2_min": -89.62036427772861, "cost1_mean": 270.10955935734916, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 10.548045804361672, "cost1_max": 315.0088795529537, "cost1_min": 28.113593115865985, "cost2_max": -8.392877958648945, "outflow_rate_mean": 942.0289327021367, "system_level_velocity_min": 8.342941250644138, "outflow_rate_max": 1197.6301834165836, "system_level_velocity_max": 19.08174937623987}, "info": {"num_steps_trained": 936298, "load_time_ms": 14.241, "grad_time_ms": 10313.26, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010023010894656181, "total_loss": 13.18610668182373, "vf_loss": 13.18832778930664, "policy_loss": -0.0024709447752684355, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.8927177786827087, "entropy": 1.3093020915985107}, "update_time_ms": 6.668, "num_steps_sampled": 936298, "sample_time_ms": 16103.015}, "episode_len_mean": 680.37, "time_this_iter_s": 27.064551830291748, "num_metric_batches_dropped": 0, "timesteps_total": 936298, "episodes_total": 262, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fba8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f320>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1433.9096644911867, "episodes_this_iter": 19, "time_total_s": 558.4842205047607, "time_since_restore": 558.4842205047607}
{"timestamp": 1557215298, "timesteps_since_restore": 981972, "training_iteration": 21, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-48-18", "episode_reward_min": 54.43102999932598, "timesteps_this_iter": 45674, "episode_reward_mean": 1188.5665145161897, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 21, "custom_metrics": {"cost2_mean": -70.31407763412626, "cost2_min": -102.27456841340248, "cost1_mean": 273.80761377253975, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 10.670626625847781, "cost1_max": 315.0088795529537, "cost1_min": 28.113593115865985, "cost2_max": -8.392877958648945, "outflow_rate_mean": 967.0682671396991, "system_level_velocity_min": 8.342941250644138, "outflow_rate_max": 1197.6301834165836, "system_level_velocity_max": 19.08174937623987}, "info": {"num_steps_trained": 981972, "load_time_ms": 14.462, "grad_time_ms": 10373.553, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009041305631399155, "total_loss": 8.778433799743652, "vf_loss": 8.77974796295166, "policy_loss": -0.0015397113747894764, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9348117709159851, "entropy": 1.3103349208831787}, "update_time_ms": 6.783, "num_steps_sampled": 981972, "sample_time_ms": 16208.409}, "episode_len_mean": 680.37, "time_this_iter_s": 28.009363412857056, "num_metric_batches_dropped": 0, "timesteps_total": 981972, "episodes_total": 278, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd154e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9461170160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd157f0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1433.9096644911867, "episodes_this_iter": 16, "time_total_s": 586.4935839176178, "time_since_restore": 586.4935839176178}
{"timestamp": 1557215324, "timesteps_since_restore": 1027415, "training_iteration": 22, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-48-44", "episode_reward_min": 54.43102999932598, "timesteps_this_iter": 45443, "episode_reward_mean": 1189.2341655090058, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 22, "custom_metrics": {"cost2_mean": -71.4804813673497, "cost2_min": -102.27456841340248, "cost1_mean": 274.9645751219091, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 10.710291798249685, "cost1_max": 315.0088795529537, "cost1_min": 28.113593115865985, "cost2_max": -8.392877958648945, "outflow_rate_mean": 971.8348116471917, "system_level_velocity_min": 8.342941250644138, "outflow_rate_max": 1197.6301834165836, "system_level_velocity_max": 19.08174937623987}, "info": {"num_steps_trained": 1027415, "load_time_ms": 13.87, "grad_time_ms": 10375.764, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010150199756026268, "total_loss": 4.456664085388184, "vf_loss": 4.459183216094971, "policy_loss": -0.002772814128547907, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9657766222953796, "entropy": 1.302733302116394}, "update_time_ms": 7.165, "num_steps_sampled": 1027415, "sample_time_ms": 15779.101}, "episode_len_mean": 680.37, "time_this_iter_s": 25.26630163192749, "num_metric_batches_dropped": 0, "timesteps_total": 1027415, "episodes_total": 286, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1be48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b0f0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1433.9096644911867, "episodes_this_iter": 8, "time_total_s": 611.7598855495453, "time_since_restore": 611.7598855495453}
{"timestamp": 1557215349, "timesteps_since_restore": 1071710, "training_iteration": 23, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-49-09", "episode_reward_min": 54.43102999932598, "timesteps_this_iter": 44295, "episode_reward_mean": 1225.552873443044, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 23, "custom_metrics": {"cost2_mean": -73.48208651263195, "cost2_min": -102.27456841340248, "cost1_mean": 285.23314991539235, "outflow_rate_min": 338.86037478867604, "system_level_velocity_mean": 10.904167931986876, "cost1_max": 349.2027067986337, "cost1_min": 28.113593115865985, "cost2_max": -8.392877958648945, "outflow_rate_mean": 1013.0886199934072, "system_level_velocity_min": 8.342941250644138, "outflow_rate_max": 1261.9120535464535, "system_level_velocity_max": 19.08174937623987}, "info": {"num_steps_trained": 1071710, "load_time_ms": 13.799, "grad_time_ms": 10383.789, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010227811522781849, "total_loss": 12.82240104675293, "vf_loss": 12.824462890625, "policy_loss": -0.002317585051059723, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9227083325386047, "entropy": 1.3170994520187378}, "update_time_ms": 7.252, "num_steps_sampled": 1071710, "sample_time_ms": 15636.005}, "episode_len_mean": 686.87, "time_this_iter_s": 24.931397199630737, "num_metric_batches_dropped": 0, "timesteps_total": 1071710, "episodes_total": 304, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f128>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1433.9096644911867, "episodes_this_iter": 18, "time_total_s": 636.691282749176, "time_since_restore": 636.691282749176}
{"timestamp": 1557215376, "timesteps_since_restore": 1116093, "training_iteration": 24, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-49-36", "episode_reward_min": 54.43102999932598, "timesteps_this_iter": 44383, "episode_reward_mean": 1240.3322085461318, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 24, "custom_metrics": {"cost2_mean": -74.47596538167456, "cost2_min": -102.27456841340248, "cost1_mean": 292.3240676020557, "outflow_rate_min": 338.86037478867604, "system_level_velocity_mean": 11.165344650258973, "cost1_max": 363.2558734658938, "cost1_min": 28.113593115865985, "cost2_max": -8.392877958648945, "outflow_rate_mean": 1036.6446376497506, "system_level_velocity_min": 9.332306182159721, "outflow_rate_max": 1261.9120535464535, "system_level_velocity_max": 19.08174937623987}, "info": {"num_steps_trained": 1116093, "load_time_ms": 13.127, "grad_time_ms": 10459.755, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009956282563507557, "total_loss": 9.475177764892578, "vf_loss": 9.47677230834961, "policy_loss": -0.001842764555476606, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9399131536483765, "entropy": 1.314183235168457}, "update_time_ms": 7.586, "num_steps_sampled": 1116093, "sample_time_ms": 15591.485}, "episode_len_mean": 686.87, "time_this_iter_s": 26.899792194366455, "num_metric_batches_dropped": 0, "timesteps_total": 1116093, "episodes_total": 320, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26710>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1454.1198845587028, "episodes_this_iter": 16, "time_total_s": 663.5910749435425, "time_since_restore": 663.5910749435425}
{"timestamp": 1557215403, "timesteps_since_restore": 1163359, "training_iteration": 25, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-50-03", "episode_reward_min": 54.43102999932598, "timesteps_this_iter": 47266, "episode_reward_mean": 1245.0978244313096, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 25, "custom_metrics": {"cost2_mean": -75.02846315780675, "cost2_min": -102.27456841340248, "cost1_mean": 294.9499223387458, "outflow_rate_min": 337.7301442378166, "system_level_velocity_mean": 11.255939543171142, "cost1_max": 363.2558734658938, "cost1_min": 29.174218679077082, "cost2_max": -9.75606498532539, "outflow_rate_mean": 1043.4095873860692, "system_level_velocity_min": 9.332306182159721, "outflow_rate_max": 1261.9120535464535, "system_level_velocity_max": 19.08174937623987}, "info": {"num_steps_trained": 1163359, "load_time_ms": 13.097, "grad_time_ms": 10633.479, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.008806799538433552, "total_loss": 5.988187313079834, "vf_loss": 5.990200042724609, "policy_loss": -0.0022324409801512957, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9636633992195129, "entropy": 1.302904725074768}, "update_time_ms": 7.91, "num_steps_sampled": 1163359, "sample_time_ms": 15467.282}, "episode_len_mean": 686.89, "time_this_iter_s": 27.290712118148804, "num_metric_batches_dropped": 0, "timesteps_total": 1163359, "episodes_total": 329, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd260f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26b38>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1454.1198845587028, "episodes_this_iter": 9, "time_total_s": 690.8817870616913, "time_since_restore": 690.8817870616913}
{"timestamp": 1557215429, "timesteps_since_restore": 1208315, "training_iteration": 26, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-50-29", "episode_reward_min": 54.43102999932598, "timesteps_this_iter": 44956, "episode_reward_mean": 1247.7843063202934, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 26, "custom_metrics": {"cost2_mean": -76.03136471278115, "cost2_min": -102.27456841340248, "cost1_mean": 298.77710170648277, "outflow_rate_min": 337.7301442378166, "system_level_velocity_mean": 11.404090070780988, "cost1_max": 363.2558734658938, "cost1_min": 29.174218679077082, "cost2_max": -9.75606498532539, "outflow_rate_mean": 1054.291105987468, "system_level_velocity_min": 9.332306182159721, "outflow_rate_max": 1261.9120535464535, "system_level_velocity_max": 19.08174937623987}, "info": {"num_steps_trained": 1208315, "load_time_ms": 12.799, "grad_time_ms": 10645.646, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011652682907879353, "total_loss": 6.329142093658447, "vf_loss": 6.331444263458252, "policy_loss": -0.0025941303465515375, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9683787226676941, "entropy": 1.273498296737671}, "update_time_ms": 8.23, "num_steps_sampled": 1208315, "sample_time_ms": 15482.696}, "episode_len_mean": 686.89, "time_this_iter_s": 26.410802841186523, "num_metric_batches_dropped": 0, "timesteps_total": 1208315, "episodes_total": 346, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f208>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1454.1198845587028, "episodes_this_iter": 17, "time_total_s": 717.2925899028778, "time_since_restore": 717.2925899028778}
{"timestamp": 1557215455, "timesteps_since_restore": 1252575, "training_iteration": 27, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-50-55", "episode_reward_min": 57.19533730327582, "timesteps_this_iter": 44260, "episode_reward_mean": 1246.5514808632645, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 27, "custom_metrics": {"cost2_mean": -75.35264494993714, "cost2_min": -102.27456841340248, "cost1_mean": 303.3860301336506, "outflow_rate_min": 337.7301442378166, "system_level_velocity_mean": 11.593595641651131, "cost1_max": 364.20828498403694, "cost1_min": 28.943815899501267, "cost2_max": -9.75606498532539, "outflow_rate_mean": 1057.2117091144717, "system_level_velocity_min": 9.332306182159721, "outflow_rate_max": 1261.9120535464535, "system_level_velocity_max": 19.533667720844573}, "info": {"num_steps_trained": 1252575, "load_time_ms": 12.797, "grad_time_ms": 10692.874, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009311366826295853, "total_loss": 11.210305213928223, "vf_loss": 11.211932182312012, "policy_loss": -0.001860226970165968, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9409428238868713, "entropy": 1.2681910991668701}, "update_time_ms": 8.601, "num_steps_sampled": 1252575, "sample_time_ms": 15426.759}, "episode_len_mean": 686.88, "time_this_iter_s": 25.319953680038452, "num_metric_batches_dropped": 0, "timesteps_total": 1252575, "episodes_total": 363, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd321d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32198>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1454.1198845587028, "episodes_this_iter": 17, "time_total_s": 742.6125435829163, "time_since_restore": 742.6125435829163}
{"timestamp": 1557215480, "timesteps_since_restore": 1295619, "training_iteration": 28, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-51-20", "episode_reward_min": 57.19533730327582, "timesteps_this_iter": 43044, "episode_reward_mean": 1246.7301964849719, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 28, "custom_metrics": {"cost2_mean": -71.70046572081026, "cost2_min": -101.13250172494327, "cost1_mean": 307.74297601574517, "outflow_rate_min": 337.7301442378166, "system_level_velocity_mean": 11.767639744088399, "cost1_max": 364.20828498403694, "cost1_min": 28.943815899501267, "cost2_max": -9.75606498532539, "outflow_rate_mean": 1063.0981944131731, "system_level_velocity_min": 9.770113790268809, "outflow_rate_max": 1304.4078873126875, "system_level_velocity_max": 19.533667720844573}, "info": {"num_steps_trained": 1295619, "load_time_ms": 13.049, "grad_time_ms": 10589.799, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012424067594110966, "total_loss": 8.688815116882324, "vf_loss": 8.69096851348877, "policy_loss": -0.0024652264546602964, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9483401775360107, "entropy": 1.2197051048278809}, "update_time_ms": 9.032, "num_steps_sampled": 1295619, "sample_time_ms": 15335.522}, "episode_len_mean": 686.88, "time_this_iter_s": 25.37205195426941, "num_metric_batches_dropped": 0, "timesteps_total": 1295619, "episodes_total": 376, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b7b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b898>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1454.1198845587028, "episodes_this_iter": 13, "time_total_s": 767.9845955371857, "time_since_restore": 767.9845955371857}
{"timestamp": 1557215506, "timesteps_since_restore": 1338626, "training_iteration": 29, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-51-46", "episode_reward_min": 57.19533730327582, "timesteps_this_iter": 43007, "episode_reward_mean": 1247.002199723261, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 29, "custom_metrics": {"cost2_mean": -66.4346831477856, "cost2_min": -101.13250172494327, "cost1_mean": 311.7108639290087, "outflow_rate_min": 337.7301442378166, "system_level_velocity_mean": 11.927239990650243, "cost1_max": 364.20828498403694, "cost1_min": 28.943815899501267, "cost2_max": -9.75606498532539, "outflow_rate_mean": 1069.5916702613251, "system_level_velocity_min": 9.770113790268809, "outflow_rate_max": 1304.4078873126875, "system_level_velocity_max": 19.533667720844573}, "info": {"num_steps_trained": 1338626, "load_time_ms": 13.276, "grad_time_ms": 10490.756, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010283898562192917, "total_loss": 15.241815567016602, "vf_loss": 15.244370460510254, "policy_loss": -0.0028124982491135597, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.8996407389640808, "entropy": 1.1865092515945435}, "update_time_ms": 9.222, "num_steps_sampled": 1338626, "sample_time_ms": 15626.344}, "episode_len_mean": 686.88, "time_this_iter_s": 25.81782555580139, "num_metric_batches_dropped": 0, "timesteps_total": 1338626, "episodes_total": 393, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26ba8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26630>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1454.1198845587028, "episodes_this_iter": 17, "time_total_s": 793.8024210929871, "time_since_restore": 793.8024210929871}
{"timestamp": 1557215535, "timesteps_since_restore": 1382174, "training_iteration": 30, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-52-15", "episode_reward_min": 57.19533730327582, "timesteps_this_iter": 43548, "episode_reward_mean": 1241.5660136563208, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 30, "custom_metrics": {"cost2_mean": -63.36324768180017, "cost2_min": -101.13250172494327, "cost1_mean": 315.09649992094865, "outflow_rate_min": 337.7301442378166, "system_level_velocity_mean": 12.05382360153933, "cost1_max": 364.20828498403694, "cost1_min": 28.943815899501267, "cost2_max": -9.75606498532539, "outflow_rate_mean": 1077.349032419167, "system_level_velocity_min": 9.770113790268809, "outflow_rate_max": 1304.4078873126875, "system_level_velocity_max": 19.533667720844573}, "info": {"num_steps_trained": 1382174, "load_time_ms": 13.342, "grad_time_ms": 10520.857, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010267688892781734, "total_loss": 11.185964584350586, "vf_loss": 11.185949325561523, "policy_loss": -0.00024054961977526546, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9306287169456482, "entropy": 1.1715691089630127}, "update_time_ms": 9.311, "num_steps_sampled": 1382174, "sample_time_ms": 15738.547}, "episode_len_mean": 686.88, "time_this_iter_s": 28.466902494430542, "num_metric_batches_dropped": 0, "timesteps_total": 1382174, "episodes_total": 406, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd322e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1454.1198845587028, "episodes_this_iter": 13, "time_total_s": 822.2693235874176, "time_since_restore": 822.2693235874176}
{"timestamp": 1557215561, "timesteps_since_restore": 1426189, "training_iteration": 31, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-52-41", "episode_reward_min": 57.19533730327582, "timesteps_this_iter": 44015, "episode_reward_mean": 1241.755291094392, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 31, "custom_metrics": {"cost2_mean": -59.707789440206106, "cost2_min": -94.22122702929339, "cost1_mean": 317.4684568501567, "outflow_rate_min": 337.7301442378166, "system_level_velocity_mean": 12.141682076608499, "cost1_max": 364.20828498403694, "cost1_min": 28.943815899501267, "cost2_max": -9.75606498532539, "outflow_rate_mean": 1083.9987053362502, "system_level_velocity_min": 9.770113790268809, "outflow_rate_max": 1304.4078873126875, "system_level_velocity_max": 19.533667720844573}, "info": {"num_steps_trained": 1426189, "load_time_ms": 12.94, "grad_time_ms": 10502.714, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012247166596353054, "total_loss": 12.280296325683594, "vf_loss": 12.281902313232422, "policy_loss": -0.0019114842871204019, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9327179193496704, "entropy": 1.1553332805633545}, "update_time_ms": 9.585, "num_steps_sampled": 1426189, "sample_time_ms": 15615.684}, "episode_len_mean": 686.88, "time_this_iter_s": 26.59511089324951, "num_metric_batches_dropped": 0, "timesteps_total": 1426189, "episodes_total": 422, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2bb70>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1389.355878090374, "episodes_this_iter": 16, "time_total_s": 848.8644344806671, "time_since_restore": 848.8644344806671}
{"timestamp": 1557215588, "timesteps_since_restore": 1469696, "training_iteration": 32, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-53-08", "episode_reward_min": 57.19533730327582, "timesteps_this_iter": 43507, "episode_reward_mean": 1260.7824339626045, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 32, "custom_metrics": {"cost2_mean": -58.084418268340606, "cost2_min": -89.6391856335867, "cost1_mean": 324.03841061834896, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 12.211364362077322, "cost1_max": 364.20828498403694, "cost1_min": 28.943815899501267, "cost2_max": -10.592400723984483, "outflow_rate_mean": 1105.805095082683, "system_level_velocity_min": 9.770113790268809, "outflow_rate_max": 1304.4078873126875, "system_level_velocity_max": 19.533667720844573}, "info": {"num_steps_trained": 1469696, "load_time_ms": 12.961, "grad_time_ms": 10460.398, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010698799975216389, "total_loss": 11.919042587280273, "vf_loss": 11.921351432800293, "policy_loss": -0.0025763455778360367, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9392572641372681, "entropy": 1.1699856519699097}, "update_time_ms": 9.631, "num_steps_sampled": 1469696, "sample_time_ms": 15810.457}, "episode_len_mean": 693.43, "time_this_iter_s": 26.78721594810486, "num_metric_batches_dropped": 0, "timesteps_total": 1469696, "episodes_total": 440, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f1d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fbe0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1404.9969235691094, "episodes_this_iter": 18, "time_total_s": 875.651650428772, "time_since_restore": 875.651650428772}
{"timestamp": 1557215615, "timesteps_since_restore": 1513436, "training_iteration": 33, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-53-35", "episode_reward_min": 57.19533730327582, "timesteps_this_iter": 43740, "episode_reward_mean": 1260.276839318638, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 33, "custom_metrics": {"cost2_mean": -56.58036037024743, "cost2_min": -80.16310524458652, "cost1_mean": 325.1128671097167, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 12.248506558238564, "cost1_max": 363.9037962418498, "cost1_min": 28.943815899501267, "cost2_max": -10.592400723984483, "outflow_rate_mean": 1107.5633235941716, "system_level_velocity_min": 9.770113790268809, "outflow_rate_max": 1304.4078873126875, "system_level_velocity_max": 19.533667720844573}, "info": {"num_steps_trained": 1513436, "load_time_ms": 13.041, "grad_time_ms": 10399.131, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015541678294539452, "total_loss": 7.5955657958984375, "vf_loss": 7.599273681640625, "policy_loss": -0.004096222575753927, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9609160423278809, "entropy": 1.14998197555542}, "update_time_ms": 9.511, "num_steps_sampled": 1513436, "sample_time_ms": 16078.954}, "episode_len_mean": 693.43, "time_this_iter_s": 26.979006052017212, "num_metric_batches_dropped": 0, "timesteps_total": 1513436, "episodes_total": 450, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd325c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd320b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32048>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1404.9969235691094, "episodes_this_iter": 10, "time_total_s": 902.6306564807892, "time_since_restore": 902.6306564807892}
{"timestamp": 1557215641, "timesteps_since_restore": 1555959, "training_iteration": 34, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-54-01", "episode_reward_min": 63.67472417339856, "timesteps_this_iter": 42523, "episode_reward_mean": 1264.782646386066, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 34, "custom_metrics": {"cost2_mean": -56.15922610646722, "cost2_min": -80.16310524458652, "cost1_mean": 328.05808353163724, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 12.353200248143644, "cost1_max": 366.07709355097234, "cost1_min": 33.91526256661861, "cost2_max": -12.800682396133414, "outflow_rate_mean": 1117.1851787267121, "system_level_velocity_min": 9.770113790268809, "outflow_rate_max": 1304.4078873126875, "system_level_velocity_max": 19.069527464884565}, "info": {"num_steps_trained": 1555959, "load_time_ms": 13.307, "grad_time_ms": 10277.221, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012912862002849579, "total_loss": 9.697662353515625, "vf_loss": 9.70114803314209, "policy_loss": -0.003808266017585993, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9548135995864868, "entropy": 1.108646035194397}, "update_time_ms": 9.302, "num_steps_sampled": 1555959, "sample_time_ms": 16064.78}, "episode_len_mean": 693.5, "time_this_iter_s": 25.522388696670532, "num_metric_batches_dropped": 0, "timesteps_total": 1555959, "episodes_total": 466, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2bcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b1d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1404.9969235691094, "episodes_this_iter": 16, "time_total_s": 928.1530451774597, "time_since_restore": 928.1530451774597}
{"timestamp": 1557215666, "timesteps_since_restore": 1598520, "training_iteration": 35, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-54-26", "episode_reward_min": 63.67472417339856, "timesteps_this_iter": 42561, "episode_reward_mean": 1272.8621729351833, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 35, "custom_metrics": {"cost2_mean": -56.3904219252473, "cost2_min": -80.16310524458652, "cost1_mean": 332.86648035978885, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 12.517731430858971, "cost1_max": 366.07709355097234, "cost1_min": 33.91526256661861, "cost2_max": -12.800682396133414, "outflow_rate_mean": 1137.2001634979406, "system_level_velocity_min": 10.268677569904591, "outflow_rate_max": 1318.081158041958, "system_level_velocity_max": 19.069527464884565}, "info": {"num_steps_trained": 1598520, "load_time_ms": 12.97, "grad_time_ms": 10090.211, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01236572302877903, "total_loss": 13.75953483581543, "vf_loss": 13.761777877807617, "policy_loss": -0.002550655510276556, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9217071533203125, "entropy": 1.123238205909729}, "update_time_ms": 8.927, "num_steps_sampled": 1598520, "sample_time_ms": 16097.23}, "episode_len_mean": 693.5, "time_this_iter_s": 25.717549562454224, "num_metric_batches_dropped": 0, "timesteps_total": 1598520, "episodes_total": 485, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd325f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32c88>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1404.9969235691094, "episodes_this_iter": 19, "time_total_s": 953.8705947399139, "time_since_restore": 953.8705947399139}
{"timestamp": 1557215691, "timesteps_since_restore": 1641522, "training_iteration": 36, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-54-51", "episode_reward_min": 63.67472417339856, "timesteps_this_iter": 43002, "episode_reward_mean": 1271.9162438305532, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 36, "custom_metrics": {"cost2_mean": -56.05119183425061, "cost2_min": -80.16310524458652, "cost1_mean": 331.74745062904844, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 12.474597912508912, "cost1_max": 366.07709355097234, "cost1_min": 33.91526256661861, "cost2_max": -12.800682396133414, "outflow_rate_mean": 1133.2562041692695, "system_level_velocity_min": 10.268677569904591, "outflow_rate_max": 1318.081158041958, "system_level_velocity_max": 19.069527464884565}, "info": {"num_steps_trained": 1641522, "load_time_ms": 13.186, "grad_time_ms": 9925.91, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01314602605998516, "total_loss": 13.678594589233398, "vf_loss": 13.680641174316406, "policy_loss": -0.002375236479565501, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9290592670440674, "entropy": 1.1026172637939453}, "update_time_ms": 8.632, "num_steps_sampled": 1641522, "sample_time_ms": 16080.303}, "episode_len_mean": 693.5, "time_this_iter_s": 24.585045337677002, "num_metric_batches_dropped": 0, "timesteps_total": 1641522, "episodes_total": 498, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32550>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32b38>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1404.9969235691094, "episodes_this_iter": 13, "time_total_s": 978.4556400775909, "time_since_restore": 978.4556400775909}
{"timestamp": 1557215716, "timesteps_since_restore": 1684171, "training_iteration": 37, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-55-16", "episode_reward_min": 63.67472417339856, "timesteps_this_iter": 42649, "episode_reward_mean": 1259.3368040731125, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 37, "custom_metrics": {"cost2_mean": -56.13114515813791, "cost2_min": -80.16310524458652, "cost1_mean": 328.13245827584825, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 12.464799984045532, "cost1_max": 366.07709355097234, "cost1_min": 33.91526256661861, "cost2_max": -12.800682396133414, "outflow_rate_mean": 1121.7334464251164, "system_level_velocity_min": 10.268677569904591, "outflow_rate_max": 1318.081158041958, "system_level_velocity_max": 19.069527464884565}, "info": {"num_steps_trained": 1684171, "load_time_ms": 13.419, "grad_time_ms": 9930.636, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012114157900214195, "total_loss": 9.536755561828613, "vf_loss": 9.539100646972656, "policy_loss": -0.0026489568408578634, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.959416925907135, "entropy": 1.1171104907989502}, "update_time_ms": 8.372, "num_steps_sampled": 1684171, "sample_time_ms": 16092.239}, "episode_len_mean": 688.63, "time_this_iter_s": 25.50898814201355, "num_metric_batches_dropped": 0, "timesteps_total": 1684171, "episodes_total": 515, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd320f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32d68>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1404.9969235691094, "episodes_this_iter": 17, "time_total_s": 1003.9646282196045, "time_since_restore": 1003.9646282196045}
{"timestamp": 1557215743, "timesteps_since_restore": 1727314, "training_iteration": 38, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-55-43", "episode_reward_min": 52.90730652316286, "timesteps_this_iter": 43143, "episode_reward_mean": 1244.4291441366477, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 38, "custom_metrics": {"cost2_mean": -55.52046783221703, "cost2_min": -80.16310524458652, "cost1_mean": 325.8374455592319, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 12.581279381623958, "cost1_max": 366.07709355097234, "cost1_min": 28.602752756235244, "cost2_max": -12.800682396133414, "outflow_rate_mean": 1117.6309888404667, "system_level_velocity_min": 10.421747862820858, "outflow_rate_max": 1330.4878157842159, "system_level_velocity_max": 19.330649908992203}, "info": {"num_steps_trained": 1727314, "load_time_ms": 13.199, "grad_time_ms": 10040.868, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014433100819587708, "total_loss": 10.417020797729492, "vf_loss": 10.420430183410645, "policy_loss": -0.003771075513213873, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9434228539466858, "entropy": 1.1093173027038574}, "update_time_ms": 9.138, "num_steps_sampled": 1727314, "sample_time_ms": 16078.495}, "episode_len_mean": 682.06, "time_this_iter_s": 26.337724447250366, "num_metric_batches_dropped": 0, "timesteps_total": 1727314, "episodes_total": 529, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b5f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b400>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1397.780272721939, "episodes_this_iter": 14, "time_total_s": 1030.3023526668549, "time_since_restore": 1030.3023526668549}
{"timestamp": 1557215768, "timesteps_since_restore": 1769868, "training_iteration": 39, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-56-08", "episode_reward_min": 52.90730652316286, "timesteps_this_iter": 42554, "episode_reward_mean": 1246.1938655731276, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 39, "custom_metrics": {"cost2_mean": -54.89055181288301, "cost2_min": -74.57813520212775, "cost1_mean": 327.5324617279113, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 12.660738864704648, "cost1_max": 369.53208617836145, "cost1_min": 28.602752756235244, "cost2_max": -12.800682396133414, "outflow_rate_mean": 1129.2023284848221, "system_level_velocity_min": 10.421747862820858, "outflow_rate_max": 1330.4878157842159, "system_level_velocity_max": 19.330649908992203}, "info": {"num_steps_trained": 1769868, "load_time_ms": 12.637, "grad_time_ms": 10270.627, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012587113305926323, "total_loss": 10.85914421081543, "vf_loss": 10.862007141113281, "policy_loss": -0.0031780251301825047, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9493274092674255, "entropy": 1.0994994640350342}, "update_time_ms": 9.036, "num_steps_sampled": 1769868, "sample_time_ms": 15793.681}, "episode_len_mean": 682.06, "time_this_iter_s": 25.259943962097168, "num_metric_batches_dropped": 0, "timesteps_total": 1769868, "episodes_total": 544, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2be80>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2bfd0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1397.780272721939, "episodes_this_iter": 15, "time_total_s": 1055.562296628952, "time_since_restore": 1055.562296628952}
{"timestamp": 1557215795, "timesteps_since_restore": 1813286, "training_iteration": 40, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-56-35", "episode_reward_min": 52.90730652316286, "timesteps_this_iter": 43418, "episode_reward_mean": 1262.462730723428, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 40, "custom_metrics": {"cost2_mean": -55.269713777191384, "cost2_min": -75.29141461047834, "cost1_mean": 333.9260995180584, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 12.758689497462962, "cost1_max": 389.19572602343374, "cost1_min": 28.602752756235244, "cost2_max": -13.006316752607383, "outflow_rate_mean": 1153.1976490548138, "system_level_velocity_min": 10.421747862820858, "outflow_rate_max": 1351.5446497502494, "system_level_velocity_max": 19.330649908992203}, "info": {"num_steps_trained": 1813286, "load_time_ms": 12.653, "grad_time_ms": 10321.875, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013287517242133617, "total_loss": 10.735443115234375, "vf_loss": 10.73903751373291, "policy_loss": -0.003926256205886602, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9570844769477844, "entropy": 1.11641526222229}, "update_time_ms": 9.231, "num_steps_sampled": 1813286, "sample_time_ms": 15567.8}, "episode_len_mean": 688.56, "time_this_iter_s": 26.728773593902588, "num_metric_batches_dropped": 0, "timesteps_total": 1813286, "episodes_total": 561, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32a20>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd320b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd321d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1394.823907665604, "episodes_this_iter": 17, "time_total_s": 1082.2910702228546, "time_since_restore": 1082.2910702228546}
{"timestamp": 1557215820, "timesteps_since_restore": 1855186, "training_iteration": 41, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-57-00", "episode_reward_min": 52.90730652316286, "timesteps_this_iter": 41900, "episode_reward_mean": 1250.9173626508657, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 41, "custom_metrics": {"cost2_mean": -55.601903414272904, "cost2_min": -75.29141461047834, "cost1_mean": 332.05530543499714, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 12.824332255518668, "cost1_max": 402.4675580100348, "cost1_min": 28.602752756235244, "cost2_max": -13.006316752607383, "outflow_rate_mean": 1147.6234413650307, "system_level_velocity_min": 10.015100791129068, "outflow_rate_max": 1351.5446497502494, "system_level_velocity_max": 19.330649908992203}, "info": {"num_steps_trained": 1855186, "load_time_ms": 12.643, "grad_time_ms": 10325.399, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01391598954796791, "total_loss": 8.065778732299805, "vf_loss": 8.068900108337402, "policy_loss": -0.0034682932309806347, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.971438467502594, "entropy": 1.095853328704834}, "update_time_ms": 9.179, "num_steps_sampled": 1855186, "sample_time_ms": 15392.713}, "episode_len_mean": 684.29, "time_this_iter_s": 24.87463140487671, "num_metric_batches_dropped": 0, "timesteps_total": 1855186, "episodes_total": 577, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32240>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1394.2988804770623, "episodes_this_iter": 16, "time_total_s": 1107.1657016277313, "time_since_restore": 1107.1657016277313}
{"timestamp": 1557215845, "timesteps_since_restore": 1897024, "training_iteration": 42, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-57-25", "episode_reward_min": 52.90730652316286, "timesteps_this_iter": 41838, "episode_reward_mean": 1249.194108676684, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 42, "custom_metrics": {"cost2_mean": -55.85749387569305, "cost2_min": -75.29141461047834, "cost1_mean": 335.0684268844899, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 13.108919119939127, "cost1_max": 402.4675580100348, "cost1_min": 28.602752756235244, "cost2_max": -13.006316752607383, "outflow_rate_mean": 1158.276126340779, "system_level_velocity_min": 10.015100791129068, "outflow_rate_max": 1400.9213366633367, "system_level_velocity_max": 19.330649908992203}, "info": {"num_steps_trained": 1897024, "load_time_ms": 12.576, "grad_time_ms": 10302.841, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014613689854741096, "total_loss": 19.485641479492188, "vf_loss": 19.488061904907227, "policy_loss": -0.002784226555377245, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9126665592193604, "entropy": 1.052802562713623}, "update_time_ms": 8.96, "num_steps_sampled": 1897024, "sample_time_ms": 15294.708}, "episode_len_mean": 679.58, "time_this_iter_s": 25.583833932876587, "num_metric_batches_dropped": 0, "timesteps_total": 1897024, "episodes_total": 594, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b080>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1416.9570191641508, "episodes_this_iter": 17, "time_total_s": 1132.749535560608, "time_since_restore": 1132.749535560608}
{"timestamp": 1557215871, "timesteps_since_restore": 1939144, "training_iteration": 43, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-57-51", "episode_reward_min": 52.90730652316286, "timesteps_this_iter": 42120, "episode_reward_mean": 1249.649911098768, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 43, "custom_metrics": {"cost2_mean": -56.52226598235982, "cost2_min": -75.29141461047834, "cost1_mean": 340.44557077438384, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 13.337620652411392, "cost1_max": 421.1804381498003, "cost1_min": 28.602752756235244, "cost2_max": -13.006316752607383, "outflow_rate_mean": 1176.7476473797403, "system_level_velocity_min": 10.015100791129068, "outflow_rate_max": 1461.9810553446555, "system_level_velocity_max": 19.330649908992203}, "info": {"num_steps_trained": 1939144, "load_time_ms": 12.226, "grad_time_ms": 10350.438, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014282215386629105, "total_loss": 9.893265724182129, "vf_loss": 9.897100448608398, "policy_loss": -0.004191730637103319, "cur_kl_coeff": 0.02500000037252903, "vf_explained_var": 0.9634252190589905, "entropy": 1.0779482126235962}, "update_time_ms": 9.168, "num_steps_sampled": 1939144, "sample_time_ms": 15122.891}, "episode_len_mean": 679.58, "time_this_iter_s": 25.721641540527344, "num_metric_batches_dropped": 0, "timesteps_total": 1939144, "episodes_total": 608, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2be10>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2bb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2be80>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1416.9570191641508, "episodes_this_iter": 14, "time_total_s": 1158.4711771011353, "time_since_restore": 1158.4711771011353}
{"timestamp": 1557215896, "timesteps_since_restore": 1980441, "training_iteration": 44, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-58-16", "episode_reward_min": 410.3763695258559, "timesteps_this_iter": 41297, "episode_reward_mean": 1271.3217199717544, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 44, "custom_metrics": {"cost2_mean": -57.730961051166744, "cost2_min": -75.29141461047834, "cost1_mean": 349.13627367706306, "outflow_rate_min": 766.7549163560719, "system_level_velocity_mean": 13.388507807096726, "cost1_max": 421.1804381498003, "cost1_min": 147.01827174756028, "cost2_max": -25.28379104487872, "outflow_rate_mean": 1200.4369244627885, "system_level_velocity_min": 10.015100791129068, "outflow_rate_max": 1461.9810553446555, "system_level_velocity_max": 17.21945580250233}, "info": {"num_steps_trained": 1980441, "load_time_ms": 12.357, "grad_time_ms": 10297.025, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013650220818817616, "total_loss": 9.75811767578125, "vf_loss": 9.762284278869629, "policy_loss": -0.004508336074650288, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9659419059753418, "entropy": 1.071782112121582}, "update_time_ms": 9.196, "num_steps_sampled": 1980441, "sample_time_ms": 15097.061}, "episode_len_mean": 691.02, "time_this_iter_s": 24.730445861816406, "num_metric_batches_dropped": 0, "timesteps_total": 1980441, "episodes_total": 625, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd329e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32748>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1435.7961127556684, "episodes_this_iter": 17, "time_total_s": 1183.2016229629517, "time_since_restore": 1183.2016229629517}
{"timestamp": 1557215921, "timesteps_since_restore": 2023310, "training_iteration": 45, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-58-41", "episode_reward_min": 53.32590338619721, "timesteps_this_iter": 42869, "episode_reward_mean": 1257.0481720895043, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 45, "custom_metrics": {"cost2_mean": -57.32241587236096, "cost2_min": -77.41901062979446, "cost1_mean": 348.50225204881576, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 13.656155110496467, "cost1_max": 436.4175286352121, "cost1_min": 29.06932123093474, "cost2_max": -15.538029455396359, "outflow_rate_mean": 1198.5403220867113, "system_level_velocity_min": 10.015100791129068, "outflow_rate_max": 1461.9810553446555, "system_level_velocity_max": 19.96886832701063}, "info": {"num_steps_trained": 2023310, "load_time_ms": 12.643, "grad_time_ms": 10253.763, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013807088136672974, "total_loss": 12.528989791870117, "vf_loss": 12.53190803527832, "policy_loss": -0.0032625298481434584, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9585584998130798, "entropy": 1.0694137811660767}, "update_time_ms": 9.254, "num_steps_sampled": 2023310, "sample_time_ms": 15086.355}, "episode_len_mean": 681.39, "time_this_iter_s": 25.171884775161743, "num_metric_batches_dropped": 0, "timesteps_total": 2023310, "episodes_total": 642, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32c50>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd324a8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1473.5295565136753, "episodes_this_iter": 17, "time_total_s": 1208.3735077381134, "time_since_restore": 1208.3735077381134}
{"timestamp": 1557215947, "timesteps_since_restore": 2064598, "training_iteration": 46, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-59-07", "episode_reward_min": 53.32590338619721, "timesteps_this_iter": 41288, "episode_reward_mean": 1233.4928734353568, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 46, "custom_metrics": {"cost2_mean": -55.940502686992566, "cost2_min": -77.41901062979446, "cost1_mean": 345.0668698355779, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 13.876980240260128, "cost1_max": 436.4175286352121, "cost1_min": 28.81984495654826, "cost2_max": -12.680742802999355, "outflow_rate_mean": 1190.0244079158551, "system_level_velocity_min": 10.015100791129068, "outflow_rate_max": 1463.1077110889112, "system_level_velocity_max": 19.96886832701063}, "info": {"num_steps_trained": 2064598, "load_time_ms": 12.368, "grad_time_ms": 10162.307, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015437562949955463, "total_loss": 16.369935989379883, "vf_loss": 16.373809814453125, "policy_loss": -0.004258777946233749, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9389945864677429, "entropy": 1.0277650356292725}, "update_time_ms": 9.569, "num_steps_sampled": 2064598, "sample_time_ms": 15258.133}, "episode_len_mean": 669.31, "time_this_iter_s": 25.38187599182129, "num_metric_batches_dropped": 0, "timesteps_total": 2064598, "episodes_total": 658, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32748>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1473.5295565136753, "episodes_this_iter": 16, "time_total_s": 1233.7553837299347, "time_since_restore": 1233.7553837299347}
{"timestamp": 1557215972, "timesteps_since_restore": 2106067, "training_iteration": 47, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-59-32", "episode_reward_min": 53.32590338619721, "timesteps_this_iter": 41469, "episode_reward_mean": 1227.8298279825865, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 47, "custom_metrics": {"cost2_mean": -55.46798408649826, "cost2_min": -81.0321751117079, "cost1_mean": 348.3519862338695, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.172015785764948, "cost1_max": 436.4175286352121, "cost1_min": 28.81984495654826, "cost2_max": -12.680742802999355, "outflow_rate_mean": 1203.938024429934, "system_level_velocity_min": 10.866561197294805, "outflow_rate_max": 1463.1077110889112, "system_level_velocity_max": 19.96886832701063}, "info": {"num_steps_trained": 2106067, "load_time_ms": 12.01, "grad_time_ms": 9995.54, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016352633014321327, "total_loss": 16.842971801757812, "vf_loss": 16.845870971679688, "policy_loss": -0.0033078710548579693, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.941428005695343, "entropy": 1.040602207183838}, "update_time_ms": 9.363, "num_steps_sampled": 2106067, "sample_time_ms": 15424.906}, "episode_len_mean": 664.45, "time_this_iter_s": 25.474077701568604, "num_metric_batches_dropped": 0, "timesteps_total": 2106067, "episodes_total": 676, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26668>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b358>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1473.5295565136753, "episodes_this_iter": 18, "time_total_s": 1259.2294614315033, "time_since_restore": 1259.2294614315033}
{"timestamp": 1557215996, "timesteps_since_restore": 2146882, "training_iteration": 48, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_07-59-56", "episode_reward_min": 53.32590338619721, "timesteps_this_iter": 40815, "episode_reward_mean": 1207.5437922750261, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 48, "custom_metrics": {"cost2_mean": -54.66192937651554, "cost2_min": -81.0321751117079, "cost1_mean": 344.91056211914764, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.335320812122204, "cost1_max": 441.2990457874306, "cost1_min": 28.81984495654826, "cost2_max": -12.680742802999355, "outflow_rate_mean": 1188.881219775885, "system_level_velocity_min": 10.866561197294805, "outflow_rate_max": 1463.1077110889112, "system_level_velocity_max": 19.96886832701063}, "info": {"num_steps_trained": 2146882, "load_time_ms": 11.883, "grad_time_ms": 9846.005, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018464501947164536, "total_loss": 19.702247619628906, "vf_loss": 19.707656860351562, "policy_loss": -0.0058714114129543304, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9221951365470886, "entropy": 1.0073421001434326}, "update_time_ms": 8.358, "num_steps_sampled": 2146882, "sample_time_ms": 15328.186}, "episode_len_mean": 654.84, "time_this_iter_s": 23.832828283309937, "num_metric_batches_dropped": 0, "timesteps_total": 2146882, "episodes_total": 694, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f7f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fbe0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1473.5295565136753, "episodes_this_iter": 18, "time_total_s": 1283.0622897148132, "time_since_restore": 1283.0622897148132}
{"timestamp": 1557216021, "timesteps_since_restore": 2188816, "training_iteration": 49, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-00-21", "episode_reward_min": 53.32590338619721, "timesteps_this_iter": 41934, "episode_reward_mean": 1192.5545017345323, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 49, "custom_metrics": {"cost2_mean": -52.978516574632955, "cost2_min": -81.0321751117079, "cost1_mean": 340.77911278068837, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.529568145148152, "cost1_max": 441.2990457874306, "cost1_min": 28.81984495654826, "cost2_max": -12.680742802999355, "outflow_rate_mean": 1172.550408800106, "system_level_velocity_min": 11.014229354562321, "outflow_rate_max": 1463.1077110889112, "system_level_velocity_max": 19.96886832701063}, "info": {"num_steps_trained": 2188816, "load_time_ms": 12.155, "grad_time_ms": 9725.774, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017057742923498154, "total_loss": 12.730713844299316, "vf_loss": 12.734763145446777, "policy_loss": -0.004475816152989864, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9529961943626404, "entropy": 1.0417958498001099}, "update_time_ms": 8.209, "num_steps_sampled": 2188816, "sample_time_ms": 15482.944}, "episode_len_mean": 643.0, "time_this_iter_s": 25.60607647895813, "num_metric_batches_dropped": 0, "timesteps_total": 2188816, "episodes_total": 712, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32a58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32ac8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1473.5295565136753, "episodes_this_iter": 18, "time_total_s": 1308.6683661937714, "time_since_restore": 1308.6683661937714}
{"timestamp": 1557216047, "timesteps_since_restore": 2232047, "training_iteration": 50, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-00-47", "episode_reward_min": 53.38547810107477, "timesteps_this_iter": 43231, "episode_reward_mean": 1200.3694297213117, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 50, "custom_metrics": {"cost2_mean": -52.14820718179675, "cost2_min": -81.0321751117079, "cost1_mean": 346.4549557410785, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.581370985584824, "cost1_max": 454.1469389430446, "cost1_min": 28.81984495654826, "cost2_max": -12.680742802999355, "outflow_rate_mean": 1186.0907691819584, "system_level_velocity_min": 11.53527169409262, "outflow_rate_max": 1463.1077110889112, "system_level_velocity_max": 19.624271202451965}, "info": {"num_steps_trained": 2232047, "load_time_ms": 12.055, "grad_time_ms": 9660.181, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015100225806236267, "total_loss": 9.62466049194336, "vf_loss": 9.628616333007812, "policy_loss": -0.004334334284067154, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9639708995819092, "entropy": 1.0663117170333862}, "update_time_ms": 8.136, "num_steps_sampled": 2232047, "sample_time_ms": 15437.926}, "episode_len_mean": 649.57, "time_this_iter_s": 25.623040676116943, "num_metric_batches_dropped": 0, "timesteps_total": 2232047, "episodes_total": 727, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd322e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd325f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32278>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1473.5295565136753, "episodes_this_iter": 15, "time_total_s": 1334.2914068698883, "time_since_restore": 1334.2914068698883}
{"timestamp": 1557216072, "timesteps_since_restore": 2274480, "training_iteration": 51, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-01-12", "episode_reward_min": 53.38547810107477, "timesteps_this_iter": 42433, "episode_reward_mean": 1191.9147816189275, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 51, "custom_metrics": {"cost2_mean": -50.40601897172649, "cost2_min": -81.0321751117079, "cost1_mean": 344.8202674790196, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.610594529336508, "cost1_max": 454.1469389430446, "cost1_min": 28.81984495654826, "cost2_max": -12.680742802999355, "outflow_rate_mean": 1178.563079289965, "system_level_velocity_min": 11.53527169409262, "outflow_rate_max": 1463.1077110889112, "system_level_velocity_max": 19.624271202451965}, "info": {"num_steps_trained": 2274480, "load_time_ms": 12.14, "grad_time_ms": 9683.043, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013539344072341919, "total_loss": 10.345104217529297, "vf_loss": 10.34724235534668, "policy_loss": -0.002477098722010851, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9645751714706421, "entropy": 1.0600303411483765}, "update_time_ms": 8.032, "num_steps_sampled": 2274480, "sample_time_ms": 15435.985}, "episode_len_mean": 647.18, "time_this_iter_s": 25.125009536743164, "num_metric_batches_dropped": 0, "timesteps_total": 2274480, "episodes_total": 742, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd266d8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26048>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1451.7923096659974, "episodes_this_iter": 15, "time_total_s": 1359.4164164066315, "time_since_restore": 1359.4164164066315}
{"timestamp": 1557216097, "timesteps_since_restore": 2315061, "training_iteration": 52, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-01-37", "episode_reward_min": 63.222908038455635, "timesteps_this_iter": 40581, "episode_reward_mean": 1194.306144507646, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 52, "custom_metrics": {"cost2_mean": -48.909050088479106, "cost2_min": -74.73028400926994, "cost1_mean": 344.06980115653903, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.528530350942853, "cost1_max": 454.1469389430446, "cost1_min": 33.8132282841578, "cost2_max": -14.117662791980266, "outflow_rate_mean": 1177.4434460236068, "system_level_velocity_min": 11.756167740348179, "outflow_rate_max": 1430.5882869130871, "system_level_velocity_max": 19.1058589278599}, "info": {"num_steps_trained": 2315061, "load_time_ms": 12.175, "grad_time_ms": 9739.652, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015299628488719463, "total_loss": 18.064945220947266, "vf_loss": 18.067890167236328, "policy_loss": -0.003327307989820838, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9362179636955261, "entropy": 1.0235416889190674}, "update_time_ms": 8.161, "num_steps_sampled": 2315061, "sample_time_ms": 15324.973}, "episode_len_mean": 647.42, "time_this_iter_s": 25.029784679412842, "num_metric_batches_dropped": 0, "timesteps_total": 2315061, "episodes_total": 762, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd267f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1446.8813071718691, "episodes_this_iter": 20, "time_total_s": 1384.4462010860443, "time_since_restore": 1384.4462010860443}
{"timestamp": 1557216123, "timesteps_since_restore": 2357279, "training_iteration": 53, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-02-03", "episode_reward_min": 53.70156203048036, "timesteps_this_iter": 42218, "episode_reward_mean": 1191.220825486524, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 53, "custom_metrics": {"cost2_mean": -47.63962528460689, "cost2_min": -73.42120559428875, "cost1_mean": 342.63068958866364, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.418915585472066, "cost1_max": 454.1469389430446, "cost1_min": 28.716677108791714, "cost2_max": -10.013617526717502, "outflow_rate_mean": 1167.6049209231687, "system_level_velocity_min": 11.756167740348179, "outflow_rate_max": 1428.9108207792206, "system_level_velocity_max": 19.49097500912943}, "info": {"num_steps_trained": 2357279, "load_time_ms": 12.338, "grad_time_ms": 9750.505, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01900971680879593, "total_loss": 12.143486022949219, "vf_loss": 12.147723197937012, "policy_loss": -0.0047132824547588825, "cur_kl_coeff": 0.02500000037252903, "vf_explained_var": 0.9534403085708618, "entropy": 1.0619467496871948}, "update_time_ms": 8.2, "num_steps_sampled": 2357279, "sample_time_ms": 15319.501}, "episode_len_mean": 649.44, "time_this_iter_s": 25.788876056671143, "num_metric_batches_dropped": 0, "timesteps_total": 2357279, "episodes_total": 779, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1bb70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1be48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd328d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1446.8813071718691, "episodes_this_iter": 17, "time_total_s": 1410.2350771427155, "time_since_restore": 1410.2350771427155}
{"timestamp": 1557216149, "timesteps_since_restore": 2399442, "training_iteration": 54, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-02-29", "episode_reward_min": 53.70156203048036, "timesteps_this_iter": 42163, "episode_reward_mean": 1199.0149527283036, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 54, "custom_metrics": {"cost2_mean": -46.811651450234294, "cost2_min": -68.19989331099273, "cost1_mean": 341.9748280031652, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.193772840636795, "cost1_max": 454.1469389430446, "cost1_min": 28.716677108791714, "cost2_max": -10.013617526717502, "outflow_rate_mean": 1166.4683759388633, "system_level_velocity_min": 11.756167740348179, "outflow_rate_max": 1428.9108207792206, "system_level_velocity_max": 19.49097500912943}, "info": {"num_steps_trained": 2399442, "load_time_ms": 11.836, "grad_time_ms": 9904.949, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011845136061310768, "total_loss": 9.359325408935547, "vf_loss": 9.36272144317627, "policy_loss": -0.0036925936583429575, "cur_kl_coeff": 0.02500000037252903, "vf_explained_var": 0.9653458595275879, "entropy": 1.0517092943191528}, "update_time_ms": 8.285, "num_steps_sampled": 2399442, "sample_time_ms": 15269.539}, "episode_len_mean": 655.27, "time_this_iter_s": 25.775286436080933, "num_metric_batches_dropped": 0, "timesteps_total": 2399442, "episodes_total": 794, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd393c8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39e48>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1428.8345849804646, "episodes_this_iter": 15, "time_total_s": 1436.0103635787964, "time_since_restore": 1436.0103635787964}
{"timestamp": 1557216175, "timesteps_since_restore": 2442102, "training_iteration": 55, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-02-55", "episode_reward_min": 51.073731359948596, "timesteps_this_iter": 42660, "episode_reward_mean": 1209.4537377433312, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 55, "custom_metrics": {"cost2_mean": -45.90090071778116, "cost2_min": -62.81072232208518, "cost1_mean": 343.9604647205049, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.130509736656826, "cost1_max": 454.1469389430446, "cost1_min": 28.716677108791714, "cost2_max": -10.013617526717502, "outflow_rate_mean": 1167.4165643429797, "system_level_velocity_min": 11.756167740348179, "outflow_rate_max": 1428.9108207792206, "system_level_velocity_max": 20.058759999892043}, "info": {"num_steps_trained": 2442102, "load_time_ms": 11.96, "grad_time_ms": 9933.251, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015318968333303928, "total_loss": 10.497883796691895, "vf_loss": 10.502636909484863, "policy_loss": -0.005136993248015642, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9659852981567383, "entropy": 1.0155110359191895}, "update_time_ms": 8.58, "num_steps_sampled": 2442102, "sample_time_ms": 15294.955}, "episode_len_mean": 660.54, "time_this_iter_s": 25.720861196517944, "num_metric_batches_dropped": 0, "timesteps_total": 2442102, "episodes_total": 812, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15a20>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15390>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1428.8345849804646, "episodes_this_iter": 18, "time_total_s": 1461.7312247753143, "time_since_restore": 1461.7312247753143}
{"timestamp": 1557216201, "timesteps_since_restore": 2483324, "training_iteration": 56, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-03-21", "episode_reward_min": 51.073731359948596, "timesteps_this_iter": 41222, "episode_reward_mean": 1204.4463575093316, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 56, "custom_metrics": {"cost2_mean": -45.7676020453465, "cost2_min": -63.55862112762786, "cost1_mean": 341.5023381547755, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.14055958927101, "cost1_max": 430.54107720556317, "cost1_min": 28.716677108791714, "cost2_max": -10.013617526717502, "outflow_rate_mean": 1158.6792865656123, "system_level_velocity_min": 11.756167740348179, "outflow_rate_max": 1428.9108207792206, "system_level_velocity_max": 20.058759999892043}, "info": {"num_steps_trained": 2483324, "load_time_ms": 12.101, "grad_time_ms": 9960.834, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018637333065271378, "total_loss": 9.227928161621094, "vf_loss": 9.232388496398926, "policy_loss": -0.004926216788589954, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9651760458946228, "entropy": 0.9852156639099121}, "update_time_ms": 8.322, "num_steps_sampled": 2483324, "sample_time_ms": 15308.079}, "episode_len_mean": 656.04, "time_this_iter_s": 25.79218554496765, "num_metric_batches_dropped": 0, "timesteps_total": 2483324, "episodes_total": 826, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32f98>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f8d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1421.1103899308987, "episodes_this_iter": 14, "time_total_s": 1487.523410320282, "time_since_restore": 1487.523410320282}
{"timestamp": 1557216225, "timesteps_since_restore": 2524938, "training_iteration": 57, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-03-45", "episode_reward_min": 51.073731359948596, "timesteps_this_iter": 41614, "episode_reward_mean": 1214.728835823441, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 57, "custom_metrics": {"cost2_mean": -46.22443543637742, "cost2_min": -63.55862112762786, "cost1_mean": 344.18057497996, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.10058700663068, "cost1_max": 430.54107720556317, "cost1_min": 28.716677108791714, "cost2_max": -10.013617526717502, "outflow_rate_mean": 1165.9299429173648, "system_level_velocity_min": 11.756167740348179, "outflow_rate_max": 1418.0534789210787, "system_level_velocity_max": 20.058759999892043}, "info": {"num_steps_trained": 2524938, "load_time_ms": 11.938, "grad_time_ms": 9975.679, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015010323375463486, "total_loss": 11.327581405639648, "vf_loss": 11.331695556640625, "policy_loss": -0.0044889627024531364, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.96465003490448, "entropy": 1.0344136953353882}, "update_time_ms": 8.371, "num_steps_sampled": 2524938, "sample_time_ms": 15223.169}, "episode_len_mean": 661.49, "time_this_iter_s": 24.770041704177856, "num_metric_batches_dropped": 0, "timesteps_total": 2524938, "episodes_total": 842, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f518>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1421.1103899308987, "episodes_this_iter": 16, "time_total_s": 1512.2934520244598, "time_since_restore": 1512.2934520244598}
{"timestamp": 1557216250, "timesteps_since_restore": 2567101, "training_iteration": 58, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-04-10", "episode_reward_min": 51.073731359948596, "timesteps_this_iter": 42163, "episode_reward_mean": 1222.5810382742718, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 58, "custom_metrics": {"cost2_mean": -46.69842141339433, "cost2_min": -63.55862112762786, "cost1_mean": 347.8788932490209, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.108906528532557, "cost1_max": 430.54107720556317, "cost1_min": 28.716677108791714, "cost2_max": -10.013617526717502, "outflow_rate_mean": 1172.5103702259846, "system_level_velocity_min": 11.756167740348179, "outflow_rate_max": 1418.0534789210787, "system_level_velocity_max": 20.058759999892043}, "info": {"num_steps_trained": 2567101, "load_time_ms": 11.872, "grad_time_ms": 10030.004, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014758060686290264, "total_loss": 6.266444206237793, "vf_loss": 6.270883083343506, "policy_loss": -0.004808851517736912, "cur_kl_coeff": 0.02500000037252903, "vf_explained_var": 0.97983717918396, "entropy": 1.0391559600830078}, "update_time_ms": 8.416, "num_steps_sampled": 2567101, "sample_time_ms": 15237.086}, "episode_len_mean": 667.99, "time_this_iter_s": 24.52240252494812, "num_metric_batches_dropped": 0, "timesteps_total": 2567101, "episodes_total": 857, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39710>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd393c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39780>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1421.1103899308987, "episodes_this_iter": 15, "time_total_s": 1536.815854549408, "time_since_restore": 1536.815854549408}
{"timestamp": 1557216276, "timesteps_since_restore": 2610427, "training_iteration": 59, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-04-36", "episode_reward_min": 51.073731359948596, "timesteps_this_iter": 43326, "episode_reward_mean": 1241.5426109936996, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 59, "custom_metrics": {"cost2_mean": -47.93987935391678, "cost2_min": -65.93245926389854, "cost1_mean": 351.69130343440645, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.027147427180726, "cost1_max": 430.54107720556317, "cost1_min": 28.716677108791714, "cost2_max": -10.013617526717502, "outflow_rate_mean": 1179.1311991590962, "system_level_velocity_min": 11.895681148865151, "outflow_rate_max": 1418.0534789210787, "system_level_velocity_max": 20.058759999892043}, "info": {"num_steps_trained": 2610427, "load_time_ms": 11.879, "grad_time_ms": 10034.975, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01701468415558338, "total_loss": 8.228791236877441, "vf_loss": 8.231752395629883, "policy_loss": -0.003385745221748948, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9737710356712341, "entropy": 1.032059907913208}, "update_time_ms": 8.386, "num_steps_sampled": 2610427, "sample_time_ms": 15237.42}, "episode_len_mean": 677.65, "time_this_iter_s": 25.654043912887573, "num_metric_batches_dropped": 0, "timesteps_total": 2610427, "episodes_total": 872, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26d30>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd266a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26390>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1411.8854993529758, "episodes_this_iter": 15, "time_total_s": 1562.4698984622955, "time_since_restore": 1562.4698984622955}
{"timestamp": 1557216302, "timesteps_since_restore": 2653882, "training_iteration": 60, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-05-02", "episode_reward_min": 51.073731359948596, "timesteps_this_iter": 43455, "episode_reward_mean": 1250.2452261264611, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 60, "custom_metrics": {"cost2_mean": -49.07923906522725, "cost2_min": -70.4551926348107, "cost1_mean": 352.59855018442903, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 13.90299770185194, "cost1_max": 430.54107720556317, "cost1_min": 29.217411452845358, "cost2_max": -15.28313146690386, "outflow_rate_mean": 1170.9559416159773, "system_level_velocity_min": 11.051121974663463, "outflow_rate_max": 1418.0534789210787, "system_level_velocity_max": 20.058759999892043}, "info": {"num_steps_trained": 2653882, "load_time_ms": 12.065, "grad_time_ms": 10009.472, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01619723066687584, "total_loss": 9.838480949401855, "vf_loss": 9.84183120727539, "policy_loss": -0.0037548409309238195, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9683873653411865, "entropy": 1.0126128196716309}, "update_time_ms": 8.271, "num_steps_sampled": 2653882, "sample_time_ms": 15304.418}, "episode_len_mean": 684.13, "time_this_iter_s": 26.037241458892822, "num_metric_batches_dropped": 0, "timesteps_total": 2653882, "episodes_total": 891, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26128>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1425.898657728909, "episodes_this_iter": 19, "time_total_s": 1588.5071399211884, "time_since_restore": 1588.5071399211884}
{"timestamp": 1557216327, "timesteps_since_restore": 2697426, "training_iteration": 61, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-05-27", "episode_reward_min": 72.4565307732893, "timesteps_this_iter": 43544, "episode_reward_mean": 1251.6217280581523, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 61, "custom_metrics": {"cost2_mean": -49.86498065022366, "cost2_min": -70.4551926348107, "cost1_mean": 352.5929393554488, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 13.890100327641795, "cost1_max": 430.54107720556317, "cost1_min": 33.89771548263788, "cost2_max": -13.21937686950734, "outflow_rate_mean": 1172.5080789702959, "system_level_velocity_min": 11.051121974663463, "outflow_rate_max": 1418.0534789210787, "system_level_velocity_max": 19.11000244004807}, "info": {"num_steps_trained": 2697426, "load_time_ms": 12.085, "grad_time_ms": 10057.861, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.02355261705815792, "total_loss": 8.822517395019531, "vf_loss": 8.825553894042969, "policy_loss": -0.003624857170507312, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.967045247554779, "entropy": 0.9818393588066101}, "update_time_ms": 8.016, "num_steps_sampled": 2697426, "sample_time_ms": 15317.227}, "episode_len_mean": 684.2, "time_this_iter_s": 25.724602222442627, "num_metric_batches_dropped": 0, "timesteps_total": 2697426, "episodes_total": 903, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39f60>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39a90>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1425.898657728909, "episodes_this_iter": 12, "time_total_s": 1614.231742143631, "time_since_restore": 1614.231742143631}
{"timestamp": 1557216352, "timesteps_since_restore": 2739507, "training_iteration": 62, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-05-52", "episode_reward_min": 72.4565307732893, "timesteps_this_iter": 42081, "episode_reward_mean": 1260.2589029133376, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 62, "custom_metrics": {"cost2_mean": -51.695009715823154, "cost2_min": -77.71878115396666, "cost1_mean": 352.77724125832077, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 13.788447027038686, "cost1_max": 419.75965231195573, "cost1_min": 33.89771548263788, "cost2_max": -13.21937686950734, "outflow_rate_mean": 1170.1324372891215, "system_level_velocity_min": 11.051121974663463, "outflow_rate_max": 1418.0534789210787, "system_level_velocity_max": 19.11000244004807}, "info": {"num_steps_trained": 2739507, "load_time_ms": 12.151, "grad_time_ms": 10077.869, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016209620982408524, "total_loss": 6.9787163734436035, "vf_loss": 6.983676910400391, "policy_loss": -0.005568790715187788, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.977781355381012, "entropy": 0.9799582958221436}, "update_time_ms": 8.006, "num_steps_sampled": 2739507, "sample_time_ms": 15276.301}, "episode_len_mean": 688.7, "time_this_iter_s": 24.84145212173462, "num_metric_batches_dropped": 0, "timesteps_total": 2739507, "episodes_total": 920, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26630>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1428.0009671089285, "episodes_this_iter": 17, "time_total_s": 1639.0731942653656, "time_since_restore": 1639.0731942653656}
{"timestamp": 1557216379, "timesteps_since_restore": 2782557, "training_iteration": 63, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-06-19", "episode_reward_min": 72.4565307732893, "timesteps_this_iter": 43050, "episode_reward_mean": 1269.6831713292165, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 63, "custom_metrics": {"cost2_mean": -54.675860335263835, "cost2_min": -89.7624789334597, "cost1_mean": 353.3966898265003, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 13.801412441675534, "cost1_max": 409.96081880657755, "cost1_min": 33.89771548263788, "cost2_max": -13.21937686950734, "outflow_rate_mean": 1172.6864009754352, "system_level_velocity_min": 11.051121974663463, "outflow_rate_max": 1387.3479732267733, "system_level_velocity_max": 19.11000244004807}, "info": {"num_steps_trained": 2782557, "load_time_ms": 12.086, "grad_time_ms": 10107.256, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01666593924164772, "total_loss": 5.442294120788574, "vf_loss": 5.445499897003174, "policy_loss": -0.0038308543153107166, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9832883477210999, "entropy": 1.0006097555160522}, "update_time_ms": 7.846, "num_steps_sampled": 2782557, "sample_time_ms": 15307.884}, "episode_len_mean": 688.7, "time_this_iter_s": 26.423451900482178, "num_metric_batches_dropped": 0, "timesteps_total": 2782557, "episodes_total": 938, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15860>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1428.139345509848, "episodes_this_iter": 18, "time_total_s": 1665.4966461658478, "time_since_restore": 1665.4966461658478}
{"timestamp": 1557216405, "timesteps_since_restore": 2826453, "training_iteration": 64, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-06-45", "episode_reward_min": 72.4565307732893, "timesteps_this_iter": 43896, "episode_reward_mean": 1272.83218286443, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 64, "custom_metrics": {"cost2_mean": -55.68237564336957, "cost2_min": -89.7624789334597, "cost1_mean": 353.674739913605, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 13.81036059906264, "cost1_max": 443.0971317856298, "cost1_min": 33.89771548263788, "cost2_max": -13.21937686950734, "outflow_rate_mean": 1170.3202635049058, "system_level_velocity_min": 11.051121974663463, "outflow_rate_max": 1387.3479732267733, "system_level_velocity_max": 19.11000244004807}, "info": {"num_steps_trained": 2826453, "load_time_ms": 12.513, "grad_time_ms": 10209.858, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01739753782749176, "total_loss": 4.08534049987793, "vf_loss": 4.090692043304443, "policy_loss": -0.006003477610647678, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9863964915275574, "entropy": 0.9831600785255432}, "update_time_ms": 7.968, "num_steps_sampled": 2826453, "sample_time_ms": 15241.042}, "episode_len_mean": 688.7, "time_this_iter_s": 26.140748739242554, "num_metric_batches_dropped": 0, "timesteps_total": 2826453, "episodes_total": 947, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2beb8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1429.7032900831907, "episodes_this_iter": 9, "time_total_s": 1691.6373949050903, "time_since_restore": 1691.6373949050903}
{"timestamp": 1557216432, "timesteps_since_restore": 2870008, "training_iteration": 65, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-07-12", "episode_reward_min": 72.4565307732893, "timesteps_this_iter": 43555, "episode_reward_mean": 1275.9002090991764, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 65, "custom_metrics": {"cost2_mean": -58.53462199286926, "cost2_min": -89.7624789334597, "cost1_mean": 353.0835500421794, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 13.792035934864957, "cost1_max": 443.0971317856298, "cost1_min": 33.89771548263788, "cost2_max": -13.21937686950734, "outflow_rate_mean": 1163.5323803500605, "system_level_velocity_min": 10.785886792789952, "outflow_rate_max": 1348.4207924075927, "system_level_velocity_max": 19.11000244004807}, "info": {"num_steps_trained": 2870008, "load_time_ms": 12.559, "grad_time_ms": 10299.073, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01667696237564087, "total_loss": 7.528724670410156, "vf_loss": 7.532744884490967, "policy_loss": -0.004644651897251606, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9783095121383667, "entropy": 0.9668052196502686}, "update_time_ms": 7.793, "num_steps_sampled": 2870008, "sample_time_ms": 15319.756}, "episode_len_mean": 688.7, "time_this_iter_s": 27.401931524276733, "num_metric_batches_dropped": 0, "timesteps_total": 2870008, "episodes_total": 965, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39c50>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd395f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39048>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1429.7032900831907, "episodes_this_iter": 18, "time_total_s": 1719.039326429367, "time_since_restore": 1719.039326429367}
{"timestamp": 1557216458, "timesteps_since_restore": 2911792, "training_iteration": 66, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-07-38", "episode_reward_min": 72.4565307732893, "timesteps_this_iter": 41784, "episode_reward_mean": 1273.0265622792647, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 66, "custom_metrics": {"cost2_mean": -60.67155067382428, "cost2_min": -91.05433465619747, "cost1_mean": 355.19784644543483, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 13.878687415326576, "cost1_max": 443.0971317856298, "cost1_min": 33.89771548263788, "cost2_max": -13.21937686950734, "outflow_rate_mean": 1169.5718163620484, "system_level_velocity_min": 10.785886792789952, "outflow_rate_max": 1348.4207924075927, "system_level_velocity_max": 19.11000244004807}, "info": {"num_steps_trained": 2911792, "load_time_ms": 12.583, "grad_time_ms": 10350.707, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01803327351808548, "total_loss": 4.6569952964782715, "vf_loss": 4.6614603996276855, "policy_loss": -0.005142124369740486, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9863871932029724, "entropy": 0.971586287021637}, "update_time_ms": 7.724, "num_steps_sampled": 2911792, "sample_time_ms": 15224.495}, "episode_len_mean": 688.7, "time_this_iter_s": 25.388201236724854, "num_metric_batches_dropped": 0, "timesteps_total": 2911792, "episodes_total": 980, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26f28>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26240>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1429.7032900831907, "episodes_this_iter": 15, "time_total_s": 1744.427527666092, "time_since_restore": 1744.427527666092}
{"timestamp": 1557216484, "timesteps_since_restore": 2954360, "training_iteration": 67, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-08-04", "episode_reward_min": 50.16024106987191, "timesteps_this_iter": 42568, "episode_reward_mean": 1254.1119525455254, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 67, "custom_metrics": {"cost2_mean": -62.93640959159896, "cost2_min": -91.05433465619747, "cost1_mean": 353.22410622218734, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.069640056339022, "cost1_max": 443.0971317856298, "cost1_min": 29.046680631675464, "cost2_max": -13.21937686950734, "outflow_rate_mean": 1164.2844288714507, "system_level_velocity_min": 10.785886792789952, "outflow_rate_max": 1362.3540739260739, "system_level_velocity_max": 20.215360893036326}, "info": {"num_steps_trained": 2954360, "load_time_ms": 12.735, "grad_time_ms": 10403.972, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.02268260531127453, "total_loss": 11.584242820739746, "vf_loss": 11.588127136230469, "policy_loss": -0.004734787158668041, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9620850086212158, "entropy": 0.9783501625061035}, "update_time_ms": 8.052, "num_steps_sampled": 2954360, "sample_time_ms": 15268.258}, "episode_len_mean": 681.11, "time_this_iter_s": 25.77361249923706, "num_metric_batches_dropped": 0, "timesteps_total": 2954360, "episodes_total": 998, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd152b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15cc0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1429.7032900831907, "episodes_this_iter": 18, "time_total_s": 1770.201140165329, "time_since_restore": 1770.201140165329}
{"timestamp": 1557216509, "timesteps_since_restore": 2996315, "training_iteration": 68, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-08-29", "episode_reward_min": 50.16024106987191, "timesteps_this_iter": 41955, "episode_reward_mean": 1260.3993205051565, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 68, "custom_metrics": {"cost2_mean": -63.723076189508404, "cost2_min": -91.05433465619747, "cost1_mean": 356.1193795035638, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.027434450683025, "cost1_max": 443.0971317856298, "cost1_min": 29.046680631675464, "cost2_max": -18.370392461856657, "outflow_rate_mean": 1168.7537237831007, "system_level_velocity_min": 10.785886792789952, "outflow_rate_max": 1362.3540739260739, "system_level_velocity_max": 20.215360893036326}, "info": {"num_steps_trained": 2996315, "load_time_ms": 12.854, "grad_time_ms": 10344.944, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016735298559069633, "total_loss": 7.6504740715026855, "vf_loss": 7.65523624420166, "policy_loss": -0.0057020545937120914, "cur_kl_coeff": 0.05625000223517418, "vf_explained_var": 0.9764922261238098, "entropy": 0.9816930890083313}, "update_time_ms": 7.97, "num_steps_sampled": 2996315, "sample_time_ms": 15458.426}, "episode_len_mean": 687.61, "time_this_iter_s": 25.835702657699585, "num_metric_batches_dropped": 0, "timesteps_total": 2996315, "episodes_total": 1015, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd395f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39978>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1429.7032900831907, "episodes_this_iter": 17, "time_total_s": 1796.0368428230286, "time_since_restore": 1796.0368428230286}
{"timestamp": 1557216536, "timesteps_since_restore": 3039889, "training_iteration": 69, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-08-56", "episode_reward_min": 50.16024106987191, "timesteps_this_iter": 43574, "episode_reward_mean": 1260.1803994629686, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 69, "custom_metrics": {"cost2_mean": -63.886468516275045, "cost2_min": -91.05433465619747, "cost1_mean": 356.20766776495424, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.04679631680521, "cost1_max": 443.0971317856298, "cost1_min": 29.046680631675464, "cost2_max": -18.370392461856657, "outflow_rate_mean": 1167.0911646442394, "system_level_velocity_min": 10.785886792789952, "outflow_rate_max": 1362.3540739260739, "system_level_velocity_max": 20.215360893036326}, "info": {"num_steps_trained": 3039889, "load_time_ms": 12.967, "grad_time_ms": 10232.524, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01597786881029606, "total_loss": 5.964313507080078, "vf_loss": 5.966955184936523, "policy_loss": -0.003540562931448221, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9785414934158325, "entropy": 0.9805805683135986}, "update_time_ms": 8.142, "num_steps_sampled": 3039889, "sample_time_ms": 15643.391}, "episode_len_mean": 687.61, "time_this_iter_s": 26.38011646270752, "num_metric_batches_dropped": 0, "timesteps_total": 3039889, "episodes_total": 1025, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2bb70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b9b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1429.7032900831907, "episodes_this_iter": 10, "time_total_s": 1822.416959285736, "time_since_restore": 1822.416959285736}
{"timestamp": 1557216561, "timesteps_since_restore": 3082041, "training_iteration": 70, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-09-21", "episode_reward_min": 50.16024106987191, "timesteps_this_iter": 42152, "episode_reward_mean": 1235.4987740568329, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 70, "custom_metrics": {"cost2_mean": -63.27810793045783, "cost2_min": -91.05433465619747, "cost1_mean": 352.3909942685577, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.174448661061922, "cost1_max": 414.1350371075223, "cost1_min": 29.046680631675464, "cost2_max": -18.370392461856657, "outflow_rate_mean": 1158.3855769192623, "system_level_velocity_min": 10.785886792789952, "outflow_rate_max": 1362.3540739260739, "system_level_velocity_max": 20.215360893036326}, "info": {"num_steps_trained": 3082041, "load_time_ms": 12.72, "grad_time_ms": 10141.086, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018054332584142685, "total_loss": 12.489396095275879, "vf_loss": 12.493162155151367, "policy_loss": -0.0047809104435145855, "cur_kl_coeff": 0.05625000223517418, "vf_explained_var": 0.9643456339836121, "entropy": 0.9687417149543762}, "update_time_ms": 8.014, "num_steps_sampled": 3082041, "sample_time_ms": 15668.73}, "episode_len_mean": 677.86, "time_this_iter_s": 25.357056379318237, "num_metric_batches_dropped": 0, "timesteps_total": 3082041, "episodes_total": 1044, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32828>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26d30>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1429.7032900831907, "episodes_this_iter": 19, "time_total_s": 1847.7740156650543, "time_since_restore": 1847.7740156650543}
{"timestamp": 1557216586, "timesteps_since_restore": 3124133, "training_iteration": 71, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-09-46", "episode_reward_min": 50.16024106987191, "timesteps_this_iter": 42092, "episode_reward_mean": 1231.590944587191, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 71, "custom_metrics": {"cost2_mean": -63.365363367905246, "cost2_min": -91.05433465619747, "cost1_mean": 354.06743838669735, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.247788200153002, "cost1_max": 436.0541892516898, "cost1_min": 29.046680631675464, "cost2_max": -18.370392461856657, "outflow_rate_mean": 1165.056960657524, "system_level_velocity_min": 11.28835664338873, "outflow_rate_max": 1415.2141178821175, "system_level_velocity_max": 20.215360893036326}, "info": {"num_steps_trained": 3124133, "load_time_ms": 12.677, "grad_time_ms": 9947.36, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.02068239077925682, "total_loss": 8.772740364074707, "vf_loss": 8.775077819824219, "policy_loss": -0.003499869257211685, "cur_kl_coeff": 0.05625000223517418, "vf_explained_var": 0.976054310798645, "entropy": 0.9777119159698486}, "update_time_ms": 8.046, "num_steps_sampled": 3124133, "sample_time_ms": 15782.446}, "episode_len_mean": 677.86, "time_this_iter_s": 24.89944338798523, "num_metric_batches_dropped": 0, "timesteps_total": 3124133, "episodes_total": 1060, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f9e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0ff60>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1416.7788901916103, "episodes_this_iter": 16, "time_total_s": 1872.6734590530396, "time_since_restore": 1872.6734590530396}
{"timestamp": 1557216612, "timesteps_since_restore": 3167525, "training_iteration": 72, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-10-12", "episode_reward_min": 50.16024106987191, "timesteps_this_iter": 43392, "episode_reward_mean": 1234.03170522314, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 72, "custom_metrics": {"cost2_mean": -63.12694943999268, "cost2_min": -96.22297258956223, "cost1_mean": 355.4081897485658, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.395444421718118, "cost1_max": 436.0541892516898, "cost1_min": 29.046680631675464, "cost2_max": -18.370392461856657, "outflow_rate_mean": 1176.622626477641, "system_level_velocity_min": 11.28835664338873, "outflow_rate_max": 1415.2141178821175, "system_level_velocity_max": 20.215360893036326}, "info": {"num_steps_trained": 3167525, "load_time_ms": 12.743, "grad_time_ms": 9858.722, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01437495369464159, "total_loss": 9.440072059631348, "vf_loss": 9.442754745483398, "policy_loss": -0.003895426634699106, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9710078239440918, "entropy": 1.0014468431472778}, "update_time_ms": 7.82, "num_steps_sampled": 3167525, "sample_time_ms": 15953.948}, "episode_len_mean": 673.74, "time_this_iter_s": 25.645185232162476, "num_metric_batches_dropped": 0, "timesteps_total": 3167525, "episodes_total": 1075, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd393c8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39f28>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1416.7788901916103, "episodes_this_iter": 15, "time_total_s": 1898.318644285202, "time_since_restore": 1898.318644285202}
{"timestamp": 1557216639, "timesteps_since_restore": 3210594, "training_iteration": 73, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-10-39", "episode_reward_min": 50.16024106987191, "timesteps_this_iter": 43069, "episode_reward_mean": 1252.9180177206708, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 73, "custom_metrics": {"cost2_mean": -65.1807075658504, "cost2_min": -99.93775122764072, "cost1_mean": 361.1808026344359, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.459849236057726, "cost1_max": 471.8033916810782, "cost1_min": 29.046680631675464, "cost2_max": -18.370392461856657, "outflow_rate_mean": 1188.8844618131875, "system_level_velocity_min": 11.002537635217188, "outflow_rate_max": 1454.0199536463538, "system_level_velocity_max": 20.215360893036326}, "info": {"num_steps_trained": 3210594, "load_time_ms": 12.746, "grad_time_ms": 9844.037, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01649816706776619, "total_loss": 8.236666679382324, "vf_loss": 8.238138198852539, "policy_loss": -0.002863676520064473, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9774272441864014, "entropy": 0.9825223088264465}, "update_time_ms": 7.632, "num_steps_sampled": 3210594, "sample_time_ms": 16007.285}, "episode_len_mean": 679.56, "time_this_iter_s": 26.78056764602661, "num_metric_batches_dropped": 0, "timesteps_total": 3210594, "episodes_total": 1093, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2bb70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1be48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b5f8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1451.8270837707823, "episodes_this_iter": 18, "time_total_s": 1925.0992119312286, "time_since_restore": 1925.0992119312286}
{"timestamp": 1557216664, "timesteps_since_restore": 3253558, "training_iteration": 74, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-11-04", "episode_reward_min": 371.88484608915957, "timesteps_this_iter": 42964, "episode_reward_mean": 1252.6123748251493, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 74, "custom_metrics": {"cost2_mean": -66.04113277219211, "cost2_min": -99.93775122764072, "cost1_mean": 363.4066373183198, "outflow_rate_min": 759.1727795767856, "system_level_velocity_mean": 14.560818298966806, "cost1_max": 471.8033916810782, "cost1_min": 143.88132552283656, "cost2_max": -27.310476991124688, "outflow_rate_mean": 1203.8807984599148, "system_level_velocity_min": 11.002537635217188, "outflow_rate_max": 1484.1211062937061, "system_level_velocity_max": 18.75285109603614}, "info": {"num_steps_trained": 3253558, "load_time_ms": 13.025, "grad_time_ms": 9756.493, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013601179234683514, "total_loss": 13.580157279968262, "vf_loss": 13.581462860107422, "policy_loss": -0.002453121356666088, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9589056372642517, "entropy": 0.966920793056488}, "update_time_ms": 7.34, "num_steps_sampled": 3253558, "sample_time_ms": 16003.095}, "episode_len_mean": 678.81, "time_this_iter_s": 25.222347021102905, "num_metric_batches_dropped": 0, "timesteps_total": 3253558, "episodes_total": 1107, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15cc0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd152b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1451.8270837707823, "episodes_this_iter": 14, "time_total_s": 1950.3215589523315, "time_since_restore": 1950.3215589523315}
{"timestamp": 1557216688, "timesteps_since_restore": 3295203, "training_iteration": 75, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-11-28", "episode_reward_min": 371.88484608915957, "timesteps_this_iter": 41645, "episode_reward_mean": 1249.9012136064239, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 75, "custom_metrics": {"cost2_mean": -68.62965538368437, "cost2_min": -99.93775122764072, "cost1_mean": 366.06670431239996, "outflow_rate_min": 759.1727795767856, "system_level_velocity_mean": 14.670678095922597, "cost1_max": 471.8033916810782, "cost1_min": 143.88132552283656, "cost2_max": -27.310476991124688, "outflow_rate_mean": 1209.4248451112635, "system_level_velocity_min": 11.002537635217188, "outflow_rate_max": 1484.1211062937061, "system_level_velocity_max": 18.75285109603614}, "info": {"num_steps_trained": 3295203, "load_time_ms": 12.937, "grad_time_ms": 9803.856, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014106742106378078, "total_loss": 7.95775842666626, "vf_loss": 7.962445259094238, "policy_loss": -0.005876374896615744, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.979746401309967, "entropy": 0.9923576712608337}, "update_time_ms": 7.231, "num_steps_sampled": 3295203, "sample_time_ms": 15648.571}, "episode_len_mean": 678.81, "time_this_iter_s": 24.3520450592041, "num_metric_batches_dropped": 0, "timesteps_total": 3295203, "episodes_total": 1124, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd269b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1451.8270837707823, "episodes_this_iter": 17, "time_total_s": 1974.6736040115356, "time_since_restore": 1974.6736040115356}
{"timestamp": 1557216714, "timesteps_since_restore": 3335461, "training_iteration": 76, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-11-54", "episode_reward_min": 65.94548552135612, "timesteps_this_iter": 40258, "episode_reward_mean": 1243.6677506537405, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 76, "custom_metrics": {"cost2_mean": -67.38298590439454, "cost2_min": -99.93775122764072, "cost1_mean": 366.68712562594845, "outflow_rate_min": 331.0357017442644, "system_level_velocity_mean": 14.911928855463309, "cost1_max": 471.8033916810782, "cost1_min": 35.30611592602566, "cost2_max": -19.411930904992037, "outflow_rate_mean": 1212.636737800797, "system_level_velocity_min": 11.002537635217188, "outflow_rate_max": 1484.1211062937061, "system_level_velocity_max": 19.15385320303166}, "info": {"num_steps_trained": 3335461, "load_time_ms": 12.891, "grad_time_ms": 9959.287, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017668934538960457, "total_loss": 21.00363540649414, "vf_loss": 21.009096145629883, "policy_loss": -0.006952982861548662, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9408583045005798, "entropy": 0.9920905232429504}, "update_time_ms": 7.437, "num_steps_sampled": 3335461, "sample_time_ms": 15539.206}, "episode_len_mean": 671.19, "time_this_iter_s": 25.840622901916504, "num_metric_batches_dropped": 0, "timesteps_total": 3335461, "episodes_total": 1144, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cb38>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c128>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1562.1827064591787, "episodes_this_iter": 20, "time_total_s": 2000.5142269134521, "time_since_restore": 2000.5142269134521}
{"timestamp": 1557216740, "timesteps_since_restore": 3378918, "training_iteration": 77, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-12-20", "episode_reward_min": 65.94548552135612, "timesteps_this_iter": 43457, "episode_reward_mean": 1248.2873763332161, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 77, "custom_metrics": {"cost2_mean": -67.23049302099811, "cost2_min": -99.93775122764072, "cost1_mean": 367.08543969053227, "outflow_rate_min": 331.0357017442644, "system_level_velocity_mean": 14.936924068066869, "cost1_max": 471.8033916810782, "cost1_min": 35.30611592602566, "cost2_max": -19.411930904992037, "outflow_rate_mean": 1215.257637251346, "system_level_velocity_min": 11.002537635217188, "outflow_rate_max": 1484.1211062937061, "system_level_velocity_max": 19.15385320303166}, "info": {"num_steps_trained": 3378918, "load_time_ms": 13.049, "grad_time_ms": 10108.716, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012990628369152546, "total_loss": 7.529880046844482, "vf_loss": 7.535059928894043, "policy_loss": -0.006275092717260122, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9741246104240417, "entropy": 1.0395183563232422}, "update_time_ms": 7.448, "num_steps_sampled": 3378918, "sample_time_ms": 15436.512}, "episode_len_mean": 671.19, "time_this_iter_s": 26.224902868270874, "num_metric_batches_dropped": 0, "timesteps_total": 3378918, "episodes_total": 1157, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2ba58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b550>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1562.1827064591787, "episodes_this_iter": 13, "time_total_s": 2026.739129781723, "time_since_restore": 2026.739129781723}
{"timestamp": 1557216768, "timesteps_since_restore": 3422086, "training_iteration": 78, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-12-48", "episode_reward_min": 65.94548552135612, "timesteps_this_iter": 43168, "episode_reward_mean": 1241.026806068492, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 78, "custom_metrics": {"cost2_mean": -66.95199937577087, "cost2_min": -99.93775122764072, "cost1_mean": 362.3584607863311, "outflow_rate_min": 331.0357017442644, "system_level_velocity_mean": 14.793488622402892, "cost1_max": 471.8033916810782, "cost1_min": 35.30611592602566, "cost2_max": -19.411930904992037, "outflow_rate_mean": 1201.7841068966313, "system_level_velocity_min": 11.002537635217188, "outflow_rate_max": 1484.1211062937061, "system_level_velocity_max": 19.15385320303166}, "info": {"num_steps_trained": 3422086, "load_time_ms": 13.0, "grad_time_ms": 10276.903, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014706616289913654, "total_loss": 10.146575927734375, "vf_loss": 10.150156021118164, "policy_loss": -0.004821006674319506, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9707496762275696, "entropy": 1.028865933418274}, "update_time_ms": 7.737, "num_steps_sampled": 3422086, "sample_time_ms": 15442.156}, "episode_len_mean": 670.66, "time_this_iter_s": 27.57508659362793, "num_metric_batches_dropped": 0, "timesteps_total": 3422086, "episodes_total": 1173, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cb00>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1562.1827064591787, "episodes_this_iter": 16, "time_total_s": 2054.314216375351, "time_since_restore": 2054.314216375351}
{"timestamp": 1557216792, "timesteps_since_restore": 3463514, "training_iteration": 79, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-13-12", "episode_reward_min": 65.94548552135612, "timesteps_this_iter": 41428, "episode_reward_mean": 1230.610705402129, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 79, "custom_metrics": {"cost2_mean": -64.76212510476849, "cost2_min": -93.61102266517001, "cost1_mean": 361.68496597999683, "outflow_rate_min": 331.0357017442644, "system_level_velocity_mean": 14.922971592230754, "cost1_max": 463.97414693628593, "cost1_min": 35.30611592602566, "cost2_max": -19.411930904992037, "outflow_rate_mean": 1201.23697528333, "system_level_velocity_min": 11.678969662817709, "outflow_rate_max": 1484.1211062937061, "system_level_velocity_max": 19.349258657236838}, "info": {"num_steps_trained": 3463514, "load_time_ms": 12.856, "grad_time_ms": 10292.063, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014965882524847984, "total_loss": 10.809433937072754, "vf_loss": 10.813318252563477, "policy_loss": -0.00514717074111104, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9671154618263245, "entropy": 0.9751039743423462}, "update_time_ms": 7.876, "num_steps_sampled": 3463514, "sample_time_ms": 15181.287}, "episode_len_mean": 665.06, "time_this_iter_s": 23.915742874145508, "num_metric_batches_dropped": 0, "timesteps_total": 3463514, "episodes_total": 1190, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15518>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c0b8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1562.1827064591787, "episodes_this_iter": 17, "time_total_s": 2078.2299592494965, "time_since_restore": 2078.2299592494965}
{"timestamp": 1557216818, "timesteps_since_restore": 3506251, "training_iteration": 80, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-13-38", "episode_reward_min": 65.94548552135612, "timesteps_this_iter": 42737, "episode_reward_mean": 1239.5748117051194, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 80, "custom_metrics": {"cost2_mean": -64.74267719288359, "cost2_min": -93.61102266517001, "cost1_mean": 363.8895008813331, "outflow_rate_min": 331.0357017442644, "system_level_velocity_mean": 14.805427232886164, "cost1_max": 462.21679555725973, "cost1_min": 35.30611592602566, "cost2_max": -19.411930904992037, "outflow_rate_mean": 1201.569769929544, "system_level_velocity_min": 11.678969662817709, "outflow_rate_max": 1483.6435332667334, "system_level_velocity_max": 19.349258657236838}, "info": {"num_steps_trained": 3506251, "load_time_ms": 13.031, "grad_time_ms": 10310.1, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013696854002773762, "total_loss": 5.8473358154296875, "vf_loss": 5.851093769073486, "policy_loss": -0.004913310520350933, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9827902913093567, "entropy": 1.0071359872817993}, "update_time_ms": 7.842, "num_steps_sampled": 3506251, "sample_time_ms": 15252.129}, "episode_len_mean": 672.38, "time_this_iter_s": 26.250605821609497, "num_metric_batches_dropped": 0, "timesteps_total": 3506251, "episodes_total": 1206, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cf28>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32828>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1562.1827064591787, "episodes_this_iter": 16, "time_total_s": 2104.480565071106, "time_since_restore": 2104.480565071106}
{"timestamp": 1557216844, "timesteps_since_restore": 3549694, "training_iteration": 81, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-14-04", "episode_reward_min": 53.48227743178171, "timesteps_this_iter": 43443, "episode_reward_mean": 1224.6159124698404, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 81, "custom_metrics": {"cost2_mean": -62.34699029023003, "cost2_min": -89.10007701213452, "cost1_mean": 358.69515325436606, "outflow_rate_min": 331.0357017442644, "system_level_velocity_mean": 14.910343364973835, "cost1_max": 472.4172081737692, "cost1_min": 29.150139359803358, "cost2_max": -15.440120515300137, "outflow_rate_mean": 1190.5834817249206, "system_level_velocity_min": 11.678969662817709, "outflow_rate_max": 1479.888754045954, "system_level_velocity_max": 20.087734489100903}, "info": {"num_steps_trained": 3549694, "load_time_ms": 13.109, "grad_time_ms": 10382.354, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01824568212032318, "total_loss": 11.61489486694336, "vf_loss": 11.618674278259277, "policy_loss": -0.0053190127946436405, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9652718901634216, "entropy": 0.9965519905090332}, "update_time_ms": 8.017, "num_steps_sampled": 3549694, "sample_time_ms": 15257.387}, "episode_len_mean": 660.85, "time_this_iter_s": 25.678112506866455, "num_metric_batches_dropped": 0, "timesteps_total": 3549694, "episodes_total": 1221, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd398d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1562.1827064591787, "episodes_this_iter": 15, "time_total_s": 2130.1586775779724, "time_since_restore": 2130.1586775779724}
{"timestamp": 1557216870, "timesteps_since_restore": 3591686, "training_iteration": 82, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-14-30", "episode_reward_min": 53.48227743178171, "timesteps_this_iter": 41992, "episode_reward_mean": 1228.1408686646782, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 82, "custom_metrics": {"cost2_mean": -63.57916196006294, "cost2_min": -91.27461610834513, "cost1_mean": 357.9407402481085, "outflow_rate_min": 331.0357017442644, "system_level_velocity_mean": 14.712130826792334, "cost1_max": 472.4172081737692, "cost1_min": 29.150139359803358, "cost2_max": -15.440120515300137, "outflow_rate_mean": 1186.2399101307672, "system_level_velocity_min": 11.678969662817709, "outflow_rate_max": 1479.888754045954, "system_level_velocity_max": 20.087734489100903}, "info": {"num_steps_trained": 3591686, "load_time_ms": 12.915, "grad_time_ms": 10344.305, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01468871533870697, "total_loss": 9.452893257141113, "vf_loss": 9.456852912902832, "policy_loss": -0.005198122002184391, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9746793508529663, "entropy": 0.9964689612388611}, "update_time_ms": 8.039, "num_steps_sampled": 3591686, "sample_time_ms": 15337.369}, "episode_len_mean": 666.99, "time_this_iter_s": 26.065431356430054, "num_metric_batches_dropped": 0, "timesteps_total": 3591686, "episodes_total": 1238, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b668>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1bba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b390>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1456.1203246150521, "episodes_this_iter": 17, "time_total_s": 2156.2241089344025, "time_since_restore": 2156.2241089344025}
{"timestamp": 1557216896, "timesteps_since_restore": 3635237, "training_iteration": 83, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-14-56", "episode_reward_min": 53.48227743178171, "timesteps_this_iter": 43551, "episode_reward_mean": 1249.8690786440886, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 83, "custom_metrics": {"cost2_mean": -63.75328261630416, "cost2_min": -91.27461610834513, "cost1_mean": 362.91127429244466, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.6843733962218, "cost1_max": 472.4172081737692, "cost1_min": 29.150139359803358, "cost2_max": -15.440120515300137, "outflow_rate_mean": 1202.4498591992385, "system_level_velocity_min": 11.906836757254506, "outflow_rate_max": 1479.888754045954, "system_level_velocity_max": 20.087734489100903}, "info": {"num_steps_trained": 3635237, "load_time_ms": 13.194, "grad_time_ms": 10303.813, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015507257543504238, "total_loss": 8.977234840393066, "vf_loss": 8.979528427124023, "policy_loss": -0.003601956646889448, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9706505537033081, "entropy": 1.0166254043579102}, "update_time_ms": 8.182, "num_steps_sampled": 3635237, "sample_time_ms": 15295.927}, "episode_len_mean": 673.47, "time_this_iter_s": 25.96614933013916, "num_metric_batches_dropped": 0, "timesteps_total": 3635237, "episodes_total": 1256, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26978>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd265c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26240>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1456.1203246150521, "episodes_this_iter": 18, "time_total_s": 2182.1902582645416, "time_since_restore": 2182.1902582645416}
{"timestamp": 1557216921, "timesteps_since_restore": 3678575, "training_iteration": 84, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-15-21", "episode_reward_min": 53.48227743178171, "timesteps_this_iter": 43338, "episode_reward_mean": 1263.5751627012069, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 84, "custom_metrics": {"cost2_mean": -63.65481772730835, "cost2_min": -91.27461610834513, "cost1_mean": 367.42941476987284, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.714240216545932, "cost1_max": 472.4172081737692, "cost1_min": 29.150139359803358, "cost2_max": -15.440120515300137, "outflow_rate_mean": 1210.9228766948754, "system_level_velocity_min": 11.906836757254506, "outflow_rate_max": 1479.888754045954, "system_level_velocity_max": 20.087734489100903}, "info": {"num_steps_trained": 3678575, "load_time_ms": 13.143, "grad_time_ms": 10317.885, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01367983128875494, "total_loss": 5.983875274658203, "vf_loss": 5.988278865814209, "policy_loss": -0.005557811353355646, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.982396125793457, "entropy": 0.9932652115821838}, "update_time_ms": 8.243, "num_steps_sampled": 3678575, "sample_time_ms": 15304.714}, "episode_len_mean": 678.12, "time_this_iter_s": 25.451061725616455, "num_metric_batches_dropped": 0, "timesteps_total": 3678575, "episodes_total": 1270, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c8d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c198>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1456.1203246150521, "episodes_this_iter": 14, "time_total_s": 2207.641319990158, "time_since_restore": 2207.641319990158}
{"timestamp": 1557216947, "timesteps_since_restore": 3720980, "training_iteration": 85, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-15-47", "episode_reward_min": 53.48227743178171, "timesteps_this_iter": 42405, "episode_reward_mean": 1266.0666770578466, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 85, "custom_metrics": {"cost2_mean": -63.40670766620909, "cost2_min": -91.27461610834513, "cost1_mean": 365.6753924119637, "outflow_rate_min": 336.6490541456901, "system_level_velocity_mean": 14.656690096311262, "cost1_max": 472.4172081737692, "cost1_min": 29.150139359803358, "cost2_max": -15.440120515300137, "outflow_rate_mean": 1206.7220344660172, "system_level_velocity_min": 11.906836757254506, "outflow_rate_max": 1479.888754045954, "system_level_velocity_max": 20.087734489100903}, "info": {"num_steps_trained": 3720980, "load_time_ms": 13.213, "grad_time_ms": 10303.777, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017690347507596016, "total_loss": 9.431729316711426, "vf_loss": 9.437027931213379, "policy_loss": -0.006791035644710064, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9731802344322205, "entropy": 0.9963759779930115}, "update_time_ms": 8.28, "num_steps_sampled": 3720980, "sample_time_ms": 15479.708}, "episode_len_mean": 677.18, "time_this_iter_s": 25.96647334098816, "num_metric_batches_dropped": 0, "timesteps_total": 3720980, "episodes_total": 1286, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd266d8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26080>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1471.1918350693256, "episodes_this_iter": 16, "time_total_s": 2233.6077933311462, "time_since_restore": 2233.6077933311462}
{"timestamp": 1557216974, "timesteps_since_restore": 3763475, "training_iteration": 86, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-16-14", "episode_reward_min": 53.067374844838845, "timesteps_this_iter": 42495, "episode_reward_mean": 1220.9460643582524, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 86, "custom_metrics": {"cost2_mean": -60.84924571087247, "cost2_min": -91.27461610834513, "cost1_mean": 351.15904398122694, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.787980059845278, "cost1_max": 472.4172081737692, "cost1_min": 28.93748946001086, "cost2_max": -15.440120515300137, "outflow_rate_mean": 1172.3632068021448, "system_level_velocity_min": 11.906836757254506, "outflow_rate_max": 1479.888754045954, "system_level_velocity_max": 20.087734489100903}, "info": {"num_steps_trained": 3763475, "load_time_ms": 12.934, "grad_time_ms": 10306.525, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016234837472438812, "total_loss": 20.07353973388672, "vf_loss": 20.075960159301758, "policy_loss": -0.003791174851357937, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9413245916366577, "entropy": 0.9718121886253357}, "update_time_ms": 8.226, "num_steps_sampled": 3763475, "sample_time_ms": 15536.711}, "episode_len_mean": 651.16, "time_this_iter_s": 26.42808246612549, "num_metric_batches_dropped": 0, "timesteps_total": 3763475, "episodes_total": 1305, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1bf98>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26240>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1471.1918350693256, "episodes_this_iter": 19, "time_total_s": 2260.0358757972717, "time_since_restore": 2260.0358757972717}
{"timestamp": 1557217000, "timesteps_since_restore": 3806104, "training_iteration": 87, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-16-40", "episode_reward_min": 53.067374844838845, "timesteps_this_iter": 42629, "episode_reward_mean": 1242.866870183525, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 87, "custom_metrics": {"cost2_mean": -61.644140412609865, "cost2_min": -91.27461610834513, "cost1_mean": 355.8141738947419, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.652797316092226, "cost1_max": 443.0601813095402, "cost1_min": 28.93748946001086, "cost2_max": -15.564489265665921, "outflow_rate_mean": 1181.5271137879872, "system_level_velocity_min": 11.986582979832747, "outflow_rate_max": 1431.7456171828173, "system_level_velocity_max": 19.887454987081412}, "info": {"num_steps_trained": 3806104, "load_time_ms": 12.752, "grad_time_ms": 10309.093, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01575937308371067, "total_loss": 5.628296852111816, "vf_loss": 5.6340203285217285, "policy_loss": -0.007053166162222624, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9843894839286804, "entropy": 1.0117977857589722}, "update_time_ms": 8.12, "num_steps_sampled": 3806104, "sample_time_ms": 15489.501}, "episode_len_mean": 662.69, "time_this_iter_s": 25.79743981361389, "num_metric_batches_dropped": 0, "timesteps_total": 3806104, "episodes_total": 1320, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c9b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cf60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c780>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1471.1918350693256, "episodes_this_iter": 15, "time_total_s": 2285.8333156108856, "time_since_restore": 2285.8333156108856}
{"timestamp": 1557217027, "timesteps_since_restore": 3848196, "training_iteration": 88, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-17-07", "episode_reward_min": 53.067374844838845, "timesteps_this_iter": 42092, "episode_reward_mean": 1251.899758478323, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 88, "custom_metrics": {"cost2_mean": -61.30951184673344, "cost2_min": -83.84381701357928, "cost1_mean": 358.8068118047478, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.64381707666125, "cost1_max": 443.0601813095402, "cost1_min": 28.93748946001086, "cost2_max": -15.564489265665921, "outflow_rate_mean": 1188.1286761782837, "system_level_velocity_min": 11.904706942434753, "outflow_rate_max": 1431.7456171828173, "system_level_velocity_max": 19.887454987081412}, "info": {"num_steps_trained": 3848196, "load_time_ms": 12.854, "grad_time_ms": 10344.861, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015507848933339119, "total_loss": 6.921665191650391, "vf_loss": 6.926056861877441, "policy_loss": -0.005700652487576008, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.97954261302948, "entropy": 0.9779106974601746}, "update_time_ms": 8.063, "num_steps_sampled": 3848196, "sample_time_ms": 15377.81}, "episode_len_mean": 667.44, "time_this_iter_s": 26.817737102508545, "num_metric_batches_dropped": 0, "timesteps_total": 3848196, "episodes_total": 1338, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd397f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd390f0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1471.1918350693256, "episodes_this_iter": 18, "time_total_s": 2312.651052713394, "time_since_restore": 2312.651052713394}
{"timestamp": 1557217054, "timesteps_since_restore": 3893727, "training_iteration": 89, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-17-34", "episode_reward_min": 53.067374844838845, "timesteps_this_iter": 45531, "episode_reward_mean": 1244.894648801596, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 89, "custom_metrics": {"cost2_mean": -61.65987529116526, "cost2_min": -84.42106762499438, "cost1_mean": 358.3177033842127, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.6364269876783, "cost1_max": 443.0601813095402, "cost1_min": 28.93748946001086, "cost2_max": -15.564489265665921, "outflow_rate_mean": 1183.1001408136485, "system_level_velocity_min": 11.904706942434753, "outflow_rate_max": 1431.7456171828173, "system_level_velocity_max": 19.887454987081412}, "info": {"num_steps_trained": 3893727, "load_time_ms": 12.927, "grad_time_ms": 10544.406, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01625574380159378, "total_loss": 5.511696815490723, "vf_loss": 5.515514850616455, "policy_loss": -0.005189887247979641, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9824182391166687, "entropy": 1.0259655714035034}, "update_time_ms": 8.12, "num_steps_sampled": 3893727, "sample_time_ms": 15543.509}, "episode_len_mean": 667.44, "time_this_iter_s": 27.605282068252563, "num_metric_batches_dropped": 0, "timesteps_total": 3893727, "episodes_total": 1350, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cdd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ce80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ceb8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1484.3594470646424, "episodes_this_iter": 12, "time_total_s": 2340.2563347816467, "time_since_restore": 2340.2563347816467}
{"timestamp": 1557217079, "timesteps_since_restore": 3936840, "training_iteration": 90, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-17-59", "episode_reward_min": 53.067374844838845, "timesteps_this_iter": 43113, "episode_reward_mean": 1240.8043526368292, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 90, "custom_metrics": {"cost2_mean": -60.922922454456646, "cost2_min": -84.42106762499438, "cost1_mean": 356.21071184725406, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.567924145873022, "cost1_max": 440.92102229906004, "cost1_min": 28.93748946001086, "cost2_max": -15.564489265665921, "outflow_rate_mean": 1172.593188206256, "system_level_velocity_min": 11.904706942434753, "outflow_rate_max": 1386.386730869131, "system_level_velocity_max": 19.887454987081412}, "info": {"num_steps_trained": 3936840, "load_time_ms": 12.771, "grad_time_ms": 10702.024, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016509609296917915, "total_loss": 5.731586933135986, "vf_loss": 5.737059593200684, "policy_loss": -0.006866171024739742, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9839820861816406, "entropy": 0.9700962901115417}, "update_time_ms": 8.402, "num_steps_sampled": 3936840, "sample_time_ms": 15278.249}, "episode_len_mean": 667.44, "time_this_iter_s": 25.18381381034851, "num_metric_batches_dropped": 0, "timesteps_total": 3936840, "episodes_total": 1364, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd267f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd260f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26b38>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1484.3594470646424, "episodes_this_iter": 14, "time_total_s": 2365.4401485919952, "time_since_restore": 2365.4401485919952}
{"timestamp": 1557217104, "timesteps_since_restore": 3978189, "training_iteration": 91, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-18-24", "episode_reward_min": 53.067374844838845, "timesteps_this_iter": 41349, "episode_reward_mean": 1253.8227753179092, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 91, "custom_metrics": {"cost2_mean": -60.278963257582035, "cost2_min": -84.42106762499438, "cost1_mean": 358.49861833602597, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.473420166765088, "cost1_max": 440.92102229906004, "cost1_min": 28.93748946001086, "cost2_max": -15.564489265665921, "outflow_rate_mean": 1172.963765502961, "system_level_velocity_min": 11.904706942434753, "outflow_rate_max": 1375.6389394605392, "system_level_velocity_max": 19.649334722106744}, "info": {"num_steps_trained": 3978189, "load_time_ms": 12.579, "grad_time_ms": 10769.334, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015510482713580132, "total_loss": 6.488437175750732, "vf_loss": 6.49356746673584, "policy_loss": -0.006439550779759884, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9813565015792847, "entropy": 0.9846186637878418}, "update_time_ms": 8.408, "num_steps_sampled": 3978189, "sample_time_ms": 15121.297}, "episode_len_mean": 673.98, "time_this_iter_s": 24.77723217010498, "num_metric_batches_dropped": 0, "timesteps_total": 3978189, "episodes_total": 1383, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b390>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b550>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1484.3594470646424, "episodes_this_iter": 19, "time_total_s": 2390.2173807621, "time_since_restore": 2390.2173807621}
{"timestamp": 1557217130, "timesteps_since_restore": 4020182, "training_iteration": 92, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-18-50", "episode_reward_min": 53.067374844838845, "timesteps_this_iter": 41993, "episode_reward_mean": 1267.8439335392634, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 92, "custom_metrics": {"cost2_mean": -59.44743444040112, "cost2_min": -84.42106762499438, "cost1_mean": 363.6974129613617, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.335425139690924, "cost1_max": 440.92102229906004, "cost1_min": 28.93748946001086, "cost2_max": -15.564489265665921, "outflow_rate_mean": 1178.7784628771658, "system_level_velocity_min": 11.904706942434753, "outflow_rate_max": 1345.0632383616385, "system_level_velocity_max": 19.649334722106744}, "info": {"num_steps_trained": 4020182, "load_time_ms": 12.811, "grad_time_ms": 10860.93, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01373044028878212, "total_loss": 6.887125015258789, "vf_loss": 6.89094352722168, "policy_loss": -0.004976298660039902, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9797555208206177, "entropy": 0.9611874222755432}, "update_time_ms": 8.77, "num_steps_sampled": 4020182, "sample_time_ms": 14981.723}, "episode_len_mean": 686.93, "time_this_iter_s": 25.597142457962036, "num_metric_batches_dropped": 0, "timesteps_total": 4020182, "episodes_total": 1397, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ca20>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c710>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1484.3594470646424, "episodes_this_iter": 14, "time_total_s": 2415.8145232200623, "time_since_restore": 2415.8145232200623}
{"timestamp": 1557217156, "timesteps_since_restore": 4061340, "training_iteration": 93, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-19-16", "episode_reward_min": 52.242934316542815, "timesteps_this_iter": 41158, "episode_reward_mean": 1267.2241209961198, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 93, "custom_metrics": {"cost2_mean": -57.30608082495353, "cost2_min": -84.42106762499438, "cost1_mean": 365.1874355502304, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.322714290733511, "cost1_max": 440.92102229906004, "cost1_min": 28.784011994638476, "cost2_max": -18.287471902013486, "outflow_rate_mean": 1188.3080452196812, "system_level_velocity_min": 11.904706942434753, "outflow_rate_max": 1377.5609634365635, "system_level_velocity_max": 19.932244812501473}, "info": {"num_steps_trained": 4061340, "load_time_ms": 12.666, "grad_time_ms": 10853.558, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0159123744815588, "total_loss": 15.810567855834961, "vf_loss": 15.81432819366455, "policy_loss": -0.0051026432774960995, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9424254298210144, "entropy": 0.8912703394889832}, "update_time_ms": 8.904, "num_steps_sampled": 4061340, "sample_time_ms": 14971.915}, "episode_len_mean": 689.16, "time_this_iter_s": 25.812588453292847, "num_metric_batches_dropped": 0, "timesteps_total": 4061340, "episodes_total": 1415, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cdd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ce80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ce10>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1484.3594470646424, "episodes_this_iter": 18, "time_total_s": 2441.627111673355, "time_since_restore": 2441.627111673355}
{"timestamp": 1557217182, "timesteps_since_restore": 4103881, "training_iteration": 94, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-19-42", "episode_reward_min": 52.242934316542815, "timesteps_this_iter": 42541, "episode_reward_mean": 1251.2745524937955, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 94, "custom_metrics": {"cost2_mean": -53.936298094089004, "cost2_min": -84.42106762499438, "cost1_mean": 363.2492146233059, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.405350124118739, "cost1_max": 440.92102229906004, "cost1_min": 28.784011994638476, "cost2_max": -18.287471902013486, "outflow_rate_mean": 1180.7227566927895, "system_level_velocity_min": 12.074175833029583, "outflow_rate_max": 1377.5609634365635, "system_level_velocity_max": 19.932244812501473}, "info": {"num_steps_trained": 4103881, "load_time_ms": 12.497, "grad_time_ms": 10787.064, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016651038080453873, "total_loss": 9.819113731384277, "vf_loss": 9.822164535522461, "policy_loss": -0.0044548846781253815, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9678761959075928, "entropy": 0.9083781242370605}, "update_time_ms": 9.013, "num_steps_sampled": 4103881, "sample_time_ms": 15106.704}, "episode_len_mean": 683.43, "time_this_iter_s": 26.16016983985901, "num_metric_batches_dropped": 0, "timesteps_total": 4103881, "episodes_total": 1430, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26e80>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26048>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1484.3594470646424, "episodes_this_iter": 15, "time_total_s": 2467.787281513214, "time_since_restore": 2467.787281513214}
{"timestamp": 1557217207, "timesteps_since_restore": 4144674, "training_iteration": 95, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-20-07", "episode_reward_min": 52.242934316542815, "timesteps_this_iter": 40793, "episode_reward_mean": 1252.6784480688648, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 95, "custom_metrics": {"cost2_mean": -52.35486797036105, "cost2_min": -84.42106762499438, "cost1_mean": 362.91360793202193, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.395341446511946, "cost1_max": 421.5303085577807, "cost1_min": 28.784011994638476, "cost2_max": -18.287471902013486, "outflow_rate_mean": 1179.60119910238, "system_level_velocity_min": 12.074175833029583, "outflow_rate_max": 1377.5609634365635, "system_level_velocity_max": 19.932244812501473}, "info": {"num_steps_trained": 4144674, "load_time_ms": 12.308, "grad_time_ms": 10678.721, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016764188185334206, "total_loss": 14.32161808013916, "vf_loss": 14.324467658996582, "policy_loss": -0.004263628739863634, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9557132124900818, "entropy": 0.8940152525901794}, "update_time_ms": 9.27, "num_steps_sampled": 4144674, "sample_time_ms": 15149.296}, "episode_len_mean": 683.43, "time_this_iter_s": 25.27216362953186, "num_metric_batches_dropped": 0, "timesteps_total": 4144674, "episodes_total": 1446, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32cc0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1462.0367265345437, "episodes_this_iter": 16, "time_total_s": 2493.059445142746, "time_since_restore": 2493.059445142746}
{"timestamp": 1557217233, "timesteps_since_restore": 4186085, "training_iteration": 96, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-20-33", "episode_reward_min": 52.242934316542815, "timesteps_this_iter": 41411, "episode_reward_mean": 1249.5960204856829, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 96, "custom_metrics": {"cost2_mean": -51.24784390554026, "cost2_min": -83.21399653333694, "cost1_mean": 364.63111178236204, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.460143986372023, "cost1_max": 453.5012878467864, "cost1_min": 28.784011994638476, "cost2_max": -18.287471902013486, "outflow_rate_mean": 1184.2319020134692, "system_level_velocity_min": 12.074175833029583, "outflow_rate_max": 1419.7041410589413, "system_level_velocity_max": 19.932244812501473}, "info": {"num_steps_trained": 4186085, "load_time_ms": 12.961, "grad_time_ms": 10520.293, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016812602058053017, "total_loss": 11.783551216125488, "vf_loss": 11.786831855773926, "policy_loss": -0.004699376877397299, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9626663327217102, "entropy": 0.9374741315841675}, "update_time_ms": 9.256, "num_steps_sampled": 4186085, "sample_time_ms": 15188.583}, "episode_len_mean": 683.43, "time_this_iter_s": 25.25742244720459, "num_metric_batches_dropped": 0, "timesteps_total": 4186085, "episodes_total": 1464, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd322b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f518>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1406.1879492369105, "episodes_this_iter": 18, "time_total_s": 2518.3168675899506, "time_since_restore": 2518.3168675899506}
{"timestamp": 1557217258, "timesteps_since_restore": 4228226, "training_iteration": 97, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-20-58", "episode_reward_min": 52.242934316542815, "timesteps_this_iter": 42141, "episode_reward_mean": 1246.062724751501, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 97, "custom_metrics": {"cost2_mean": -51.52530380495036, "cost2_min": -83.21399653333694, "cost1_mean": 365.0448848243008, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.496128346491679, "cost1_max": 453.5012878467864, "cost1_min": 28.784011994638476, "cost2_max": -18.287471902013486, "outflow_rate_mean": 1187.8825035898926, "system_level_velocity_min": 11.433457760978452, "outflow_rate_max": 1419.7041410589413, "system_level_velocity_max": 19.932244812501473}, "info": {"num_steps_trained": 4228226, "load_time_ms": 13.003, "grad_time_ms": 10347.052, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01700693927705288, "total_loss": 12.549772262573242, "vf_loss": 12.552886009216309, "policy_loss": -0.004548957571387291, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9590368866920471, "entropy": 0.8970483541488647}, "update_time_ms": 9.153, "num_steps_sampled": 4228226, "sample_time_ms": 15363.678}, "episode_len_mean": 683.43, "time_this_iter_s": 25.78505778312683, "num_metric_batches_dropped": 0, "timesteps_total": 4228226, "episodes_total": 1477, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c6a0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b9b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1406.1879492369105, "episodes_this_iter": 13, "time_total_s": 2544.1019253730774, "time_since_restore": 2544.1019253730774}
{"timestamp": 1557217283, "timesteps_since_restore": 4270406, "training_iteration": 98, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-21-23", "episode_reward_min": 52.242934316542815, "timesteps_this_iter": 42180, "episode_reward_mean": 1240.9205983814836, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 98, "custom_metrics": {"cost2_mean": -52.1771241932898, "cost2_min": -85.87610347324483, "cost1_mean": 363.86376270943913, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.453548396507726, "cost1_max": 453.5012878467864, "cost1_min": 28.784011994638476, "cost2_max": -18.287471902013486, "outflow_rate_mean": 1190.4507663791035, "system_level_velocity_min": 11.433457760978452, "outflow_rate_max": 1419.7041410589413, "system_level_velocity_max": 19.932244812501473}, "info": {"num_steps_trained": 4270406, "load_time_ms": 12.747, "grad_time_ms": 10202.377, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015935290604829788, "total_loss": 11.9856538772583, "vf_loss": 11.98820686340332, "policy_loss": -0.003896832000464201, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9614366292953491, "entropy": 0.8870444893836975}, "update_time_ms": 8.748, "num_steps_sampled": 4270406, "sample_time_ms": 15312.307}, "episode_len_mean": 683.43, "time_this_iter_s": 24.85699439048767, "num_metric_batches_dropped": 0, "timesteps_total": 4270406, "episodes_total": 1494, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd264a8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1444.164286013974, "episodes_this_iter": 17, "time_total_s": 2568.958919763565, "time_since_restore": 2568.958919763565}
{"timestamp": 1557217308, "timesteps_since_restore": 4311892, "training_iteration": 99, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-21-48", "episode_reward_min": 68.90479924662883, "timesteps_this_iter": 41486, "episode_reward_mean": 1247.4288212795889, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 99, "custom_metrics": {"cost2_mean": -52.84192307504391, "cost2_min": -85.87610347324483, "cost1_mean": 365.66774709587764, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.549645061923897, "cost1_max": 455.4352970540938, "cost1_min": 34.11016893850313, "cost2_max": -19.022230569801057, "outflow_rate_mean": 1190.617338654221, "system_level_velocity_min": 11.433457760978452, "outflow_rate_max": 1419.7041410589413, "system_level_velocity_max": 20.234132362574307}, "info": {"num_steps_trained": 4311892, "load_time_ms": 12.582, "grad_time_ms": 10077.76, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018013179302215576, "total_loss": 16.39655876159668, "vf_loss": 16.400035858154297, "policy_loss": -0.004996082745492458, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9449660778045654, "entropy": 0.8836112022399902}, "update_time_ms": 8.531, "num_steps_sampled": 4311892, "sample_time_ms": 15163.107}, "episode_len_mean": 682.92, "time_this_iter_s": 24.836533308029175, "num_metric_batches_dropped": 0, "timesteps_total": 4311892, "episodes_total": 1513, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f518>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c198>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1485.2480026881146, "episodes_this_iter": 19, "time_total_s": 2593.7954530715942, "time_since_restore": 2593.7954530715942}
{"timestamp": 1557217335, "timesteps_since_restore": 4352678, "training_iteration": 100, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-22-15", "episode_reward_min": 68.90479924662883, "timesteps_this_iter": 40786, "episode_reward_mean": 1257.8209615225587, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 100, "custom_metrics": {"cost2_mean": -53.69910634345242, "cost2_min": -85.87610347324483, "cost1_mean": 367.17770865275406, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.457816084017795, "cost1_max": 455.4352970540938, "cost1_min": 34.11016893850313, "cost2_max": -19.022230569801057, "outflow_rate_mean": 1193.5179316486451, "system_level_velocity_min": 11.433457760978452, "outflow_rate_max": 1419.7041410589413, "system_level_velocity_max": 20.234132362574307}, "info": {"num_steps_trained": 4352678, "load_time_ms": 12.643, "grad_time_ms": 10060.78, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015223958529531956, "total_loss": 7.817399501800537, "vf_loss": 7.820620536804199, "policy_loss": -0.004505704157054424, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9766455292701721, "entropy": 0.9105541110038757}, "update_time_ms": 8.246, "num_steps_sampled": 4352678, "sample_time_ms": 15304.702}, "episode_len_mean": 688.65, "time_this_iter_s": 26.422129154205322, "num_metric_batches_dropped": 0, "timesteps_total": 4352678, "episodes_total": 1527, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39d30>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b278>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1485.2480026881146, "episodes_this_iter": 14, "time_total_s": 2620.2175822257996, "time_since_restore": 2620.2175822257996}
{"timestamp": 1557217359, "timesteps_since_restore": 4393756, "training_iteration": 101, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-22-39", "episode_reward_min": 67.03160602502959, "timesteps_this_iter": 41078, "episode_reward_mean": 1232.3678519023385, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 101, "custom_metrics": {"cost2_mean": -53.029692053221396, "cost2_min": -85.87610347324483, "cost1_mean": 359.77943778478203, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.490995332840054, "cost1_max": 455.4352970540938, "cost1_min": 33.40904119521527, "cost2_max": -17.066297753187463, "outflow_rate_mean": 1176.1050568254475, "system_level_velocity_min": 11.433457760978452, "outflow_rate_max": 1411.2073586413587, "system_level_velocity_max": 20.234132362574307}, "info": {"num_steps_trained": 4393756, "load_time_ms": 12.573, "grad_time_ms": 10052.93, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.019756916910409927, "total_loss": 16.35748863220215, "vf_loss": 16.36226463317871, "policy_loss": -0.006441970355808735, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9432625770568848, "entropy": 0.8963533639907837}, "update_time_ms": 8.254, "num_steps_sampled": 4393756, "sample_time_ms": 15325.182}, "episode_len_mean": 676.59, "time_this_iter_s": 24.900314807891846, "num_metric_batches_dropped": 0, "timesteps_total": 4393756, "episodes_total": 1547, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c9b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26d30>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1485.2480026881146, "episodes_this_iter": 20, "time_total_s": 2645.1178970336914, "time_since_restore": 2645.1178970336914}
{"timestamp": 1557217385, "timesteps_since_restore": 4435619, "training_iteration": 102, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-23-05", "episode_reward_min": 67.03160602502959, "timesteps_this_iter": 41863, "episode_reward_mean": 1229.0698293975415, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 102, "custom_metrics": {"cost2_mean": -51.68075404242316, "cost2_min": -85.87610347324483, "cost1_mean": 359.14796543894767, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.474265382943594, "cost1_max": 455.4352970540938, "cost1_min": 33.40904119521527, "cost2_max": -17.066297753187463, "outflow_rate_mean": 1178.5083611491236, "system_level_velocity_min": 11.433457760978452, "outflow_rate_max": 1402.896851948052, "system_level_velocity_max": 20.234132362574307}, "info": {"num_steps_trained": 4435619, "load_time_ms": 12.556, "grad_time_ms": 10083.331, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0167478546500206, "total_loss": 10.744845390319824, "vf_loss": 10.74996280670166, "policy_loss": -0.006530023645609617, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9624120593070984, "entropy": 0.8837348222732544}, "update_time_ms": 7.966, "num_steps_sampled": 4435619, "sample_time_ms": 15278.432}, "episode_len_mean": 676.59, "time_this_iter_s": 25.429741859436035, "num_metric_batches_dropped": 0, "timesteps_total": 4435619, "episodes_total": 1560, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6e10>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6eb8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1485.2480026881146, "episodes_this_iter": 13, "time_total_s": 2670.5476388931274, "time_since_restore": 2670.5476388931274}
{"timestamp": 1557217410, "timesteps_since_restore": 4477359, "training_iteration": 103, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-23-30", "episode_reward_min": 67.03160602502959, "timesteps_this_iter": 41740, "episode_reward_mean": 1211.9755208206384, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 103, "custom_metrics": {"cost2_mean": -49.540503710909476, "cost2_min": -85.87610347324483, "cost1_mean": 356.3153744590864, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.505920135277922, "cost1_max": 455.4352970540938, "cost1_min": 33.40904119521527, "cost2_max": -17.066297753187463, "outflow_rate_mean": 1171.2381856295758, "system_level_velocity_min": 11.517671862286928, "outflow_rate_max": 1402.714001998002, "system_level_velocity_max": 20.234132362574307}, "info": {"num_steps_trained": 4477359, "load_time_ms": 12.622, "grad_time_ms": 10105.567, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018892917782068253, "total_loss": 14.466876029968262, "vf_loss": 14.47096061706543, "policy_loss": -0.005678957793861628, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9505969882011414, "entropy": 0.8901739716529846}, "update_time_ms": 7.968, "num_steps_sampled": 4477359, "sample_time_ms": 15143.03}, "episode_len_mean": 670.79, "time_this_iter_s": 24.67355990409851, "num_metric_batches_dropped": 0, "timesteps_total": 4477359, "episodes_total": 1577, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39048>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39400>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1485.2480026881146, "episodes_this_iter": 17, "time_total_s": 2695.221198797226, "time_since_restore": 2695.221198797226}
{"timestamp": 1557217435, "timesteps_since_restore": 4518525, "training_iteration": 104, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-23-55", "episode_reward_min": 67.03160602502959, "timesteps_this_iter": 41166, "episode_reward_mean": 1199.7484978106527, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 104, "custom_metrics": {"cost2_mean": -47.881293496221005, "cost2_min": -80.63869778337792, "cost1_mean": 352.2080415616763, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.476036466342942, "cost1_max": 455.4352970540938, "cost1_min": 33.40904119521527, "cost2_max": -17.066297753187463, "outflow_rate_mean": 1159.9548588260861, "system_level_velocity_min": 11.540377627165464, "outflow_rate_max": 1396.0264391608391, "system_level_velocity_max": 20.234132362574307}, "info": {"num_steps_trained": 4518525, "load_time_ms": 12.725, "grad_time_ms": 10110.589, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017416464164853096, "total_loss": 10.757728576660156, "vf_loss": 10.761273384094238, "policy_loss": -0.005013513378798962, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9657973051071167, "entropy": 0.884238064289093}, "update_time_ms": 8.079, "num_steps_sampled": 4518525, "sample_time_ms": 15043.026}, "episode_len_mean": 665.36, "time_this_iter_s": 25.20163059234619, "num_metric_batches_dropped": 0, "timesteps_total": 4518525, "episodes_total": 1596, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ca58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26978>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1485.2480026881146, "episodes_this_iter": 19, "time_total_s": 2720.422829389572, "time_since_restore": 2720.422829389572}
{"timestamp": 1557217460, "timesteps_since_restore": 4558893, "training_iteration": 105, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-24-20", "episode_reward_min": 67.03160602502959, "timesteps_this_iter": 40368, "episode_reward_mean": 1204.4339524483541, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 105, "custom_metrics": {"cost2_mean": -46.517079354264354, "cost2_min": -80.63869778337792, "cost1_mean": 354.34573297592783, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.343647716995795, "cost1_max": 438.10068489556505, "cost1_min": 33.40904119521527, "cost2_max": -17.066297753187463, "outflow_rate_mean": 1170.4226117432017, "system_level_velocity_min": 11.540377627165464, "outflow_rate_max": 1396.0264391608391, "system_level_velocity_max": 18.771886654242596}, "info": {"num_steps_trained": 4558893, "load_time_ms": 12.626, "grad_time_ms": 10073.994, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.020576680079102516, "total_loss": 12.83415412902832, "vf_loss": 12.838908195495605, "policy_loss": -0.006490323692560196, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9580407738685608, "entropy": 0.8652779459953308}, "update_time_ms": 8.228, "num_steps_sampled": 4558893, "sample_time_ms": 15061.173}, "episode_len_mean": 671.91, "time_this_iter_s": 25.103692531585693, "num_metric_batches_dropped": 0, "timesteps_total": 4558893, "episodes_total": 1612, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc65f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6780>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1376.6014686493504, "episodes_this_iter": 16, "time_total_s": 2745.526521921158, "time_since_restore": 2745.526521921158}
{"timestamp": 1557217487, "timesteps_since_restore": 4599618, "training_iteration": 106, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-24-47", "episode_reward_min": 67.03160602502959, "timesteps_this_iter": 40725, "episode_reward_mean": 1191.3870244039483, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 106, "custom_metrics": {"cost2_mean": -44.561051514775045, "cost2_min": -63.030889123268295, "cost1_mean": 355.0185618907497, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.462196473812616, "cost1_max": 438.10068489556505, "cost1_min": 33.40904119521527, "cost2_max": -20.967083209208475, "outflow_rate_mean": 1176.722312071426, "system_level_velocity_min": 11.540377627165464, "outflow_rate_max": 1396.0264391608391, "system_level_velocity_max": 19.286042156194885}, "info": {"num_steps_trained": 4599618, "load_time_ms": 12.245, "grad_time_ms": 10086.114, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01613982953131199, "total_loss": 18.01555061340332, "vf_loss": 18.018354415893555, "policy_loss": -0.0048463670536875725, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9392883777618408, "entropy": 0.887992262840271}, "update_time_ms": 8.4, "num_steps_sampled": 4599618, "sample_time_ms": 15191.974}, "episode_len_mean": 667.58, "time_this_iter_s": 26.662410736083984, "num_metric_batches_dropped": 0, "timesteps_total": 4599618, "episodes_total": 1631, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6f28>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1367.4926593200935, "episodes_this_iter": 19, "time_total_s": 2772.188932657242, "time_since_restore": 2772.188932657242}
{"timestamp": 1557217512, "timesteps_since_restore": 4640697, "training_iteration": 107, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-25-12", "episode_reward_min": 184.59106216455652, "timesteps_this_iter": 41079, "episode_reward_mean": 1199.709829073952, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 107, "custom_metrics": {"cost2_mean": -43.75685040203879, "cost2_min": -61.73444583998949, "cost1_mean": 357.05500981427804, "outflow_rate_min": 495.14880408918117, "system_level_velocity_mean": 14.36446775586218, "cost1_max": 427.0268130777057, "cost1_min": 79.47322559892626, "cost2_max": -24.9088272715685, "outflow_rate_mean": 1182.042130059999, "system_level_velocity_min": 11.540377627165464, "outflow_rate_max": 1396.0264391608391, "system_level_velocity_max": 19.286042156194885}, "info": {"num_steps_trained": 4640697, "load_time_ms": 12.026, "grad_time_ms": 10110.954, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015218052081763744, "total_loss": 9.752589225769043, "vf_loss": 9.755104064941406, "policy_loss": -0.004439937882125378, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9694516062736511, "entropy": 0.9153413772583008}, "update_time_ms": 8.736, "num_steps_sampled": 4640697, "sample_time_ms": 15151.783}, "episode_len_mean": 674.08, "time_this_iter_s": 25.655734539031982, "num_metric_batches_dropped": 0, "timesteps_total": 4640697, "episodes_total": 1646, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd325c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd326d8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1367.4926593200935, "episodes_this_iter": 15, "time_total_s": 2797.844667196274, "time_since_restore": 2797.844667196274}
{"timestamp": 1557217536, "timesteps_since_restore": 4681576, "training_iteration": 108, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-25-36", "episode_reward_min": 184.59106216455652, "timesteps_this_iter": 40879, "episode_reward_mean": 1203.2482826950677, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 108, "custom_metrics": {"cost2_mean": -42.73816722119409, "cost2_min": -61.73444583998949, "cost1_mean": 357.620657978742, "outflow_rate_min": 495.14880408918117, "system_level_velocity_mean": 14.381061766854367, "cost1_max": 427.0268130777057, "cost1_min": 79.47322559892626, "cost2_max": -24.9088272715685, "outflow_rate_mean": 1180.5837816883704, "system_level_velocity_min": 11.540377627165464, "outflow_rate_max": 1396.0264391608391, "system_level_velocity_max": 19.286042156194885}, "info": {"num_steps_trained": 4681576, "load_time_ms": 12.219, "grad_time_ms": 10003.636, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01548528391867876, "total_loss": 17.52464485168457, "vf_loss": 17.526330947875977, "policy_loss": -0.0036440384574234486, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9284257292747498, "entropy": 0.8565821051597595}, "update_time_ms": 9.152, "num_steps_sampled": 4681576, "sample_time_ms": 15108.611}, "episode_len_mean": 674.08, "time_this_iter_s": 23.353718996047974, "num_metric_batches_dropped": 0, "timesteps_total": 4681576, "episodes_total": 1662, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39f98>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1382.9204429914198, "episodes_this_iter": 16, "time_total_s": 2821.198386192322, "time_since_restore": 2821.198386192322}
{"timestamp": 1557217560, "timesteps_since_restore": 4722763, "training_iteration": 109, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-26-00", "episode_reward_min": 217.47117574154248, "timesteps_this_iter": 41187, "episode_reward_mean": 1217.5733060018567, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 109, "custom_metrics": {"cost2_mean": -42.13240051237147, "cost2_min": -61.73444583998949, "cost1_mean": 360.4568566953965, "outflow_rate_min": 547.7856406383617, "system_level_velocity_mean": 14.32786628094001, "cost1_max": 408.12035425666124, "cost1_min": 93.78207255985922, "cost2_max": -24.9088272715685, "outflow_rate_mean": 1188.9232111779484, "system_level_velocity_min": 11.540377627165464, "outflow_rate_max": 1340.2403564435565, "system_level_velocity_max": 19.286042156194885}, "info": {"num_steps_trained": 4722763, "load_time_ms": 12.245, "grad_time_ms": 9905.211, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013061003759503365, "total_loss": 9.164644241333008, "vf_loss": 9.16714096069336, "policy_loss": -0.00414994778111577, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9698501825332642, "entropy": 0.8896322846412659}, "update_time_ms": 9.066, "num_steps_sampled": 4722763, "sample_time_ms": 15181.957}, "episode_len_mean": 679.88, "time_this_iter_s": 24.58843183517456, "num_metric_batches_dropped": 0, "timesteps_total": 4722763, "episodes_total": 1678, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6198>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc69b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6cf8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1382.9204429914198, "episodes_this_iter": 16, "time_total_s": 2845.7868180274963, "time_since_restore": 2845.7868180274963}
{"timestamp": 1557217584, "timesteps_since_restore": 4763126, "training_iteration": 110, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-26-24", "episode_reward_min": 62.81707910734099, "timesteps_this_iter": 40363, "episode_reward_mean": 1189.7374939799117, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 110, "custom_metrics": {"cost2_mean": -40.88516902517917, "cost2_min": -61.73444583998949, "cost1_mean": 353.757336482007, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.47004915513835, "cost1_max": 408.12035425666124, "cost1_min": 33.989698636573806, "cost2_max": -18.06017742765495, "outflow_rate_mean": 1174.2354917295074, "system_level_velocity_min": 12.333280571599586, "outflow_rate_max": 1348.2590473526475, "system_level_velocity_max": 19.507633024728545}, "info": {"num_steps_trained": 4763126, "load_time_ms": 12.536, "grad_time_ms": 9680.808, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.020693140104413033, "total_loss": 21.982074737548828, "vf_loss": 21.9846134185791, "policy_loss": -0.005157392472028732, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.936551034450531, "entropy": 0.8582193851470947}, "update_time_ms": 9.142, "num_steps_sampled": 4763126, "sample_time_ms": 15148.912}, "episode_len_mean": 664.72, "time_this_iter_s": 23.852967023849487, "num_metric_batches_dropped": 0, "timesteps_total": 4763126, "episodes_total": 1698, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc65f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc63c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6908>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1382.9204429914198, "episodes_this_iter": 20, "time_total_s": 2869.639785051346, "time_since_restore": 2869.639785051346}
{"timestamp": 1557217609, "timesteps_since_restore": 4803398, "training_iteration": 111, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-26-49", "episode_reward_min": 62.81707910734099, "timesteps_this_iter": 40272, "episode_reward_mean": 1193.4876289681781, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 111, "custom_metrics": {"cost2_mean": -40.52113405589196, "cost2_min": -61.73444583998949, "cost1_mean": 352.07480883265976, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.430744463903228, "cost1_max": 401.9956043739661, "cost1_min": 33.989698636573806, "cost2_max": -18.06017742765495, "outflow_rate_mean": 1166.563645903727, "system_level_velocity_min": 12.08805836598359, "outflow_rate_max": 1348.2590473526475, "system_level_velocity_max": 19.507633024728545}, "info": {"num_steps_trained": 4803398, "load_time_ms": 12.801, "grad_time_ms": 9545.247, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013705706223845482, "total_loss": 11.001906394958496, "vf_loss": 11.005534172058105, "policy_loss": -0.006230175029486418, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9667045474052429, "entropy": 0.9046722054481506}, "update_time_ms": 9.053, "num_steps_sampled": 4803398, "sample_time_ms": 15263.839}, "episode_len_mean": 664.1, "time_this_iter_s": 24.689192056655884, "num_metric_batches_dropped": 0, "timesteps_total": 4803398, "episodes_total": 1718, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c4e0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1382.9204429914198, "episodes_this_iter": 20, "time_total_s": 2894.3289771080017, "time_since_restore": 2894.3289771080017}
{"timestamp": 1557217634, "timesteps_since_restore": 4844376, "training_iteration": 112, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-27-14", "episode_reward_min": 62.81707910734099, "timesteps_this_iter": 40978, "episode_reward_mean": 1209.0908088901579, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 112, "custom_metrics": {"cost2_mean": -40.59489420527794, "cost2_min": -61.73444583998949, "cost1_mean": 354.9996951024384, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.280598622530558, "cost1_max": 401.9956043739661, "cost1_min": 33.989698636573806, "cost2_max": -18.06017742765495, "outflow_rate_mean": 1170.6277628776602, "system_level_velocity_min": 12.08805836598359, "outflow_rate_max": 1348.2590473526475, "system_level_velocity_max": 19.507633024728545}, "info": {"num_steps_trained": 4844376, "load_time_ms": 12.586, "grad_time_ms": 9484.282, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013329101726412773, "total_loss": 10.712662696838379, "vf_loss": 10.71591854095459, "policy_loss": -0.005786658264696598, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.960004985332489, "entropy": 0.8586568832397461}, "update_time_ms": 9.212, "num_steps_sampled": 4844376, "sample_time_ms": 15303.696}, "episode_len_mean": 673.99, "time_this_iter_s": 25.20991826057434, "num_metric_batches_dropped": 0, "timesteps_total": 4844376, "episodes_total": 1734, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd399e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39b38>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1382.9204429914198, "episodes_this_iter": 16, "time_total_s": 2919.538895368576, "time_since_restore": 2919.538895368576}
{"timestamp": 1557217660, "timesteps_since_restore": 4887470, "training_iteration": 113, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-27-40", "episode_reward_min": 62.81707910734099, "timesteps_this_iter": 43094, "episode_reward_mean": 1209.2280795682739, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 113, "custom_metrics": {"cost2_mean": -40.46492807589812, "cost2_min": -56.17222441552455, "cost1_mean": 353.83118392967657, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.232479505637277, "cost1_max": 399.5313113871072, "cost1_min": 33.989698636573806, "cost2_max": -18.06017742765495, "outflow_rate_mean": 1169.4018498426956, "system_level_velocity_min": 12.08805836598359, "outflow_rate_max": 1348.2590473526475, "system_level_velocity_max": 19.507633024728545}, "info": {"num_steps_trained": 4887470, "load_time_ms": 12.618, "grad_time_ms": 9448.325, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013112662360072136, "total_loss": 7.965107440948486, "vf_loss": 7.968347549438477, "policy_loss": -0.005729249678552151, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9724186658859253, "entropy": 0.880678653717041}, "update_time_ms": 9.303, "num_steps_sampled": 4887470, "sample_time_ms": 15462.549}, "episode_len_mean": 673.99, "time_this_iter_s": 25.915498971939087, "num_metric_batches_dropped": 0, "timesteps_total": 4887470, "episodes_total": 1745, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc67b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6cc0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1382.9204429914198, "episodes_this_iter": 11, "time_total_s": 2945.454394340515, "time_since_restore": 2945.454394340515}
{"timestamp": 1557217685, "timesteps_since_restore": 4928489, "training_iteration": 114, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-28-05", "episode_reward_min": 62.81707910734099, "timesteps_this_iter": 41019, "episode_reward_mean": 1177.1586929592925, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 114, "custom_metrics": {"cost2_mean": -40.325477430056715, "cost2_min": -56.17222441552455, "cost1_mean": 343.6225454592282, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.179940182073738, "cost1_max": 394.8785409427382, "cost1_min": 33.989698636573806, "cost2_max": -18.06017742765495, "outflow_rate_mean": 1143.1910019751606, "system_level_velocity_min": 11.567597535856448, "outflow_rate_max": 1348.2590473526475, "system_level_velocity_max": 19.507633024728545}, "info": {"num_steps_trained": 4928489, "load_time_ms": 12.377, "grad_time_ms": 9423.47, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014726725406944752, "total_loss": 14.972040176391602, "vf_loss": 14.973361015319824, "policy_loss": -0.004117895849049091, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.953476071357727, "entropy": 0.8555145263671875}, "update_time_ms": 9.318, "num_steps_sampled": 4928489, "sample_time_ms": 15447.539}, "episode_len_mean": 660.44, "time_this_iter_s": 24.78598713874817, "num_metric_batches_dropped": 0, "timesteps_total": 4928489, "episodes_total": 1763, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39a20>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1374.6665861395466, "episodes_this_iter": 18, "time_total_s": 2970.2403814792633, "time_since_restore": 2970.2403814792633}
{"timestamp": 1557217711, "timesteps_since_restore": 4968581, "training_iteration": 115, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-28-31", "episode_reward_min": 54.933749005013524, "timesteps_this_iter": 40092, "episode_reward_mean": 1169.3819726869451, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 115, "custom_metrics": {"cost2_mean": -40.348347183895264, "cost2_min": -56.17222441552455, "cost1_mean": 342.24342346709244, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.205623822766519, "cost1_max": 404.2483280172371, "cost1_min": 29.745245917773033, "cost2_max": -14.217077805499564, "outflow_rate_mean": 1139.6378597554865, "system_level_velocity_min": 11.550210633187014, "outflow_rate_max": 1349.2019608391606, "system_level_velocity_max": 19.77927016151877}, "info": {"num_steps_trained": 4968581, "load_time_ms": 12.484, "grad_time_ms": 9480.178, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0126683060079813, "total_loss": 13.955204010009766, "vf_loss": 13.95855712890625, "policy_loss": -0.00575743243098259, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.962140679359436, "entropy": 0.887584924697876}, "update_time_ms": 9.172, "num_steps_sampled": 4968581, "sample_time_ms": 15469.966}, "episode_len_mean": 658.76, "time_this_iter_s": 25.886072635650635, "num_metric_batches_dropped": 0, "timesteps_total": 4968581, "episodes_total": 1782, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32940>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1374.6665861395466, "episodes_this_iter": 19, "time_total_s": 2996.126454114914, "time_since_restore": 2996.126454114914}
{"timestamp": 1557217736, "timesteps_since_restore": 5009570, "training_iteration": 116, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-28-56", "episode_reward_min": 54.933749005013524, "timesteps_this_iter": 40989, "episode_reward_mean": 1197.3881839184253, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 116, "custom_metrics": {"cost2_mean": -40.956319406210675, "cost2_min": -72.19734946763676, "cost1_mean": 350.86743637944215, "outflow_rate_min": 333.93808739864676, "system_level_velocity_mean": 14.11487171412207, "cost1_max": 412.7524639649788, "cost1_min": 29.745245917773033, "cost2_max": -14.217077805499564, "outflow_rate_mean": 1162.6069005656132, "system_level_velocity_min": 11.550210633187014, "outflow_rate_max": 1433.1287132867133, "system_level_velocity_max": 19.77927016151877}, "info": {"num_steps_trained": 5009570, "load_time_ms": 12.642, "grad_time_ms": 9504.29, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011229750700294971, "total_loss": 11.918789863586426, "vf_loss": 11.921823501586914, "policy_loss": -0.005166339222341776, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9654768705368042, "entropy": 0.8945740461349487}, "update_time_ms": 9.047, "num_steps_sampled": 5009570, "sample_time_ms": 15261.424}, "episode_len_mean": 674.47, "time_this_iter_s": 24.85087513923645, "num_metric_batches_dropped": 0, "timesteps_total": 5009570, "episodes_total": 1800, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd398d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39358>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1374.6665861395466, "episodes_this_iter": 18, "time_total_s": 3020.9773292541504, "time_since_restore": 3020.9773292541504}
{"timestamp": 1557217762, "timesteps_since_restore": 5050883, "training_iteration": 117, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-29-22", "episode_reward_min": 54.933749005013524, "timesteps_this_iter": 41313, "episode_reward_mean": 1193.4932679698459, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 117, "custom_metrics": {"cost2_mean": -41.83487959148757, "cost2_min": -72.19734946763676, "cost1_mean": 350.2030731915144, "outflow_rate_min": 333.93808739864676, "system_level_velocity_mean": 14.158050152660792, "cost1_max": 412.7524639649788, "cost1_min": 29.745245917773033, "cost2_max": -14.217077805499564, "outflow_rate_mean": 1168.6363009334082, "system_level_velocity_min": 11.400120710343929, "outflow_rate_max": 1433.1287132867133, "system_level_velocity_max": 19.77927016151877}, "info": {"num_steps_trained": 5050883, "load_time_ms": 12.89, "grad_time_ms": 9539.525, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013021646998822689, "total_loss": 16.385648727416992, "vf_loss": 16.386810302734375, "policy_loss": -0.0036354411859065294, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9535424113273621, "entropy": 0.8537968993186951}, "update_time_ms": 8.848, "num_steps_sampled": 5050883, "sample_time_ms": 15276.428}, "episode_len_mean": 671.85, "time_this_iter_s": 26.14812397956848, "num_metric_batches_dropped": 0, "timesteps_total": 5050883, "episodes_total": 1818, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6438>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1382.465512352598, "episodes_this_iter": 18, "time_total_s": 3047.125453233719, "time_since_restore": 3047.125453233719}
{"timestamp": 1557217787, "timesteps_since_restore": 5093130, "training_iteration": 118, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-29-47", "episode_reward_min": 54.933749005013524, "timesteps_this_iter": 42247, "episode_reward_mean": 1188.9700022094084, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 118, "custom_metrics": {"cost2_mean": -43.235178091414774, "cost2_min": -72.19734946763676, "cost1_mean": 350.2543655401928, "outflow_rate_min": 333.93808739864676, "system_level_velocity_mean": 14.321036508740617, "cost1_max": 446.2507687033253, "cost1_min": 29.745245917773033, "cost2_max": -14.217077805499564, "outflow_rate_mean": 1167.7714049710812, "system_level_velocity_min": 11.400120710343929, "outflow_rate_max": 1461.4122445554447, "system_level_velocity_max": 19.77927016151877}, "info": {"num_steps_trained": 5093130, "load_time_ms": 12.854, "grad_time_ms": 9596.724, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014259510673582554, "total_loss": 14.29150104522705, "vf_loss": 14.293797492980957, "policy_loss": -0.005004859063774347, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9603443741798401, "entropy": 0.8790037035942078}, "update_time_ms": 8.743, "num_steps_sampled": 5093130, "sample_time_ms": 15331.347}, "episode_len_mean": 666.1, "time_this_iter_s": 24.501381635665894, "num_metric_batches_dropped": 0, "timesteps_total": 5093130, "episodes_total": 1832, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39e10>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39f98>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1466.040287212429, "episodes_this_iter": 14, "time_total_s": 3071.6268348693848, "time_since_restore": 3071.6268348693848}
{"timestamp": 1557217811, "timesteps_since_restore": 5135684, "training_iteration": 119, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-30-11", "episode_reward_min": 54.933749005013524, "timesteps_this_iter": 42554, "episode_reward_mean": 1193.927664787925, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 119, "custom_metrics": {"cost2_mean": -44.536664597323664, "cost2_min": -72.19734946763676, "cost1_mean": 351.98844439007314, "outflow_rate_min": 333.93808739864676, "system_level_velocity_mean": 14.394386519636774, "cost1_max": 453.6665922910653, "cost1_min": 29.745245917773033, "cost2_max": -14.217077805499564, "outflow_rate_mean": 1172.192282887165, "system_level_velocity_min": 11.400120710343929, "outflow_rate_max": 1461.4122445554447, "system_level_velocity_max": 19.77927016151877}, "info": {"num_steps_trained": 5135684, "load_time_ms": 12.745, "grad_time_ms": 9616.832, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012969517149031162, "total_loss": 8.809398651123047, "vf_loss": 8.812466621398926, "policy_loss": -0.005530593451112509, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9765698313713074, "entropy": 0.902729332447052}, "update_time_ms": 8.906, "num_steps_sampled": 5135684, "sample_time_ms": 15311.964}, "episode_len_mean": 666.1, "time_this_iter_s": 24.58994483947754, "num_metric_batches_dropped": 0, "timesteps_total": 5135684, "episodes_total": 1847, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fb70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0f128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd2b5f8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.3259150010497, "episodes_this_iter": 15, "time_total_s": 3096.2167797088623, "time_since_restore": 3096.2167797088623}
{"timestamp": 1557217835, "timesteps_since_restore": 5177038, "training_iteration": 120, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-30-35", "episode_reward_min": 54.933749005013524, "timesteps_this_iter": 41354, "episode_reward_mean": 1216.9038406611057, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 120, "custom_metrics": {"cost2_mean": -47.216933303426316, "cost2_min": -75.72252567826212, "cost1_mean": 360.2023658449427, "outflow_rate_min": 333.93808739864676, "system_level_velocity_mean": 14.509833435475572, "cost1_max": 502.79679003287777, "cost1_min": 29.745245917773033, "cost2_max": -14.217077805499564, "outflow_rate_mean": 1194.812545259806, "system_level_velocity_min": 11.400120710343929, "outflow_rate_max": 1507.5812827172826, "system_level_velocity_max": 19.77927016151877}, "info": {"num_steps_trained": 5177038, "load_time_ms": 12.275, "grad_time_ms": 9504.177, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013425539247691631, "total_loss": 13.195503234863281, "vf_loss": 13.19821834564209, "policy_loss": -0.005263026803731918, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.965111255645752, "entropy": 0.8964218497276306}, "update_time_ms": 9.017, "num_steps_sampled": 5177038, "sample_time_ms": 15400.943}, "episode_len_mean": 674.66, "time_this_iter_s": 23.606117486953735, "num_metric_batches_dropped": 0, "timesteps_total": 5177038, "episodes_total": 1865, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6fd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc62b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.3259150010497, "episodes_this_iter": 18, "time_total_s": 3119.822897195816, "time_since_restore": 3119.822897195816}
{"timestamp": 1557217861, "timesteps_since_restore": 5217802, "training_iteration": 121, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-31-01", "episode_reward_min": 211.08906661889952, "timesteps_this_iter": 40764, "episode_reward_mean": 1228.6356009626195, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 121, "custom_metrics": {"cost2_mean": -50.225356905373665, "cost2_min": -80.88073030749237, "cost1_mean": 363.97479807482995, "outflow_rate_min": 478.52540676432363, "system_level_velocity_mean": 14.46798313979004, "cost1_max": 502.79679003287777, "cost1_min": 81.65894358165059, "cost2_max": -22.52593316082429, "outflow_rate_mean": 1203.5723101840213, "system_level_velocity_min": 11.230990279034794, "outflow_rate_max": 1507.5812827172826, "system_level_velocity_max": 19.090502585604515}, "info": {"num_steps_trained": 5217802, "load_time_ms": 11.926, "grad_time_ms": 9364.471, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011567577719688416, "total_loss": 8.24581241607666, "vf_loss": 8.249242782592773, "policy_loss": -0.005626192782074213, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9787432551383972, "entropy": 0.9210749268531799}, "update_time_ms": 9.239, "num_steps_sampled": 5217802, "sample_time_ms": 15662.508}, "episode_len_mean": 681.22, "time_this_iter_s": 25.928229093551636, "num_metric_batches_dropped": 0, "timesteps_total": 5217802, "episodes_total": 1883, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39e10>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd392e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.3259150010497, "episodes_this_iter": 18, "time_total_s": 3145.7511262893677, "time_since_restore": 3145.7511262893677}
{"timestamp": 1557217886, "timesteps_since_restore": 5260418, "training_iteration": 122, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-31-26", "episode_reward_min": 211.08906661889952, "timesteps_this_iter": 42616, "episode_reward_mean": 1217.3943013723037, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 122, "custom_metrics": {"cost2_mean": -52.09374556371485, "cost2_min": -88.53521829881421, "cost1_mean": 361.5738244489715, "outflow_rate_min": 478.52540676432363, "system_level_velocity_mean": 14.555893731498053, "cost1_max": 502.79679003287777, "cost1_min": 81.65894358165059, "cost2_max": -26.448574798924586, "outflow_rate_mean": 1198.2284898002258, "system_level_velocity_min": 11.230990279034794, "outflow_rate_max": 1507.5812827172826, "system_level_velocity_max": 19.090502585604515}, "info": {"num_steps_trained": 5260418, "load_time_ms": 11.943, "grad_time_ms": 9109.465, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014654913917183876, "total_loss": 12.01296329498291, "vf_loss": 12.014005661010742, "policy_loss": -0.0038259492721408606, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9668639898300171, "entropy": 0.9212432503700256}, "update_time_ms": 9.226, "num_steps_sampled": 5260418, "sample_time_ms": 15930.718}, "episode_len_mean": 674.44, "time_this_iter_s": 25.338132858276367, "num_metric_batches_dropped": 0, "timesteps_total": 5260418, "episodes_total": 1899, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6518>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1bb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6d68>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.3259150010497, "episodes_this_iter": 16, "time_total_s": 3171.089259147644, "time_since_restore": 3171.089259147644}
{"timestamp": 1557217912, "timesteps_since_restore": 5302891, "training_iteration": 123, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-31-52", "episode_reward_min": 211.08906661889952, "timesteps_this_iter": 42473, "episode_reward_mean": 1226.6115429479685, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 123, "custom_metrics": {"cost2_mean": -53.72872134883511, "cost2_min": -89.8336364308622, "cost1_mean": 365.33146804562125, "outflow_rate_min": 478.52540676432363, "system_level_velocity_mean": 14.501294539320142, "cost1_max": 502.79679003287777, "cost1_min": 81.65894358165059, "cost2_max": -26.448574798924586, "outflow_rate_mean": 1198.8238918872555, "system_level_velocity_min": 11.230990279034794, "outflow_rate_max": 1507.5812827172826, "system_level_velocity_max": 19.090502585604515}, "info": {"num_steps_trained": 5302891, "load_time_ms": 11.614, "grad_time_ms": 8900.916, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011929302476346493, "total_loss": 6.195802211761475, "vf_loss": 6.199148178100586, "policy_loss": -0.00560956122353673, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.983403205871582, "entropy": 0.9177170395851135}, "update_time_ms": 8.882, "num_steps_sampled": 5302891, "sample_time_ms": 16118.731}, "episode_len_mean": 682.48, "time_this_iter_s": 25.662955284118652, "num_metric_batches_dropped": 0, "timesteps_total": 5302891, "episodes_total": 1913, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc66a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6c50>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.3259150010497, "episodes_this_iter": 14, "time_total_s": 3196.7522144317627, "time_since_restore": 3196.7522144317627}
{"timestamp": 1557217936, "timesteps_since_restore": 5343237, "training_iteration": 124, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-32-16", "episode_reward_min": 53.44937664644538, "timesteps_this_iter": 40346, "episode_reward_mean": 1209.2993289945919, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 124, "custom_metrics": {"cost2_mean": -54.179983189915895, "cost2_min": -89.8336364308622, "cost1_mean": 361.35489207208826, "outflow_rate_min": 332.19890697104705, "system_level_velocity_mean": 14.539322631189066, "cost1_max": 502.79679003287777, "cost1_min": 29.45737615052915, "cost2_max": -18.621270050483844, "outflow_rate_mean": 1188.52156905566, "system_level_velocity_min": 11.230990279034794, "outflow_rate_max": 1507.5812827172826, "system_level_velocity_max": 20.128236422430284}, "info": {"num_steps_trained": 5343237, "load_time_ms": 11.713, "grad_time_ms": 8625.206, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013428128324449062, "total_loss": 16.19270896911621, "vf_loss": 16.194658279418945, "policy_loss": -0.004499613307416439, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9562269449234009, "entropy": 0.8653227090835571}, "update_time_ms": 8.633, "num_steps_sampled": 5343237, "sample_time_ms": 16308.294}, "episode_len_mean": 675.93, "time_this_iter_s": 23.90762758255005, "num_metric_batches_dropped": 0, "timesteps_total": 5343237, "episodes_total": 1932, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6c88>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6ba8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.3259150010497, "episodes_this_iter": 19, "time_total_s": 3220.6598420143127, "time_since_restore": 3220.6598420143127}
{"timestamp": 1557217962, "timesteps_since_restore": 5384362, "training_iteration": 125, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-32-42", "episode_reward_min": 53.44937664644538, "timesteps_this_iter": 41125, "episode_reward_mean": 1207.3039300052246, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 125, "custom_metrics": {"cost2_mean": -53.57879823244898, "cost2_min": -89.8336364308622, "cost1_mean": 363.1989176829156, "outflow_rate_min": 332.19890697104705, "system_level_velocity_mean": 14.612303016985468, "cost1_max": 502.79679003287777, "cost1_min": 29.45737615052915, "cost2_max": -18.621270050483844, "outflow_rate_mean": 1193.3339675971183, "system_level_velocity_min": 11.230990279034794, "outflow_rate_max": 1507.5812827172826, "system_level_velocity_max": 20.128236422430284}, "info": {"num_steps_trained": 5384362, "load_time_ms": 12.389, "grad_time_ms": 8517.075, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012221576645970345, "total_loss": 11.296963691711426, "vf_loss": 11.300006866455078, "policy_loss": -0.005363486707210541, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9700231552124023, "entropy": 0.9108357429504395}, "update_time_ms": 8.244, "num_steps_sampled": 5384362, "sample_time_ms": 16489.233}, "episode_len_mean": 675.93, "time_this_iter_s": 26.624958992004395, "num_metric_batches_dropped": 0, "timesteps_total": 5384362, "episodes_total": 1949, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd325f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b898>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1386.763551304965, "episodes_this_iter": 17, "time_total_s": 3247.284801006317, "time_since_restore": 3247.284801006317}
{"timestamp": 1557217987, "timesteps_since_restore": 5425888, "training_iteration": 126, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-33-07", "episode_reward_min": 53.44937664644538, "timesteps_this_iter": 41526, "episode_reward_mean": 1216.2432968018634, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 126, "custom_metrics": {"cost2_mean": -52.9559018549367, "cost2_min": -89.8336364308622, "cost1_mean": 363.9389092402112, "outflow_rate_min": 332.19890697104705, "system_level_velocity_mean": 14.488619501628527, "cost1_max": 462.3640854712571, "cost1_min": 29.45737615052915, "cost2_max": -18.621270050483844, "outflow_rate_mean": 1195.4046923567478, "system_level_velocity_min": 11.230990279034794, "outflow_rate_max": 1499.8824887112887, "system_level_velocity_max": 20.128236422430284}, "info": {"num_steps_trained": 5425888, "load_time_ms": 12.366, "grad_time_ms": 8366.438, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011908604763448238, "total_loss": 11.515952110290527, "vf_loss": 11.518738746643066, "policy_loss": -0.005047318525612354, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9686893224716187, "entropy": 0.9162009954452515}, "update_time_ms": 8.087, "num_steps_sampled": 5425888, "sample_time_ms": 16640.12}, "episode_len_mean": 680.92, "time_this_iter_s": 24.806519985198975, "num_metric_batches_dropped": 0, "timesteps_total": 5425888, "episodes_total": 1966, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32ac8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd329b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32198>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1386.763551304965, "episodes_this_iter": 17, "time_total_s": 3272.091320991516, "time_since_restore": 3272.091320991516}
{"timestamp": 1557218013, "timesteps_since_restore": 5469942, "training_iteration": 127, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-33-33", "episode_reward_min": 53.44937664644538, "timesteps_this_iter": 44054, "episode_reward_mean": 1219.9147753521727, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 127, "custom_metrics": {"cost2_mean": -51.615793884524535, "cost2_min": -89.8336364308622, "cost1_mean": 363.5156205965512, "outflow_rate_min": 332.19890697104705, "system_level_velocity_mean": 14.462589154401064, "cost1_max": 436.7216680191567, "cost1_min": 29.45737615052915, "cost2_max": -18.621270050483844, "outflow_rate_mean": 1194.5904854676367, "system_level_velocity_min": 11.823339982960151, "outflow_rate_max": 1499.8824887112887, "system_level_velocity_max": 20.128236422430284}, "info": {"num_steps_trained": 5469942, "load_time_ms": 12.431, "grad_time_ms": 8342.628, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012757123447954655, "total_loss": 7.268190383911133, "vf_loss": 7.2711310386657715, "policy_loss": -0.005362518131732941, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9783439040184021, "entropy": 0.9454696178436279}, "update_time_ms": 7.78, "num_steps_sampled": 5469942, "sample_time_ms": 16662.984}, "episode_len_mean": 680.92, "time_this_iter_s": 26.128859758377075, "num_metric_batches_dropped": 0, "timesteps_total": 5469942, "episodes_total": 1981, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd321d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1386.763551304965, "episodes_this_iter": 15, "time_total_s": 3298.220180749893, "time_since_restore": 3298.220180749893}
{"timestamp": 1557218038, "timesteps_since_restore": 5512561, "training_iteration": 128, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-33-58", "episode_reward_min": 53.44937664644538, "timesteps_this_iter": 42619, "episode_reward_mean": 1215.9598854212318, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 128, "custom_metrics": {"cost2_mean": -50.31576794674869, "cost2_min": -89.8336364308622, "cost1_mean": 359.5182385387849, "outflow_rate_min": 332.19890697104705, "system_level_velocity_mean": 14.359104832531742, "cost1_max": 436.7216680191567, "cost1_min": 29.45737615052915, "cost2_max": -18.621270050483844, "outflow_rate_mean": 1182.8047715979067, "system_level_velocity_min": 11.66267168755358, "outflow_rate_max": 1499.8824887112887, "system_level_velocity_max": 20.128236422430284}, "info": {"num_steps_trained": 5512561, "load_time_ms": 12.516, "grad_time_ms": 8371.262, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012268745340406895, "total_loss": 9.80483341217041, "vf_loss": 9.808039665222168, "policy_loss": -0.005534777417778969, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9703830480575562, "entropy": 0.9194301962852478}, "update_time_ms": 7.586, "num_steps_sampled": 5512561, "sample_time_ms": 16658.258}, "episode_len_mean": 678.96, "time_this_iter_s": 24.710665464401245, "num_metric_batches_dropped": 0, "timesteps_total": 5512561, "episodes_total": 1995, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c9e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c710>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1400.7123880160618, "episodes_this_iter": 14, "time_total_s": 3322.9308462142944, "time_since_restore": 3322.9308462142944}
{"timestamp": 1557218063, "timesteps_since_restore": 5555006, "training_iteration": 129, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-34-23", "episode_reward_min": 53.44937664644538, "timesteps_this_iter": 42445, "episode_reward_mean": 1229.5822899797129, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 129, "custom_metrics": {"cost2_mean": -49.63171310553339, "cost2_min": -71.96237443817824, "cost1_mean": 362.64548207269326, "outflow_rate_min": 332.19890697104705, "system_level_velocity_mean": 14.332013700529082, "cost1_max": 436.7216680191567, "cost1_min": 29.45737615052915, "cost2_max": -18.621270050483844, "outflow_rate_mean": 1191.3410618991804, "system_level_velocity_min": 11.66267168755358, "outflow_rate_max": 1499.8824887112887, "system_level_velocity_max": 20.128236422430284}, "info": {"num_steps_trained": 5555006, "load_time_ms": 13.134, "grad_time_ms": 8423.474, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012830336578190327, "total_loss": 5.828137397766113, "vf_loss": 5.8320393562316895, "policy_loss": -0.006338175851851702, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.984088659286499, "entropy": 0.9528954029083252}, "update_time_ms": 7.399, "num_steps_sampled": 5555006, "sample_time_ms": 16606.988}, "episode_len_mean": 683.94, "time_this_iter_s": 24.612698554992676, "num_metric_batches_dropped": 0, "timesteps_total": 5555006, "episodes_total": 2011, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2710>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1400.7123880160618, "episodes_this_iter": 16, "time_total_s": 3347.543544769287, "time_since_restore": 3347.543544769287}
{"timestamp": 1557218087, "timesteps_since_restore": 5596843, "training_iteration": 130, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-34-47", "episode_reward_min": 57.411218168627094, "timesteps_this_iter": 41837, "episode_reward_mean": 1232.4335887592667, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 130, "custom_metrics": {"cost2_mean": -48.22029496010035, "cost2_min": -69.87047131713642, "cost1_mean": 359.3205004091124, "outflow_rate_min": 333.50599664218385, "system_level_velocity_mean": 14.188118250277414, "cost1_max": 436.7216680191567, "cost1_min": 31.06570941658935, "cost2_max": -15.528643278830776, "outflow_rate_mean": 1182.4842796730145, "system_level_velocity_min": 11.66267168755358, "outflow_rate_max": 1499.8824887112887, "system_level_velocity_max": 19.5754566508072}, "info": {"num_steps_trained": 5596843, "load_time_ms": 13.518, "grad_time_ms": 8643.409, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014471194706857204, "total_loss": 9.531625747680664, "vf_loss": 9.535555839538574, "policy_loss": -0.006677368655800819, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9736810922622681, "entropy": 0.9340426325798035}, "update_time_ms": 7.248, "num_steps_sampled": 5596843, "sample_time_ms": 16463.75}, "episode_len_mean": 683.97, "time_this_iter_s": 24.379873991012573, "num_metric_batches_dropped": 0, "timesteps_total": 5596843, "episodes_total": 2029, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32d30>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd329b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1400.7123880160618, "episodes_this_iter": 18, "time_total_s": 3371.9234187602997, "time_since_restore": 3371.9234187602997}
{"timestamp": 1557218111, "timesteps_since_restore": 5638856, "training_iteration": 131, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-35-11", "episode_reward_min": 57.411218168627094, "timesteps_this_iter": 42013, "episode_reward_mean": 1243.9319791690068, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 131, "custom_metrics": {"cost2_mean": -48.56464399235402, "cost2_min": -69.87047131713642, "cost1_mean": 358.92633162522617, "outflow_rate_min": 333.50599664218385, "system_level_velocity_mean": 14.007196856388296, "cost1_max": 436.7216680191567, "cost1_min": 31.06570941658935, "cost2_max": -15.528643278830776, "outflow_rate_mean": 1181.2674166255583, "system_level_velocity_min": 11.66267168755358, "outflow_rate_max": 1439.5635024975027, "system_level_velocity_max": 19.5754566508072}, "info": {"num_steps_trained": 5638856, "load_time_ms": 13.919, "grad_time_ms": 8801.785, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01320773083716631, "total_loss": 6.941324234008789, "vf_loss": 6.9443535804748535, "policy_loss": -0.005536756943911314, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9802128076553345, "entropy": 0.9501674175262451}, "update_time_ms": 7.015, "num_steps_sampled": 5638856, "sample_time_ms": 16098.432}, "episode_len_mean": 689.7, "time_this_iter_s": 23.846033811569214, "num_metric_batches_dropped": 0, "timesteps_total": 5638856, "episodes_total": 2044, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6e48>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc65f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6240>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1400.7123880160618, "episodes_this_iter": 15, "time_total_s": 3395.769452571869, "time_since_restore": 3395.769452571869}
{"timestamp": 1557218136, "timesteps_since_restore": 5681168, "training_iteration": 132, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-35-36", "episode_reward_min": 57.411218168627094, "timesteps_this_iter": 42312, "episode_reward_mean": 1247.8015269067682, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 132, "custom_metrics": {"cost2_mean": -48.74068130591936, "cost2_min": -72.86729864937308, "cost1_mean": 358.5776957538663, "outflow_rate_min": 333.50599664218385, "system_level_velocity_mean": 13.992087816487613, "cost1_max": 439.9042531417102, "cost1_min": 31.06570941658935, "cost2_max": -15.528643278830776, "outflow_rate_mean": 1182.959551087097, "system_level_velocity_min": 11.66267168755358, "outflow_rate_max": 1411.8789538461538, "system_level_velocity_max": 19.5754566508072}, "info": {"num_steps_trained": 5681168, "load_time_ms": 14.292, "grad_time_ms": 8961.078, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012194526381790638, "total_loss": 10.048624992370605, "vf_loss": 10.052055358886719, "policy_loss": -0.005744894500821829, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.970744252204895, "entropy": 0.931853711605072}, "update_time_ms": 6.809, "num_steps_sampled": 5681168, "sample_time_ms": 15898.633}, "episode_len_mean": 689.7, "time_this_iter_s": 24.94490694999695, "num_metric_batches_dropped": 0, "timesteps_total": 5681168, "episodes_total": 2060, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd264a8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd267b8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1466.5970347227017, "episodes_this_iter": 16, "time_total_s": 3420.714359521866, "time_since_restore": 3420.714359521866}
{"timestamp": 1557218162, "timesteps_since_restore": 5723619, "training_iteration": 133, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-36-02", "episode_reward_min": 57.411218168627094, "timesteps_this_iter": 42451, "episode_reward_mean": 1234.494509711854, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 133, "custom_metrics": {"cost2_mean": -48.58442897179141, "cost2_min": -72.86729864937308, "cost1_mean": 352.94813099319686, "outflow_rate_min": 333.50599664218385, "system_level_velocity_mean": 13.97925245583445, "cost1_max": 439.9042531417102, "cost1_min": 31.06570941658935, "cost2_max": -15.528643278830776, "outflow_rate_mean": 1171.5328915685939, "system_level_velocity_min": 11.66267168755358, "outflow_rate_max": 1411.8789538461538, "system_level_velocity_max": 19.5754566508072}, "info": {"num_steps_trained": 5723619, "load_time_ms": 14.396, "grad_time_ms": 9127.35, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012831829488277435, "total_loss": 11.616402626037598, "vf_loss": 11.618334770202637, "policy_loss": -0.00436802301555872, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9640451073646545, "entropy": 0.9254357814788818}, "update_time_ms": 6.808, "num_steps_sampled": 5723619, "sample_time_ms": 15741.561}, "episode_len_mean": 681.26, "time_this_iter_s": 25.772141933441162, "num_metric_batches_dropped": 0, "timesteps_total": 5723619, "episodes_total": 2075, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cdd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ce80>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1466.5970347227017, "episodes_this_iter": 15, "time_total_s": 3446.486501455307, "time_since_restore": 3446.486501455307}
{"timestamp": 1557218186, "timesteps_since_restore": 5763437, "training_iteration": 134, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-36-26", "episode_reward_min": 57.411218168627094, "timesteps_this_iter": 39818, "episode_reward_mean": 1223.5514947854622, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 134, "custom_metrics": {"cost2_mean": -48.27004793825414, "cost2_min": -72.86729864937308, "cost1_mean": 351.27261888144994, "outflow_rate_min": 333.50599664218385, "system_level_velocity_mean": 14.025033149150726, "cost1_max": 439.9042531417102, "cost1_min": 31.06570941658935, "cost2_max": -15.528643278830776, "outflow_rate_mean": 1168.9173227677215, "system_level_velocity_min": 11.469851801778674, "outflow_rate_max": 1411.8789538461538, "system_level_velocity_max": 19.5754566508072}, "info": {"num_steps_trained": 5763437, "load_time_ms": 14.306, "grad_time_ms": 9286.289, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013509952463209629, "total_loss": 11.681197166442871, "vf_loss": 11.684901237487793, "policy_loss": -0.006269360426813364, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9634485840797424, "entropy": 0.8557080030441284}, "update_time_ms": 6.868, "num_steps_sampled": 5763437, "sample_time_ms": 15586.652}, "episode_len_mean": 676.46, "time_this_iter_s": 23.95560884475708, "num_metric_batches_dropped": 0, "timesteps_total": 5763437, "episodes_total": 2091, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc61d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6dd8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1466.5970347227017, "episodes_this_iter": 16, "time_total_s": 3470.442110300064, "time_since_restore": 3470.442110300064}
{"timestamp": 1557218211, "timesteps_since_restore": 5804769, "training_iteration": 135, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-36-51", "episode_reward_min": 57.411218168627094, "timesteps_this_iter": 41332, "episode_reward_mean": 1221.7118239219355, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 135, "custom_metrics": {"cost2_mean": -45.46633461846968, "cost2_min": -72.86729864937308, "cost1_mean": 352.93951148331695, "outflow_rate_min": 333.50599664218385, "system_level_velocity_mean": 14.097046264096, "cost1_max": 439.9042531417102, "cost1_min": 31.06570941658935, "cost2_max": -15.528643278830776, "outflow_rate_mean": 1180.720399621063, "system_level_velocity_min": 11.469851801778674, "outflow_rate_max": 1461.8073674325674, "system_level_velocity_max": 19.5754566508072}, "info": {"num_steps_trained": 5804769, "load_time_ms": 13.628, "grad_time_ms": 9322.649, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013282476924359798, "total_loss": 21.286283493041992, "vf_loss": 21.2891902923584, "policy_loss": -0.005429745186120272, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9298601746559143, "entropy": 0.8759673833847046}, "update_time_ms": 6.942, "num_steps_sampled": 5804769, "sample_time_ms": 15394.918}, "episode_len_mean": 675.54, "time_this_iter_s": 25.06075954437256, "num_metric_batches_dropped": 0, "timesteps_total": 5804769, "episodes_total": 2110, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd156d8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd15518>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1466.5970347227017, "episodes_this_iter": 19, "time_total_s": 3495.5028698444366, "time_since_restore": 3495.5028698444366}
{"timestamp": 1557218236, "timesteps_since_restore": 5845943, "training_iteration": 136, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-37-16", "episode_reward_min": 393.1707080454732, "timesteps_this_iter": 41174, "episode_reward_mean": 1234.6907003192991, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 136, "custom_metrics": {"cost2_mean": -44.675973104893416, "cost2_min": -72.86729864937308, "cost1_mean": 357.4528003575602, "outflow_rate_min": 779.8934303687089, "system_level_velocity_mean": 14.078682371344064, "cost1_max": 439.9042531417102, "cost1_min": 146.8750594998507, "cost2_max": -24.01116651358151, "outflow_rate_mean": 1196.8577590552409, "system_level_velocity_min": 11.469851801778674, "outflow_rate_max": 1461.8073674325674, "system_level_velocity_max": 18.10641927765607}, "info": {"num_steps_trained": 5845943, "load_time_ms": 13.575, "grad_time_ms": 9412.85, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014791910536587238, "total_loss": 10.57986831665039, "vf_loss": 10.58271312713623, "policy_loss": -0.005652418825775385, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9711087942123413, "entropy": 0.9167697429656982}, "update_time_ms": 7.059, "num_steps_sampled": 5845943, "sample_time_ms": 15316.19}, "episode_len_mean": 682.08, "time_this_iter_s": 24.93505048751831, "num_metric_batches_dropped": 0, "timesteps_total": 5845943, "episodes_total": 2126, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c978>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ca58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cef0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1466.5970347227017, "episodes_this_iter": 16, "time_total_s": 3520.437920331955, "time_since_restore": 3520.437920331955}
{"timestamp": 1557218262, "timesteps_since_restore": 5887291, "training_iteration": 137, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-37-42", "episode_reward_min": 393.1707080454732, "timesteps_this_iter": 41348, "episode_reward_mean": 1226.6325215400643, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 137, "custom_metrics": {"cost2_mean": -43.57026811334581, "cost2_min": -72.86729864937308, "cost1_mean": 357.6416922103929, "outflow_rate_min": 779.8934303687089, "system_level_velocity_mean": 14.087285902174285, "cost1_max": 439.9042531417102, "cost1_min": 146.8750594998507, "cost2_max": -24.01116651358151, "outflow_rate_mean": 1198.439245153143, "system_level_velocity_min": 11.469851801778674, "outflow_rate_max": 1461.8073674325674, "system_level_velocity_max": 18.10641927765607}, "info": {"num_steps_trained": 5887291, "load_time_ms": 13.631, "grad_time_ms": 9469.526, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012955252081155777, "total_loss": 11.704522132873535, "vf_loss": 11.707828521728516, "policy_loss": -0.0057656713761389256, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9648637771606445, "entropy": 0.9312431216239929}, "update_time_ms": 7.388, "num_steps_sampled": 5887291, "sample_time_ms": 15265.244}, "episode_len_mean": 682.08, "time_this_iter_s": 26.188612937927246, "num_metric_batches_dropped": 0, "timesteps_total": 5887291, "episodes_total": 2142, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cfd0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1466.5970347227017, "episodes_this_iter": 16, "time_total_s": 3546.626533269882, "time_since_restore": 3546.626533269882}
{"timestamp": 1557218286, "timesteps_since_restore": 5927937, "training_iteration": 138, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-38-06", "episode_reward_min": 63.27892487598921, "timesteps_this_iter": 40646, "episode_reward_mean": 1197.2349124947439, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 138, "custom_metrics": {"cost2_mean": -41.9612187803297, "cost2_min": -66.18475078118138, "cost1_mean": 351.85673967039446, "outflow_rate_min": 329.47395416043526, "system_level_velocity_mean": 14.20728255309731, "cost1_max": 447.1437472668954, "cost1_min": 31.830716751522136, "cost2_max": -13.210901959949101, "outflow_rate_mean": 1180.8119035285856, "system_level_velocity_min": 11.469851801778674, "outflow_rate_max": 1461.8073674325674, "system_level_velocity_max": 19.346278012068513}, "info": {"num_steps_trained": 5927937, "load_time_ms": 13.758, "grad_time_ms": 9475.38, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015290595591068268, "total_loss": 13.183032989501953, "vf_loss": 13.186498641967773, "policy_loss": -0.0063687581568956375, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9637032151222229, "entropy": 0.8744158148765564}, "update_time_ms": 7.435, "num_steps_sampled": 5927937, "sample_time_ms": 15220.653}, "episode_len_mean": 669.62, "time_this_iter_s": 24.330700874328613, "num_metric_batches_dropped": 0, "timesteps_total": 5927937, "episodes_total": 2159, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd268d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26080>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1381.6114507491393, "episodes_this_iter": 17, "time_total_s": 3570.957234144211, "time_since_restore": 3570.957234144211}
{"timestamp": 1557218311, "timesteps_since_restore": 5968337, "training_iteration": 139, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-38-31", "episode_reward_min": 63.27892487598921, "timesteps_this_iter": 40400, "episode_reward_mean": 1213.878664600721, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 139, "custom_metrics": {"cost2_mean": -40.332655950514884, "cost2_min": -65.17102480067715, "cost1_mean": 361.4918244020419, "outflow_rate_min": 329.47395416043526, "system_level_velocity_mean": 14.376045923338843, "cost1_max": 447.1437472668954, "cost1_min": 31.830716751522136, "cost2_max": -13.210901959949101, "outflow_rate_mean": 1205.2993545635725, "system_level_velocity_min": 11.469851801778674, "outflow_rate_max": 1461.8073674325674, "system_level_velocity_max": 19.346278012068513}, "info": {"num_steps_trained": 5968337, "load_time_ms": 13.255, "grad_time_ms": 9492.699, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01416750717908144, "total_loss": 12.542014122009277, "vf_loss": 12.546533584594727, "policy_loss": -0.007209222298115492, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9628881812095642, "entropy": 0.8648083209991455}, "update_time_ms": 7.404, "num_steps_sampled": 5968337, "sample_time_ms": 15149.916}, "episode_len_mean": 678.06, "time_this_iter_s": 24.08778977394104, "num_metric_batches_dropped": 0, "timesteps_total": 5968337, "episodes_total": 2176, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b358>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1381.6114507491393, "episodes_this_iter": 17, "time_total_s": 3595.045023918152, "time_since_restore": 3595.045023918152}
{"timestamp": 1557218335, "timesteps_since_restore": 6010101, "training_iteration": 140, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-38-55", "episode_reward_min": 63.27892487598921, "timesteps_this_iter": 41764, "episode_reward_mean": 1220.2963209292998, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 140, "custom_metrics": {"cost2_mean": -39.378133495881485, "cost2_min": -57.75297019774905, "cost1_mean": 363.1448314931877, "outflow_rate_min": 329.47395416043526, "system_level_velocity_mean": 14.326260781425356, "cost1_max": 447.1437472668954, "cost1_min": 31.830716751522136, "cost2_max": -13.210901959949101, "outflow_rate_mean": 1211.527464767042, "system_level_velocity_min": 12.206379904196682, "outflow_rate_max": 1461.8073674325674, "system_level_velocity_max": 19.346278012068513}, "info": {"num_steps_trained": 6010101, "load_time_ms": 13.127, "grad_time_ms": 9595.461, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013205469585955143, "total_loss": 10.389636039733887, "vf_loss": 10.393677711486816, "policy_loss": -0.006549041718244553, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9709048867225647, "entropy": 0.9188814759254456}, "update_time_ms": 7.618, "num_steps_sampled": 6010101, "sample_time_ms": 15091.282}, "episode_len_mean": 682.86, "time_this_iter_s": 24.826310634613037, "num_metric_batches_dropped": 0, "timesteps_total": 6010101, "episodes_total": 2194, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6390>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1378.8788266545098, "episodes_this_iter": 18, "time_total_s": 3619.871334552765, "time_since_restore": 3619.871334552765}
{"timestamp": 1557218360, "timesteps_since_restore": 6051291, "training_iteration": 141, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-39-20", "episode_reward_min": 63.27892487598921, "timesteps_this_iter": 41190, "episode_reward_mean": 1220.7373623848748, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 141, "custom_metrics": {"cost2_mean": -39.85186859930067, "cost2_min": -57.75297019774905, "cost1_mean": 360.73937790178684, "outflow_rate_min": 329.47395416043526, "system_level_velocity_mean": 14.239727005472528, "cost1_max": 447.1437472668954, "cost1_min": 31.830716751522136, "cost2_max": -13.210901959949101, "outflow_rate_mean": 1202.0665956727153, "system_level_velocity_min": 12.206379904196682, "outflow_rate_max": 1461.8073674325674, "system_level_velocity_max": 19.346278012068513}, "info": {"num_steps_trained": 6051291, "load_time_ms": 12.811, "grad_time_ms": 9753.613, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013837737031280994, "total_loss": 12.300978660583496, "vf_loss": 12.303826332092285, "policy_loss": -0.005475071258842945, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9709739685058594, "entropy": 0.9102271795272827}, "update_time_ms": 7.571, "num_steps_sampled": 6051291, "sample_time_ms": 15023.71}, "episode_len_mean": 682.61, "time_this_iter_s": 24.747579097747803, "num_metric_batches_dropped": 0, "timesteps_total": 6051291, "episodes_total": 2208, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd322e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32a90>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1378.8788266545098, "episodes_this_iter": 14, "time_total_s": 3644.6189136505127, "time_since_restore": 3644.6189136505127}
{"timestamp": 1557218384, "timesteps_since_restore": 6092359, "training_iteration": 142, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-39-44", "episode_reward_min": 63.27892487598921, "timesteps_this_iter": 41068, "episode_reward_mean": 1204.317462102246, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 142, "custom_metrics": {"cost2_mean": -39.705546135419446, "cost2_min": -57.75297019774905, "cost1_mean": 358.6375262167702, "outflow_rate_min": 329.47395416043526, "system_level_velocity_mean": 14.460318108098932, "cost1_max": 447.1437472668954, "cost1_min": 31.830716751522136, "cost2_max": -13.210901959949101, "outflow_rate_mean": 1199.4682047017384, "system_level_velocity_min": 12.206379904196682, "outflow_rate_max": 1464.7663304695302, "system_level_velocity_max": 19.346278012068513}, "info": {"num_steps_trained": 6092359, "load_time_ms": 12.355, "grad_time_ms": 9773.115, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012935593724250793, "total_loss": 20.552480697631836, "vf_loss": 20.55437660217285, "policy_loss": -0.004350869916379452, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9448062181472778, "entropy": 0.8796270489692688}, "update_time_ms": 7.906, "num_steps_sampled": 6092359, "sample_time_ms": 14941.095}, "episode_len_mean": 671.63, "time_this_iter_s": 24.30643939971924, "num_metric_batches_dropped": 0, "timesteps_total": 6092359, "episodes_total": 2226, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc64a8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6cf8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1394.5694189071844, "episodes_this_iter": 18, "time_total_s": 3668.925353050232, "time_since_restore": 3668.925353050232}
{"timestamp": 1557218408, "timesteps_since_restore": 6133363, "training_iteration": 143, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-40-08", "episode_reward_min": 63.27892487598921, "timesteps_this_iter": 41004, "episode_reward_mean": 1212.638239976605, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 143, "custom_metrics": {"cost2_mean": -40.10281926756491, "cost2_min": -58.04090359708333, "cost1_mean": 361.91931347452316, "outflow_rate_min": 329.47395416043526, "system_level_velocity_mean": 14.582596956744284, "cost1_max": 454.1161103049369, "cost1_min": 31.830716751522136, "cost2_max": -13.210901959949101, "outflow_rate_mean": 1206.4023665638763, "system_level_velocity_min": 12.309624257847707, "outflow_rate_max": 1464.7663304695302, "system_level_velocity_max": 19.346278012068513}, "info": {"num_steps_trained": 6133363, "load_time_ms": 11.899, "grad_time_ms": 9690.014, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01318407990038395, "total_loss": 9.41125774383545, "vf_loss": 9.414260864257812, "policy_loss": -0.005505614914000034, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9754167795181274, "entropy": 0.8963072896003723}, "update_time_ms": 8.219, "num_steps_sampled": 6133363, "sample_time_ms": 14799.709}, "episode_len_mean": 671.63, "time_this_iter_s": 23.517677307128906, "num_metric_batches_dropped": 0, "timesteps_total": 6133363, "episodes_total": 2242, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cbe0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c9e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1394.5694189071844, "episodes_this_iter": 16, "time_total_s": 3692.443030357361, "time_since_restore": 3692.443030357361}
{"timestamp": 1557218434, "timesteps_since_restore": 6173476, "training_iteration": 144, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-40-34", "episode_reward_min": 58.01388292070735, "timesteps_this_iter": 40113, "episode_reward_mean": 1212.7681080151979, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 144, "custom_metrics": {"cost2_mean": -39.5718525734092, "cost2_min": -58.04090359708333, "cost1_mean": 363.24278718253044, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.650480315731173, "cost1_max": 454.1161103049369, "cost1_min": 31.59104765050916, "cost2_max": -11.414206301647315, "outflow_rate_mean": 1212.7161326439682, "system_level_velocity_min": 12.28689193929557, "outflow_rate_max": 1464.7663304695302, "system_level_velocity_max": 19.331963700000152}, "info": {"num_steps_trained": 6173476, "load_time_ms": 12.231, "grad_time_ms": 9690.925, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01274070329964161, "total_loss": 17.12801170349121, "vf_loss": 17.130666732788086, "policy_loss": -0.005074460059404373, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9606913924217224, "entropy": 0.9084661602973938}, "update_time_ms": 8.421, "num_steps_sampled": 6173476, "sample_time_ms": 15010.973}, "episode_len_mean": 671.06, "time_this_iter_s": 26.10095739364624, "num_metric_batches_dropped": 0, "timesteps_total": 6173476, "episodes_total": 2262, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2c18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2e80>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1394.5694189071844, "episodes_this_iter": 20, "time_total_s": 3718.543987751007, "time_since_restore": 3718.543987751007}
{"timestamp": 1557218462, "timesteps_since_restore": 6214433, "training_iteration": 145, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-41-02", "episode_reward_min": 58.01388292070735, "timesteps_this_iter": 40957, "episode_reward_mean": 1195.8698600061705, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 145, "custom_metrics": {"cost2_mean": -39.67891331072329, "cost2_min": -65.71230608154032, "cost1_mean": 358.7549595255441, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.74919680088303, "cost1_max": 470.2861722311715, "cost1_min": 31.59104765050916, "cost2_max": -11.414206301647315, "outflow_rate_mean": 1202.0808992821785, "system_level_velocity_min": 12.059174938951918, "outflow_rate_max": 1485.4311272727275, "system_level_velocity_max": 19.331963700000152}, "info": {"num_steps_trained": 6214433, "load_time_ms": 12.751, "grad_time_ms": 9792.712, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013256818987429142, "total_loss": 18.594341278076172, "vf_loss": 18.596527099609375, "policy_loss": -0.004703440237790346, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9535344243049622, "entropy": 0.9088645577430725}, "update_time_ms": 8.627, "num_steps_sampled": 6214433, "sample_time_ms": 15152.158}, "episode_len_mean": 660.57, "time_this_iter_s": 27.507272243499756, "num_metric_batches_dropped": 0, "timesteps_total": 6214433, "episodes_total": 2281, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc60f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc69e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6208>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1465.6468223595666, "episodes_this_iter": 19, "time_total_s": 3746.051259994507, "time_since_restore": 3746.051259994507}
{"timestamp": 1557218486, "timesteps_since_restore": 6255398, "training_iteration": 146, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-41-26", "episode_reward_min": 58.01388292070735, "timesteps_this_iter": 40965, "episode_reward_mean": 1192.8289144474836, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 146, "custom_metrics": {"cost2_mean": -39.63589761892771, "cost2_min": -65.71230608154032, "cost1_mean": 359.0199694301526, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.889266656831007, "cost1_max": 470.2861722311715, "cost1_min": 31.59104765050916, "cost2_max": -11.414206301647315, "outflow_rate_mean": 1207.3729787421926, "system_level_velocity_min": 12.059174938951918, "outflow_rate_max": 1485.4311272727275, "system_level_velocity_max": 19.331963700000152}, "info": {"num_steps_trained": 6255398, "load_time_ms": 12.483, "grad_time_ms": 9640.824, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013771901838481426, "total_loss": 17.242937088012695, "vf_loss": 17.245758056640625, "policy_loss": -0.005436760373413563, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9520946741104126, "entropy": 0.9264063835144043}, "update_time_ms": 8.907, "num_steps_sampled": 6255398, "sample_time_ms": 15208.823}, "episode_len_mean": 655.55, "time_this_iter_s": 23.977871417999268, "num_metric_batches_dropped": 0, "timesteps_total": 6255398, "episodes_total": 2296, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26470>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26be0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1465.6468223595666, "episodes_this_iter": 15, "time_total_s": 3770.029131412506, "time_since_restore": 3770.029131412506}
{"timestamp": 1557218510, "timesteps_since_restore": 6296702, "training_iteration": 147, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-41-50", "episode_reward_min": 58.01388292070735, "timesteps_this_iter": 41304, "episode_reward_mean": 1186.8696310645064, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 147, "custom_metrics": {"cost2_mean": -40.35558563591588, "cost2_min": -65.71230608154032, "cost1_mean": 357.19007743477164, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.934985018258137, "cost1_max": 470.2861722311715, "cost1_min": 31.59104765050916, "cost2_max": -11.414206301647315, "outflow_rate_mean": 1202.6687708692446, "system_level_velocity_min": 12.059174938951918, "outflow_rate_max": 1485.4311272727275, "system_level_velocity_max": 19.331963700000152}, "info": {"num_steps_trained": 6296702, "load_time_ms": 12.08, "grad_time_ms": 9373.41, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014116954989731312, "total_loss": 17.492900848388672, "vf_loss": 17.49701499938965, "policy_loss": -0.006795633118599653, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9533038139343262, "entropy": 0.9486882090568542}, "update_time_ms": 8.869, "num_steps_sampled": 6296702, "sample_time_ms": 15299.021}, "episode_len_mean": 651.01, "time_this_iter_s": 24.40306258201599, "num_metric_batches_dropped": 0, "timesteps_total": 6296702, "episodes_total": 2314, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c240>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1465.6468223595666, "episodes_this_iter": 18, "time_total_s": 3794.432193994522, "time_since_restore": 3794.432193994522}
{"timestamp": 1557218535, "timesteps_since_restore": 6338537, "training_iteration": 148, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-42-15", "episode_reward_min": 58.01388292070735, "timesteps_this_iter": 41835, "episode_reward_mean": 1190.9590963284993, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 148, "custom_metrics": {"cost2_mean": -40.8695392266509, "cost2_min": -65.71230608154032, "cost1_mean": 356.8140302904526, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.766114719908225, "cost1_max": 470.2861722311715, "cost1_min": 31.59104765050916, "cost2_max": -11.414206301647315, "outflow_rate_mean": 1196.8989722665967, "system_level_velocity_min": 12.059174938951918, "outflow_rate_max": 1485.4311272727275, "system_level_velocity_max": 19.331963700000152}, "info": {"num_steps_trained": 6338537, "load_time_ms": 11.981, "grad_time_ms": 9148.837, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013263656757771969, "total_loss": 12.490148544311523, "vf_loss": 12.493215560913086, "policy_loss": -0.00558438990265131, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9660223126411438, "entropy": 0.9785287380218506}, "update_time_ms": 8.811, "num_steps_sampled": 6338537, "sample_time_ms": 15561.06}, "episode_len_mean": 656.36, "time_this_iter_s": 24.71432900428772, "num_metric_batches_dropped": 0, "timesteps_total": 6338537, "episodes_total": 2329, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34a90>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b2e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1465.6468223595666, "episodes_this_iter": 15, "time_total_s": 3819.14652299881, "time_since_restore": 3819.14652299881}
{"timestamp": 1557218560, "timesteps_since_restore": 6379889, "training_iteration": 149, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-42-40", "episode_reward_min": 58.01388292070735, "timesteps_this_iter": 41352, "episode_reward_mean": 1193.5007953347426, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 149, "custom_metrics": {"cost2_mean": -40.91971003061647, "cost2_min": -65.71230608154032, "cost1_mean": 355.8211451515432, "outflow_rate_min": 335.6139678872712, "system_level_velocity_mean": 14.700287706063381, "cost1_max": 470.2861722311715, "cost1_min": 31.59104765050916, "cost2_max": -15.647174940206362, "outflow_rate_mean": 1199.4516693892472, "system_level_velocity_min": 12.059174938951918, "outflow_rate_max": 1485.4311272727275, "system_level_velocity_max": 19.331963700000152}, "info": {"num_steps_trained": 6379889, "load_time_ms": 12.054, "grad_time_ms": 8973.595, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013899757526814938, "total_loss": 17.613895416259766, "vf_loss": 17.618396759033203, "policy_loss": -0.007139764726161957, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9507512450218201, "entropy": 0.9738385677337646}, "update_time_ms": 8.994, "num_steps_sampled": 6379889, "sample_time_ms": 15826.667}, "episode_len_mean": 657.18, "time_this_iter_s": 24.96573519706726, "num_metric_batches_dropped": 0, "timesteps_total": 6379889, "episodes_total": 2347, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cfd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cb70>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1465.6468223595666, "episodes_this_iter": 18, "time_total_s": 3844.112258195877, "time_since_restore": 3844.112258195877}
{"timestamp": 1557218586, "timesteps_since_restore": 6421007, "training_iteration": 150, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-43-06", "episode_reward_min": 170.18788105660025, "timesteps_this_iter": 41118, "episode_reward_mean": 1202.769516939936, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 150, "custom_metrics": {"cost2_mean": -42.10539817455801, "cost2_min": -65.71230608154032, "cost1_mean": 356.0995196537075, "outflow_rate_min": 466.95705314127684, "system_level_velocity_mean": 14.51232430723204, "cost1_max": 470.2861722311715, "cost1_min": 76.58242272332656, "cost2_max": -15.647174940206362, "outflow_rate_mean": 1200.656640343741, "system_level_velocity_min": 12.059174938951918, "outflow_rate_max": 1485.4311272727275, "system_level_velocity_max": 19.11868739686881}, "info": {"num_steps_trained": 6421007, "load_time_ms": 12.07, "grad_time_ms": 8743.893, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014155295677483082, "total_loss": 14.325374603271484, "vf_loss": 14.32765007019043, "policy_loss": -0.004962890408933163, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9605647325515747, "entropy": 1.0148155689239502}, "update_time_ms": 8.848, "num_steps_sampled": 6421007, "sample_time_ms": 16217.222}, "episode_len_mean": 663.71, "time_this_iter_s": 26.441240072250366, "num_metric_batches_dropped": 0, "timesteps_total": 6421007, "episodes_total": 2365, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd0fef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c208>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1465.6468223595666, "episodes_this_iter": 18, "time_total_s": 3870.5534982681274, "time_since_restore": 3870.5534982681274}
{"timestamp": 1557218611, "timesteps_since_restore": 6462337, "training_iteration": 151, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-43-31", "episode_reward_min": 63.08974816690021, "timesteps_this_iter": 41330, "episode_reward_mean": 1205.1178846903213, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 151, "custom_metrics": {"cost2_mean": -41.86745856147065, "cost2_min": -65.19464337054184, "cost1_mean": 354.31419929703173, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.452502950804265, "cost1_max": 420.46180500472, "cost1_min": 33.32490994175465, "cost2_max": -9.85671537888149, "outflow_rate_mean": 1201.0276042313476, "system_level_velocity_min": 12.273464098257792, "outflow_rate_max": 1453.9109654345652, "system_level_velocity_max": 18.70699480956841}, "info": {"num_steps_trained": 6462337, "load_time_ms": 12.245, "grad_time_ms": 8526.642, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018291819840669632, "total_loss": 11.408055305480957, "vf_loss": 11.412958145141602, "policy_loss": -0.008375723846256733, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9654332399368286, "entropy": 0.998001754283905}, "update_time_ms": 8.852, "num_steps_sampled": 6462337, "sample_time_ms": 16453.3}, "episode_len_mean": 663.11, "time_this_iter_s": 24.950964212417603, "num_metric_batches_dropped": 0, "timesteps_total": 6462337, "episodes_total": 2379, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6860>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1434.0191958804753, "episodes_this_iter": 14, "time_total_s": 3895.504462480545, "time_since_restore": 3895.504462480545}
{"timestamp": 1557218637, "timesteps_since_restore": 6503375, "training_iteration": 152, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-43-57", "episode_reward_min": 63.08974816690021, "timesteps_this_iter": 41038, "episode_reward_mean": 1203.937992296472, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 152, "custom_metrics": {"cost2_mean": -42.653683306921565, "cost2_min": -65.19464337054184, "cost1_mean": 351.5569933217142, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.341566717075095, "cost1_max": 416.34892303860954, "cost1_min": 33.32490994175465, "cost2_max": -9.85671537888149, "outflow_rate_mean": 1189.4618648530345, "system_level_velocity_min": 12.089342476115135, "outflow_rate_max": 1444.4734225774225, "system_level_velocity_max": 18.70699480956841}, "info": {"num_steps_trained": 6503375, "load_time_ms": 12.237, "grad_time_ms": 8499.288, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014206720516085625, "total_loss": 15.08117389678955, "vf_loss": 15.085100173950195, "policy_loss": -0.006624311208724976, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9576566815376282, "entropy": 1.0097434520721436}, "update_time_ms": 8.415, "num_steps_sampled": 6503375, "sample_time_ms": 16567.895}, "episode_len_mean": 663.03, "time_this_iter_s": 25.170031785964966, "num_metric_batches_dropped": 0, "timesteps_total": 6503375, "episodes_total": 2399, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc69e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc66a0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1434.0191958804753, "episodes_this_iter": 20, "time_total_s": 3920.67449426651, "time_since_restore": 3920.67449426651}
{"timestamp": 1557218663, "timesteps_since_restore": 6546225, "training_iteration": 153, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-44-23", "episode_reward_min": 63.08974816690021, "timesteps_this_iter": 42850, "episode_reward_mean": 1224.1402763506414, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 153, "custom_metrics": {"cost2_mean": -43.77072634060488, "cost2_min": -62.5433334914857, "cost1_mean": 354.3268154009378, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.194453319406152, "cost1_max": 416.34892303860954, "cost1_min": 33.32490994175465, "cost2_max": -9.85671537888149, "outflow_rate_mean": 1193.6624492988403, "system_level_velocity_min": 12.089342476115135, "outflow_rate_max": 1444.4734225774225, "system_level_velocity_max": 18.70699480956841}, "info": {"num_steps_trained": 6546225, "load_time_ms": 12.821, "grad_time_ms": 8586.674, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012191938236355782, "total_loss": 8.966730117797852, "vf_loss": 8.970052719116211, "policy_loss": -0.005636660382151604, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9711616039276123, "entropy": 1.0581709146499634}, "update_time_ms": 8.065, "num_steps_sampled": 6546225, "sample_time_ms": 16735.845}, "episode_len_mean": 672.5, "time_this_iter_s": 26.07211184501648, "num_metric_batches_dropped": 0, "timesteps_total": 6546225, "episodes_total": 2413, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26be0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1b358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26ba8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1434.0191958804753, "episodes_this_iter": 14, "time_total_s": 3946.7466061115265, "time_since_restore": 3946.7466061115265}
{"timestamp": 1557218689, "timesteps_since_restore": 6589479, "training_iteration": 154, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-44-49", "episode_reward_min": 63.08974816690021, "timesteps_this_iter": 43254, "episode_reward_mean": 1233.690502330769, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 154, "custom_metrics": {"cost2_mean": -44.897578395794916, "cost2_min": -62.5433334914857, "cost1_mean": 354.9741222304911, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.068283745339672, "cost1_max": 412.10017241047404, "cost1_min": 33.32490994175465, "cost2_max": -9.85671537888149, "outflow_rate_mean": 1195.392787188149, "system_level_velocity_min": 12.088355733829001, "outflow_rate_max": 1409.5795872127871, "system_level_velocity_max": 18.70699480956841}, "info": {"num_steps_trained": 6589479, "load_time_ms": 12.796, "grad_time_ms": 8729.664, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011386005207896233, "total_loss": 7.376180171966553, "vf_loss": 7.378347873687744, "policy_loss": -0.0043290178291499615, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.976829469203949, "entropy": 0.9995134472846985}, "update_time_ms": 7.713, "num_steps_sampled": 6589479, "sample_time_ms": 16574.466}, "episode_len_mean": 678.13, "time_this_iter_s": 25.914881944656372, "num_metric_batches_dropped": 0, "timesteps_total": 6589479, "episodes_total": 2425, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2828>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1434.0191958804753, "episodes_this_iter": 12, "time_total_s": 3972.661488056183, "time_since_restore": 3972.661488056183}
{"timestamp": 1557218714, "timesteps_since_restore": 6632998, "training_iteration": 155, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-45-14", "episode_reward_min": 63.08974816690021, "timesteps_this_iter": 43519, "episode_reward_mean": 1250.9028740691767, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 155, "custom_metrics": {"cost2_mean": -45.677498556117115, "cost2_min": -62.5433334914857, "cost1_mean": 357.65933766683173, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.009523228249636, "cost1_max": 420.83381880414265, "cost1_min": 33.32490994175465, "cost2_max": -9.85671537888149, "outflow_rate_mean": 1202.0483538043213, "system_level_velocity_min": 12.088355733829001, "outflow_rate_max": 1448.3761546453545, "system_level_velocity_max": 18.70699480956841}, "info": {"num_steps_trained": 6632998, "load_time_ms": 12.523, "grad_time_ms": 8682.356, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011788950301706791, "total_loss": 10.60228443145752, "vf_loss": 10.60439395904541, "policy_loss": -0.0043480899184942245, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9685242176055908, "entropy": 1.0350074768066406}, "update_time_ms": 7.592, "num_steps_sampled": 6632998, "sample_time_ms": 16423.269}, "episode_len_mean": 683.81, "time_this_iter_s": 25.52315616607666, "num_metric_batches_dropped": 0, "timesteps_total": 6632998, "episodes_total": 2442, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd347b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd349b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1441.9876967342343, "episodes_this_iter": 17, "time_total_s": 3998.1846442222595, "time_since_restore": 3998.1846442222595}
{"timestamp": 1557218739, "timesteps_since_restore": 6673829, "training_iteration": 156, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-45-39", "episode_reward_min": 63.08974816690021, "timesteps_this_iter": 40831, "episode_reward_mean": 1234.308782589597, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 156, "custom_metrics": {"cost2_mean": -46.789365707136085, "cost2_min": -68.72381699999312, "cost1_mean": 351.37980117525166, "outflow_rate_min": 326.87068933731643, "system_level_velocity_mean": 14.064210368607277, "cost1_max": 420.83381880414265, "cost1_min": 33.32490994175465, "cost2_max": -9.85671537888149, "outflow_rate_mean": 1186.1271900419765, "system_level_velocity_min": 12.088355733829001, "outflow_rate_max": 1448.3761546453545, "system_level_velocity_max": 18.985559684747813}, "info": {"num_steps_trained": 6673829, "load_time_ms": 12.996, "grad_time_ms": 8827.394, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013906188309192657, "total_loss": 12.783863067626953, "vf_loss": 12.787189483642578, "policy_loss": -0.0059663341380655766, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9673576951026917, "entropy": 1.0550106763839722}, "update_time_ms": 7.308, "num_steps_sampled": 6673829, "sample_time_ms": 16341.425}, "episode_len_mean": 672.59, "time_this_iter_s": 24.61770749092102, "num_metric_batches_dropped": 0, "timesteps_total": 6673829, "episodes_total": 2460, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc63c8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc67b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6e48>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1441.9876967342343, "episodes_this_iter": 18, "time_total_s": 4022.8023517131805, "time_since_restore": 4022.8023517131805}
{"timestamp": 1557218763, "timesteps_since_restore": 6714604, "training_iteration": 157, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-46-03", "episode_reward_min": 66.98137482937261, "timesteps_this_iter": 40775, "episode_reward_mean": 1247.5593924216557, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 157, "custom_metrics": {"cost2_mean": -48.115031942498845, "cost2_min": -68.72381699999312, "cost1_mean": 356.57242599448875, "outflow_rate_min": 326.87068933731643, "system_level_velocity_mean": 14.088795091941817, "cost1_max": 423.52944401097386, "cost1_min": 35.56146987921082, "cost2_max": -12.599507049610455, "outflow_rate_mean": 1199.914395481099, "system_level_velocity_min": 12.088355733829001, "outflow_rate_max": 1460.0461978021979, "system_level_velocity_max": 18.985559684747813}, "info": {"num_steps_trained": 6714604, "load_time_ms": 12.724, "grad_time_ms": 8949.883, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013371044769883156, "total_loss": 12.413351058959961, "vf_loss": 12.417659759521484, "policy_loss": -0.0068473052233457565, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9627693295478821, "entropy": 1.0091890096664429}, "update_time_ms": 7.067, "num_steps_sampled": 6714604, "sample_time_ms": 16214.288}, "episode_len_mean": 679.09, "time_this_iter_s": 24.358186960220337, "num_metric_batches_dropped": 0, "timesteps_total": 6714604, "episodes_total": 2477, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cc18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c048>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1441.9876967342343, "episodes_this_iter": 17, "time_total_s": 4047.160538673401, "time_since_restore": 4047.160538673401}
{"timestamp": 1557218789, "timesteps_since_restore": 6757255, "training_iteration": 158, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-46-29", "episode_reward_min": 66.98137482937261, "timesteps_this_iter": 42651, "episode_reward_mean": 1268.1061517702472, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 158, "custom_metrics": {"cost2_mean": -49.147178386462585, "cost2_min": -68.72381699999312, "cost1_mean": 362.75579452795137, "outflow_rate_min": 326.87068933731643, "system_level_velocity_mean": 14.075797133888848, "cost1_max": 446.2342461752811, "cost1_min": 35.56146987921082, "cost2_max": -12.599507049610455, "outflow_rate_mean": 1216.9170077021909, "system_level_velocity_min": 12.088355733829001, "outflow_rate_max": 1487.484983016983, "system_level_velocity_max": 18.985559684747813}, "info": {"num_steps_trained": 6757255, "load_time_ms": 12.537, "grad_time_ms": 9130.65, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013444161973893642, "total_loss": 14.57550048828125, "vf_loss": 14.578365325927734, "policy_loss": -0.0054166787303984165, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9529234766960144, "entropy": 1.0424774885177612}, "update_time_ms": 7.134, "num_steps_sampled": 6757255, "sample_time_ms": 16160.371}, "episode_len_mean": 688.78, "time_this_iter_s": 25.96753978729248, "num_metric_batches_dropped": 0, "timesteps_total": 6757255, "episodes_total": 2492, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2470>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1441.9876967342343, "episodes_this_iter": 15, "time_total_s": 4073.1280784606934, "time_since_restore": 4073.1280784606934}
{"timestamp": 1557218814, "timesteps_since_restore": 6799052, "training_iteration": 159, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-46-54", "episode_reward_min": 66.98137482937261, "timesteps_this_iter": 41797, "episode_reward_mean": 1261.1824487922015, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 159, "custom_metrics": {"cost2_mean": -50.29605967413456, "cost2_min": -74.3577316492371, "cost1_mean": 359.96995231230284, "outflow_rate_min": 326.87068933731643, "system_level_velocity_mean": 14.08159280052412, "cost1_max": 446.2342461752811, "cost1_min": 35.56146987921082, "cost2_max": -12.599507049610455, "outflow_rate_mean": 1214.9417967386728, "system_level_velocity_min": 11.069152246963625, "outflow_rate_max": 1487.484983016983, "system_level_velocity_max": 18.985559684747813}, "info": {"num_steps_trained": 6799052, "load_time_ms": 12.44, "grad_time_ms": 9173.812, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014455762691795826, "total_loss": 11.58537769317627, "vf_loss": 11.589189529418945, "policy_loss": -0.006555832922458649, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9634983539581299, "entropy": 1.0607943534851074}, "update_time_ms": 7.015, "num_steps_sampled": 6799052, "sample_time_ms": 16095.909}, "episode_len_mean": 684.4, "time_this_iter_s": 24.766438007354736, "num_metric_batches_dropped": 0, "timesteps_total": 6799052, "episodes_total": 2507, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd347b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd340f0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1441.9876967342343, "episodes_this_iter": 15, "time_total_s": 4097.894516468048, "time_since_restore": 4097.894516468048}
{"timestamp": 1557218839, "timesteps_since_restore": 6840574, "training_iteration": 160, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-47-19", "episode_reward_min": 66.98137482937261, "timesteps_this_iter": 41522, "episode_reward_mean": 1260.5410126332554, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 160, "custom_metrics": {"cost2_mean": -50.68527883512301, "cost2_min": -74.3577316492371, "cost1_mean": 359.7127429234962, "outflow_rate_min": 326.87068933731643, "system_level_velocity_mean": 14.158260785748553, "cost1_max": 446.2342461752811, "cost1_min": 35.56146987921082, "cost2_max": -12.599507049610455, "outflow_rate_mean": 1220.1897009127126, "system_level_velocity_min": 11.069152246963625, "outflow_rate_max": 1487.484983016983, "system_level_velocity_max": 18.985559684747813}, "info": {"num_steps_trained": 6840574, "load_time_ms": 12.48, "grad_time_ms": 9224.099, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016614874824881554, "total_loss": 14.496563911437988, "vf_loss": 14.501449584960938, "policy_loss": -0.008039426989853382, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9527930617332458, "entropy": 1.0019044876098633}, "update_time_ms": 7.348, "num_steps_sampled": 6840574, "sample_time_ms": 15908.698}, "episode_len_mean": 680.57, "time_this_iter_s": 25.064915895462036, "num_metric_batches_dropped": 0, "timesteps_total": 6840574, "episodes_total": 2524, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39d68>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1443.8195367346973, "episodes_this_iter": 17, "time_total_s": 4122.95943236351, "time_since_restore": 4122.95943236351}
{"timestamp": 1557218864, "timesteps_since_restore": 6881768, "training_iteration": 161, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-47-44", "episode_reward_min": 66.98137482937261, "timesteps_this_iter": 41194, "episode_reward_mean": 1250.1493980948048, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 161, "custom_metrics": {"cost2_mean": -51.0669458173572, "cost2_min": -74.3577316492371, "cost1_mean": 357.2890094447654, "outflow_rate_min": 326.87068933731643, "system_level_velocity_mean": 14.227827522346818, "cost1_max": 446.2342461752811, "cost1_min": 35.56146987921082, "cost2_max": -12.599507049610455, "outflow_rate_mean": 1218.5220663528935, "system_level_velocity_min": 11.069152246963625, "outflow_rate_max": 1487.484983016983, "system_level_velocity_max": 18.985559684747813}, "info": {"num_steps_trained": 6881768, "load_time_ms": 12.663, "grad_time_ms": 9112.81, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013970442116260529, "total_loss": 16.610851287841797, "vf_loss": 16.613670349121094, "policy_loss": -0.0054731727577745914, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.953890323638916, "entropy": 1.0721635818481445}, "update_time_ms": 7.406, "num_steps_sampled": 6881768, "sample_time_ms": 15985.141}, "episode_len_mean": 674.07, "time_this_iter_s": 24.620713710784912, "num_metric_batches_dropped": 0, "timesteps_total": 6881768, "episodes_total": 2543, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cfd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ce48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c710>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1453.7133873889616, "episodes_this_iter": 19, "time_total_s": 4147.580146074295, "time_since_restore": 4147.580146074295}
{"timestamp": 1557218889, "timesteps_since_restore": 6924426, "training_iteration": 162, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-48-09", "episode_reward_min": 494.62242953541795, "timesteps_this_iter": 42658, "episode_reward_mean": 1272.9325458540764, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 162, "custom_metrics": {"cost2_mean": -51.40767795170516, "cost2_min": -75.51321178855828, "cost1_mean": 364.3696024000702, "outflow_rate_min": 879.6201368150402, "system_level_velocity_mean": 14.204227344634292, "cost1_max": 446.2342461752811, "cost1_min": 172.53364817030655, "cost2_max": -21.60136565452527, "outflow_rate_mean": 1239.7013185547985, "system_level_velocity_min": 11.069152246963625, "outflow_rate_max": 1487.484983016983, "system_level_velocity_max": 17.867478606961026}, "info": {"num_steps_trained": 6924426, "load_time_ms": 12.638, "grad_time_ms": 8970.937, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011056537739932537, "total_loss": 11.999462127685547, "vf_loss": 12.001187324523926, "policy_loss": -0.0038249024655669928, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9647762179374695, "entropy": 1.0750328302383423}, "update_time_ms": 7.723, "num_steps_sampled": 6924426, "sample_time_ms": 16136.424}, "episode_len_mean": 685.29, "time_this_iter_s": 25.27505350112915, "num_metric_batches_dropped": 0, "timesteps_total": 6924426, "episodes_total": 2556, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39668>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39128>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1453.7133873889616, "episodes_this_iter": 13, "time_total_s": 4172.855199575424, "time_since_restore": 4172.855199575424}
{"timestamp": 1557218915, "timesteps_since_restore": 6967224, "training_iteration": 163, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-48-35", "episode_reward_min": 29.398996896922, "timesteps_this_iter": 42798, "episode_reward_mean": 1247.6975687878482, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 163, "custom_metrics": {"cost2_mean": -52.446472894007385, "cost2_min": -80.34078575443408, "cost1_mean": 356.5556522512613, "outflow_rate_min": 317.5287350200169, "system_level_velocity_mean": 14.222388635621344, "cost1_max": 446.2342461752811, "cost1_min": 18.07721006400532, "cost2_max": -7.5906742049302265, "outflow_rate_mean": 1219.8460238837554, "system_level_velocity_min": 10.997131854311371, "outflow_rate_max": 1487.484983016983, "system_level_velocity_max": 19.07543498947914}, "info": {"num_steps_trained": 6967224, "load_time_ms": 12.638, "grad_time_ms": 8906.836, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015504702925682068, "total_loss": 12.880005836486816, "vf_loss": 12.883671760559082, "policy_loss": -0.006608833093196154, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.963930606842041, "entropy": 1.0757830142974854}, "update_time_ms": 7.935, "num_steps_sampled": 6967224, "sample_time_ms": 16176.987}, "episode_len_mean": 673.49, "time_this_iter_s": 25.844627857208252, "num_metric_batches_dropped": 0, "timesteps_total": 6967224, "episodes_total": 2572, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6ac8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1453.7133873889616, "episodes_this_iter": 16, "time_total_s": 4198.699827432632, "time_since_restore": 4198.699827432632}
{"timestamp": 1557218940, "timesteps_since_restore": 7009206, "training_iteration": 164, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-49-00", "episode_reward_min": 29.398996896922, "timesteps_this_iter": 41982, "episode_reward_mean": 1248.4980620270778, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 164, "custom_metrics": {"cost2_mean": -52.6790537805321, "cost2_min": -83.34775039736759, "cost1_mean": 354.3179925339948, "outflow_rate_min": 317.5287350200169, "system_level_velocity_mean": 14.144107483136395, "cost1_max": 438.4607359607624, "cost1_min": 18.07721006400532, "cost2_max": -7.5906742049302265, "outflow_rate_mean": 1214.6785678218173, "system_level_velocity_min": 10.997131854311371, "outflow_rate_max": 1451.9260251748253, "system_level_velocity_max": 19.07543498947914}, "info": {"num_steps_trained": 7009206, "load_time_ms": 12.608, "grad_time_ms": 8723.845, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01223713718354702, "total_loss": 14.113574981689453, "vf_loss": 14.1166410446167, "policy_loss": -0.005389540456235409, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9608697295188904, "entropy": 1.0737543106079102}, "update_time_ms": 8.052, "num_steps_sampled": 7009206, "sample_time_ms": 16310.14}, "episode_len_mean": 673.49, "time_this_iter_s": 25.38900589942932, "num_metric_batches_dropped": 0, "timesteps_total": 7009206, "episodes_total": 2589, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc8be0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc80f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc8208>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1453.7133873889616, "episodes_this_iter": 17, "time_total_s": 4224.088833332062, "time_since_restore": 4224.088833332062}
{"timestamp": 1557218966, "timesteps_since_restore": 7050356, "training_iteration": 165, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-49-26", "episode_reward_min": 29.398996896922, "timesteps_this_iter": 41150, "episode_reward_mean": 1236.453723213429, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 165, "custom_metrics": {"cost2_mean": -52.50873417867669, "cost2_min": -83.34775039736759, "cost1_mean": 352.1539351590468, "outflow_rate_min": 317.5287350200169, "system_level_velocity_mean": 14.179981412224889, "cost1_max": 438.4607359607624, "cost1_min": 18.07721006400532, "cost2_max": -7.5906742049302265, "outflow_rate_mean": 1209.809549817768, "system_level_velocity_min": 10.598602980733004, "outflow_rate_max": 1451.9260251748253, "system_level_velocity_max": 19.07543498947914}, "info": {"num_steps_trained": 7050356, "load_time_ms": 12.471, "grad_time_ms": 8642.346, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013210969977080822, "total_loss": 15.696313858032227, "vf_loss": 15.700243949890137, "policy_loss": -0.006440060678869486, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9540359377861023, "entropy": 1.098900556564331}, "update_time_ms": 8.061, "num_steps_sampled": 7050356, "sample_time_ms": 16428.264}, "episode_len_mean": 669.45, "time_this_iter_s": 25.863213539123535, "num_metric_batches_dropped": 0, "timesteps_total": 7050356, "episodes_total": 2608, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd349b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd343c8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1453.7133873889616, "episodes_this_iter": 19, "time_total_s": 4249.952046871185, "time_since_restore": 4249.952046871185}
{"timestamp": 1557218991, "timesteps_since_restore": 7090882, "training_iteration": 166, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-49-51", "episode_reward_min": 29.398996896922, "timesteps_this_iter": 40526, "episode_reward_mean": 1235.1068652168829, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 166, "custom_metrics": {"cost2_mean": -52.811022213166545, "cost2_min": -83.34775039736759, "cost1_mean": 353.58863413778903, "outflow_rate_min": 317.5287350200169, "system_level_velocity_mean": 14.164739706765927, "cost1_max": 438.4607359607624, "cost1_min": 18.07721006400532, "cost2_max": -7.5906742049302265, "outflow_rate_mean": 1209.5578691082635, "system_level_velocity_min": 10.598602980733004, "outflow_rate_max": 1455.7457198801199, "system_level_velocity_max": 19.07543498947914}, "info": {"num_steps_trained": 7090882, "load_time_ms": 12.221, "grad_time_ms": 8604.466, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01409967616200447, "total_loss": 11.961971282958984, "vf_loss": 11.965277671813965, "policy_loss": -0.00598272355273366, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9654841423034668, "entropy": 1.0927917957305908}, "update_time_ms": 8.057, "num_steps_sampled": 7090882, "sample_time_ms": 16469.131}, "episode_len_mean": 673.28, "time_this_iter_s": 24.630202770233154, "num_metric_batches_dropped": 0, "timesteps_total": 7090882, "episodes_total": 2623, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd391d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39080>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1453.7133873889616, "episodes_this_iter": 15, "time_total_s": 4274.5822496414185, "time_since_restore": 4274.5822496414185}
{"timestamp": 1557219015, "timesteps_since_restore": 7132548, "training_iteration": 167, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-50-15", "episode_reward_min": 29.398996896922, "timesteps_this_iter": 41666, "episode_reward_mean": 1240.7843579370203, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 167, "custom_metrics": {"cost2_mean": -51.97666537967332, "cost2_min": -83.34775039736759, "cost1_mean": 356.07662973347493, "outflow_rate_min": 317.5287350200169, "system_level_velocity_mean": 14.158226724772998, "cost1_max": 438.4607359607624, "cost1_min": 18.07721006400532, "cost2_max": -7.5906742049302265, "outflow_rate_mean": 1215.6289785132378, "system_level_velocity_min": 10.598602980733004, "outflow_rate_max": 1455.7457198801199, "system_level_velocity_max": 19.07543498947914}, "info": {"num_steps_trained": 7132548, "load_time_ms": 12.903, "grad_time_ms": 8655.026, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011578606441617012, "total_loss": 20.06639289855957, "vf_loss": 20.06879997253418, "policy_loss": -0.004605122841894627, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9263021349906921, "entropy": 1.052706241607666}, "update_time_ms": 8.028, "num_steps_sampled": 7132548, "sample_time_ms": 16379.325}, "episode_len_mean": 678.27, "time_this_iter_s": 23.969064712524414, "num_metric_batches_dropped": 0, "timesteps_total": 7132548, "episodes_total": 2639, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39668>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39710>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1453.7133873889616, "episodes_this_iter": 16, "time_total_s": 4298.551314353943, "time_since_restore": 4298.551314353943}
{"timestamp": 1557219040, "timesteps_since_restore": 7173665, "training_iteration": 168, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-50-40", "episode_reward_min": 29.398996896922, "timesteps_this_iter": 41117, "episode_reward_mean": 1225.0055019571407, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 168, "custom_metrics": {"cost2_mean": -52.21910866881913, "cost2_min": -83.34775039736759, "cost1_mean": 354.7882292312977, "outflow_rate_min": 317.5287350200169, "system_level_velocity_mean": 14.315064128182486, "cost1_max": 438.4607359607624, "cost1_min": 18.07721006400532, "cost2_max": -7.5906742049302265, "outflow_rate_mean": 1211.4900697078087, "system_level_velocity_min": 10.598602980733004, "outflow_rate_max": 1489.9899364635367, "system_level_velocity_max": 19.344741046558838}, "info": {"num_steps_trained": 7173665, "load_time_ms": 13.015, "grad_time_ms": 8680.103, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012561117298901081, "total_loss": 16.5506591796875, "vf_loss": 16.553844451904297, "policy_loss": -0.005570721346884966, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9589149951934814, "entropy": 1.0838935375213623}, "update_time_ms": 7.848, "num_steps_sampled": 7173665, "sample_time_ms": 16224.727}, "episode_len_mean": 671.7, "time_this_iter_s": 24.660844802856445, "num_metric_batches_dropped": 0, "timesteps_total": 7173665, "episodes_total": 2656, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd349e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd347b8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1445.1675860237497, "episodes_this_iter": 17, "time_total_s": 4323.212159156799, "time_since_restore": 4323.212159156799}
{"timestamp": 1557219065, "timesteps_since_restore": 7214650, "training_iteration": 169, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-51-05", "episode_reward_min": 56.805061155545516, "timesteps_this_iter": 40985, "episode_reward_mean": 1236.4393153176452, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 169, "custom_metrics": {"cost2_mean": -52.5136369606364, "cost2_min": -83.34775039736759, "cost1_mean": 360.8695015112609, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.393632933377013, "cost1_max": 461.3474311877022, "cost1_min": 28.7334918809984, "cost2_max": -10.440541277607304, "outflow_rate_mean": 1222.860251426916, "system_level_velocity_min": 10.598602980733004, "outflow_rate_max": 1489.9899364635367, "system_level_velocity_max": 19.344741046558838}, "info": {"num_steps_trained": 7214650, "load_time_ms": 13.21, "grad_time_ms": 8825.582, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01263115368783474, "total_loss": 15.870051383972168, "vf_loss": 15.8723726272583, "policy_loss": -0.004717613570392132, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9558225870132446, "entropy": 1.0931216478347778}, "update_time_ms": 7.991, "num_steps_sampled": 7214650, "sample_time_ms": 16150.9}, "episode_len_mean": 678.01, "time_this_iter_s": 25.477998971939087, "num_metric_batches_dropped": 0, "timesteps_total": 7214650, "episodes_total": 2675, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3ca58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c898>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5645972533398, "episodes_this_iter": 19, "time_total_s": 4348.690158128738, "time_since_restore": 4348.690158128738}
{"timestamp": 1557219090, "timesteps_since_restore": 7256119, "training_iteration": 170, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-51-30", "episode_reward_min": 56.805061155545516, "timesteps_this_iter": 41469, "episode_reward_mean": 1228.4641295419083, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 170, "custom_metrics": {"cost2_mean": -54.27626148293034, "cost2_min": -86.52751182905226, "cost1_mean": 362.0564518464631, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.450925579170349, "cost1_max": 461.3474311877022, "cost1_min": 28.7334918809984, "cost2_max": -10.440541277607304, "outflow_rate_mean": 1218.8271576906525, "system_level_velocity_min": 10.598602980733004, "outflow_rate_max": 1489.9899364635367, "system_level_velocity_max": 19.344741046558838}, "info": {"num_steps_trained": 7256119, "load_time_ms": 13.021, "grad_time_ms": 8982.188, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011351250112056732, "total_loss": 11.154726028442383, "vf_loss": 11.158773422241211, "policy_loss": -0.006201652344316244, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9677264094352722, "entropy": 1.0894126892089844}, "update_time_ms": 7.743, "num_steps_sampled": 7256119, "sample_time_ms": 16020.934}, "episode_len_mean": 678.01, "time_this_iter_s": 25.328166961669922, "num_metric_batches_dropped": 0, "timesteps_total": 7256119, "episodes_total": 2690, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c9b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c8d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5645972533398, "episodes_this_iter": 15, "time_total_s": 4374.018325090408, "time_since_restore": 4374.018325090408}
{"timestamp": 1557219116, "timesteps_since_restore": 7298158, "training_iteration": 171, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-51-56", "episode_reward_min": 56.805061155545516, "timesteps_this_iter": 42039, "episode_reward_mean": 1230.7522948253797, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 171, "custom_metrics": {"cost2_mean": -55.25923676282061, "cost2_min": -86.52751182905226, "cost1_mean": 363.3223363509528, "outflow_rate_min": 340.0431742023662, "system_level_velocity_mean": 14.576321275814571, "cost1_max": 461.3474311877022, "cost1_min": 28.7334918809984, "cost2_max": -10.440541277607304, "outflow_rate_mean": 1223.5270734907933, "system_level_velocity_min": 11.096225639560123, "outflow_rate_max": 1489.9899364635367, "system_level_velocity_max": 19.344741046558838}, "info": {"num_steps_trained": 7298158, "load_time_ms": 12.811, "grad_time_ms": 9291.711, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01456465944647789, "total_loss": 15.118926048278809, "vf_loss": 15.121980667114258, "policy_loss": -0.005820621270686388, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9457842111587524, "entropy": 1.0439726114273071}, "update_time_ms": 7.865, "num_steps_sampled": 7298158, "sample_time_ms": 15772.99}, "episode_len_mean": 674.43, "time_this_iter_s": 25.206989288330078, "num_metric_batches_dropped": 0, "timesteps_total": 7298158, "episodes_total": 2704, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd348d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34ba8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5645972533398, "episodes_this_iter": 14, "time_total_s": 4399.225314378738, "time_since_restore": 4399.225314378738}
{"timestamp": 1557219142, "timesteps_since_restore": 7340045, "training_iteration": 172, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-52-22", "episode_reward_min": 56.805061155545516, "timesteps_this_iter": 41887, "episode_reward_mean": 1236.30299870713, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 172, "custom_metrics": {"cost2_mean": -55.494406285600064, "cost2_min": -86.52751182905226, "cost1_mean": 363.10879752660236, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.657774725795507, "cost1_max": 461.3474311877022, "cost1_min": 28.7334918809984, "cost2_max": -10.440541277607304, "outflow_rate_mean": 1224.9769002671562, "system_level_velocity_min": 11.096225639560123, "outflow_rate_max": 1489.9899364635367, "system_level_velocity_max": 19.344741046558838}, "info": {"num_steps_trained": 7340045, "load_time_ms": 12.999, "grad_time_ms": 9554.357, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013364467769861221, "total_loss": 19.504287719726562, "vf_loss": 19.506065368652344, "policy_loss": -0.004314077086746693, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9377431869506836, "entropy": 1.0618840456008911}, "update_time_ms": 7.694, "num_steps_sampled": 7340045, "sample_time_ms": 15594.192}, "episode_len_mean": 671.55, "time_this_iter_s": 26.13398838043213, "num_metric_batches_dropped": 0, "timesteps_total": 7340045, "episodes_total": 2723, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd344e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd1bfd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34eb8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5645972533398, "episodes_this_iter": 19, "time_total_s": 4425.3593027591705, "time_since_restore": 4425.3593027591705}
{"timestamp": 1557219167, "timesteps_since_restore": 7381021, "training_iteration": 173, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-52-47", "episode_reward_min": 56.805061155545516, "timesteps_this_iter": 40976, "episode_reward_mean": 1219.94703612813, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 173, "custom_metrics": {"cost2_mean": -56.58909250059, "cost2_min": -86.52751182905226, "cost1_mean": 358.2582993792057, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.694438043892685, "cost1_max": 461.3474311877022, "cost1_min": 28.7334918809984, "cost2_max": -10.440541277607304, "outflow_rate_mean": 1208.2671006336966, "system_level_velocity_min": 11.096225639560123, "outflow_rate_max": 1489.9899364635367, "system_level_velocity_max": 19.344741046558838}, "info": {"num_steps_trained": 7381021, "load_time_ms": 12.88, "grad_time_ms": 9724.792, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013600963167846203, "total_loss": 16.50074577331543, "vf_loss": 16.503704071044922, "policy_loss": -0.0055402591824531555, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9498192071914673, "entropy": 1.0834077596664429}, "update_time_ms": 7.77, "num_steps_sampled": 7381021, "sample_time_ms": 15318.21}, "episode_len_mean": 662.25, "time_this_iter_s": 24.819692134857178, "num_metric_batches_dropped": 0, "timesteps_total": 7381021, "episodes_total": 2741, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c8d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5645972533398, "episodes_this_iter": 18, "time_total_s": 4450.178994894028, "time_since_restore": 4450.178994894028}
{"timestamp": 1557219193, "timesteps_since_restore": 7422498, "training_iteration": 174, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-53-13", "episode_reward_min": 57.01124905230162, "timesteps_this_iter": 41477, "episode_reward_mean": 1218.4267758159833, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 174, "custom_metrics": {"cost2_mean": -55.73509546685907, "cost2_min": -86.52751182905226, "cost1_mean": 352.57570574660394, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.60798086419303, "cost1_max": 446.4968208829315, "cost1_min": 28.883565246065142, "cost2_max": -10.910335444494228, "outflow_rate_mean": 1195.17407226463, "system_level_velocity_min": 11.096225639560123, "outflow_rate_max": 1464.47751008991, "system_level_velocity_max": 19.703055477169606}, "info": {"num_steps_trained": 7422498, "load_time_ms": 12.738, "grad_time_ms": 10007.108, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013316201977431774, "total_loss": 19.1455078125, "vf_loss": 19.150041580200195, "policy_loss": -0.007062795106321573, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9313539266586304, "entropy": 1.1204434633255005}, "update_time_ms": 7.944, "num_steps_sampled": 7422498, "sample_time_ms": 15134.164}, "episode_len_mean": 656.63, "time_this_iter_s": 26.40861940383911, "num_metric_batches_dropped": 0, "timesteps_total": 7422498, "episodes_total": 2760, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbfd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd26be0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5645972533398, "episodes_this_iter": 19, "time_total_s": 4476.587614297867, "time_since_restore": 4476.587614297867}
{"timestamp": 1557219218, "timesteps_since_restore": 7464527, "training_iteration": 175, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-53-38", "episode_reward_min": 57.01124905230162, "timesteps_this_iter": 42029, "episode_reward_mean": 1226.492092889923, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 175, "custom_metrics": {"cost2_mean": -55.42574159106734, "cost2_min": -86.52751182905226, "cost1_mean": 355.28977870576347, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.562852666808622, "cost1_max": 446.4968208829315, "cost1_min": 28.883565246065142, "cost2_max": -10.910335444494228, "outflow_rate_mean": 1202.3408979078747, "system_level_velocity_min": 11.096225639560123, "outflow_rate_max": 1464.47751008991, "system_level_velocity_max": 19.703055477169606}, "info": {"num_steps_trained": 7464527, "load_time_ms": 12.799, "grad_time_ms": 10137.564, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013386379927396774, "total_loss": 11.21432876586914, "vf_loss": 11.218541145324707, "policy_loss": -0.0067540863528847694, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9624847769737244, "entropy": 1.1032724380493164}, "update_time_ms": 8.179, "num_steps_sampled": 7464527, "sample_time_ms": 14954.621}, "episode_len_mean": 662.12, "time_this_iter_s": 25.38553476333618, "num_metric_batches_dropped": 0, "timesteps_total": 7464527, "episodes_total": 2774, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd25c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2240>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1485.1780778148595, "episodes_this_iter": 14, "time_total_s": 4501.973149061203, "time_since_restore": 4501.973149061203}
{"timestamp": 1557219243, "timesteps_since_restore": 7506481, "training_iteration": 176, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-54-03", "episode_reward_min": 57.01124905230162, "timesteps_this_iter": 41954, "episode_reward_mean": 1211.516750665174, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 176, "custom_metrics": {"cost2_mean": -53.68354470296065, "cost2_min": -83.60082757389071, "cost1_mean": 347.1171193853705, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.52315338521483, "cost1_max": 446.4968208829315, "cost1_min": 28.883565246065142, "cost2_max": -10.910335444494228, "outflow_rate_mean": 1184.819350182225, "system_level_velocity_min": 11.096225639560123, "outflow_rate_max": 1464.47751008991, "system_level_velocity_max": 20.18323738866194}, "info": {"num_steps_trained": 7506481, "load_time_ms": 12.877, "grad_time_ms": 10162.59, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012668210081756115, "total_loss": 13.280640602111816, "vf_loss": 13.28360652923584, "policy_loss": -0.005370276514440775, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9570440649986267, "entropy": 1.0819201469421387}, "update_time_ms": 8.427, "num_steps_sampled": 7506481, "sample_time_ms": 14881.729}, "episode_len_mean": 651.25, "time_this_iter_s": 24.174263954162598, "num_metric_batches_dropped": 0, "timesteps_total": 7506481, "episodes_total": 2789, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2518>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd25f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2e10>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1485.1780778148595, "episodes_this_iter": 15, "time_total_s": 4526.147413015366, "time_since_restore": 4526.147413015366}
{"timestamp": 1557219268, "timesteps_since_restore": 7548676, "training_iteration": 177, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-54-28", "episode_reward_min": 57.01124905230162, "timesteps_this_iter": 42195, "episode_reward_mean": 1191.0420392062888, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 177, "custom_metrics": {"cost2_mean": -52.48261483892139, "cost2_min": -81.53272666703788, "cost1_mean": 341.6362426297381, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 14.507511731551435, "cost1_max": 446.4968208829315, "cost1_min": 28.883565246065142, "cost2_max": -9.233552814338172, "outflow_rate_mean": 1164.8666791052126, "system_level_velocity_min": 11.610328983642955, "outflow_rate_max": 1464.47751008991, "system_level_velocity_max": 20.18323738866194}, "info": {"num_steps_trained": 7548676, "load_time_ms": 12.521, "grad_time_ms": 10080.832, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013402199372649193, "total_loss": 15.142642974853516, "vf_loss": 15.144746780395508, "policy_loss": -0.004646549932658672, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9525575041770935, "entropy": 1.108986735343933}, "update_time_ms": 8.815, "num_steps_sampled": 7548676, "sample_time_ms": 15052.254}, "episode_len_mean": 643.65, "time_this_iter_s": 24.863579988479614, "num_metric_batches_dropped": 0, "timesteps_total": 7548676, "episodes_total": 2809, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39ac8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39748>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1472.26572963267, "episodes_this_iter": 20, "time_total_s": 4551.010993003845, "time_since_restore": 4551.010993003845}
{"timestamp": 1557219293, "timesteps_since_restore": 7589619, "training_iteration": 178, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-54-53", "episode_reward_min": 57.01124905230162, "timesteps_this_iter": 40943, "episode_reward_mean": 1209.8825297475178, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 178, "custom_metrics": {"cost2_mean": -53.64736474118348, "cost2_min": -82.65263921263318, "cost1_mean": 345.8894612521385, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.362820842085583, "cost1_max": 446.4968208829315, "cost1_min": 28.883565246065142, "cost2_max": -9.233552814338172, "outflow_rate_mean": 1172.1591635761374, "system_level_velocity_min": 11.610328983642955, "outflow_rate_max": 1441.105165234765, "system_level_velocity_max": 20.18323738866194}, "info": {"num_steps_trained": 7589619, "load_time_ms": 12.25, "grad_time_ms": 9984.284, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012836091220378876, "total_loss": 9.70215129852295, "vf_loss": 9.705280303955078, "policy_loss": -0.005565118510276079, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9704723954200745, "entropy": 1.068014144897461}, "update_time_ms": 9.015, "num_steps_sampled": 7589619, "sample_time_ms": 15202.878}, "episode_len_mean": 654.95, "time_this_iter_s": 25.210862159729004, "num_metric_batches_dropped": 0, "timesteps_total": 7589619, "episodes_total": 2822, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd22e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c8d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1472.26572963267, "episodes_this_iter": 13, "time_total_s": 4576.221855163574, "time_since_restore": 4576.221855163574}
{"timestamp": 1557219318, "timesteps_since_restore": 7630931, "training_iteration": 179, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-55-18", "episode_reward_min": 57.01124905230162, "timesteps_this_iter": 41312, "episode_reward_mean": 1222.761749405015, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 179, "custom_metrics": {"cost2_mean": -55.0623064790088, "cost2_min": -89.03929527763651, "cost1_mean": 351.1993416236637, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.403299057074635, "cost1_max": 446.4968208829315, "cost1_min": 28.883565246065142, "cost2_max": -9.233552814338172, "outflow_rate_mean": 1186.893512248774, "system_level_velocity_min": 11.610328983642955, "outflow_rate_max": 1441.105165234765, "system_level_velocity_max": 20.18323738866194}, "info": {"num_steps_trained": 7630931, "load_time_ms": 11.861, "grad_time_ms": 9813.011, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012697857804596424, "total_loss": 9.762222290039062, "vf_loss": 9.766347885131836, "policy_loss": -0.0065376595593988895, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9697493314743042, "entropy": 1.075789451599121}, "update_time_ms": 9.121, "num_steps_sampled": 7630931, "sample_time_ms": 15361.575}, "episode_len_mean": 660.88, "time_this_iter_s": 25.343080759048462, "num_metric_batches_dropped": 0, "timesteps_total": 7630931, "episodes_total": 2839, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbcc0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb8d0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1494.4565271743666, "episodes_this_iter": 17, "time_total_s": 4601.564935922623, "time_since_restore": 4601.564935922623}
{"timestamp": 1557219344, "timesteps_since_restore": 7673055, "training_iteration": 180, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-55-44", "episode_reward_min": 58.32725473883474, "timesteps_this_iter": 42124, "episode_reward_mean": 1251.1094605533735, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 180, "custom_metrics": {"cost2_mean": -57.1146890071584, "cost2_min": -89.03929527763651, "cost1_mean": 360.3456989268116, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.30521985391064, "cost1_max": 432.6403947247777, "cost1_min": 29.444810859218208, "cost2_max": -9.233552814338172, "outflow_rate_mean": 1212.0036657067699, "system_level_velocity_min": 11.610328983642955, "outflow_rate_max": 1479.4440123876125, "system_level_velocity_max": 20.18323738866194}, "info": {"num_steps_trained": 7673055, "load_time_ms": 12.182, "grad_time_ms": 9600.529, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015665002167224884, "total_loss": 15.591537475585938, "vf_loss": 15.595967292785645, "policy_loss": -0.007405414246022701, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9578105807304382, "entropy": 1.0609031915664673}, "update_time_ms": 9.153, "num_steps_sampled": 7673055, "sample_time_ms": 15597.613}, "episode_len_mean": 677.95, "time_this_iter_s": 25.58734107017517, "num_metric_batches_dropped": 0, "timesteps_total": 7673055, "episodes_total": 2857, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34c88>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34f28>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1494.4565271743666, "episodes_this_iter": 18, "time_total_s": 4627.152276992798, "time_since_restore": 4627.152276992798}
{"timestamp": 1557219369, "timesteps_since_restore": 7715691, "training_iteration": 181, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-56-09", "episode_reward_min": 58.32725473883474, "timesteps_this_iter": 42636, "episode_reward_mean": 1236.1381071081241, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 181, "custom_metrics": {"cost2_mean": -58.01499878864496, "cost2_min": -89.03929527763651, "cost1_mean": 357.8775628579689, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.459157365174542, "cost1_max": 440.891718726505, "cost1_min": 29.444810859218208, "cost2_max": -9.233552814338172, "outflow_rate_mean": 1205.814480863473, "system_level_velocity_min": 11.610328983642955, "outflow_rate_max": 1479.4440123876125, "system_level_velocity_max": 20.18323738866194}, "info": {"num_steps_trained": 7715691, "load_time_ms": 12.011, "grad_time_ms": 9384.43, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014408675953745842, "total_loss": 12.258795738220215, "vf_loss": 12.261283874511719, "policy_loss": -0.005224859341979027, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9665922522544861, "entropy": 1.070671558380127}, "update_time_ms": 9.009, "num_steps_sampled": 7715691, "sample_time_ms": 15766.793}, "episode_len_mean": 668.18, "time_this_iter_s": 24.737770795822144, "num_metric_batches_dropped": 0, "timesteps_total": 7715691, "episodes_total": 2871, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc60b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1494.4565271743666, "episodes_this_iter": 14, "time_total_s": 4651.89004778862, "time_since_restore": 4651.89004778862}
{"timestamp": 1557219396, "timesteps_since_restore": 7758532, "training_iteration": 182, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-56-36", "episode_reward_min": 68.96260787954428, "timesteps_this_iter": 42841, "episode_reward_mean": 1253.8043215414718, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 182, "custom_metrics": {"cost2_mean": -60.25690400718326, "cost2_min": -90.23472927022654, "cost1_mean": 362.4314482753039, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.472607323329937, "cost1_max": 440.891718726505, "cost1_min": 33.19772695248186, "cost2_max": -9.233552814338172, "outflow_rate_mean": 1220.2531050043706, "system_level_velocity_min": 11.765108244250733, "outflow_rate_max": 1483.5694117882117, "system_level_velocity_max": 18.626470670859995}, "info": {"num_steps_trained": 7758532, "load_time_ms": 12.505, "grad_time_ms": 9153.679, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013649897649884224, "total_loss": 10.70371150970459, "vf_loss": 10.706624984741211, "policy_loss": -0.005504198372364044, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9737080931663513, "entropy": 1.079454779624939}, "update_time_ms": 8.909, "num_steps_sampled": 7758532, "sample_time_ms": 16116.186}, "episode_len_mean": 674.19, "time_this_iter_s": 27.321165323257446, "num_metric_batches_dropped": 0, "timesteps_total": 7758532, "episodes_total": 2889, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc62b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc67f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6278>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1494.4565271743666, "episodes_this_iter": 18, "time_total_s": 4679.211213111877, "time_since_restore": 4679.211213111877}
{"timestamp": 1557219421, "timesteps_since_restore": 7801026, "training_iteration": 183, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-57-01", "episode_reward_min": 60.265473980407386, "timesteps_this_iter": 42494, "episode_reward_mean": 1244.234846875259, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 183, "custom_metrics": {"cost2_mean": -61.69180392966411, "cost2_min": -90.23472927022654, "cost1_mean": 359.15446566638997, "outflow_rate_min": 329.0289964895558, "system_level_velocity_mean": 14.565216750561312, "cost1_max": 448.68338699761426, "cost1_min": 29.536132245209, "cost2_max": -8.329575570831743, "outflow_rate_mean": 1213.428506603165, "system_level_velocity_min": 11.765108244250733, "outflow_rate_max": 1483.5694117882117, "system_level_velocity_max": 18.658550481435086}, "info": {"num_steps_trained": 7801026, "load_time_ms": 12.77, "grad_time_ms": 8914.279, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015440993010997772, "total_loss": 17.052757263183594, "vf_loss": 17.05600357055664, "policy_loss": -0.006178281269967556, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.953537106513977, "entropy": 1.124413013458252}, "update_time_ms": 8.707, "num_steps_sampled": 7801026, "sample_time_ms": 16429.665}, "episode_len_mean": 666.45, "time_this_iter_s": 25.53273844718933, "num_metric_batches_dropped": 0, "timesteps_total": 7801026, "episodes_total": 2906, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd20b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd24e0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5775610724786, "episodes_this_iter": 17, "time_total_s": 4704.743951559067, "time_since_restore": 4704.743951559067}
{"timestamp": 1557219448, "timesteps_since_restore": 7843851, "training_iteration": 184, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-57-28", "episode_reward_min": 60.265473980407386, "timesteps_this_iter": 42825, "episode_reward_mean": 1258.9255309273578, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 184, "custom_metrics": {"cost2_mean": -63.43075757423733, "cost2_min": -90.23472927022654, "cost1_mean": 362.281747976983, "outflow_rate_min": 329.0289964895558, "system_level_velocity_mean": 14.516194876914119, "cost1_max": 448.68338699761426, "cost1_min": 29.536132245209, "cost2_max": -8.329575570831743, "outflow_rate_mean": 1221.5714501681616, "system_level_velocity_min": 11.765108244250733, "outflow_rate_max": 1483.5694117882117, "system_level_velocity_max": 18.658550481435086}, "info": {"num_steps_trained": 7843851, "load_time_ms": 13.313, "grad_time_ms": 8690.847, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01412016898393631, "total_loss": 7.229498863220215, "vf_loss": 7.23368501663208, "policy_loss": -0.006867168936878443, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9779730439186096, "entropy": 1.1102733612060547}, "update_time_ms": 8.464, "num_steps_sampled": 7843851, "sample_time_ms": 16649.876}, "episode_len_mean": 672.95, "time_this_iter_s": 26.352729558944702, "num_metric_batches_dropped": 0, "timesteps_total": 7843851, "episodes_total": 2920, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd347f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd32fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34d68>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5775610724786, "episodes_this_iter": 14, "time_total_s": 4731.0966811180115, "time_since_restore": 4731.0966811180115}
{"timestamp": 1557219474, "timesteps_since_restore": 7886191, "training_iteration": 185, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-57-54", "episode_reward_min": 60.265473980407386, "timesteps_this_iter": 42340, "episode_reward_mean": 1259.632018845566, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 185, "custom_metrics": {"cost2_mean": -63.78215594330485, "cost2_min": -90.23472927022654, "cost1_mean": 361.0728785624875, "outflow_rate_min": 329.0289964895558, "system_level_velocity_mean": 14.48356995760728, "cost1_max": 448.68338699761426, "cost1_min": 29.536132245209, "cost2_max": -8.329575570831743, "outflow_rate_mean": 1219.3243410033265, "system_level_velocity_min": 11.765108244250733, "outflow_rate_max": 1518.469184015984, "system_level_velocity_max": 18.658550481435086}, "info": {"num_steps_trained": 7886191, "load_time_ms": 13.369, "grad_time_ms": 8583.359, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014703064225614071, "total_loss": 11.480874061584473, "vf_loss": 11.483963966369629, "policy_loss": -0.005881353747099638, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9652842879295349, "entropy": 1.0821077823638916}, "update_time_ms": 8.17, "num_steps_sampled": 7886191, "sample_time_ms": 16810.653}, "episode_len_mean": 672.95, "time_this_iter_s": 25.9131760597229, "num_metric_batches_dropped": 0, "timesteps_total": 7886191, "episodes_total": 2936, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb908>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb240>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5775610724786, "episodes_this_iter": 16, "time_total_s": 4757.009857177734, "time_since_restore": 4757.009857177734}
{"timestamp": 1557219500, "timesteps_since_restore": 7927959, "training_iteration": 186, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-58-20", "episode_reward_min": 60.265473980407386, "timesteps_this_iter": 41768, "episode_reward_mean": 1249.2194042821204, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 186, "custom_metrics": {"cost2_mean": -63.535479160106796, "cost2_min": -90.23472927022654, "cost1_mean": 360.1028878293645, "outflow_rate_min": 329.0289964895558, "system_level_velocity_mean": 14.557653668295481, "cost1_max": 448.68338699761426, "cost1_min": 29.536132245209, "cost2_max": -8.329575570831743, "outflow_rate_mean": 1217.333387173633, "system_level_velocity_min": 11.765108244250733, "outflow_rate_max": 1518.469184015984, "system_level_velocity_max": 18.658550481435086}, "info": {"num_steps_trained": 7927959, "load_time_ms": 13.312, "grad_time_ms": 8689.183, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013552194461226463, "total_loss": 12.584753036499023, "vf_loss": 12.588862419128418, "policy_loss": -0.006683198735117912, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9638433456420898, "entropy": 1.0694866180419922}, "update_time_ms": 7.936, "num_steps_sampled": 7927959, "sample_time_ms": 16909.294}, "episode_len_mean": 668.59, "time_this_iter_s": 26.212562561035156, "num_metric_batches_dropped": 0, "timesteps_total": 7927959, "episodes_total": 2951, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb208>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5775610724786, "episodes_this_iter": 15, "time_total_s": 4783.2224197387695, "time_since_restore": 4783.2224197387695}
{"timestamp": 1557219525, "timesteps_since_restore": 7967816, "training_iteration": 187, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-58-45", "episode_reward_min": 60.265473980407386, "timesteps_this_iter": 39857, "episode_reward_mean": 1239.6786517873077, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 187, "custom_metrics": {"cost2_mean": -62.43496764490952, "cost2_min": -90.23472927022654, "cost1_mean": 354.57682258856215, "outflow_rate_min": 329.0289964895558, "system_level_velocity_mean": 14.36213124871112, "cost1_max": 448.68338699761426, "cost1_min": 29.536132245209, "cost2_max": -8.329575570831743, "outflow_rate_mean": 1200.4116353928357, "system_level_velocity_min": 11.42230123042929, "outflow_rate_max": 1518.469184015984, "system_level_velocity_max": 18.658550481435086}, "info": {"num_steps_trained": 7967816, "load_time_ms": 13.337, "grad_time_ms": 8727.339, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015746694058179855, "total_loss": 20.703048706054688, "vf_loss": 20.70676040649414, "policy_loss": -0.0067007532343268394, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9394621253013611, "entropy": 1.0345759391784668}, "update_time_ms": 7.853, "num_steps_sampled": 7967816, "sample_time_ms": 16892.081}, "episode_len_mean": 668.1, "time_this_iter_s": 25.093836307525635, "num_metric_batches_dropped": 0, "timesteps_total": 7967816, "episodes_total": 2969, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd20b8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5775610724786, "episodes_this_iter": 18, "time_total_s": 4808.316256046295, "time_since_restore": 4808.316256046295}
{"timestamp": 1557219550, "timesteps_since_restore": 8009209, "training_iteration": 188, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-59-10", "episode_reward_min": 60.265473980407386, "timesteps_this_iter": 41393, "episode_reward_mean": 1228.0037810385736, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 188, "custom_metrics": {"cost2_mean": -59.28616214438737, "cost2_min": -84.116798242528, "cost1_mean": 354.77791178381557, "outflow_rate_min": 329.0289964895558, "system_level_velocity_mean": 14.505921010247869, "cost1_max": 448.68338699761426, "cost1_min": 29.536132245209, "cost2_max": -8.329575570831743, "outflow_rate_mean": 1208.7340132992438, "system_level_velocity_min": 11.42230123042929, "outflow_rate_max": 1518.469184015984, "system_level_velocity_max": 18.658550481435086}, "info": {"num_steps_trained": 8009209, "load_time_ms": 14.286, "grad_time_ms": 8840.426, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015153936110436916, "total_loss": 23.585060119628906, "vf_loss": 23.588592529296875, "policy_loss": -0.006409976631402969, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9300738573074341, "entropy": 1.0605120658874512}, "update_time_ms": 7.949, "num_steps_sampled": 8009209, "sample_time_ms": 16760.766}, "episode_len_mean": 663.16, "time_this_iter_s": 25.05182147026062, "num_metric_batches_dropped": 0, "timesteps_total": 8009209, "episodes_total": 2989, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd23c8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1496.5775610724786, "episodes_this_iter": 20, "time_total_s": 4833.368077516556, "time_since_restore": 4833.368077516556}
{"timestamp": 1557219574, "timesteps_since_restore": 8050879, "training_iteration": 189, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-59-34", "episode_reward_min": 230.95842729675138, "timesteps_this_iter": 41670, "episode_reward_mean": 1247.056014756442, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 189, "custom_metrics": {"cost2_mean": -58.76165060242169, "cost2_min": -84.116798242528, "cost1_mean": 361.8578026864917, "outflow_rate_min": 542.0653228559187, "system_level_velocity_mean": 14.454035905334, "cost1_max": 433.48745664707684, "cost1_min": 96.05245274023487, "cost2_max": -20.069428718351233, "outflow_rate_mean": 1223.953653088648, "system_level_velocity_min": 11.42230123042929, "outflow_rate_max": 1518.469184015984, "system_level_velocity_max": 18.39757564886118}, "info": {"num_steps_trained": 8050879, "load_time_ms": 14.65, "grad_time_ms": 8954.489, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014181947335600853, "total_loss": 9.643128395080566, "vf_loss": 9.64773178100586, "policy_loss": -0.007297099102288485, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9721837639808655, "entropy": 1.0657716989517212}, "update_time_ms": 7.962, "num_steps_sampled": 8050879, "sample_time_ms": 16519.463}, "episode_len_mean": 675.58, "time_this_iter_s": 24.08248257637024, "num_metric_batches_dropped": 0, "timesteps_total": 8050879, "episodes_total": 3004, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34710>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34390>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1502.0536284284458, "episodes_this_iter": 15, "time_total_s": 4857.450560092926, "time_since_restore": 4857.450560092926}
{"timestamp": 1557219599, "timesteps_since_restore": 8092798, "training_iteration": 190, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_08-59-59", "episode_reward_min": 56.853223919668544, "timesteps_this_iter": 41919, "episode_reward_mean": 1212.749432815321, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 190, "custom_metrics": {"cost2_mean": -55.29538834781916, "cost2_min": -83.9862283564594, "cost1_mean": 356.30924746779783, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.672194199241755, "cost1_max": 433.48745664707684, "cost1_min": 28.86031283138622, "cost2_max": -11.44945086531754, "outflow_rate_mean": 1213.4610034341579, "system_level_velocity_min": 11.42230123042929, "outflow_rate_max": 1518.469184015984, "system_level_velocity_max": 19.45572390987906}, "info": {"num_steps_trained": 8092798, "load_time_ms": 14.638, "grad_time_ms": 8981.93, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01827065460383892, "total_loss": 19.758026123046875, "vf_loss": 19.759841918945312, "policy_loss": -0.0052829887717962265, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9463924765586853, "entropy": 1.0923964977264404}, "update_time_ms": 8.078, "num_steps_sampled": 8092798, "sample_time_ms": 16352.665}, "episode_len_mean": 659.94, "time_this_iter_s": 24.182446241378784, "num_metric_batches_dropped": 0, "timesteps_total": 8092798, "episodes_total": 3020, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cf98>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1502.0536284284458, "episodes_this_iter": 16, "time_total_s": 4881.633006334305, "time_since_restore": 4881.633006334305}
{"timestamp": 1557219624, "timesteps_since_restore": 8133944, "training_iteration": 191, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-00-24", "episode_reward_min": 56.853223919668544, "timesteps_this_iter": 41146, "episode_reward_mean": 1205.8812868830669, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 191, "custom_metrics": {"cost2_mean": -54.903654146551105, "cost2_min": -78.96145272229612, "cost1_mean": 356.47244380843654, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.673297788057187, "cost1_max": 439.3635260637238, "cost1_min": 28.86031283138622, "cost2_max": -11.44945086531754, "outflow_rate_mean": 1212.3115702593327, "system_level_velocity_min": 11.42230123042929, "outflow_rate_max": 1524.8313066933067, "system_level_velocity_max": 19.45572390987906}, "info": {"num_steps_trained": 8133944, "load_time_ms": 14.98, "grad_time_ms": 9001.947, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016171669587492943, "total_loss": 10.518256187438965, "vf_loss": 10.522990226745605, "policy_loss": -0.007805387489497662, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9738509058952332, "entropy": 1.1188673973083496}, "update_time_ms": 8.112, "num_steps_sampled": 8133944, "sample_time_ms": 16388.908}, "episode_len_mean": 659.94, "time_this_iter_s": 25.306453704833984, "num_metric_batches_dropped": 0, "timesteps_total": 8133944, "episodes_total": 3037, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb400>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1502.0536284284458, "episodes_this_iter": 17, "time_total_s": 4906.939460039139, "time_since_restore": 4906.939460039139}
{"timestamp": 1557219650, "timesteps_since_restore": 8174663, "training_iteration": 192, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-00-50", "episode_reward_min": 56.853223919668544, "timesteps_this_iter": 40719, "episode_reward_mean": 1225.3292313098796, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 192, "custom_metrics": {"cost2_mean": -54.87756255907476, "cost2_min": -78.96145272229612, "cost1_mean": 362.2157183039464, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.775410237487527, "cost1_max": 461.9642511408342, "cost1_min": 28.86031283138622, "cost2_max": -11.44945086531754, "outflow_rate_mean": 1223.7299227903247, "system_level_velocity_min": 11.42230123042929, "outflow_rate_max": 1524.8313066933067, "system_level_velocity_max": 19.45572390987906}, "info": {"num_steps_trained": 8174663, "load_time_ms": 14.587, "grad_time_ms": 9036.303, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01521336380392313, "total_loss": 11.58635425567627, "vf_loss": 11.58981990814209, "policy_loss": -0.006353255361318588, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9682585597038269, "entropy": 1.111775517463684}, "update_time_ms": 8.353, "num_steps_sampled": 8174663, "sample_time_ms": 16191.239}, "episode_len_mean": 664.3, "time_this_iter_s": 25.692134618759155, "num_metric_batches_dropped": 0, "timesteps_total": 8174663, "episodes_total": 3055, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34d30>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34f28>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1502.0536284284458, "episodes_this_iter": 18, "time_total_s": 4932.631594657898, "time_since_restore": 4932.631594657898}
{"timestamp": 1557219677, "timesteps_since_restore": 8216084, "training_iteration": 193, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-01-17", "episode_reward_min": 56.853223919668544, "timesteps_this_iter": 41421, "episode_reward_mean": 1218.6177870132653, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 193, "custom_metrics": {"cost2_mean": -54.557120966701035, "cost2_min": -78.01788998844638, "cost1_mean": 362.0834459361844, "outflow_rate_min": 330.1099134487595, "system_level_velocity_mean": 14.822921914801565, "cost1_max": 461.9642511408342, "cost1_min": 28.86031283138622, "cost2_max": -11.44945086531754, "outflow_rate_mean": 1218.4872386701954, "system_level_velocity_min": 12.197247123784653, "outflow_rate_max": 1524.8313066933067, "system_level_velocity_max": 19.45572390987906}, "info": {"num_steps_trained": 8216084, "load_time_ms": 14.599, "grad_time_ms": 9175.982, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01624654233455658, "total_loss": 17.662776947021484, "vf_loss": 17.667272567749023, "policy_loss": -0.007580016274005175, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9492120146751404, "entropy": 1.1195945739746094}, "update_time_ms": 9.054, "num_steps_sampled": 8216084, "sample_time_ms": 16213.98}, "episode_len_mean": 662.5, "time_this_iter_s": 27.18917489051819, "num_metric_batches_dropped": 0, "timesteps_total": 8216084, "episodes_total": 3072, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd345f8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd344e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34cc0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1502.0536284284458, "episodes_this_iter": 17, "time_total_s": 4959.820769548416, "time_since_restore": 4959.820769548416}
{"timestamp": 1557219703, "timesteps_since_restore": 8259005, "training_iteration": 194, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-01-43", "episode_reward_min": 56.853223919668544, "timesteps_this_iter": 42921, "episode_reward_mean": 1204.6191075818574, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 194, "custom_metrics": {"cost2_mean": -54.966535024975656, "cost2_min": -78.01788998844638, "cost1_mean": 356.2686850656486, "outflow_rate_min": 330.1099134487595, "system_level_velocity_mean": 14.800702513872382, "cost1_max": 461.9642511408342, "cost1_min": 28.86031283138622, "cost2_max": -11.318998655512054, "outflow_rate_mean": 1194.7714669851248, "system_level_velocity_min": 12.197247123784653, "outflow_rate_max": 1524.8313066933067, "system_level_velocity_max": 19.45572390987906}, "info": {"num_steps_trained": 8259005, "load_time_ms": 14.161, "grad_time_ms": 9199.779, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014112190343439579, "total_loss": 11.732206344604492, "vf_loss": 11.735244750976562, "policy_loss": -0.005717727821320295, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9660307765007019, "entropy": 1.1278899908065796}, "update_time_ms": 9.188, "num_steps_sampled": 8259005, "sample_time_ms": 16191.053}, "episode_len_mean": 654.6, "time_this_iter_s": 26.38237500190735, "num_metric_batches_dropped": 0, "timesteps_total": 8259005, "episodes_total": 3085, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb5c0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1502.0536284284458, "episodes_this_iter": 13, "time_total_s": 4986.2031445503235, "time_since_restore": 4986.2031445503235}
{"timestamp": 1557219728, "timesteps_since_restore": 8300332, "training_iteration": 195, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-02-08", "episode_reward_min": 56.853223919668544, "timesteps_this_iter": 41327, "episode_reward_mean": 1197.2295950864338, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 195, "custom_metrics": {"cost2_mean": -55.31253218252866, "cost2_min": -86.90597227449986, "cost1_mean": 351.807502085277, "outflow_rate_min": 330.1099134487595, "system_level_velocity_mean": 14.755523701552477, "cost1_max": 461.9642511408342, "cost1_min": 28.86031283138622, "cost2_max": -11.318998655512054, "outflow_rate_mean": 1183.5471285323663, "system_level_velocity_min": 12.197247123784653, "outflow_rate_max": 1524.8313066933067, "system_level_velocity_max": 19.45572390987906}, "info": {"num_steps_trained": 8300332, "load_time_ms": 14.579, "grad_time_ms": 9160.783, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013679403811693192, "total_loss": 15.663705825805664, "vf_loss": 15.66723346710205, "policy_loss": -0.006123763509094715, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.954814076423645, "entropy": 1.1121879816055298}, "update_time_ms": 9.417, "num_steps_sampled": 8300332, "sample_time_ms": 16126.406}, "episode_len_mean": 649.4, "time_this_iter_s": 24.91070246696472, "num_metric_batches_dropped": 0, "timesteps_total": 8300332, "episodes_total": 3103, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd341d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34be0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1491.7195369055569, "episodes_this_iter": 18, "time_total_s": 5011.113847017288, "time_since_restore": 5011.113847017288}
{"timestamp": 1557219754, "timesteps_since_restore": 8341505, "training_iteration": 196, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-02-34", "episode_reward_min": 62.70144551759969, "timesteps_this_iter": 41173, "episode_reward_mean": 1214.1068129095534, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 196, "custom_metrics": {"cost2_mean": -57.31921178441844, "cost2_min": -86.90597227449986, "cost1_mean": 355.8446885593715, "outflow_rate_min": 330.1099134487595, "system_level_velocity_mean": 14.611240391328998, "cost1_max": 461.9642511408342, "cost1_min": 32.10610046156048, "cost2_max": -11.318998655512054, "outflow_rate_mean": 1192.274790132314, "system_level_velocity_min": 11.236032526416976, "outflow_rate_max": 1490.2496955044953, "system_level_velocity_max": 19.038640671739497}, "info": {"num_steps_trained": 8341505, "load_time_ms": 14.453, "grad_time_ms": 8965.424, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014680684544146061, "total_loss": 16.668235778808594, "vf_loss": 16.67254066467285, "policy_loss": -0.007091829553246498, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9567528963088989, "entropy": 1.1238598823547363}, "update_time_ms": 9.654, "num_steps_sampled": 8341505, "sample_time_ms": 16271.529}, "episode_len_mean": 659.45, "time_this_iter_s": 25.707833528518677, "num_metric_batches_dropped": 0, "timesteps_total": 8341505, "episodes_total": 3123, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2c18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2a58>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1491.7195369055569, "episodes_this_iter": 20, "time_total_s": 5036.821680545807, "time_since_restore": 5036.821680545807}
{"timestamp": 1557219780, "timesteps_since_restore": 8383395, "training_iteration": 197, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-03-00", "episode_reward_min": 62.70144551759969, "timesteps_this_iter": 41890, "episode_reward_mean": 1208.6424772351281, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 197, "custom_metrics": {"cost2_mean": -56.55773995480257, "cost2_min": -86.90597227449986, "cost1_mean": 354.14857946463474, "outflow_rate_min": 330.1099134487595, "system_level_velocity_mean": 14.679688813786491, "cost1_max": 461.9642511408342, "cost1_min": 32.10610046156048, "cost2_max": -11.318998655512054, "outflow_rate_mean": 1193.6021951840535, "system_level_velocity_min": 11.236032526416976, "outflow_rate_max": 1490.2496955044953, "system_level_velocity_max": 19.038640671739497}, "info": {"num_steps_trained": 8383395, "load_time_ms": 14.772, "grad_time_ms": 8945.339, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01701461337506771, "total_loss": 18.10959815979004, "vf_loss": 18.113718032836914, "policy_loss": -0.007348649203777313, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.945559561252594, "entropy": 1.1340562105178833}, "update_time_ms": 9.54, "num_steps_sampled": 8383395, "sample_time_ms": 16397.447}, "episode_len_mean": 654.42, "time_this_iter_s": 26.14098072052002, "num_metric_batches_dropped": 0, "timesteps_total": 8383395, "episodes_total": 3139, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb358>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1491.7195369055569, "episodes_this_iter": 16, "time_total_s": 5062.962661266327, "time_since_restore": 5062.962661266327}
{"timestamp": 1557219806, "timesteps_since_restore": 8425407, "training_iteration": 198, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-03-26", "episode_reward_min": 57.09121321993299, "timesteps_this_iter": 42012, "episode_reward_mean": 1158.3079967999815, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 198, "custom_metrics": {"cost2_mean": -54.00643781996492, "cost2_min": -86.90597227449986, "cost1_mean": 338.19936412068046, "outflow_rate_min": 328.1930291279599, "system_level_velocity_mean": 14.736466407606096, "cost1_max": 438.27905643745066, "cost1_min": 28.93461150035024, "cost2_max": -11.020977149188349, "outflow_rate_mean": 1154.4694344686097, "system_level_velocity_min": 11.132794368722124, "outflow_rate_max": 1474.9368559440559, "system_level_velocity_max": 19.87507599240685}, "info": {"num_steps_trained": 8425407, "load_time_ms": 14.056, "grad_time_ms": 8847.196, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014544039033353329, "total_loss": 19.377817153930664, "vf_loss": 19.38115882873535, "policy_loss": -0.0061037191189825535, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9403316974639893, "entropy": 1.198901891708374}, "update_time_ms": 9.646, "num_steps_sampled": 8425407, "sample_time_ms": 16605.633}, "episode_len_mean": 630.27, "time_this_iter_s": 26.13285732269287, "num_metric_batches_dropped": 0, "timesteps_total": 8425407, "episodes_total": 3158, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfa58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf978>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1491.7195369055569, "episodes_this_iter": 19, "time_total_s": 5089.09551858902, "time_since_restore": 5089.09551858902}
{"timestamp": 1557219832, "timesteps_since_restore": 8467804, "training_iteration": 199, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-03-52", "episode_reward_min": 54.95145425641579, "timesteps_this_iter": 42397, "episode_reward_mean": 1164.980914524787, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 199, "custom_metrics": {"cost2_mean": -54.4897235987816, "cost2_min": -86.90597227449986, "cost1_mean": 339.7570369718632, "outflow_rate_min": 328.1930291279599, "system_level_velocity_mean": 14.65620004679152, "cost1_max": 438.27905643745066, "cost1_min": 28.93461150035024, "cost2_max": -11.020977149188349, "outflow_rate_mean": 1158.2054286530279, "system_level_velocity_min": 11.132794368722124, "outflow_rate_max": 1474.9368559440559, "system_level_velocity_max": 19.87507599240685}, "info": {"num_steps_trained": 8467804, "load_time_ms": 13.899, "grad_time_ms": 8722.098, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014596051536500454, "total_loss": 14.76483154296875, "vf_loss": 14.76955795288086, "policy_loss": -0.007498542312532663, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9533590078353882, "entropy": 1.158362865447998}, "update_time_ms": 9.718, "num_steps_sampled": 8467804, "sample_time_ms": 16924.64}, "episode_len_mean": 635.77, "time_this_iter_s": 26.031711101531982, "num_metric_batches_dropped": 0, "timesteps_total": 8467804, "episodes_total": 3174, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39ac8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd39b38>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1491.7195369055569, "episodes_this_iter": 16, "time_total_s": 5115.127229690552, "time_since_restore": 5115.127229690552}
{"timestamp": 1557219858, "timesteps_since_restore": 8510289, "training_iteration": 200, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-04-18", "episode_reward_min": 54.95145425641579, "timesteps_this_iter": 42485, "episode_reward_mean": 1179.1547919678226, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 200, "custom_metrics": {"cost2_mean": -54.41395639528096, "cost2_min": -82.83455633202712, "cost1_mean": 344.653040250166, "outflow_rate_min": 328.1930291279599, "system_level_velocity_mean": 14.515216472992742, "cost1_max": 438.27905643745066, "cost1_min": 28.93461150035024, "cost2_max": -11.020977149188349, "outflow_rate_mean": 1171.7567414887574, "system_level_velocity_min": 11.132794368722124, "outflow_rate_max": 1474.9368559440559, "system_level_velocity_max": 19.87507599240685}, "info": {"num_steps_trained": 8510289, "load_time_ms": 13.318, "grad_time_ms": 8669.598, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01375916600227356, "total_loss": 9.277740478515625, "vf_loss": 9.281058311462402, "policy_loss": -0.005929092410951853, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9708826541900635, "entropy": 1.202907919883728}, "update_time_ms": 9.494, "num_steps_sampled": 8510289, "sample_time_ms": 17080.347}, "episode_len_mean": 647.75, "time_this_iter_s": 25.198264598846436, "num_metric_batches_dropped": 0, "timesteps_total": 8510289, "episodes_total": 3188, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd349e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34a20>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1470.3491761758844, "episodes_this_iter": 14, "time_total_s": 5140.325494289398, "time_since_restore": 5140.325494289398}
{"timestamp": 1557219883, "timesteps_since_restore": 8551747, "training_iteration": 201, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-04-43", "episode_reward_min": 54.95145425641579, "timesteps_this_iter": 41458, "episode_reward_mean": 1194.8321735468244, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 201, "custom_metrics": {"cost2_mean": -54.45054727282054, "cost2_min": -82.83455633202712, "cost1_mean": 345.433315190117, "outflow_rate_min": 328.1930291279599, "system_level_velocity_mean": 14.244718036628392, "cost1_max": 438.27905643745066, "cost1_min": 28.93461150035024, "cost2_max": -11.020977149188349, "outflow_rate_mean": 1169.0053733543155, "system_level_velocity_min": 11.072681186347763, "outflow_rate_max": 1474.9368559440559, "system_level_velocity_max": 19.87507599240685}, "info": {"num_steps_trained": 8551747, "load_time_ms": 13.008, "grad_time_ms": 8658.209, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01659269817173481, "total_loss": 10.874671936035156, "vf_loss": 10.878376960754395, "policy_loss": -0.006854649167507887, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9664697051048279, "entropy": 1.1945174932479858}, "update_time_ms": 9.593, "num_steps_sampled": 8551747, "sample_time_ms": 17142.911}, "episode_len_mean": 658.67, "time_this_iter_s": 25.832288026809692, "num_metric_batches_dropped": 0, "timesteps_total": 8551747, "episodes_total": 3206, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc65c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2ef0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1470.3491761758844, "episodes_this_iter": 18, "time_total_s": 5166.157782316208, "time_since_restore": 5166.157782316208}
{"timestamp": 1557219908, "timesteps_since_restore": 8592988, "training_iteration": 202, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-05-08", "episode_reward_min": 54.95145425641579, "timesteps_this_iter": 41241, "episode_reward_mean": 1208.2489029124015, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 202, "custom_metrics": {"cost2_mean": -53.361770747561984, "cost2_min": -80.96139372101283, "cost1_mean": 347.04329738540815, "outflow_rate_min": 328.1930291279599, "system_level_velocity_mean": 14.154723803422009, "cost1_max": 432.28774839165067, "cost1_min": 28.93461150035024, "cost2_max": -11.020977149188349, "outflow_rate_mean": 1172.7305106636031, "system_level_velocity_min": 11.072681186347763, "outflow_rate_max": 1474.9368559440559, "system_level_velocity_max": 19.87507599240685}, "info": {"num_steps_trained": 8592988, "load_time_ms": 12.839, "grad_time_ms": 8594.647, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014690401032567024, "total_loss": 13.142390251159668, "vf_loss": 13.146637916564941, "policy_loss": -0.007037678733468056, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9601863026618958, "entropy": 1.164076566696167}, "update_time_ms": 9.57, "num_steps_sampled": 8592988, "sample_time_ms": 17085.117}, "episode_len_mean": 664.26, "time_this_iter_s": 24.45885920524597, "num_metric_batches_dropped": 0, "timesteps_total": 8592988, "episodes_total": 3221, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfba8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfc50>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1470.3491761758844, "episodes_this_iter": 15, "time_total_s": 5190.616641521454, "time_since_restore": 5190.616641521454}
{"timestamp": 1557219934, "timesteps_since_restore": 8635039, "training_iteration": 203, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-05-34", "episode_reward_min": 54.95145425641579, "timesteps_this_iter": 42051, "episode_reward_mean": 1205.5119191423853, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 203, "custom_metrics": {"cost2_mean": -52.08529669616596, "cost2_min": -70.66771963714996, "cost1_mean": 347.40342338598924, "outflow_rate_min": 328.1930291279599, "system_level_velocity_mean": 14.158899993177952, "cost1_max": 441.33970426036666, "cost1_min": 28.93461150035024, "cost2_max": -11.020977149188349, "outflow_rate_mean": 1172.804048693573, "system_level_velocity_min": 11.072681186347763, "outflow_rate_max": 1467.165935264735, "system_level_velocity_max": 19.87507599240685}, "info": {"num_steps_trained": 8635039, "load_time_ms": 12.49, "grad_time_ms": 8505.573, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014543142169713974, "total_loss": 12.064682960510254, "vf_loss": 12.067920684814453, "policy_loss": -0.005997536703944206, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9627968668937683, "entropy": 1.1457383632659912}, "update_time_ms": 8.858, "num_steps_sampled": 8635039, "sample_time_ms": 17016.068}, "episode_len_mean": 664.26, "time_this_iter_s": 25.594400882720947, "num_metric_batches_dropped": 0, "timesteps_total": 8635039, "episodes_total": 3234, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd346a0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34fd0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1470.3491761758844, "episodes_this_iter": 13, "time_total_s": 5216.211042404175, "time_since_restore": 5216.211042404175}
{"timestamp": 1557219958, "timesteps_since_restore": 8676236, "training_iteration": 204, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-05-58", "episode_reward_min": 54.95145425641579, "timesteps_this_iter": 41197, "episode_reward_mean": 1239.4190167255556, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 204, "custom_metrics": {"cost2_mean": -52.32652665064151, "cost2_min": -71.49029648069977, "cost1_mean": 353.61637636967725, "outflow_rate_min": 338.86037478867604, "system_level_velocity_mean": 13.873715904429192, "cost1_max": 441.33970426036666, "cost1_min": 29.710596253792342, "cost2_max": -13.964671499999142, "outflow_rate_mean": 1189.4147294267123, "system_level_velocity_min": 10.361655437416541, "outflow_rate_max": 1467.165935264735, "system_level_velocity_max": 19.691910913953464}, "info": {"num_steps_trained": 8676236, "load_time_ms": 12.524, "grad_time_ms": 8425.513, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01670949161052704, "total_loss": 16.457361221313477, "vf_loss": 16.462190628051758, "policy_loss": -0.008001497946679592, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9486355781555176, "entropy": 1.1461858749389648}, "update_time_ms": 8.758, "num_steps_sampled": 8676236, "sample_time_ms": 16935.352}, "episode_len_mean": 682.43, "time_this_iter_s": 24.751285552978516, "num_metric_batches_dropped": 0, "timesteps_total": 8676236, "episodes_total": 3252, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfe80>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfa58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfba8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1470.3491761758844, "episodes_this_iter": 18, "time_total_s": 5240.962327957153, "time_since_restore": 5240.962327957153}
{"timestamp": 1557219983, "timesteps_since_restore": 8717089, "training_iteration": 205, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-06-23", "episode_reward_min": 1060.771769900793, "timesteps_this_iter": 40853, "episode_reward_mean": 1272.0340688520016, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 205, "custom_metrics": {"cost2_mean": -53.50423140800798, "cost2_min": -73.93302993280469, "cost1_mean": 363.0050439371937, "outflow_rate_min": 896.3088851148851, "system_level_velocity_mean": 13.739736299059178, "cost1_max": 441.33970426036666, "cost1_min": 271.39737579688745, "cost2_max": -36.340216245568556, "outflow_rate_mean": 1214.8315268091908, "system_level_velocity_min": 10.361655437416541, "outflow_rate_max": 1467.165935264735, "system_level_velocity_max": 16.75881528594988}, "info": {"num_steps_trained": 8717089, "load_time_ms": 12.038, "grad_time_ms": 8447.941, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013803146779537201, "total_loss": 10.698735237121582, "vf_loss": 10.702884674072266, "policy_loss": -0.006769258063286543, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9705479741096497, "entropy": 1.1873619556427002}, "update_time_ms": 8.42, "num_steps_sampled": 8717089, "sample_time_ms": 16927.819}, "episode_len_mean": 700.0, "time_this_iter_s": 25.035362482070923, "num_metric_batches_dropped": 0, "timesteps_total": 8717089, "episodes_total": 3267, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34710>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34198>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1470.3491761758844, "episodes_this_iter": 15, "time_total_s": 5265.997690439224, "time_since_restore": 5265.997690439224}
{"timestamp": 1557220010, "timesteps_since_restore": 8759432, "training_iteration": 206, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-06-50", "episode_reward_min": 1050.4959609477037, "timesteps_this_iter": 42343, "episode_reward_mean": 1267.3570271824995, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 206, "custom_metrics": {"cost2_mean": -52.93598529701138, "cost2_min": -73.93302993280469, "cost1_mean": 362.1663289044551, "outflow_rate_min": 896.3088851148851, "system_level_velocity_mean": 13.708393888250885, "cost1_max": 441.33970426036666, "cost1_min": 271.39737579688745, "cost2_max": -36.340216245568556, "outflow_rate_mean": 1213.080132047952, "system_level_velocity_min": 10.361655437416541, "outflow_rate_max": 1458.1247304695305, "system_level_velocity_max": 16.75881528594988}, "info": {"num_steps_trained": 8759432, "load_time_ms": 12.112, "grad_time_ms": 8510.793, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016694704070687294, "total_loss": 10.87435531616211, "vf_loss": 10.879236221313477, "policy_loss": -0.008050438947975636, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9686081409454346, "entropy": 1.2322063446044922}, "update_time_ms": 8.068, "num_steps_sampled": 8759432, "sample_time_ms": 16917.911}, "episode_len_mean": 700.0, "time_this_iter_s": 26.23602318763733, "num_metric_batches_dropped": 0, "timesteps_total": 8759432, "episodes_total": 3282, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf9e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdff98>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1470.3491761758844, "episodes_this_iter": 15, "time_total_s": 5292.233713626862, "time_since_restore": 5292.233713626862}
{"timestamp": 1557220035, "timesteps_since_restore": 8800853, "training_iteration": 207, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-07-15", "episode_reward_min": 302.39494949357953, "timesteps_this_iter": 41421, "episode_reward_mean": 1256.7202087842377, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 207, "custom_metrics": {"cost2_mean": -52.18298147804154, "cost2_min": -78.42374616760264, "cost1_mean": 359.886392248076, "outflow_rate_min": 598.7214558366695, "system_level_velocity_mean": 13.775257432676321, "cost1_max": 441.33970426036666, "cost1_min": 109.2811702612415, "cost2_max": -28.087844935015063, "outflow_rate_mean": 1206.2395130718533, "system_level_velocity_min": 10.361655437416541, "outflow_rate_max": 1458.1247304695305, "system_level_velocity_max": 18.36014651986786}, "info": {"num_steps_trained": 8800853, "load_time_ms": 11.95, "grad_time_ms": 8526.587, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01447793934494257, "total_loss": 16.933574676513672, "vf_loss": 16.936235427856445, "policy_loss": -0.005408179480582476, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9530608654022217, "entropy": 1.1782433986663818}, "update_time_ms": 8.0, "num_steps_sampled": 8800853, "sample_time_ms": 16788.377}, "episode_len_mean": 694.62, "time_this_iter_s": 24.986732721328735, "num_metric_batches_dropped": 0, "timesteps_total": 8800853, "episodes_total": 3299, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34be0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd349b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1436.3333708154578, "episodes_this_iter": 17, "time_total_s": 5317.22044634819, "time_since_restore": 5317.22044634819}
{"timestamp": 1557220061, "timesteps_since_restore": 8844193, "training_iteration": 208, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-07-41", "episode_reward_min": 249.1829235602703, "timesteps_this_iter": 43340, "episode_reward_mean": 1232.0359270689323, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 208, "custom_metrics": {"cost2_mean": -50.982718797537935, "cost2_min": -78.42374616760264, "cost1_mean": 354.958580932465, "outflow_rate_min": 556.7779989122567, "system_level_velocity_mean": 13.900178744668004, "cost1_max": 441.33970426036666, "cost1_min": 98.82821763869359, "cost2_max": -23.419093895657426, "outflow_rate_mean": 1195.6748690709944, "system_level_velocity_min": 10.361655437416541, "outflow_rate_max": 1458.1247304695305, "system_level_velocity_max": 19.174586304274623}, "info": {"num_steps_trained": 8844193, "load_time_ms": 11.828, "grad_time_ms": 8588.29, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017621604725718498, "total_loss": 16.826942443847656, "vf_loss": 16.82900619506836, "policy_loss": -0.005410660523921251, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9498999714851379, "entropy": 1.2198200225830078}, "update_time_ms": 7.71, "num_steps_sampled": 8844193, "sample_time_ms": 16691.427}, "episode_len_mean": 684.08, "time_this_iter_s": 25.769139051437378, "num_metric_batches_dropped": 0, "timesteps_total": 8844193, "episodes_total": 3314, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfdd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc63c8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1436.3333708154578, "episodes_this_iter": 15, "time_total_s": 5342.989585399628, "time_since_restore": 5342.989585399628}
{"timestamp": 1557220086, "timesteps_since_restore": 8886690, "training_iteration": 209, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-08-06", "episode_reward_min": 249.1829235602703, "timesteps_this_iter": 42497, "episode_reward_mean": 1225.7483084908924, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 209, "custom_metrics": {"cost2_mean": -52.35867140519952, "cost2_min": -81.86251286229151, "cost1_mean": 353.9096324816934, "outflow_rate_min": 556.7779989122567, "system_level_velocity_mean": 13.875402342804323, "cost1_max": 441.33970426036666, "cost1_min": 98.82821763869359, "cost2_max": -23.419093895657426, "outflow_rate_mean": 1188.9663732947708, "system_level_velocity_min": 10.361655437416541, "outflow_rate_max": 1458.1247304695305, "system_level_velocity_max": 19.174586304274623}, "info": {"num_steps_trained": 8886690, "load_time_ms": 11.742, "grad_time_ms": 8728.96, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015130209736526012, "total_loss": 7.470517635345459, "vf_loss": 7.474115371704102, "policy_loss": -0.006470380816608667, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9791993498802185, "entropy": 1.1845365762710571}, "update_time_ms": 7.415, "num_steps_sampled": 8886690, "sample_time_ms": 16530.744}, "episode_len_mean": 684.08, "time_this_iter_s": 25.81368088722229, "num_metric_batches_dropped": 0, "timesteps_total": 8886690, "episodes_total": 3330, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd345c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34be0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1436.3333708154578, "episodes_this_iter": 16, "time_total_s": 5368.80326628685, "time_since_restore": 5368.80326628685}
{"timestamp": 1557220112, "timesteps_since_restore": 8928955, "training_iteration": 210, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-08-32", "episode_reward_min": 249.1829235602703, "timesteps_this_iter": 42265, "episode_reward_mean": 1226.812616493218, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 210, "custom_metrics": {"cost2_mean": -54.157326599750796, "cost2_min": -81.86251286229151, "cost1_mean": 354.8371442952102, "outflow_rate_min": 556.7779989122567, "system_level_velocity_mean": 13.94228700440888, "cost1_max": 419.7929292188571, "cost1_min": 98.82821763869359, "cost2_max": -23.419093895657426, "outflow_rate_mean": 1187.714691692373, "system_level_velocity_min": 10.608718278699993, "outflow_rate_max": 1433.684763236763, "system_level_velocity_max": 19.174586304274623}, "info": {"num_steps_trained": 8928955, "load_time_ms": 12.117, "grad_time_ms": 8827.726, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014612944796681404, "total_loss": 10.773332595825195, "vf_loss": 10.777039527893066, "policy_loss": -0.006481356918811798, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9719552993774414, "entropy": 1.188141942024231}, "update_time_ms": 7.385, "num_steps_sampled": 8928955, "sample_time_ms": 16489.179}, "episode_len_mean": 684.08, "time_this_iter_s": 25.80441975593567, "num_metric_batches_dropped": 0, "timesteps_total": 8928955, "episodes_total": 3347, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6390>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc66d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6358>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1402.4068508852722, "episodes_this_iter": 17, "time_total_s": 5394.607686042786, "time_since_restore": 5394.607686042786}
{"timestamp": 1557220138, "timesteps_since_restore": 8969341, "training_iteration": 211, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-08-58", "episode_reward_min": 249.1829235602703, "timesteps_this_iter": 40386, "episode_reward_mean": 1226.5072334203514, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 211, "custom_metrics": {"cost2_mean": -54.97508590257301, "cost2_min": -81.86251286229151, "cost1_mean": 357.2755138528009, "outflow_rate_min": 556.7779989122567, "system_level_velocity_mean": 14.188759702641605, "cost1_max": 505.65682620733236, "cost1_min": 98.82821763869359, "cost2_max": -23.419093895657426, "outflow_rate_mean": 1194.135991831687, "system_level_velocity_min": 10.608718278699993, "outflow_rate_max": 1528.0975392607395, "system_level_velocity_max": 19.174586304274623}, "info": {"num_steps_trained": 8969341, "load_time_ms": 12.039, "grad_time_ms": 8923.146, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014859509654343128, "total_loss": 19.12525749206543, "vf_loss": 19.1297607421875, "policy_loss": -0.007325176149606705, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9506945610046387, "entropy": 1.1686290502548218}, "update_time_ms": 7.599, "num_steps_sampled": 8969341, "sample_time_ms": 16393.946}, "episode_len_mean": 679.46, "time_this_iter_s": 25.81564235687256, "num_metric_batches_dropped": 0, "timesteps_total": 8969341, "episodes_total": 3365, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb2b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1411.013835449156, "episodes_this_iter": 18, "time_total_s": 5420.423328399658, "time_since_restore": 5420.423328399658}
{"timestamp": 1557220165, "timesteps_since_restore": 9011070, "training_iteration": 212, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-09-25", "episode_reward_min": 53.29810588495083, "timesteps_this_iter": 41729, "episode_reward_mean": 1207.5958355434768, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 212, "custom_metrics": {"cost2_mean": -55.36694933544567, "cost2_min": -81.86251286229151, "cost1_mean": 355.424190046596, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.6228827544237, "cost1_max": 505.65682620733236, "cost1_min": 28.88347315357877, "cost2_max": -13.301640347884202, "outflow_rate_mean": 1192.2274239863427, "system_level_velocity_min": 11.225754640835117, "outflow_rate_max": 1528.0975392607395, "system_level_velocity_max": 19.80527903876046}, "info": {"num_steps_trained": 9011070, "load_time_ms": 12.024, "grad_time_ms": 9142.103, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014893963001668453, "total_loss": 22.967483520507812, "vf_loss": 22.971439361572266, "policy_loss": -0.00678405724465847, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9382336139678955, "entropy": 1.1700778007507324}, "update_time_ms": 7.589, "num_steps_sampled": 9011070, "sample_time_ms": 16389.97}, "episode_len_mean": 662.48, "time_this_iter_s": 26.622812271118164, "num_metric_batches_dropped": 0, "timesteps_total": 9011070, "episodes_total": 3384, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd342e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1411.013835449156, "episodes_this_iter": 19, "time_total_s": 5447.046140670776, "time_since_restore": 5447.046140670776}
{"timestamp": 1557220189, "timesteps_since_restore": 9052991, "training_iteration": 213, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-09-49", "episode_reward_min": 53.29810588495083, "timesteps_this_iter": 41921, "episode_reward_mean": 1198.7292299357575, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 213, "custom_metrics": {"cost2_mean": -54.915333663233945, "cost2_min": -81.86251286229151, "cost1_mean": 354.95850677439955, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.848372094043752, "cost1_max": 505.65682620733236, "cost1_min": 28.88347315357877, "cost2_max": -9.564681057281991, "outflow_rate_mean": 1197.6704471705323, "system_level_velocity_min": 11.695544000441224, "outflow_rate_max": 1528.0975392607395, "system_level_velocity_max": 19.80527903876046}, "info": {"num_steps_trained": 9052991, "load_time_ms": 12.054, "grad_time_ms": 9238.785, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016767624765634537, "total_loss": 22.92926597595215, "vf_loss": 22.934494018554688, "policy_loss": -0.008410448208451271, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9314693808555603, "entropy": 1.196536660194397}, "update_time_ms": 7.721, "num_steps_sampled": 9052991, "sample_time_ms": 16146.858}, "episode_len_mean": 654.8, "time_this_iter_s": 24.12320899963379, "num_metric_batches_dropped": 0, "timesteps_total": 9052991, "episodes_total": 3398, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb2e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1411.013835449156, "episodes_this_iter": 14, "time_total_s": 5471.16934967041, "time_since_restore": 5471.16934967041}
{"timestamp": 1557220213, "timesteps_since_restore": 9094681, "training_iteration": 214, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-10-13", "episode_reward_min": 53.29810588495083, "timesteps_this_iter": 41690, "episode_reward_mean": 1194.45691006207, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 214, "custom_metrics": {"cost2_mean": -55.88367418630842, "cost2_min": -81.86251286229151, "cost1_mean": 353.9120578230655, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.867396112111189, "cost1_max": 505.65682620733236, "cost1_min": 28.88347315357877, "cost2_max": -9.564681057281991, "outflow_rate_mean": 1190.4445632756706, "system_level_velocity_min": 11.695544000441224, "outflow_rate_max": 1528.0975392607395, "system_level_velocity_max": 19.80527903876046}, "info": {"num_steps_trained": 9094681, "load_time_ms": 11.665, "grad_time_ms": 9329.603, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014087492600083351, "total_loss": 17.066667556762695, "vf_loss": 17.06997299194336, "policy_loss": -0.005982674192637205, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.945267915725708, "entropy": 1.211120367050171}, "update_time_ms": 7.813, "num_steps_sampled": 9094681, "sample_time_ms": 16024.207}, "episode_len_mean": 653.14, "time_this_iter_s": 24.43144989013672, "num_metric_batches_dropped": 0, "timesteps_total": 9094681, "episodes_total": 3415, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2828>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd26a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2cc0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1411.013835449156, "episodes_this_iter": 17, "time_total_s": 5495.600799560547, "time_since_restore": 5495.600799560547}
{"timestamp": 1557220238, "timesteps_since_restore": 9136333, "training_iteration": 215, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-10-38", "episode_reward_min": 53.29810588495083, "timesteps_this_iter": 41652, "episode_reward_mean": 1202.328244552581, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 215, "custom_metrics": {"cost2_mean": -55.96784136201314, "cost2_min": -79.85980676825191, "cost1_mean": 356.9196838475425, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.985112960480674, "cost1_max": 505.65682620733236, "cost1_min": 28.88347315357877, "cost2_max": -9.564681057281991, "outflow_rate_mean": 1200.1135360788674, "system_level_velocity_min": 12.199133071855199, "outflow_rate_max": 1528.0975392607395, "system_level_velocity_max": 19.80527903876046}, "info": {"num_steps_trained": 9136333, "load_time_ms": 11.009, "grad_time_ms": 9311.956, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0156254880130291, "total_loss": 13.099669456481934, "vf_loss": 13.103413581848145, "policy_loss": -0.006711621768772602, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9614719748497009, "entropy": 1.1981229782104492}, "update_time_ms": 8.1, "num_steps_sampled": 9136333, "sample_time_ms": 15962.693}, "episode_len_mean": 653.14, "time_this_iter_s": 24.2514431476593, "num_metric_batches_dropped": 0, "timesteps_total": 9136333, "episodes_total": 3432, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb588>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb128>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1427.2033480452085, "episodes_this_iter": 17, "time_total_s": 5519.852242708206, "time_since_restore": 5519.852242708206}
{"timestamp": 1557220263, "timesteps_since_restore": 9177657, "training_iteration": 216, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-11-03", "episode_reward_min": 53.29810588495083, "timesteps_this_iter": 41324, "episode_reward_mean": 1196.7614160893866, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 216, "custom_metrics": {"cost2_mean": -55.96960356801824, "cost2_min": -79.85980676825191, "cost1_mean": 356.6010685680031, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 15.045196785740757, "cost1_max": 479.29398743200227, "cost1_min": 28.88347315357877, "cost2_max": -9.564681057281991, "outflow_rate_mean": 1202.0078123348646, "system_level_velocity_min": 12.013098471289984, "outflow_rate_max": 1518.2948943056945, "system_level_velocity_max": 19.80527903876046}, "info": {"num_steps_trained": 9177657, "load_time_ms": 10.836, "grad_time_ms": 9268.867, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01609695702791214, "total_loss": 22.589231491088867, "vf_loss": 22.593273162841797, "policy_loss": -0.007098088506609201, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9406120181083679, "entropy": 1.206734538078308}, "update_time_ms": 8.501, "num_steps_sampled": 9177657, "sample_time_ms": 15930.39}, "episode_len_mean": 649.84, "time_this_iter_s": 25.48846459388733, "num_metric_batches_dropped": 0, "timesteps_total": 9177657, "episodes_total": 3452, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6780>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1450.864747876138, "episodes_this_iter": 20, "time_total_s": 5545.3407073020935, "time_since_restore": 5545.3407073020935}
{"timestamp": 1557220290, "timesteps_since_restore": 9217929, "training_iteration": 217, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-11-30", "episode_reward_min": 53.29810588495083, "timesteps_this_iter": 40272, "episode_reward_mean": 1205.1447398641901, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 217, "custom_metrics": {"cost2_mean": -56.31489034164311, "cost2_min": -79.85980676825191, "cost1_mean": 358.4531569276992, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.955255062520848, "cost1_max": 479.29398743200227, "cost1_min": 28.88347315357877, "cost2_max": -9.564681057281991, "outflow_rate_mean": 1199.5592248998269, "system_level_velocity_min": 11.772172578850439, "outflow_rate_max": 1518.2948943056945, "system_level_velocity_max": 19.81756792249964}, "info": {"num_steps_trained": 9217929, "load_time_ms": 10.963, "grad_time_ms": 9272.222, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014420825056731701, "total_loss": 17.189970016479492, "vf_loss": 17.193910598754883, "policy_loss": -0.006677300203591585, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9600921273231506, "entropy": 1.229791283607483}, "update_time_ms": 8.629, "num_steps_sampled": 9217929, "sample_time_ms": 16111.581}, "episode_len_mean": 655.62, "time_this_iter_s": 26.838940620422363, "num_metric_batches_dropped": 0, "timesteps_total": 9217929, "episodes_total": 3470, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd346d8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd346a0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1467.3766230493375, "episodes_this_iter": 18, "time_total_s": 5572.179647922516, "time_since_restore": 5572.179647922516}
{"timestamp": 1557220316, "timesteps_since_restore": 9260373, "training_iteration": 218, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-11-56", "episode_reward_min": 55.18255157675643, "timesteps_this_iter": 42444, "episode_reward_mean": 1215.0953891303093, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 218, "custom_metrics": {"cost2_mean": -56.477368004541084, "cost2_min": -79.39026402924607, "cost1_mean": 361.28981805222446, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.878464512574126, "cost1_max": 479.29398743200227, "cost1_min": 29.153371779257597, "cost2_max": -9.564681057281991, "outflow_rate_mean": 1208.1533824185428, "system_level_velocity_min": 11.772172578850439, "outflow_rate_max": 1518.2948943056945, "system_level_velocity_max": 19.81756792249964}, "info": {"num_steps_trained": 9260373, "load_time_ms": 11.411, "grad_time_ms": 9299.009, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013559931889176369, "total_loss": 11.574541091918945, "vf_loss": 11.578232765197754, "policy_loss": -0.0062667508609592915, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9659809470176697, "entropy": 1.2315893173217773}, "update_time_ms": 8.881, "num_steps_sampled": 9260373, "sample_time_ms": 16098.494}, "episode_len_mean": 662.19, "time_this_iter_s": 25.941184997558594, "num_metric_batches_dropped": 0, "timesteps_total": 9260373, "episodes_total": 3484, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6ef0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc64a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc66a0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1467.3766230493375, "episodes_this_iter": 14, "time_total_s": 5598.1208329200745, "time_since_restore": 5598.1208329200745}
{"timestamp": 1557220340, "timesteps_since_restore": 9302242, "training_iteration": 219, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-12-20", "episode_reward_min": 55.18255157675643, "timesteps_this_iter": 41869, "episode_reward_mean": 1202.2648503668452, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 219, "custom_metrics": {"cost2_mean": -56.87531649133396, "cost2_min": -79.39026402924607, "cost1_mean": 356.668344829154, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.838712250921533, "cost1_max": 479.29398743200227, "cost1_min": 29.153371779257597, "cost2_max": -9.564681057281991, "outflow_rate_mean": 1190.8375291815278, "system_level_velocity_min": 11.772172578850439, "outflow_rate_max": 1518.2948943056945, "system_level_velocity_max": 19.81756792249964}, "info": {"num_steps_trained": 9302242, "load_time_ms": 11.812, "grad_time_ms": 9222.53, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01544903963804245, "total_loss": 13.510881423950195, "vf_loss": 13.513468742370605, "policy_loss": -0.005520694889128208, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9604893326759338, "entropy": 1.2248564958572388}, "update_time_ms": 8.978, "num_steps_sampled": 9302242, "sample_time_ms": 16021.06}, "episode_len_mean": 656.86, "time_this_iter_s": 24.282433032989502, "num_metric_batches_dropped": 0, "timesteps_total": 9302242, "episodes_total": 3496, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbd30>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb828>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1467.3766230493375, "episodes_this_iter": 12, "time_total_s": 5622.403265953064, "time_since_restore": 5622.403265953064}
{"timestamp": 1557220364, "timesteps_since_restore": 9342975, "training_iteration": 220, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-12-44", "episode_reward_min": 51.12024428743566, "timesteps_this_iter": 40733, "episode_reward_mean": 1239.4406422509041, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 220, "custom_metrics": {"cost2_mean": -59.24527947580987, "cost2_min": -89.26400102262465, "cost1_mean": 366.629688756181, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.688262192273143, "cost1_max": 479.29398743200227, "cost1_min": 28.902413176920966, "cost2_max": -11.82813150244855, "outflow_rate_mean": 1220.1652311196476, "system_level_velocity_min": 11.772172578850439, "outflow_rate_max": 1518.2948943056945, "system_level_velocity_max": 19.81756792249964}, "info": {"num_steps_trained": 9342975, "load_time_ms": 11.576, "grad_time_ms": 9080.874, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015227124094963074, "total_loss": 14.322683334350586, "vf_loss": 14.327953338623047, "policy_loss": -0.008162103593349457, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9619927406311035, "entropy": 1.23458731174469}, "update_time_ms": 9.248, "num_steps_sampled": 9342975, "sample_time_ms": 15951.314}, "episode_len_mean": 675.55, "time_this_iter_s": 23.662896633148193, "num_metric_batches_dropped": 0, "timesteps_total": 9342975, "episodes_total": 3515, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3cf28>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34c50>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1467.3766230493375, "episodes_this_iter": 19, "time_total_s": 5646.066162586212, "time_since_restore": 5646.066162586212}
{"timestamp": 1557220390, "timesteps_since_restore": 9384425, "training_iteration": 221, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-13-10", "episode_reward_min": 51.12024428743566, "timesteps_this_iter": 41450, "episode_reward_mean": 1238.6347264340286, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 221, "custom_metrics": {"cost2_mean": -59.75200634127012, "cost2_min": -89.26400102262465, "cost1_mean": 368.27509177496626, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.743491247983261, "cost1_max": 479.29398743200227, "cost1_min": 28.902413176920966, "cost2_max": -11.82813150244855, "outflow_rate_mean": 1226.8407724103572, "system_level_velocity_min": 11.772172578850439, "outflow_rate_max": 1518.2948943056945, "system_level_velocity_max": 19.81756792249964}, "info": {"num_steps_trained": 9384425, "load_time_ms": 11.521, "grad_time_ms": 8947.737, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.017416123300790787, "total_loss": 14.614849090576172, "vf_loss": 14.620512962341309, "policy_loss": -0.008971191942691803, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9597302079200745, "entropy": 1.282509446144104}, "update_time_ms": 9.184, "num_steps_sampled": 9384425, "sample_time_ms": 16072.676}, "episode_len_mean": 675.55, "time_this_iter_s": 25.68529725074768, "num_metric_batches_dropped": 0, "timesteps_total": 9384425, "episodes_total": 3534, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc64a8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc65c0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1534.6613519707175, "episodes_this_iter": 19, "time_total_s": 5671.75145983696, "time_since_restore": 5671.75145983696}
{"timestamp": 1557220416, "timesteps_since_restore": 9424642, "training_iteration": 222, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-13-36", "episode_reward_min": 51.12024428743566, "timesteps_this_iter": 40217, "episode_reward_mean": 1231.8739448788679, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 222, "custom_metrics": {"cost2_mean": -59.930112191874834, "cost2_min": -89.26400102262465, "cost1_mean": 368.52265172526126, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.770629215449217, "cost1_max": 478.9902490382299, "cost1_min": 28.902413176920966, "cost2_max": -11.82813150244855, "outflow_rate_mean": 1225.893282101156, "system_level_velocity_min": 11.772172578850439, "outflow_rate_max": 1483.192185014985, "system_level_velocity_max": 19.81756792249964}, "info": {"num_steps_trained": 9424642, "load_time_ms": 11.783, "grad_time_ms": 8739.545, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01596921868622303, "total_loss": 15.055511474609375, "vf_loss": 15.05855941772461, "policy_loss": -0.006079315673559904, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9601452350616455, "entropy": 1.230859637260437}, "update_time_ms": 9.135, "num_steps_sampled": 9424642, "sample_time_ms": 16212.028}, "episode_len_mean": 675.48, "time_this_iter_s": 25.90723705291748, "num_metric_batches_dropped": 0, "timesteps_total": 9424642, "episodes_total": 3550, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb7f0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1534.6613519707175, "episodes_this_iter": 16, "time_total_s": 5697.658696889877, "time_since_restore": 5697.658696889877}
{"timestamp": 1557220441, "timesteps_since_restore": 9466795, "training_iteration": 223, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-14-01", "episode_reward_min": 51.12024428743566, "timesteps_this_iter": 42153, "episode_reward_mean": 1239.1216011561396, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 223, "custom_metrics": {"cost2_mean": -60.237108642980104, "cost2_min": -89.26400102262465, "cost1_mean": 374.4307144442971, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.75644224048329, "cost1_max": 456.4885407977691, "cost1_min": 28.902413176920966, "cost2_max": -11.82813150244855, "outflow_rate_mean": 1239.3235919193132, "system_level_velocity_min": 12.209942719049616, "outflow_rate_max": 1492.722771628372, "system_level_velocity_max": 19.5766311849735}, "info": {"num_steps_trained": 9466795, "load_time_ms": 11.815, "grad_time_ms": 8552.693, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014870756305754185, "total_loss": 15.802971839904785, "vf_loss": 15.808151245117188, "policy_loss": -0.00800324510782957, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9517600536346436, "entropy": 1.2773832082748413}, "update_time_ms": 9.168, "num_steps_sampled": 9466795, "sample_time_ms": 16549.658}, "episode_len_mean": 684.73, "time_this_iter_s": 25.609046697616577, "num_metric_batches_dropped": 0, "timesteps_total": 9466795, "episodes_total": 3566, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6048>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6c18>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1534.6613519707175, "episodes_this_iter": 16, "time_total_s": 5723.267743587494, "time_since_restore": 5723.267743587494}
{"timestamp": 1557220467, "timesteps_since_restore": 9507630, "training_iteration": 224, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-14-27", "episode_reward_min": 51.12024428743566, "timesteps_this_iter": 40835, "episode_reward_mean": 1235.1492099606157, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 224, "custom_metrics": {"cost2_mean": -60.57434556240222, "cost2_min": -89.26400102262465, "cost1_mean": 372.42100494214645, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.69962009613584, "cost1_max": 456.4885407977691, "cost1_min": 28.902413176920966, "cost2_max": -11.82813150244855, "outflow_rate_mean": 1231.20837889234, "system_level_velocity_min": 11.94600725290713, "outflow_rate_max": 1492.722771628372, "system_level_velocity_max": 19.5766311849735}, "info": {"num_steps_trained": 9507630, "load_time_ms": 12.154, "grad_time_ms": 8412.125, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015468061901628971, "total_loss": 11.305347442626953, "vf_loss": 11.310029029846191, "policy_loss": -0.007618354167789221, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9675363898277283, "entropy": 1.2181212902069092}, "update_time_ms": 9.109, "num_steps_sampled": 9507630, "sample_time_ms": 16778.817}, "episode_len_mean": 683.78, "time_this_iter_s": 25.316991806030273, "num_metric_batches_dropped": 0, "timesteps_total": 9507630, "episodes_total": 3578, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd64a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6780>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1534.6613519707175, "episodes_this_iter": 12, "time_total_s": 5748.584735393524, "time_since_restore": 5748.584735393524}
{"timestamp": 1557220492, "timesteps_since_restore": 9548804, "training_iteration": 225, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-14-52", "episode_reward_min": 51.12024428743566, "timesteps_this_iter": 41174, "episode_reward_mean": 1243.5542355534642, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 225, "custom_metrics": {"cost2_mean": -60.673166241720786, "cost2_min": -89.26400102262465, "cost1_mean": 377.4943154995319, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.737186537341538, "cost1_max": 456.4885407977691, "cost1_min": 28.902413176920966, "cost2_max": -11.82813150244855, "outflow_rate_mean": 1243.8572132202644, "system_level_velocity_min": 11.94600725290713, "outflow_rate_max": 1492.722771628372, "system_level_velocity_max": 19.5766311849735}, "info": {"num_steps_trained": 9548804, "load_time_ms": 13.201, "grad_time_ms": 8342.228, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014986133202910423, "total_loss": 18.724023818969727, "vf_loss": 18.728580474853516, "policy_loss": -0.007402840536087751, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9345085024833679, "entropy": 1.2267519235610962}, "update_time_ms": 9.001, "num_steps_sampled": 9548804, "sample_time_ms": 17012.889}, "episode_len_mean": 689.11, "time_this_iter_s": 25.88526940345764, "num_metric_batches_dropped": 0, "timesteps_total": 9548804, "episodes_total": 3596, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6c18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd3c9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6128>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1534.6613519707175, "episodes_this_iter": 18, "time_total_s": 5774.470004796982, "time_since_restore": 5774.470004796982}
{"timestamp": 1557220519, "timesteps_since_restore": 9590181, "training_iteration": 226, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-15-19", "episode_reward_min": 225.60620067756633, "timesteps_this_iter": 41377, "episode_reward_mean": 1239.7166733961426, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 226, "custom_metrics": {"cost2_mean": -59.64776106433899, "cost2_min": -80.12274683367973, "cost1_mean": 379.85490723796954, "outflow_rate_min": 526.1767147459389, "system_level_velocity_mean": 14.818543171342865, "cost1_max": 456.4885407977691, "cost1_min": 94.02839251146204, "cost2_max": -26.41739764912084, "outflow_rate_mean": 1248.4255331861643, "system_level_velocity_min": 11.666628304080136, "outflow_rate_max": 1492.722771628372, "system_level_velocity_max": 19.06620613976857}, "info": {"num_steps_trained": 9590181, "load_time_ms": 13.649, "grad_time_ms": 8390.533, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016276013106107712, "total_loss": 19.46527671813965, "vf_loss": 19.46813201904297, "policy_loss": -0.005948031786829233, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9525275230407715, "entropy": 1.2349222898483276}, "update_time_ms": 8.631, "num_steps_sampled": 9590181, "sample_time_ms": 17027.84}, "episode_len_mean": 690.03, "time_this_iter_s": 26.118279457092285, "num_metric_batches_dropped": 0, "timesteps_total": 9590181, "episodes_total": 3615, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbb70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1534.6613519707175, "episodes_this_iter": 19, "time_total_s": 5800.588284254074, "time_since_restore": 5800.588284254074}
{"timestamp": 1557220543, "timesteps_since_restore": 9630556, "training_iteration": 227, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-15-43", "episode_reward_min": 225.60620067756633, "timesteps_this_iter": 40375, "episode_reward_mean": 1238.9886969382485, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 227, "custom_metrics": {"cost2_mean": -59.44300521184297, "cost2_min": -84.09938406671115, "cost1_mean": 380.0656745657705, "outflow_rate_min": 526.1767147459389, "system_level_velocity_mean": 14.844716645718387, "cost1_max": 464.1671511523467, "cost1_min": 94.02839251146204, "cost2_max": -26.41739764912084, "outflow_rate_mean": 1246.7879384748755, "system_level_velocity_min": 11.564425636980479, "outflow_rate_max": 1492.722771628372, "system_level_velocity_max": 19.06620613976857}, "info": {"num_steps_trained": 9630556, "load_time_ms": 13.609, "grad_time_ms": 8271.976, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01692631095647812, "total_loss": 17.89643096923828, "vf_loss": 17.901100158691406, "policy_loss": -0.007882259786128998, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9529412388801575, "entropy": 1.2413146495819092}, "update_time_ms": 8.548, "num_steps_sampled": 9630556, "sample_time_ms": 16940.417}, "episode_len_mean": 690.03, "time_this_iter_s": 24.78827977180481, "num_metric_batches_dropped": 0, "timesteps_total": 9630556, "episodes_total": 3631, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbe80>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb438>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1479.4173082820234, "episodes_this_iter": 16, "time_total_s": 5825.376564025879, "time_since_restore": 5825.376564025879}
{"timestamp": 1557220569, "timesteps_since_restore": 9670224, "training_iteration": 228, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-16-09", "episode_reward_min": 225.60620067756633, "timesteps_this_iter": 39668, "episode_reward_mean": 1235.8874646940876, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 228, "custom_metrics": {"cost2_mean": -57.99249698038046, "cost2_min": -84.09938406671115, "cost1_mean": 378.10830171831105, "outflow_rate_min": 526.1767147459389, "system_level_velocity_mean": 14.80454595003752, "cost1_max": 464.1671511523467, "cost1_min": 94.02839251146204, "cost2_max": -26.41739764912084, "outflow_rate_mean": 1243.5444504049456, "system_level_velocity_min": 11.564425636980479, "outflow_rate_max": 1492.722771628372, "system_level_velocity_max": 19.06620613976857}, "info": {"num_steps_trained": 9670224, "load_time_ms": 13.254, "grad_time_ms": 8118.428, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01549247745424509, "total_loss": 30.280858993530273, "vf_loss": 30.284473419189453, "policy_loss": -0.006558465305715799, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.896569013595581, "entropy": 1.2257121801376343}, "update_time_ms": 8.244, "num_steps_sampled": 9670224, "sample_time_ms": 17006.755}, "episode_len_mean": 688.85, "time_this_iter_s": 25.031281232833862, "num_metric_batches_dropped": 0, "timesteps_total": 9670224, "episodes_total": 3648, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb278>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbbe0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1479.4173082820234, "episodes_this_iter": 17, "time_total_s": 5850.407845258713, "time_since_restore": 5850.407845258713}
{"timestamp": 1557220593, "timesteps_since_restore": 9711361, "training_iteration": 229, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-16-33", "episode_reward_min": 71.9205910812881, "timesteps_this_iter": 41137, "episode_reward_mean": 1223.639746701882, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 229, "custom_metrics": {"cost2_mean": -56.98675716020891, "cost2_min": -84.09938406671115, "cost1_mean": 375.8849827308236, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.80340382483535, "cost1_max": 464.1671511523467, "cost1_min": 33.737138173317, "cost2_max": -14.14421961478585, "outflow_rate_mean": 1239.5222488452002, "system_level_velocity_min": 11.564425636980479, "outflow_rate_max": 1472.2575084915086, "system_level_velocity_max": 19.06620613976857}, "info": {"num_steps_trained": 9711361, "load_time_ms": 12.943, "grad_time_ms": 8136.473, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014215472154319286, "total_loss": 23.544479370117188, "vf_loss": 23.54736328125, "policy_loss": -0.005582001991569996, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.913689136505127, "entropy": 1.242236614227295}, "update_time_ms": 8.067, "num_steps_sampled": 9711361, "sample_time_ms": 17045.571}, "episode_len_mean": 685.72, "time_this_iter_s": 24.839768886566162, "num_metric_batches_dropped": 0, "timesteps_total": 9711361, "episodes_total": 3664, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd64e0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd65f8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1479.4173082820234, "episodes_this_iter": 16, "time_total_s": 5875.247614145279, "time_since_restore": 5875.247614145279}
{"timestamp": 1557220619, "timesteps_since_restore": 9751084, "training_iteration": 230, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-16-59", "episode_reward_min": 65.9557124289943, "timesteps_this_iter": 39723, "episode_reward_mean": 1202.6288089619998, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 230, "custom_metrics": {"cost2_mean": -54.53648474791168, "cost2_min": -84.09938406671115, "cost1_mean": 370.7056733926081, "outflow_rate_min": 317.75050677530305, "system_level_velocity_mean": 14.902614517399343, "cost1_max": 464.1671511523467, "cost1_min": 33.737138173317, "cost2_max": -9.628075614526338, "outflow_rate_mean": 1234.276165917952, "system_level_velocity_min": 11.564425636980479, "outflow_rate_max": 1472.2575084915086, "system_level_velocity_max": 19.06620613976857}, "info": {"num_steps_trained": 9751084, "load_time_ms": 12.996, "grad_time_ms": 8283.169, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015895884484052658, "total_loss": 30.14825439453125, "vf_loss": 30.151628494262695, "policy_loss": -0.006390106398612261, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.8992060422897339, "entropy": 1.2101030349731445}, "update_time_ms": 7.787, "num_steps_sampled": 9751084, "sample_time_ms": 17078.485}, "episode_len_mean": 675.39, "time_this_iter_s": 25.491804838180542, "num_metric_batches_dropped": 0, "timesteps_total": 9751084, "episodes_total": 3684, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccba58>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1403.5379003110115, "episodes_this_iter": 20, "time_total_s": 5900.7394189834595, "time_since_restore": 5900.7394189834595}
{"timestamp": 1557220644, "timesteps_since_restore": 9791370, "training_iteration": 231, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-17-24", "episode_reward_min": 65.9557124289943, "timesteps_this_iter": 40286, "episode_reward_mean": 1196.4156459369804, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 231, "custom_metrics": {"cost2_mean": -53.878792491873284, "cost2_min": -84.09938406671115, "cost1_mean": 369.3469643250308, "outflow_rate_min": 317.75050677530305, "system_level_velocity_mean": 14.878257390941975, "cost1_max": 464.1671511523467, "cost1_min": 33.737138173317, "cost2_max": -9.628075614526338, "outflow_rate_mean": 1236.1088207511189, "system_level_velocity_min": 11.564425636980479, "outflow_rate_max": 1472.2575084915086, "system_level_velocity_max": 19.06620613976857}, "info": {"num_steps_trained": 9791370, "load_time_ms": 13.601, "grad_time_ms": 8370.252, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016766129061579704, "total_loss": 23.98161506652832, "vf_loss": 23.98445701599121, "policy_loss": -0.006025596056133509, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.8980645537376404, "entropy": 1.2327474355697632}, "update_time_ms": 7.89, "num_steps_sampled": 9791370, "sample_time_ms": 16939.681}, "episode_len_mean": 674.84, "time_this_iter_s": 25.188889503479004, "num_metric_batches_dropped": 0, "timesteps_total": 9791370, "episodes_total": 3700, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6860>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1403.5379003110115, "episodes_this_iter": 16, "time_total_s": 5925.9283084869385, "time_since_restore": 5925.9283084869385}
{"timestamp": 1557220669, "timesteps_since_restore": 9831173, "training_iteration": 232, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-17-49", "episode_reward_min": 56.00760463666425, "timesteps_this_iter": 39803, "episode_reward_mean": 1187.7547587033769, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 232, "custom_metrics": {"cost2_mean": -52.455699579132535, "cost2_min": -78.26828816444731, "cost1_mean": 368.7196446814373, "outflow_rate_min": 317.75050677530305, "system_level_velocity_mean": 15.023420313038436, "cost1_max": 464.1671511523467, "cost1_min": 30.078531852945645, "cost2_max": -9.628075614526338, "outflow_rate_mean": 1238.9798848558917, "system_level_velocity_min": 12.277932837559357, "outflow_rate_max": 1472.2575084915086, "system_level_velocity_max": 19.047943375691688}, "info": {"num_steps_trained": 9831173, "load_time_ms": 13.394, "grad_time_ms": 8478.093, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014900173991918564, "total_loss": 31.529329299926758, "vf_loss": 31.532062530517578, "policy_loss": -0.005561097990721464, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.8861023187637329, "entropy": 1.2513068914413452}, "update_time_ms": 7.872, "num_steps_sampled": 9831173, "sample_time_ms": 16676.961}, "episode_len_mean": 668.56, "time_this_iter_s": 24.38389801979065, "num_metric_batches_dropped": 0, "timesteps_total": 9831173, "episodes_total": 3718, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6400>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd65f8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1396.6699253358452, "episodes_this_iter": 18, "time_total_s": 5950.312206506729, "time_since_restore": 5950.312206506729}
{"timestamp": 1557220694, "timesteps_since_restore": 9871634, "training_iteration": 233, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-18-14", "episode_reward_min": 56.00760463666425, "timesteps_this_iter": 40461, "episode_reward_mean": 1165.1279840688985, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 233, "custom_metrics": {"cost2_mean": -52.91120227313201, "cost2_min": -76.84728974803272, "cost1_mean": 362.5409377553766, "outflow_rate_min": 317.75050677530305, "system_level_velocity_mean": 15.134485050071047, "cost1_max": 440.3788174776025, "cost1_min": 30.078531852945645, "cost2_max": -9.628075614526338, "outflow_rate_mean": 1228.950003018358, "system_level_velocity_min": 12.277932837559357, "outflow_rate_max": 1460.106674125874, "system_level_velocity_max": 19.047943375691688}, "info": {"num_steps_trained": 9871634, "load_time_ms": 13.626, "grad_time_ms": 8622.736, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015032797120511532, "total_loss": 25.606277465820312, "vf_loss": 25.611621856689453, "policy_loss": -0.008197533898055553, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9246171116828918, "entropy": 1.3072702884674072}, "update_time_ms": 7.918, "num_steps_sampled": 9871634, "sample_time_ms": 16532.38}, "episode_len_mean": 655.1, "time_this_iter_s": 25.621342182159424, "num_metric_batches_dropped": 0, "timesteps_total": 9871634, "episodes_total": 3739, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf160>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf470>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1448.3065847131072, "episodes_this_iter": 21, "time_total_s": 5975.933548688889, "time_since_restore": 5975.933548688889}
{"timestamp": 1557220720, "timesteps_since_restore": 9913506, "training_iteration": 234, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-18-40", "episode_reward_min": 56.00760463666425, "timesteps_this_iter": 41872, "episode_reward_mean": 1171.216301383834, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 234, "custom_metrics": {"cost2_mean": -55.986269541127655, "cost2_min": -87.52271580470854, "cost1_mean": 361.21143370019365, "outflow_rate_min": 317.75050677530305, "system_level_velocity_mean": 15.048440709750595, "cost1_max": 440.3788174776025, "cost1_min": 30.078531852945645, "cost2_max": -9.628075614526338, "outflow_rate_mean": 1223.635563826902, "system_level_velocity_min": 12.277932837559357, "outflow_rate_max": 1460.106674125874, "system_level_velocity_max": 19.03850945014232}, "info": {"num_steps_trained": 9913506, "load_time_ms": 13.862, "grad_time_ms": 8776.558, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01322504784911871, "total_loss": 15.045604705810547, "vf_loss": 15.049490928649902, "policy_loss": -0.006397605407983065, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9487855434417725, "entropy": 1.3421401977539062}, "update_time_ms": 8.026, "num_steps_sampled": 9913506, "sample_time_ms": 16439.324}, "episode_len_mean": 656.31, "time_this_iter_s": 25.953936338424683, "num_metric_batches_dropped": 0, "timesteps_total": 9913506, "episodes_total": 3755, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6898>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1448.3065847131072, "episodes_this_iter": 16, "time_total_s": 6001.887485027313, "time_since_restore": 6001.887485027313}
{"timestamp": 1557220749, "timesteps_since_restore": 9957384, "training_iteration": 235, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-19-09", "episode_reward_min": 56.00760463666425, "timesteps_this_iter": 43878, "episode_reward_mean": 1158.7606919272882, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 235, "custom_metrics": {"cost2_mean": -58.146898513852896, "cost2_min": -98.04409283615742, "cost1_mean": 356.08571940752796, "outflow_rate_min": 317.75050677530305, "system_level_velocity_mean": 15.18720429398287, "cost1_max": 440.3788174776025, "cost1_min": 29.55122934610743, "cost2_max": -9.628075614526338, "outflow_rate_mean": 1205.5904062513284, "system_level_velocity_min": 12.762726933342968, "outflow_rate_max": 1460.106674125874, "system_level_velocity_max": 19.942072360015775}, "info": {"num_steps_trained": 9957384, "load_time_ms": 13.725, "grad_time_ms": 9119.451, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01405410561710596, "total_loss": 9.016092300415039, "vf_loss": 9.01931095123291, "policy_loss": -0.0058865319006145, "cur_kl_coeff": 0.1898437887430191, "vf_explained_var": 0.975800096988678, "entropy": 1.318788766860962}, "update_time_ms": 8.069, "num_steps_sampled": 9957384, "sample_time_ms": 16397.7}, "episode_len_mean": 644.14, "time_this_iter_s": 28.911252975463867, "num_metric_batches_dropped": 0, "timesteps_total": 9957384, "episodes_total": 3768, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbfd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbba8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1448.3065847131072, "episodes_this_iter": 13, "time_total_s": 6030.798738002777, "time_since_restore": 6030.798738002777}
{"timestamp": 1557220774, "timesteps_since_restore": 10000177, "training_iteration": 236, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-19-34", "episode_reward_min": 56.00760463666425, "timesteps_this_iter": 42793, "episode_reward_mean": 1187.8146224096115, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 236, "custom_metrics": {"cost2_mean": -63.437391005425326, "cost2_min": -98.04409283615742, "cost1_mean": 359.8278841376779, "outflow_rate_min": 324.9984463757209, "system_level_velocity_mean": 15.105437167797929, "cost1_max": 453.57535900042194, "cost1_min": 29.55122934610743, "cost2_max": -11.606245435500252, "outflow_rate_mean": 1211.1794099911206, "system_level_velocity_min": 12.306940495920431, "outflow_rate_max": 1460.106674125874, "system_level_velocity_max": 19.942072360015775}, "info": {"num_steps_trained": 10000177, "load_time_ms": 13.68, "grad_time_ms": 9190.462, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015948060899972916, "total_loss": 10.736931800842285, "vf_loss": 10.74201774597168, "policy_loss": -0.008114061318337917, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9721009731292725, "entropy": 1.2721519470214844}, "update_time_ms": 8.182, "num_steps_sampled": 10000177, "sample_time_ms": 16245.928}, "episode_len_mean": 651.81, "time_this_iter_s": 25.323224544525146, "num_metric_batches_dropped": 0, "timesteps_total": 10000177, "episodes_total": 3785, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2a20>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd27b8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1493.8431519102046, "episodes_this_iter": 17, "time_total_s": 6056.121962547302, "time_since_restore": 6056.121962547302}
{"timestamp": 1557220799, "timesteps_since_restore": 10041459, "training_iteration": 237, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-19-59", "episode_reward_min": 56.00760463666425, "timesteps_this_iter": 41282, "episode_reward_mean": 1206.545646254783, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 237, "custom_metrics": {"cost2_mean": -67.86922632205727, "cost2_min": -98.04409283615742, "cost1_mean": 359.4707694723698, "outflow_rate_min": 324.9984463757209, "system_level_velocity_mean": 15.077560473794769, "cost1_max": 453.57535900042194, "cost1_min": 29.55122934610743, "cost2_max": -11.606245435500252, "outflow_rate_mean": 1206.1282178754116, "system_level_velocity_min": 12.306940495920431, "outflow_rate_max": 1460.106674125874, "system_level_velocity_max": 19.942072360015775}, "info": {"num_steps_trained": 10041459, "load_time_ms": 13.835, "grad_time_ms": 9319.407, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01477573812007904, "total_loss": 10.118788719177246, "vf_loss": 10.122101783752441, "policy_loss": -0.006118070799857378, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9715815186500549, "entropy": 1.3258318901062012}, "update_time_ms": 8.286, "num_steps_sampled": 10041459, "sample_time_ms": 16098.276}, "episode_len_mean": 651.23, "time_this_iter_s": 24.60623264312744, "num_metric_batches_dropped": 0, "timesteps_total": 10041459, "episodes_total": 3803, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf128>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1493.8431519102046, "episodes_this_iter": 18, "time_total_s": 6080.72819519043, "time_since_restore": 6080.72819519043}
{"timestamp": 1557220826, "timesteps_since_restore": 10084161, "training_iteration": 238, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-20-26", "episode_reward_min": 57.01898216668706, "timesteps_this_iter": 42702, "episode_reward_mean": 1209.1639626086696, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 238, "custom_metrics": {"cost2_mean": -70.42638477750546, "cost2_min": -98.04409283615742, "cost1_mean": 356.5678683122148, "outflow_rate_min": 330.22370737173105, "system_level_velocity_mean": 15.110516920557668, "cost1_max": 453.57535900042194, "cost1_min": 29.55122934610743, "cost2_max": -13.869254679943982, "outflow_rate_mean": 1194.9789889274234, "system_level_velocity_min": 12.306940495920431, "outflow_rate_max": 1460.106674125874, "system_level_velocity_max": 19.942072360015775}, "info": {"num_steps_trained": 10084161, "load_time_ms": 13.942, "grad_time_ms": 9508.292, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013425878249108791, "total_loss": 18.959470748901367, "vf_loss": 18.96391487121582, "policy_loss": -0.0069935498759150505, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9514917135238647, "entropy": 1.3267031908035278}, "update_time_ms": 8.642, "num_steps_sampled": 10084161, "sample_time_ms": 16069.366}, "episode_len_mean": 645.81, "time_this_iter_s": 26.65808892250061, "num_metric_batches_dropped": 0, "timesteps_total": 10084161, "episodes_total": 3820, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbb00>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb940>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1493.8431519102046, "episodes_this_iter": 17, "time_total_s": 6107.38628411293, "time_since_restore": 6107.38628411293}
{"timestamp": 1557220853, "timesteps_since_restore": 10127238, "training_iteration": 239, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-20-53", "episode_reward_min": 57.01898216668706, "timesteps_this_iter": 43077, "episode_reward_mean": 1191.5021406213634, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 239, "custom_metrics": {"cost2_mean": -72.18425373122184, "cost2_min": -98.48237722152045, "cost1_mean": 348.2985185769534, "outflow_rate_min": 330.22370737173105, "system_level_velocity_mean": 15.124216111758559, "cost1_max": 453.57535900042194, "cost1_min": 29.55122934610743, "cost2_max": -13.869254679943982, "outflow_rate_mean": 1170.5119424982981, "system_level_velocity_min": 12.306940495920431, "outflow_rate_max": 1460.0769906093906, "system_level_velocity_max": 19.942072360015775}, "info": {"num_steps_trained": 10127238, "load_time_ms": 14.009, "grad_time_ms": 9585.473, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016478415578603745, "total_loss": 12.368108749389648, "vf_loss": 12.373445510864258, "policy_loss": -0.008464218117296696, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9683877825737, "entropy": 1.3125965595245361}, "update_time_ms": 9.052, "num_steps_sampled": 10127238, "sample_time_ms": 16216.449}, "episode_len_mean": 633.54, "time_this_iter_s": 27.09733271598816, "num_metric_batches_dropped": 0, "timesteps_total": 10127238, "episodes_total": 3835, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd62e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd69e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1493.8431519102046, "episodes_this_iter": 15, "time_total_s": 6134.4836168289185, "time_since_restore": 6134.4836168289185}
{"timestamp": 1557220878, "timesteps_since_restore": 10170050, "training_iteration": 240, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-21-18", "episode_reward_min": 57.01898216668706, "timesteps_this_iter": 42812, "episode_reward_mean": 1232.1214497339467, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 240, "custom_metrics": {"cost2_mean": -75.74914190099732, "cost2_min": -102.71537088303458, "cost1_mean": 358.7121824295698, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 15.066463830130084, "cost1_max": 453.57535900042194, "cost1_min": 29.55122934610743, "cost2_max": -13.869254679943982, "outflow_rate_mean": 1197.688343253591, "system_level_velocity_min": 12.306940495920431, "outflow_rate_max": 1471.1567560439562, "system_level_velocity_max": 19.942072360015775}, "info": {"num_steps_trained": 10170050, "load_time_ms": 14.1, "grad_time_ms": 9649.38, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015832141041755676, "total_loss": 11.417352676391602, "vf_loss": 11.423830032348633, "policy_loss": -0.009484033100306988, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9703336358070374, "entropy": 1.276188850402832}, "update_time_ms": 9.157, "num_steps_sampled": 10170050, "sample_time_ms": 16110.194}, "episode_len_mean": 650.64, "time_this_iter_s": 25.041261196136475, "num_metric_batches_dropped": 0, "timesteps_total": 10170050, "episodes_total": 3851, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6e48>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdfef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6908>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1518.9706438356025, "episodes_this_iter": 16, "time_total_s": 6159.524878025055, "time_since_restore": 6159.524878025055}
{"timestamp": 1557220904, "timesteps_since_restore": 10213291, "training_iteration": 241, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-21-44", "episode_reward_min": 63.3060688722685, "timesteps_this_iter": 43241, "episode_reward_mean": 1250.1109013942482, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 241, "custom_metrics": {"cost2_mean": -78.51653287964015, "cost2_min": -120.2184318389924, "cost1_mean": 361.2639844002929, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 15.069603842105739, "cost1_max": 453.57535900042194, "cost1_min": 32.7742961813741, "cost2_max": -13.869254679943982, "outflow_rate_mean": 1208.3581813986016, "system_level_velocity_min": 12.306940495920431, "outflow_rate_max": 1514.6355068225894, "system_level_velocity_max": 19.415120877878756}, "info": {"num_steps_trained": 10213291, "load_time_ms": 13.714, "grad_time_ms": 9735.989, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016514625400304794, "total_loss": 15.403264999389648, "vf_loss": 15.405861854553223, "policy_loss": -0.005731122102588415, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9587470889091492, "entropy": 1.275661826133728}, "update_time_ms": 8.984, "num_steps_sampled": 10213291, "sample_time_ms": 16072.853}, "episode_len_mean": 652.83, "time_this_iter_s": 25.66570210456848, "num_metric_batches_dropped": 0, "timesteps_total": 10213291, "episodes_total": 3867, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd340f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34e10>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1550.1927577434094, "episodes_this_iter": 16, "time_total_s": 6185.190580129623, "time_since_restore": 6185.190580129623}
{"timestamp": 1557220930, "timesteps_since_restore": 10255412, "training_iteration": 242, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-22-10", "episode_reward_min": 63.3060688722685, "timesteps_this_iter": 42121, "episode_reward_mean": 1256.728056114253, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 242, "custom_metrics": {"cost2_mean": -81.29585759589337, "cost2_min": -120.2184318389924, "cost1_mean": 364.43893819064544, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 15.092170492026119, "cost1_max": 451.35161972879416, "cost1_min": 32.7742961813741, "cost2_max": -13.869254679943982, "outflow_rate_mean": 1221.2116115910528, "system_level_velocity_min": 12.329767450029717, "outflow_rate_max": 1514.6355068225894, "system_level_velocity_max": 19.415120877878756}, "info": {"num_steps_trained": 10255412, "load_time_ms": 13.902, "grad_time_ms": 9799.466, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014660791493952274, "total_loss": 10.28209400177002, "vf_loss": 10.285736083984375, "policy_loss": -0.0064254445023834705, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9766654372215271, "entropy": 1.2545465230941772}, "update_time_ms": 8.854, "num_steps_sampled": 10255412, "sample_time_ms": 16192.354}, "episode_len_mean": 656.44, "time_this_iter_s": 26.191489696502686, "num_metric_batches_dropped": 0, "timesteps_total": 10255412, "episodes_total": 3884, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb7f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbdd8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1550.1927577434094, "episodes_this_iter": 17, "time_total_s": 6211.382069826126, "time_since_restore": 6211.382069826126}
{"timestamp": 1557220956, "timesteps_since_restore": 10299392, "training_iteration": 243, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-22-36", "episode_reward_min": 63.3060688722685, "timesteps_this_iter": 43980, "episode_reward_mean": 1252.8204005385562, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 243, "custom_metrics": {"cost2_mean": -85.25557431451001, "cost2_min": -120.2184318389924, "cost1_mean": 365.36248453924605, "outflow_rate_min": 331.3055169108091, "system_level_velocity_mean": 15.130466092353702, "cost1_max": 475.476117965138, "cost1_min": 32.7742961813741, "cost2_max": -13.869254679943982, "outflow_rate_mean": 1223.1373412119024, "system_level_velocity_min": 12.329767450029717, "outflow_rate_max": 1543.3734727272727, "system_level_velocity_max": 19.415120877878756}, "info": {"num_steps_trained": 10299392, "load_time_ms": 13.87, "grad_time_ms": 9845.532, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015385858714580536, "total_loss": 8.386251449584961, "vf_loss": 8.391201972961426, "policy_loss": -0.007869821041822433, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9792937636375427, "entropy": 1.2503690719604492}, "update_time_ms": 8.73, "num_steps_sampled": 10299392, "sample_time_ms": 16217.369}, "episode_len_mean": 656.44, "time_this_iter_s": 26.332262754440308, "num_metric_batches_dropped": 0, "timesteps_total": 10299392, "episodes_total": 3898, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd67b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6f98>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1614.4173376887422, "episodes_this_iter": 14, "time_total_s": 6237.714332580566, "time_since_restore": 6237.714332580566}
{"timestamp": 1557220983, "timesteps_since_restore": 10345174, "training_iteration": 244, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-23-03", "episode_reward_min": 66.1833947320168, "timesteps_this_iter": 45782, "episode_reward_mean": 1277.5582196530304, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 244, "custom_metrics": {"cost2_mean": -91.56556677616994, "cost2_min": -134.49208150538226, "cost1_mean": 371.79173662892447, "outflow_rate_min": 333.67054062656626, "system_level_velocity_mean": 15.085390924485615, "cost1_max": 475.476117965138, "cost1_min": 32.7742961813741, "cost2_max": -15.31985798789908, "outflow_rate_mean": 1243.9998617539868, "system_level_velocity_min": 12.329767450029717, "outflow_rate_max": 1625.604708068402, "system_level_velocity_max": 19.12590451382043}, "info": {"num_steps_trained": 10345174, "load_time_ms": 13.705, "grad_time_ms": 9921.877, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015430201776325703, "total_loss": 10.152911186218262, "vf_loss": 10.155470848083496, "policy_loss": -0.005489255301654339, "cur_kl_coeff": 0.1898437887430191, "vf_explained_var": 0.974047064781189, "entropy": 1.2270890474319458}, "update_time_ms": 8.781, "num_steps_sampled": 10345174, "sample_time_ms": 16188.31}, "episode_len_mean": 667.39, "time_this_iter_s": 26.412880182266235, "num_metric_batches_dropped": 0, "timesteps_total": 10345174, "episodes_total": 3914, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6080>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6160>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1704.5279458543332, "episodes_this_iter": 16, "time_total_s": 6264.127212762833, "time_since_restore": 6264.127212762833}
{"timestamp": 1557221009, "timesteps_since_restore": 10388442, "training_iteration": 245, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-23-29", "episode_reward_min": 56.544454993985795, "timesteps_this_iter": 43268, "episode_reward_mean": 1278.7551667128748, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 245, "custom_metrics": {"cost2_mean": -96.35535999343432, "cost2_min": -134.49208150538226, "cost1_mean": 372.2256301439285, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 14.99971911800625, "cost1_max": 475.476117965138, "cost1_min": 28.801609039369477, "cost2_max": -12.38845334653608, "outflow_rate_mean": 1246.2113588084228, "system_level_velocity_min": 12.329767450029717, "outflow_rate_max": 1625.604708068402, "system_level_velocity_max": 19.410370245482344}, "info": {"num_steps_trained": 10388442, "load_time_ms": 13.71, "grad_time_ms": 9729.691, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014873679727315903, "total_loss": 10.372014999389648, "vf_loss": 10.376713752746582, "policy_loss": -0.007521940395236015, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9784526228904724, "entropy": 1.2341852188110352}, "update_time_ms": 8.794, "num_steps_sampled": 10388442, "sample_time_ms": 16138.755}, "episode_len_mean": 672.81, "time_this_iter_s": 26.483490705490112, "num_metric_batches_dropped": 0, "timesteps_total": 10388442, "episodes_total": 3929, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6748>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd152b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1704.5279458543332, "episodes_this_iter": 15, "time_total_s": 6290.610703468323, "time_since_restore": 6290.610703468323}
{"timestamp": 1557221034, "timesteps_since_restore": 10431223, "training_iteration": 246, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-23-54", "episode_reward_min": 56.544454993985795, "timesteps_this_iter": 42781, "episode_reward_mean": 1286.7863776913534, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 246, "custom_metrics": {"cost2_mean": -99.11428272745124, "cost2_min": -134.49208150538226, "cost1_mean": 377.70465522950815, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 15.200298783673801, "cost1_max": 502.7890657912593, "cost1_min": 28.801609039369477, "cost2_max": -12.38845334653608, "outflow_rate_mean": 1263.6668853054327, "system_level_velocity_min": 12.329767450029717, "outflow_rate_max": 1625.604708068402, "system_level_velocity_max": 19.410370245482344}, "info": {"num_steps_trained": 10431223, "load_time_ms": 13.559, "grad_time_ms": 9781.468, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015840576961636543, "total_loss": 14.423589706420898, "vf_loss": 14.427336692810059, "policy_loss": -0.006754723843187094, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9671862125396729, "entropy": 1.2435015439987183}, "update_time_ms": 8.645, "num_steps_sampled": 10431223, "sample_time_ms": 16048.168}, "episode_len_mean": 672.8, "time_this_iter_s": 24.923529148101807, "num_metric_batches_dropped": 0, "timesteps_total": 10431223, "episodes_total": 3945, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbe10>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb5c0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1704.5279458543332, "episodes_this_iter": 16, "time_total_s": 6315.534232616425, "time_since_restore": 6315.534232616425}
{"timestamp": 1557221061, "timesteps_since_restore": 10473891, "training_iteration": 247, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-24-21", "episode_reward_min": 56.544454993985795, "timesteps_this_iter": 42668, "episode_reward_mean": 1285.3374166881702, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 247, "custom_metrics": {"cost2_mean": -101.2754505781141, "cost2_min": -134.49208150538226, "cost1_mean": 380.58859085358466, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 15.223635634228978, "cost1_max": 502.7890657912593, "cost1_min": 28.801609039369477, "cost2_max": -12.38845334653608, "outflow_rate_mean": 1267.2151456910108, "system_level_velocity_min": 12.329767450029717, "outflow_rate_max": 1625.604708068402, "system_level_velocity_max": 19.410370245482344}, "info": {"num_steps_trained": 10473891, "load_time_ms": 13.301, "grad_time_ms": 9896.692, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012805440463125706, "total_loss": 10.771916389465332, "vf_loss": 10.775842666625977, "policy_loss": -0.006356997415423393, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9759633541107178, "entropy": 1.2867929935455322}, "update_time_ms": 8.536, "num_steps_sampled": 10473891, "sample_time_ms": 16110.652}, "episode_len_mean": 676.99, "time_this_iter_s": 26.37342143058777, "num_metric_batches_dropped": 0, "timesteps_total": 10473891, "episodes_total": 3963, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0be0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf05c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34860>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1704.5279458543332, "episodes_this_iter": 18, "time_total_s": 6341.907654047012, "time_since_restore": 6341.907654047012}
{"timestamp": 1557221087, "timesteps_since_restore": 10518001, "training_iteration": 248, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-24-47", "episode_reward_min": 56.544454993985795, "timesteps_this_iter": 44110, "episode_reward_mean": 1251.516674699788, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 248, "custom_metrics": {"cost2_mean": -101.18476267374427, "cost2_min": -134.49208150538226, "cost1_mean": 373.53854263463063, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 15.297132993635758, "cost1_max": 502.7890657912593, "cost1_min": 28.801609039369477, "cost2_max": -12.38845334653608, "outflow_rate_mean": 1244.2089211546966, "system_level_velocity_min": 12.329767450029717, "outflow_rate_max": 1625.604708068402, "system_level_velocity_max": 19.410370245482344}, "info": {"num_steps_trained": 10518001, "load_time_ms": 13.827, "grad_time_ms": 9915.57, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013827216811478138, "total_loss": 10.766349792480469, "vf_loss": 10.769987106323242, "policy_loss": -0.006262782029807568, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9744736552238464, "entropy": 1.2671915292739868}, "update_time_ms": 8.267, "num_steps_sampled": 10518001, "sample_time_ms": 16066.58}, "episode_len_mean": 665.3, "time_this_iter_s": 26.401833534240723, "num_metric_batches_dropped": 0, "timesteps_total": 10518001, "episodes_total": 3978, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0b70>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf09e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2668>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1704.5279458543332, "episodes_this_iter": 15, "time_total_s": 6368.309487581253, "time_since_restore": 6368.309487581253}
{"timestamp": 1557221114, "timesteps_since_restore": 10562742, "training_iteration": 249, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-25-14", "episode_reward_min": 56.544454993985795, "timesteps_this_iter": 44741, "episode_reward_mean": 1235.277217348518, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 249, "custom_metrics": {"cost2_mean": -101.1802358966296, "cost2_min": -134.49208150538226, "cost1_mean": 369.1181320464989, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 15.280426698132723, "cost1_max": 502.7890657912593, "cost1_min": 28.801609039369477, "cost2_max": -12.38845334653608, "outflow_rate_mean": 1232.6165817196693, "system_level_velocity_min": 12.61552230038762, "outflow_rate_max": 1625.604708068402, "system_level_velocity_max": 19.410370245482344}, "info": {"num_steps_trained": 10562742, "load_time_ms": 13.947, "grad_time_ms": 9959.595, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014072442427277565, "total_loss": 8.112115859985352, "vf_loss": 8.114527702331543, "policy_loss": -0.005082864314317703, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9809628129005432, "entropy": 1.2626019716262817}, "update_time_ms": 8.042, "num_steps_sampled": 10562742, "sample_time_ms": 15964.0}, "episode_len_mean": 660.65, "time_this_iter_s": 26.51832628250122, "num_metric_batches_dropped": 0, "timesteps_total": 10562742, "episodes_total": 3994, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbc50>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1704.5279458543332, "episodes_this_iter": 16, "time_total_s": 6394.827813863754, "time_since_restore": 6394.827813863754}
{"timestamp": 1557221139, "timesteps_since_restore": 10606405, "training_iteration": 250, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-25-39", "episode_reward_min": 56.544454993985795, "timesteps_this_iter": 43663, "episode_reward_mean": 1227.5004762005426, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 250, "custom_metrics": {"cost2_mean": -99.00884170896614, "cost2_min": -125.96225053959644, "cost1_mean": 367.7508525200908, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 15.261237715622663, "cost1_max": 502.7890657912593, "cost1_min": 28.801609039369477, "cost2_max": -12.38845334653608, "outflow_rate_mean": 1222.5416484018979, "system_level_velocity_min": 12.237188606109266, "outflow_rate_max": 1594.0541164835165, "system_level_velocity_max": 19.410370245482344}, "info": {"num_steps_trained": 10606405, "load_time_ms": 14.056, "grad_time_ms": 9968.476, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.018017668277025223, "total_loss": 11.527931213378906, "vf_loss": 11.531298637390137, "policy_loss": -0.0067884959280490875, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9746382832527161, "entropy": 1.2322931289672852}, "update_time_ms": 7.978, "num_steps_sampled": 10606405, "sample_time_ms": 16035.101}, "episode_len_mean": 659.88, "time_this_iter_s": 25.836291790008545, "num_metric_batches_dropped": 0, "timesteps_total": 10606405, "episodes_total": 4009, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0908>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1645.2472018662413, "episodes_this_iter": 15, "time_total_s": 6420.664105653763, "time_since_restore": 6420.664105653763}
{"timestamp": 1557221167, "timesteps_since_restore": 10651685, "training_iteration": 251, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-26-07", "episode_reward_min": 56.544454993985795, "timesteps_this_iter": 45280, "episode_reward_mean": 1230.818753481858, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 251, "custom_metrics": {"cost2_mean": -99.23868047937081, "cost2_min": -124.15609182884731, "cost1_mean": 367.9736580503339, "outflow_rate_min": 338.35525222187107, "system_level_velocity_mean": 15.258448915982173, "cost1_max": 502.7890657912593, "cost1_min": 28.801609039369477, "cost2_max": -12.38845334653608, "outflow_rate_mean": 1226.0203715087907, "system_level_velocity_min": 12.237188606109266, "outflow_rate_max": 1661.4604850561202, "system_level_velocity_max": 19.410370245482344}, "info": {"num_steps_trained": 10651685, "load_time_ms": 14.213, "grad_time_ms": 9997.77, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013367608189582825, "total_loss": 8.176328659057617, "vf_loss": 8.179689407348633, "policy_loss": -0.005898904055356979, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.978854238986969, "entropy": 1.2683128118515015}, "update_time_ms": 7.891, "num_steps_sampled": 10651685, "sample_time_ms": 16187.686}, "episode_len_mean": 659.88, "time_this_iter_s": 27.495337963104248, "num_metric_batches_dropped": 0, "timesteps_total": 10651685, "episodes_total": 4024, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc63c8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6ba8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1645.2472018662413, "episodes_this_iter": 15, "time_total_s": 6448.159443616867, "time_since_restore": 6448.159443616867}
{"timestamp": 1557221193, "timesteps_since_restore": 10695252, "training_iteration": 252, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-26-33", "episode_reward_min": 169.48059816193663, "timesteps_this_iter": 43567, "episode_reward_mean": 1216.9728117376033, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 252, "custom_metrics": {"cost2_mean": -100.77848244975186, "cost2_min": -124.29226642806091, "cost1_mean": 360.80909302427034, "outflow_rate_min": 438.71551708833755, "system_level_velocity_mean": 15.024916065390446, "cost1_max": 497.5805930105663, "cost1_min": 76.15715463708729, "cost2_max": -19.327580422442942, "outflow_rate_mean": 1209.7199492315735, "system_level_velocity_min": 12.237188606109266, "outflow_rate_max": 1661.4604850561202, "system_level_velocity_max": 19.179138465617836}, "info": {"num_steps_trained": 10695252, "load_time_ms": 14.291, "grad_time_ms": 10005.964, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01483460608869791, "total_loss": 16.099397659301758, "vf_loss": 16.10122299194336, "policy_loss": -0.004642672371119261, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9639015793800354, "entropy": 1.2495815753936768}, "update_time_ms": 7.847, "num_steps_sampled": 10695252, "sample_time_ms": 16189.046}, "episode_len_mean": 658.62, "time_this_iter_s": 26.324299573898315, "num_metric_batches_dropped": 0, "timesteps_total": 10695252, "episodes_total": 4044, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6b70>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1544.7234695302316, "episodes_this_iter": 20, "time_total_s": 6474.483743190765, "time_since_restore": 6474.483743190765}
{"timestamp": 1557221219, "timesteps_since_restore": 10738280, "training_iteration": 253, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-26-59", "episode_reward_min": 169.48059816193663, "timesteps_this_iter": 43028, "episode_reward_mean": 1209.6871767694986, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 253, "custom_metrics": {"cost2_mean": -101.19362293575303, "cost2_min": -124.29226642806091, "cost1_mean": 359.2735172805055, "outflow_rate_min": 438.71551708833755, "system_level_velocity_mean": 15.139395898910113, "cost1_max": 497.5805930105663, "cost1_min": 76.15715463708729, "cost2_max": -19.327580422442942, "outflow_rate_mean": 1213.317184346195, "system_level_velocity_min": 12.237188606109266, "outflow_rate_max": 1661.4604850561202, "system_level_velocity_max": 19.334216654943507}, "info": {"num_steps_trained": 10738280, "load_time_ms": 14.415, "grad_time_ms": 10041.884, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015661660581827164, "total_loss": 9.273356437683105, "vf_loss": 9.277298927307129, "policy_loss": -0.006914892233908176, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9798771142959595, "entropy": 1.2874287366867065}, "update_time_ms": 7.742, "num_steps_sampled": 10738280, "sample_time_ms": 16060.063}, "episode_len_mean": 651.84, "time_this_iter_s": 25.405080556869507, "num_metric_batches_dropped": 0, "timesteps_total": 10738280, "episodes_total": 4057, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6390>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6b00>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1544.7234695302316, "episodes_this_iter": 13, "time_total_s": 6499.888823747635, "time_since_restore": 6499.888823747635}
{"timestamp": 1557221245, "timesteps_since_restore": 10780269, "training_iteration": 254, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-27-25", "episode_reward_min": 169.48059816193663, "timesteps_this_iter": 41989, "episode_reward_mean": 1225.7262501001146, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 254, "custom_metrics": {"cost2_mean": -102.23889453554318, "cost2_min": -134.5442505633718, "cost1_mean": 365.8422939137108, "outflow_rate_min": 438.71551708833755, "system_level_velocity_mean": 15.201581909382334, "cost1_max": 509.5711989437838, "cost1_min": 76.15715463708729, "cost2_max": -19.327580422442942, "outflow_rate_mean": 1232.5962479153316, "system_level_velocity_min": 12.237188606109266, "outflow_rate_max": 1661.4604850561202, "system_level_velocity_max": 19.334216654943507}, "info": {"num_steps_trained": 10780269, "load_time_ms": 14.346, "grad_time_ms": 10021.29, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01616917923092842, "total_loss": 12.324410438537598, "vf_loss": 12.330268859863281, "policy_loss": -0.008926606737077236, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9731336236000061, "entropy": 1.2876123189926147}, "update_time_ms": 7.604, "num_steps_sampled": 10780269, "sample_time_ms": 16014.558}, "episode_len_mean": 658.29, "time_this_iter_s": 25.747411251068115, "num_metric_batches_dropped": 0, "timesteps_total": 10780269, "episodes_total": 4076, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbbe0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1544.7234695302316, "episodes_this_iter": 19, "time_total_s": 6525.636234998703, "time_since_restore": 6525.636234998703}
{"timestamp": 1557221270, "timesteps_since_restore": 10824363, "training_iteration": 255, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-27-50", "episode_reward_min": 185.72217649730786, "timesteps_this_iter": 44094, "episode_reward_mean": 1244.9396761611213, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 255, "custom_metrics": {"cost2_mean": -104.13443997319793, "cost2_min": -134.5442505633718, "cost1_mean": 370.754081245787, "outflow_rate_min": 458.40943295269415, "system_level_velocity_mean": 15.222441475656533, "cost1_max": 509.5711989437838, "cost1_min": 79.03178024857348, "cost2_max": -22.88447848628217, "outflow_rate_mean": 1248.379417896355, "system_level_velocity_min": 12.237188606109266, "outflow_rate_max": 1661.4604850561202, "system_level_velocity_max": 19.334216654943507}, "info": {"num_steps_trained": 10824363, "load_time_ms": 14.341, "grad_time_ms": 10115.416, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013430637307465076, "total_loss": 6.1615800857543945, "vf_loss": 6.165103435516357, "policy_loss": -0.006074501201510429, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9830272793769836, "entropy": 1.300584077835083}, "update_time_ms": 7.613, "num_steps_sampled": 10824363, "sample_time_ms": 15864.18}, "episode_len_mean": 664.21, "time_this_iter_s": 25.927618503570557, "num_metric_batches_dropped": 0, "timesteps_total": 10824363, "episodes_total": 4089, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34940>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1544.7234695302316, "episodes_this_iter": 13, "time_total_s": 6551.563853502274, "time_since_restore": 6551.563853502274}
{"timestamp": 1557221297, "timesteps_since_restore": 10869140, "training_iteration": 256, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-28-17", "episode_reward_min": 185.72217649730786, "timesteps_this_iter": 44777, "episode_reward_mean": 1237.0713085057564, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 256, "custom_metrics": {"cost2_mean": -104.96892064002913, "cost2_min": -134.5442505633718, "cost1_mean": 366.66277720092484, "outflow_rate_min": 458.40943295269415, "system_level_velocity_mean": 15.097722757992713, "cost1_max": 509.5711989437838, "cost1_min": 79.03178024857348, "cost2_max": -22.88447848628217, "outflow_rate_mean": 1238.8697205223207, "system_level_velocity_min": 12.321020148910891, "outflow_rate_max": 1661.4604850561202, "system_level_velocity_max": 19.334216654943507}, "info": {"num_steps_trained": 10869140, "load_time_ms": 14.511, "grad_time_ms": 10150.912, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015433785505592823, "total_loss": 8.75163459777832, "vf_loss": 8.757721900939941, "policy_loss": -0.009016858413815498, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9795317053794861, "entropy": 1.3028910160064697}, "update_time_ms": 7.686, "num_steps_sampled": 10869140, "sample_time_ms": 16025.277}, "episode_len_mean": 663.29, "time_this_iter_s": 26.900890827178955, "num_metric_batches_dropped": 0, "timesteps_total": 10869140, "episodes_total": 4102, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0ac8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0e80>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1544.7234695302316, "episodes_this_iter": 13, "time_total_s": 6578.4647443294525, "time_since_restore": 6578.4647443294525}
{"timestamp": 1557221322, "timesteps_since_restore": 10911314, "training_iteration": 257, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-28-42", "episode_reward_min": 180.99652079520396, "timesteps_this_iter": 42174, "episode_reward_mean": 1223.4644607572523, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 257, "custom_metrics": {"cost2_mean": -104.12895780758667, "cost2_min": -134.5442505633718, "cost1_mean": 364.1655365210378, "outflow_rate_min": 458.40943295269415, "system_level_velocity_mean": 15.281417974662505, "cost1_max": 509.5711989437838, "cost1_min": 77.79132959304091, "cost2_max": -23.697617147332227, "outflow_rate_mean": 1235.893732121928, "system_level_velocity_min": 12.321020148910891, "outflow_rate_max": 1667.9436875124877, "system_level_velocity_max": 19.344607648276025}, "info": {"num_steps_trained": 10911314, "load_time_ms": 14.751, "grad_time_ms": 10134.487, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.016175908967852592, "total_loss": 19.758691787719727, "vf_loss": 19.760988235473633, "policy_loss": -0.0053687612526118755, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9586401581764221, "entropy": 1.2581769227981567}, "update_time_ms": 7.537, "num_steps_sampled": 10911314, "sample_time_ms": 15884.503}, "episode_len_mean": 652.56, "time_this_iter_s": 24.811392545700073, "num_metric_batches_dropped": 0, "timesteps_total": 10911314, "episodes_total": 4121, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbe80>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb7f0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1551.1741273438702, "episodes_this_iter": 19, "time_total_s": 6603.276136875153, "time_since_restore": 6603.276136875153}
{"timestamp": 1557221348, "timesteps_since_restore": 10952841, "training_iteration": 258, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-29-08", "episode_reward_min": 180.99652079520396, "timesteps_this_iter": 41527, "episode_reward_mean": 1232.312772344853, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 258, "custom_metrics": {"cost2_mean": -103.06397059421955, "cost2_min": -134.5442505633718, "cost1_mean": 370.95491027903734, "outflow_rate_min": 458.40943295269415, "system_level_velocity_mean": 15.477557393720723, "cost1_max": 509.5711989437838, "cost1_min": 77.79132959304091, "cost2_max": -23.697617147332227, "outflow_rate_mean": 1251.1069527647594, "system_level_velocity_min": 12.294711647554436, "outflow_rate_max": 1667.9436875124877, "system_level_velocity_max": 19.344607648276025}, "info": {"num_steps_trained": 10952841, "load_time_ms": 14.08, "grad_time_ms": 10179.162, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01352706365287304, "total_loss": 12.292814254760742, "vf_loss": 12.29636001586914, "policy_loss": -0.0061143627390265465, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9739608764648438, "entropy": 1.3277523517608643}, "update_time_ms": 7.638, "num_steps_sampled": 10952841, "sample_time_ms": 15777.041}, "episode_len_mean": 655.36, "time_this_iter_s": 25.763423204421997, "num_metric_batches_dropped": 0, "timesteps_total": 10952841, "episodes_total": 4140, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb160>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1588.5396256181352, "episodes_this_iter": 19, "time_total_s": 6629.039560079575, "time_since_restore": 6629.039560079575}
{"timestamp": 1557221374, "timesteps_since_restore": 10996835, "training_iteration": 259, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-29-34", "episode_reward_min": 180.99652079520396, "timesteps_this_iter": 43994, "episode_reward_mean": 1238.0454107740886, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 259, "custom_metrics": {"cost2_mean": -102.31910544210685, "cost2_min": -134.5442505633718, "cost1_mean": 375.24653178452974, "outflow_rate_min": 471.8166004030129, "system_level_velocity_mean": 15.515463783889485, "cost1_max": 516.6576291079018, "cost1_min": 77.79132959304091, "cost2_max": -23.697617147332227, "outflow_rate_mean": 1260.6094873520153, "system_level_velocity_min": 12.294711647554436, "outflow_rate_max": 1683.4830677910325, "system_level_velocity_max": 19.597565065803625}, "info": {"num_steps_trained": 10996835, "load_time_ms": 14.232, "grad_time_ms": 10323.827, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01282282080501318, "total_loss": 11.30163288116455, "vf_loss": 11.305615425109863, "policy_loss": -0.006416719872504473, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9768338799476624, "entropy": 1.3010647296905518}, "update_time_ms": 7.765, "num_steps_sampled": 10996835, "sample_time_ms": 15621.104}, "episode_len_mean": 659.87, "time_this_iter_s": 26.399869680404663, "num_metric_batches_dropped": 0, "timesteps_total": 10996835, "episodes_total": 4152, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf04a8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0d30>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1721.6439401122213, "episodes_this_iter": 12, "time_total_s": 6655.439429759979, "time_since_restore": 6655.439429759979}
{"timestamp": 1557221401, "timesteps_since_restore": 11040594, "training_iteration": 260, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-30-01", "episode_reward_min": 180.99652079520396, "timesteps_this_iter": 43759, "episode_reward_mean": 1245.9049304929367, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 260, "custom_metrics": {"cost2_mean": -104.2558477029295, "cost2_min": -140.38460084610898, "cost1_mean": 375.35905383810575, "outflow_rate_min": 471.8166004030129, "system_level_velocity_mean": 15.432545657220999, "cost1_max": 516.6576291079018, "cost1_min": 77.79132959304091, "cost2_max": -23.697617147332227, "outflow_rate_mean": 1266.9783568732216, "system_level_velocity_min": 12.075638181757073, "outflow_rate_max": 1683.4830677910325, "system_level_velocity_max": 19.597565065803625}, "info": {"num_steps_trained": 11040594, "load_time_ms": 14.585, "grad_time_ms": 10413.15, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013310961425304413, "total_loss": 12.448408126831055, "vf_loss": 12.452600479125977, "policy_loss": -0.006719696335494518, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9742204546928406, "entropy": 1.3040611743927002}, "update_time_ms": 8.024, "num_steps_sampled": 11040594, "sample_time_ms": 15603.627}, "episode_len_mean": 663.51, "time_this_iter_s": 26.572577238082886, "num_metric_batches_dropped": 0, "timesteps_total": 11040594, "episodes_total": 4171, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0b38>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0a20>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1721.6439401122213, "episodes_this_iter": 19, "time_total_s": 6682.012006998062, "time_since_restore": 6682.012006998062}
{"timestamp": 1557221427, "timesteps_since_restore": 11084953, "training_iteration": 261, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-30-27", "episode_reward_min": 180.99652079520396, "timesteps_this_iter": 44359, "episode_reward_mean": 1246.1808407082656, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 261, "custom_metrics": {"cost2_mean": -103.99611776129042, "cost2_min": -140.38460084610898, "cost1_mean": 376.39919992236815, "outflow_rate_min": 471.8166004030129, "system_level_velocity_mean": 15.487969368430331, "cost1_max": 516.6576291079018, "cost1_min": 77.79132959304091, "cost2_max": -23.697617147332227, "outflow_rate_mean": 1266.2141182774646, "system_level_velocity_min": 12.075638181757073, "outflow_rate_max": 1683.4830677910325, "system_level_velocity_max": 19.597565065803625}, "info": {"num_steps_trained": 11084953, "load_time_ms": 14.547, "grad_time_ms": 10530.32, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013936067931354046, "total_loss": 8.268057823181152, "vf_loss": 8.2724027633667, "policy_loss": -0.0069907247088849545, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9806684255599976, "entropy": 1.314005732536316}, "update_time_ms": 8.17, "num_steps_sampled": 11084953, "sample_time_ms": 15292.691}, "episode_len_mean": 663.51, "time_this_iter_s": 25.564231395721436, "num_metric_batches_dropped": 0, "timesteps_total": 11084953, "episodes_total": 4183, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb438>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb908>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1721.6439401122213, "episodes_this_iter": 12, "time_total_s": 6707.576238393784, "time_since_restore": 6707.576238393784}
{"timestamp": 1557221452, "timesteps_since_restore": 11129634, "training_iteration": 262, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-30-52", "episode_reward_min": 180.99652079520396, "timesteps_this_iter": 44681, "episode_reward_mean": 1245.89433520747, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 262, "custom_metrics": {"cost2_mean": -103.78943483642354, "cost2_min": -140.38460084610898, "cost1_mean": 377.9984741817664, "outflow_rate_min": 471.8166004030129, "system_level_velocity_mean": 15.535279701414662, "cost1_max": 516.6576291079018, "cost1_min": 77.79132959304091, "cost2_max": -23.697617147332227, "outflow_rate_mean": 1270.4883538052861, "system_level_velocity_min": 12.075638181757073, "outflow_rate_max": 1683.4830677910325, "system_level_velocity_max": 19.597565065803625}, "info": {"num_steps_trained": 11129634, "load_time_ms": 14.567, "grad_time_ms": 10698.776, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01306676585227251, "total_loss": 14.35421371459961, "vf_loss": 14.35835075378418, "policy_loss": -0.006616357248276472, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9696516990661621, "entropy": 1.3325281143188477}, "update_time_ms": 8.469, "num_steps_sampled": 11129634, "sample_time_ms": 15065.302}, "episode_len_mean": 664.16, "time_this_iter_s": 25.707751989364624, "num_metric_batches_dropped": 0, "timesteps_total": 11129634, "episodes_total": 4199, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcc6668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6cc0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1721.6439401122213, "episodes_this_iter": 16, "time_total_s": 6733.283990383148, "time_since_restore": 6733.283990383148}
{"timestamp": 1557221480, "timesteps_since_restore": 11172973, "training_iteration": 263, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-31-20", "episode_reward_min": 256.9622580909686, "timesteps_this_iter": 43339, "episode_reward_mean": 1252.847258846374, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 263, "custom_metrics": {"cost2_mean": -104.06995097306962, "cost2_min": -140.38460084610898, "cost1_mean": 378.47457502922504, "outflow_rate_min": 548.9266417780265, "system_level_velocity_mean": 15.421185818377399, "cost1_max": 516.6576291079018, "cost1_min": 100.16910333624253, "cost2_max": -27.93891459335071, "outflow_rate_mean": 1267.997184818262, "system_level_velocity_min": 12.075638181757073, "outflow_rate_max": 1683.4830677910325, "system_level_velocity_max": 19.597565065803625}, "info": {"num_steps_trained": 11172973, "load_time_ms": 14.913, "grad_time_ms": 10809.437, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012540250085294247, "total_loss": 11.812957763671875, "vf_loss": 11.815911293029785, "policy_loss": -0.005334530957043171, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9739779233932495, "entropy": 1.3327207565307617}, "update_time_ms": 8.71, "num_steps_sampled": 11172973, "sample_time_ms": 15134.271}, "episode_len_mean": 669.97, "time_this_iter_s": 27.210441827774048, "num_metric_batches_dropped": 0, "timesteps_total": 11172973, "episodes_total": 4217, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd349b0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6e48>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1721.6439401122213, "episodes_this_iter": 18, "time_total_s": 6760.494432210922, "time_since_restore": 6760.494432210922}
{"timestamp": 1557221505, "timesteps_since_restore": 11215878, "training_iteration": 264, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-31-45", "episode_reward_min": 309.4028083796988, "timesteps_this_iter": 42905, "episode_reward_mean": 1271.186957400439, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 264, "custom_metrics": {"cost2_mean": -106.10674551246355, "cost2_min": -140.38460084610898, "cost1_mean": 383.7278084573879, "outflow_rate_min": 604.3130795720716, "system_level_velocity_mean": 15.336738972838988, "cost1_max": 516.6576291079018, "cost1_min": 121.13351565575684, "cost2_max": -34.63412984390591, "outflow_rate_mean": 1283.4264317596253, "system_level_velocity_min": 12.075638181757073, "outflow_rate_max": 1683.4830677910325, "system_level_velocity_max": 19.597565065803625}, "info": {"num_steps_trained": 11215878, "load_time_ms": 15.325, "grad_time_ms": 10890.582, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014176667667925358, "total_loss": 8.077239990234375, "vf_loss": 8.08051586151123, "policy_loss": -0.005966910161077976, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9824325442314148, "entropy": 1.3316991329193115}, "update_time_ms": 8.952, "num_steps_sampled": 11215878, "sample_time_ms": 15010.161}, "episode_len_mean": 680.48, "time_this_iter_s": 25.329455137252808, "num_metric_batches_dropped": 0, "timesteps_total": 11215878, "episodes_total": 4231, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34668>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0a58>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1721.6439401122213, "episodes_this_iter": 14, "time_total_s": 6785.823887348175, "time_since_restore": 6785.823887348175}
{"timestamp": 1557221532, "timesteps_since_restore": 11258394, "training_iteration": 265, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-32-12", "episode_reward_min": 302.41706855063165, "timesteps_this_iter": 42516, "episode_reward_mean": 1257.5013853695266, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 265, "custom_metrics": {"cost2_mean": -105.86147581288307, "cost2_min": -140.38460084610898, "cost1_mean": 376.9502091829927, "outflow_rate_min": 601.9647637466364, "system_level_velocity_mean": 15.295512271119327, "cost1_max": 505.70319474236146, "cost1_min": 114.15160530250739, "cost2_max": -32.31842588319331, "outflow_rate_mean": 1267.4589012786562, "system_level_velocity_min": 12.075638181757073, "outflow_rate_max": 1679.088668931069, "system_level_velocity_max": 19.096020456436985}, "info": {"num_steps_trained": 11258394, "load_time_ms": 15.109, "grad_time_ms": 10899.621, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013301366940140724, "total_loss": 18.972990036010742, "vf_loss": 18.975135803222656, "policy_loss": -0.004671745002269745, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9585947394371033, "entropy": 1.3119536638259888}, "update_time_ms": 9.07, "num_steps_sampled": 11258394, "sample_time_ms": 15081.32}, "episode_len_mean": 672.53, "time_this_iter_s": 26.755688190460205, "num_metric_batches_dropped": 0, "timesteps_total": 11258394, "episodes_total": 4249, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb6d8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccba90>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1670.4564728548412, "episodes_this_iter": 18, "time_total_s": 6812.579575538635, "time_since_restore": 6812.579575538635}
{"timestamp": 1557221559, "timesteps_since_restore": 11304120, "training_iteration": 266, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-32-39", "episode_reward_min": 302.41706855063165, "timesteps_this_iter": 45726, "episode_reward_mean": 1253.974177656488, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 266, "custom_metrics": {"cost2_mean": -104.08260098491778, "cost2_min": -140.38460084610898, "cost1_mean": 375.8764114468634, "outflow_rate_min": 601.9647637466364, "system_level_velocity_mean": 15.254182076729196, "cost1_max": 505.70319474236146, "cost1_min": 114.15160530250739, "cost2_max": -32.31842588319331, "outflow_rate_mean": 1261.5940315888013, "system_level_velocity_min": 12.075638181757073, "outflow_rate_max": 1679.088668931069, "system_level_velocity_max": 19.096020456436985}, "info": {"num_steps_trained": 11304120, "load_time_ms": 15.166, "grad_time_ms": 10997.47, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013292376883327961, "total_loss": 9.2999849319458, "vf_loss": 9.303427696228027, "policy_loss": -0.005965887103229761, "cur_kl_coeff": 0.1898437887430191, "vf_explained_var": 0.9736574292182922, "entropy": 1.4042826890945435}, "update_time_ms": 9.307, "num_steps_sampled": 11304120, "sample_time_ms": 15020.116}, "episode_len_mean": 672.1, "time_this_iter_s": 27.262930154800415, "num_metric_batches_dropped": 0, "timesteps_total": 11304120, "episodes_total": 4265, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8fd0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8f60>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1670.4564728548412, "episodes_this_iter": 16, "time_total_s": 6839.842505693436, "time_since_restore": 6839.842505693436}
{"timestamp": 1557221585, "timesteps_since_restore": 11347006, "training_iteration": 267, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-33-05", "episode_reward_min": 63.97641798775851, "timesteps_this_iter": 42886, "episode_reward_mean": 1211.8270493105215, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 267, "custom_metrics": {"cost2_mean": -100.0898918200591, "cost2_min": -139.05756563102685, "cost1_mean": 362.3688076539105, "outflow_rate_min": 313.51521265765604, "system_level_velocity_mean": 15.226469534428894, "cost1_max": 505.70319474236146, "cost1_min": 33.95956070367037, "cost2_max": -6.928203927545849, "outflow_rate_mean": 1228.888539817859, "system_level_velocity_min": 12.308326523489388, "outflow_rate_max": 1679.088668931069, "system_level_velocity_max": 19.402052366344996}, "info": {"num_steps_trained": 11347006, "load_time_ms": 14.955, "grad_time_ms": 11128.972, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01641799509525299, "total_loss": 17.14764404296875, "vf_loss": 17.15334701538086, "policy_loss": -0.00881879311054945, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9615591764450073, "entropy": 1.3565700054168701}, "update_time_ms": 9.532, "num_steps_sampled": 11347006, "sample_time_ms": 14956.823}, "episode_len_mean": 653.4, "time_this_iter_s": 25.51173424720764, "num_metric_batches_dropped": 0, "timesteps_total": 11347006, "episodes_total": 4281, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce86d8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce86a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8898>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1670.4564728548412, "episodes_this_iter": 16, "time_total_s": 6865.354239940643, "time_since_restore": 6865.354239940643}
{"timestamp": 1557221610, "timesteps_since_restore": 11390883, "training_iteration": 268, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-33-30", "episode_reward_min": 63.97641798775851, "timesteps_this_iter": 43877, "episode_reward_mean": 1228.9114857232842, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 268, "custom_metrics": {"cost2_mean": -98.66393227031084, "cost2_min": -139.05756563102685, "cost1_mean": 364.89021439445895, "outflow_rate_min": 313.51521265765604, "system_level_velocity_mean": 15.163138402173088, "cost1_max": 488.66425232327833, "cost1_min": 33.95956070367037, "cost2_max": -6.928203927545849, "outflow_rate_mean": 1235.0055986362681, "system_level_velocity_min": 12.216358923480549, "outflow_rate_max": 1652.4808451078334, "system_level_velocity_max": 19.402052366344996}, "info": {"num_steps_trained": 11390883, "load_time_ms": 15.183, "grad_time_ms": 11167.616, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015826763585209846, "total_loss": 11.562012672424316, "vf_loss": 11.567131996154785, "policy_loss": -0.008122705854475498, "cur_kl_coeff": 0.1898437887430191, "vf_explained_var": 0.9697461724281311, "entropy": 1.3798890113830566}, "update_time_ms": 9.613, "num_steps_sampled": 11390883, "sample_time_ms": 14899.734}, "episode_len_mean": 658.32, "time_this_iter_s": 25.594358682632446, "num_metric_batches_dropped": 0, "timesteps_total": 11390883, "episodes_total": 4297, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0a58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf09b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0e80>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1670.4564728548412, "episodes_this_iter": 16, "time_total_s": 6890.948598623276, "time_since_restore": 6890.948598623276}
{"timestamp": 1557221635, "timesteps_since_restore": 11433721, "training_iteration": 269, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-33-55", "episode_reward_min": 63.97641798775851, "timesteps_this_iter": 42838, "episode_reward_mean": 1247.0607767475276, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 269, "custom_metrics": {"cost2_mean": -96.52785740610334, "cost2_min": -139.05756563102685, "cost1_mean": 369.47734748005854, "outflow_rate_min": 313.51521265765604, "system_level_velocity_mean": 15.168774508625267, "cost1_max": 488.66425232327833, "cost1_min": 33.95956070367037, "cost2_max": -6.928203927545849, "outflow_rate_mean": 1246.7481969647913, "system_level_velocity_min": 12.216358923480549, "outflow_rate_max": 1652.4808451078334, "system_level_velocity_max": 19.402052366344996}, "info": {"num_steps_trained": 11433721, "load_time_ms": 15.164, "grad_time_ms": 11048.027, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015370569191873074, "total_loss": 9.234285354614258, "vf_loss": 9.239081382751465, "policy_loss": -0.007715276442468166, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9783927202224731, "entropy": 1.3783044815063477}, "update_time_ms": 9.609, "num_steps_sampled": 11433721, "sample_time_ms": 14900.895}, "episode_len_mean": 663.3, "time_this_iter_s": 25.23637580871582, "num_metric_batches_dropped": 0, "timesteps_total": 11433721, "episodes_total": 4312, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf04e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0f60>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1620.7199244369656, "episodes_this_iter": 15, "time_total_s": 6916.184974431992, "time_since_restore": 6916.184974431992}
{"timestamp": 1557221662, "timesteps_since_restore": 11477448, "training_iteration": 270, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-34-22", "episode_reward_min": 63.97641798775851, "timesteps_this_iter": 43727, "episode_reward_mean": 1229.3385189026862, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 270, "custom_metrics": {"cost2_mean": -91.5145663439697, "cost2_min": -127.99367847805922, "cost1_mean": 365.3125637581129, "outflow_rate_min": 313.51521265765604, "system_level_velocity_mean": 15.272462187608788, "cost1_max": 486.4341906586419, "cost1_min": 33.95956070367037, "cost2_max": -6.928203927545849, "outflow_rate_mean": 1229.1799951603355, "system_level_velocity_min": 11.975899286558088, "outflow_rate_max": 1598.006145137216, "system_level_velocity_max": 19.402052366344996}, "info": {"num_steps_trained": 11477448, "load_time_ms": 14.762, "grad_time_ms": 11011.627, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015342467464506626, "total_loss": 13.86646842956543, "vf_loss": 13.870391845703125, "policy_loss": -0.006835984997451305, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.968697190284729, "entropy": 1.3899847269058228}, "update_time_ms": 9.648, "num_steps_sampled": 11477448, "sample_time_ms": 14934.591}, "episode_len_mean": 652.45, "time_this_iter_s": 26.547778606414795, "num_metric_batches_dropped": 0, "timesteps_total": 11477448, "episodes_total": 4329, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0828>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0438>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1620.7199244369656, "episodes_this_iter": 17, "time_total_s": 6942.732753038406, "time_since_restore": 6942.732753038406}
{"timestamp": 1557221688, "timesteps_since_restore": 11519739, "training_iteration": 271, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-34-48", "episode_reward_min": 63.97641798775851, "timesteps_this_iter": 42291, "episode_reward_mean": 1230.4411716856769, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 271, "custom_metrics": {"cost2_mean": -89.86350923351738, "cost2_min": -125.03754713221336, "cost1_mean": 363.19462029574856, "outflow_rate_min": 313.51521265765604, "system_level_velocity_mean": 15.191145382225377, "cost1_max": 480.4164038840051, "cost1_min": 33.95956070367037, "cost2_max": -6.928203927545849, "outflow_rate_mean": 1221.7483680154282, "system_level_velocity_min": 11.975899286558088, "outflow_rate_max": 1571.523693106893, "system_level_velocity_max": 19.402052366344996}, "info": {"num_steps_trained": 11519739, "load_time_ms": 14.727, "grad_time_ms": 10950.614, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015323411673307419, "total_loss": 16.429086685180664, "vf_loss": 16.433212280273438, "policy_loss": -0.0070350863970816135, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9614363312721252, "entropy": 1.3581197261810303}, "update_time_ms": 9.491, "num_steps_sampled": 11519739, "sample_time_ms": 15014.244}, "episode_len_mean": 651.69, "time_this_iter_s": 25.765599489212036, "num_metric_batches_dropped": 0, "timesteps_total": 11519739, "episodes_total": 4345, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8898>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1620.7199244369656, "episodes_this_iter": 16, "time_total_s": 6968.498352527618, "time_since_restore": 6968.498352527618}
{"timestamp": 1557221714, "timesteps_since_restore": 11563829, "training_iteration": 272, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-35-14", "episode_reward_min": 63.517882932405584, "timesteps_this_iter": 44090, "episode_reward_mean": 1249.355161813086, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 272, "custom_metrics": {"cost2_mean": -88.15175774232077, "cost2_min": -116.0371904006052, "cost1_mean": 367.6101149679473, "outflow_rate_min": 313.51521265765604, "system_level_velocity_mean": 15.258258143551275, "cost1_max": 482.03804354932936, "cost1_min": 33.95956070367037, "cost2_max": -6.928203927545849, "outflow_rate_mean": 1236.0948723744314, "system_level_velocity_min": 11.975899286558088, "outflow_rate_max": 1571.523693106893, "system_level_velocity_max": 19.402052366344996}, "info": {"num_steps_trained": 11563829, "load_time_ms": 14.969, "grad_time_ms": 10866.315, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014455262571573257, "total_loss": 13.877137184143066, "vf_loss": 13.882003784179688, "policy_loss": -0.007608816958963871, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9634023308753967, "entropy": 1.402259349822998}, "update_time_ms": 9.535, "num_steps_sampled": 11563829, "sample_time_ms": 15162.448}, "episode_len_mean": 654.9, "time_this_iter_s": 26.3583345413208, "num_metric_batches_dropped": 0, "timesteps_total": 11563829, "episodes_total": 4361, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf07b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0400>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1620.7199244369656, "episodes_this_iter": 16, "time_total_s": 6994.856687068939, "time_since_restore": 6994.856687068939}
{"timestamp": 1557221740, "timesteps_since_restore": 11607851, "training_iteration": 273, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-35-40", "episode_reward_min": 63.517882932405584, "timesteps_this_iter": 44022, "episode_reward_mean": 1279.9583653076343, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 273, "custom_metrics": {"cost2_mean": -90.9466492006114, "cost2_min": -119.5788396500053, "cost1_mean": 374.96365123813024, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 15.177274270738462, "cost1_max": 482.03804354932936, "cost1_min": 34.14428637294468, "cost2_max": -15.973711061881477, "outflow_rate_mean": 1261.1586645937177, "system_level_velocity_min": 11.975899286558088, "outflow_rate_max": 1571.523693106893, "system_level_velocity_max": 19.402052366344996}, "info": {"num_steps_trained": 11607851, "load_time_ms": 14.905, "grad_time_ms": 10789.062, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.013938114047050476, "total_loss": 10.925188064575195, "vf_loss": 10.929291725158691, "policy_loss": -0.006750180386006832, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.972784698009491, "entropy": 1.4093085527420044}, "update_time_ms": 9.566, "num_steps_sampled": 11607851, "sample_time_ms": 15097.736}, "episode_len_mean": 667.89, "time_this_iter_s": 25.79719591140747, "num_metric_batches_dropped": 0, "timesteps_total": 11607851, "episodes_total": 4377, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2da0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd25f8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1620.7199244369656, "episodes_this_iter": 16, "time_total_s": 7020.653882980347, "time_since_restore": 7020.653882980347}
{"timestamp": 1557221765, "timesteps_since_restore": 11651760, "training_iteration": 274, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-36-05", "episode_reward_min": 63.517882932405584, "timesteps_this_iter": 43909, "episode_reward_mean": 1276.2365025853808, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 274, "custom_metrics": {"cost2_mean": -91.58756493444629, "cost2_min": -120.66196740227298, "cost1_mean": 372.57928399941216, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 15.071124376274154, "cost1_max": 486.576944001472, "cost1_min": 34.14428637294468, "cost2_max": -15.973711061881477, "outflow_rate_mean": 1255.7275117628992, "system_level_velocity_min": 11.975899286558088, "outflow_rate_max": 1571.523693106893, "system_level_velocity_max": 19.29495852305188}, "info": {"num_steps_trained": 11651760, "load_time_ms": 14.117, "grad_time_ms": 10658.273, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.015298922546207905, "total_loss": 12.481926918029785, "vf_loss": 12.485818862915039, "policy_loss": -0.006797093898057938, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9683729410171509, "entropy": 1.42499840259552}, "update_time_ms": 9.573, "num_steps_sampled": 11651760, "sample_time_ms": 15202.922}, "episode_len_mean": 667.82, "time_this_iter_s": 25.091190099716187, "num_metric_batches_dropped": 0, "timesteps_total": 11651760, "episodes_total": 4392, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce88d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd69e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1620.7199244369656, "episodes_this_iter": 15, "time_total_s": 7045.745073080063, "time_since_restore": 7045.745073080063}
{"timestamp": 1557221792, "timesteps_since_restore": 11694925, "training_iteration": 275, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-36-32", "episode_reward_min": 63.517882932405584, "timesteps_this_iter": 43165, "episode_reward_mean": 1256.7965060779593, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 275, "custom_metrics": {"cost2_mean": -92.00740434134431, "cost2_min": -120.66196740227298, "cost1_mean": 367.5527528947548, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 15.01770446181067, "cost1_max": 486.576944001472, "cost1_min": 34.14428637294468, "cost2_max": -15.973711061881477, "outflow_rate_mean": 1243.2258173690404, "system_level_velocity_min": 11.975899286558088, "outflow_rate_max": 1571.2545378621378, "system_level_velocity_max": 19.29495852305188}, "info": {"num_steps_trained": 11694925, "load_time_ms": 14.097, "grad_time_ms": 10616.315, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01605156622827053, "total_loss": 13.343024253845215, "vf_loss": 13.34814167022705, "policy_loss": -0.008164109662175179, "cur_kl_coeff": 0.18984375894069672, "vf_explained_var": 0.9688206315040588, "entropy": 1.409974455833435}, "update_time_ms": 9.608, "num_steps_sampled": 11694925, "sample_time_ms": 15288.644}, "episode_len_mean": 663.04, "time_this_iter_s": 27.184439182281494, "num_metric_batches_dropped": 0, "timesteps_total": 11694925, "episodes_total": 4409, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce80f0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8898>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1570.9188080339197, "episodes_this_iter": 17, "time_total_s": 7072.929512262344, "time_since_restore": 7072.929512262344}
{"timestamp": 1557221819, "timesteps_since_restore": 11738332, "training_iteration": 276, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-36-59", "episode_reward_min": 63.517882932405584, "timesteps_this_iter": 43407, "episode_reward_mean": 1260.0871569199164, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 276, "custom_metrics": {"cost2_mean": -93.0946996377703, "cost2_min": -120.66196740227298, "cost1_mean": 368.9528344843669, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 15.057982791414426, "cost1_max": 498.6893402905682, "cost1_min": 34.14428637294468, "cost2_max": -15.973711061881477, "outflow_rate_mean": 1249.6255066424728, "system_level_velocity_min": 12.424020481050004, "outflow_rate_max": 1614.9175806193807, "system_level_velocity_max": 19.29495852305188}, "info": {"num_steps_trained": 11738332, "load_time_ms": 14.273, "grad_time_ms": 10506.313, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.014059068635106087, "total_loss": 11.437283515930176, "vf_loss": 11.44128131866455, "policy_loss": -0.0066658197902143, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9738483428955078, "entropy": 1.3961824178695679}, "update_time_ms": 9.817, "num_steps_sampled": 11738332, "sample_time_ms": 15367.396}, "episode_len_mean": 663.04, "time_this_iter_s": 26.95272946357727, "num_metric_batches_dropped": 0, "timesteps_total": 11738332, "episodes_total": 4424, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0e10>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0400>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1570.9188080339197, "episodes_this_iter": 15, "time_total_s": 7099.882241725922, "time_since_restore": 7099.882241725922}
{"timestamp": 1557221847, "timesteps_since_restore": 11783148, "training_iteration": 277, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-37-27", "episode_reward_min": 63.517882932405584, "timesteps_this_iter": 44816, "episode_reward_mean": 1281.9455294393122, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 277, "custom_metrics": {"cost2_mean": -96.4971080499678, "cost2_min": -134.99040140489538, "cost1_mean": 372.57259545505394, "outflow_rate_min": 332.7571298140349, "system_level_velocity_mean": 14.813828431885431, "cost1_max": 498.6893402905682, "cost1_min": 34.14428637294468, "cost2_max": -15.973711061881477, "outflow_rate_mean": 1262.1469601547078, "system_level_velocity_min": 12.424020481050004, "outflow_rate_max": 1614.9175806193807, "system_level_velocity_max": 19.19284220026724}, "info": {"num_steps_trained": 11783148, "load_time_ms": 14.523, "grad_time_ms": 10454.272, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.025823352858424187, "total_loss": 10.712700843811035, "vf_loss": 10.71013069152832, "policy_loss": -0.002331564435735345, "cur_kl_coeff": 0.1898437738418579, "vf_explained_var": 0.9727864265441895, "entropy": 1.4260493516921997}, "update_time_ms": 9.85, "num_steps_sampled": 11783148, "sample_time_ms": 15618.164}, "episode_len_mean": 677.91, "time_this_iter_s": 27.4833242893219, "num_metric_batches_dropped": 0, "timesteps_total": 11783148, "episodes_total": 4439, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0128>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb940>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1647.293845252359, "episodes_this_iter": 15, "time_total_s": 7127.3655660152435, "time_since_restore": 7127.3655660152435}
{"timestamp": 1557221871, "timesteps_since_restore": 11826242, "training_iteration": 278, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-37-51", "episode_reward_min": 192.55454570287066, "timesteps_this_iter": 43094, "episode_reward_mean": 1286.1942523010773, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 278, "custom_metrics": {"cost2_mean": -97.48290364034494, "cost2_min": -134.99040140489538, "cost1_mean": 373.9376007228664, "outflow_rate_min": 442.67095484181755, "system_level_velocity_mean": 14.695642396728108, "cost1_max": 498.6893402905682, "cost1_min": 82.28739820246055, "cost2_max": -24.899536847108443, "outflow_rate_mean": 1257.427606320163, "system_level_velocity_min": 12.048010621292471, "outflow_rate_max": 1614.9175806193807, "system_level_velocity_max": 18.706592753435867}, "info": {"num_steps_trained": 11826242, "load_time_ms": 14.3, "grad_time_ms": 10355.118, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010801934637129307, "total_loss": 7.502389907836914, "vf_loss": 7.505443572998047, "policy_loss": -0.006130112800747156, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9838221669197083, "entropy": 1.3846253156661987}, "update_time_ms": 9.952, "num_steps_sampled": 11826242, "sample_time_ms": 15607.739}, "episode_len_mean": 684.41, "time_this_iter_s": 24.510584354400635, "num_metric_batches_dropped": 0, "timesteps_total": 11826242, "episodes_total": 4452, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd69e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1647.293845252359, "episodes_this_iter": 13, "time_total_s": 7151.876150369644, "time_since_restore": 7151.876150369644}
{"timestamp": 1557221898, "timesteps_since_restore": 11871020, "training_iteration": 279, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-38-18", "episode_reward_min": 192.55454570287066, "timesteps_this_iter": 44778, "episode_reward_mean": 1288.820748416634, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 279, "custom_metrics": {"cost2_mean": -98.00571747751813, "cost2_min": -134.99040140489538, "cost1_mean": 374.6848535564275, "outflow_rate_min": 442.67095484181755, "system_level_velocity_mean": 14.727150320034411, "cost1_max": 498.6893402905682, "cost1_min": 82.28739820246055, "cost2_max": -24.899536847108443, "outflow_rate_mean": 1255.7644081500978, "system_level_velocity_min": 12.048010621292471, "outflow_rate_max": 1614.9175806193807, "system_level_velocity_max": 18.706592753435867}, "info": {"num_steps_trained": 11871020, "load_time_ms": 14.6, "grad_time_ms": 10297.232, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010800521820783615, "total_loss": 7.681930065155029, "vf_loss": 7.684142112731934, "policy_loss": -0.0052870092913508415, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9808571934700012, "entropy": 1.4226149320602417}, "update_time_ms": 10.058, "num_steps_sampled": 11871020, "sample_time_ms": 15784.894}, "episode_len_mean": 684.41, "time_this_iter_s": 26.447255849838257, "num_metric_batches_dropped": 0, "timesteps_total": 11871020, "episodes_total": 4467, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd65c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd67f0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1647.293845252359, "episodes_this_iter": 15, "time_total_s": 7178.323406219482, "time_since_restore": 7178.323406219482}
{"timestamp": 1557221925, "timesteps_since_restore": 11914457, "training_iteration": 280, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-38-45", "episode_reward_min": 192.55454570287066, "timesteps_this_iter": 43437, "episode_reward_mean": 1287.2496350049869, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 280, "custom_metrics": {"cost2_mean": -97.32716746545228, "cost2_min": -134.99040140489538, "cost1_mean": 375.3634405458477, "outflow_rate_min": 442.67095484181755, "system_level_velocity_mean": 14.760275405755076, "cost1_max": 498.6893402905682, "cost1_min": 82.28739820246055, "cost2_max": -24.899536847108443, "outflow_rate_mean": 1254.3218919829706, "system_level_velocity_min": 11.845118980047305, "outflow_rate_max": 1620.370728071928, "system_level_velocity_max": 18.706592753435867}, "info": {"num_steps_trained": 11914457, "load_time_ms": 14.547, "grad_time_ms": 10267.702, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011135712265968323, "total_loss": 8.896842002868652, "vf_loss": 8.900723457336426, "policy_loss": -0.007052188273519278, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9807162880897522, "entropy": 1.4025932550430298}, "update_time_ms": 9.878, "num_steps_sampled": 11914457, "sample_time_ms": 15876.636}, "episode_len_mean": 684.41, "time_this_iter_s": 27.17187809944153, "num_metric_batches_dropped": 0, "timesteps_total": 11914457, "episodes_total": 4484, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0240>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0ef0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1647.293845252359, "episodes_this_iter": 17, "time_total_s": 7205.495284318924, "time_since_restore": 7205.495284318924}
{"timestamp": 1557221954, "timesteps_since_restore": 11960092, "training_iteration": 281, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-39-14", "episode_reward_min": 380.55001049778093, "timesteps_this_iter": 45635, "episode_reward_mean": 1292.016204921539, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 281, "custom_metrics": {"cost2_mean": -97.93464321901783, "cost2_min": -134.99040140489538, "cost1_mean": 374.14366546958735, "outflow_rate_min": 697.1089058639878, "system_level_velocity_mean": 14.711247377376814, "cost1_max": 498.6893402905682, "cost1_min": 127.59900167584206, "cost2_max": -33.9393843897216, "outflow_rate_mean": 1249.776668321188, "system_level_velocity_min": 11.663759715973194, "outflow_rate_max": 1620.370728071928, "system_level_velocity_max": 18.706592753435867}, "info": {"num_steps_trained": 11960092, "load_time_ms": 14.703, "grad_time_ms": 10333.037, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.0106464559212327, "total_loss": 9.098457336425781, "vf_loss": 9.101020812988281, "policy_loss": -0.005595321301370859, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9768132567405701, "entropy": 1.455826997756958}, "update_time_ms": 10.127, "num_steps_sampled": 11960092, "sample_time_ms": 16151.664}, "episode_len_mean": 685.05, "time_this_iter_s": 29.16302490234375, "num_metric_batches_dropped": 0, "timesteps_total": 11960092, "episodes_total": 4501, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0208>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf07f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0780>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1649.250420488442, "episodes_this_iter": 17, "time_total_s": 7234.658309221268, "time_since_restore": 7234.658309221268}
{"timestamp": 1557221982, "timesteps_since_restore": 12004939, "training_iteration": 282, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-39-42", "episode_reward_min": 53.57093284316544, "timesteps_this_iter": 44847, "episode_reward_mean": 1255.975731814521, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 282, "custom_metrics": {"cost2_mean": -95.72274657239579, "cost2_min": -134.99040140489538, "cost1_mean": 363.2435544257834, "outflow_rate_min": 329.0289964895558, "system_level_velocity_mean": 14.767042140763728, "cost1_max": 498.6893402905682, "cost1_min": 28.688023098205225, "cost2_max": -10.493958424810286, "outflow_rate_mean": 1220.5430477988912, "system_level_velocity_min": 11.663759715973194, "outflow_rate_max": 1620.370728071928, "system_level_velocity_max": 19.65947703684609}, "info": {"num_steps_trained": 12004939, "load_time_ms": 14.615, "grad_time_ms": 10473.622, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011044513434171677, "total_loss": 14.5138578414917, "vf_loss": 14.517098426818848, "policy_loss": -0.006385923828929663, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9654425978660583, "entropy": 1.3996057510375977}, "update_time_ms": 10.148, "num_steps_sampled": 12004939, "sample_time_ms": 16178.717}, "episode_len_mean": 667.87, "time_this_iter_s": 28.027262449264526, "num_metric_batches_dropped": 0, "timesteps_total": 12004939, "episodes_total": 4514, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34c18>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fd34470>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1649.250420488442, "episodes_this_iter": 13, "time_total_s": 7262.685571670532, "time_since_restore": 7262.685571670532}
{"timestamp": 1557222009, "timesteps_since_restore": 12049365, "training_iteration": 283, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-40-09", "episode_reward_min": 53.57093284316544, "timesteps_this_iter": 44426, "episode_reward_mean": 1241.7630049473469, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 283, "custom_metrics": {"cost2_mean": -94.7989417907839, "cost2_min": -134.99040140489538, "cost1_mean": 361.589198234194, "outflow_rate_min": 325.4860739527011, "system_level_velocity_mean": 14.900661736956929, "cost1_max": 484.0051419827188, "cost1_min": 28.688023098205225, "cost2_max": -10.493958424810286, "outflow_rate_mean": 1220.2303369143353, "system_level_velocity_min": 11.663759715973194, "outflow_rate_max": 1620.370728071928, "system_level_velocity_max": 19.65947703684609}, "info": {"num_steps_trained": 12049365, "load_time_ms": 14.167, "grad_time_ms": 10564.757, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011158132925629616, "total_loss": 13.930157661437988, "vf_loss": 13.932791709899902, "policy_loss": -0.005810941569507122, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9681945443153381, "entropy": 1.4069560766220093}, "update_time_ms": 9.99, "num_steps_sampled": 12049365, "sample_time_ms": 16132.586}, "episode_len_mean": 660.99, "time_this_iter_s": 26.256038188934326, "num_metric_batches_dropped": 0, "timesteps_total": 12049365, "episodes_total": 4532, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2dd8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2ac8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1649.250420488442, "episodes_this_iter": 18, "time_total_s": 7288.941609859467, "time_since_restore": 7288.941609859467}
{"timestamp": 1557222034, "timesteps_since_restore": 12091458, "training_iteration": 284, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-40-34", "episode_reward_min": 53.57093284316544, "timesteps_this_iter": 42093, "episode_reward_mean": 1235.6262454245352, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 284, "custom_metrics": {"cost2_mean": -93.87292799637369, "cost2_min": -127.58358019590557, "cost1_mean": 359.78608162174345, "outflow_rate_min": 325.4860739527011, "system_level_velocity_mean": 14.839737737054545, "cost1_max": 484.0051419827188, "cost1_min": 28.688023098205225, "cost2_max": -10.493958424810286, "outflow_rate_mean": 1213.3043395980046, "system_level_velocity_min": 11.590772719633115, "outflow_rate_max": 1620.370728071928, "system_level_velocity_max": 19.65947703684609}, "info": {"num_steps_trained": 12091458, "load_time_ms": 14.452, "grad_time_ms": 10657.401, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010657391510903835, "total_loss": 7.619943618774414, "vf_loss": 7.6229987144470215, "policy_loss": -0.006089765578508377, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9843026399612427, "entropy": 1.4269051551818848}, "update_time_ms": 10.008, "num_steps_sampled": 12091458, "sample_time_ms": 16025.882}, "episode_len_mean": 660.99, "time_this_iter_s": 24.940479278564453, "num_metric_batches_dropped": 0, "timesteps_total": 12091458, "episodes_total": 4547, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6e48>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6780>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1649.250420488442, "episodes_this_iter": 15, "time_total_s": 7313.882089138031, "time_since_restore": 7313.882089138031}
{"timestamp": 1557222060, "timesteps_since_restore": 12134952, "training_iteration": 285, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-41-00", "episode_reward_min": 53.57093284316544, "timesteps_this_iter": 43494, "episode_reward_mean": 1217.2075223914526, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 285, "custom_metrics": {"cost2_mean": -93.30893816149074, "cost2_min": -127.58358019590557, "cost1_mean": 355.0200740439538, "outflow_rate_min": 325.4860739527011, "system_level_velocity_mean": 14.94381996629469, "cost1_max": 485.85444481331274, "cost1_min": 28.688023098205225, "cost2_max": -10.493958424810286, "outflow_rate_mean": 1202.9440185870817, "system_level_velocity_min": 11.590772719633115, "outflow_rate_max": 1620.370728071928, "system_level_velocity_max": 19.65947703684609}, "info": {"num_steps_trained": 12134952, "load_time_ms": 14.255, "grad_time_ms": 10707.607, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011139505542814732, "total_loss": 14.39452838897705, "vf_loss": 14.396749496459961, "policy_loss": -0.005391785409301519, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9690814018249512, "entropy": 1.3967432975769043}, "update_time_ms": 9.895, "num_steps_sampled": 12134952, "sample_time_ms": 15857.632}, "episode_len_mean": 650.08, "time_this_iter_s": 26.03466033935547, "num_metric_batches_dropped": 0, "timesteps_total": 12134952, "episodes_total": 4565, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb898>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf06a0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1693.2442363072034, "episodes_this_iter": 18, "time_total_s": 7339.9167494773865, "time_since_restore": 7339.9167494773865}
{"timestamp": 1557222086, "timesteps_since_restore": 12178325, "training_iteration": 286, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-41-26", "episode_reward_min": 53.57093284316544, "timesteps_this_iter": 43373, "episode_reward_mean": 1199.643058366196, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 286, "custom_metrics": {"cost2_mean": -91.85046170020836, "cost2_min": -127.58358019590557, "cost1_mean": 351.96198439483777, "outflow_rate_min": 325.4860739527011, "system_level_velocity_mean": 15.118995650147653, "cost1_max": 485.85444481331274, "cost1_min": 28.688023098205225, "cost2_max": -10.493958424810286, "outflow_rate_mean": 1198.2533946453138, "system_level_velocity_min": 11.590772719633115, "outflow_rate_max": 1670.4025666803782, "system_level_velocity_max": 19.65947703684609}, "info": {"num_steps_trained": 12178325, "load_time_ms": 13.56, "grad_time_ms": 10718.241, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011639700271189213, "total_loss": 18.09910011291504, "vf_loss": 18.10188865661621, "policy_loss": -0.006101244129240513, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9620881676673889, "entropy": 1.3573416471481323}, "update_time_ms": 9.687, "num_steps_sampled": 12178325, "sample_time_ms": 15799.022}, "episode_len_mean": 639.34, "time_this_iter_s": 26.466928005218506, "num_metric_batches_dropped": 0, "timesteps_total": 12178325, "episodes_total": 4581, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf4a8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8e10>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1706.5903817116766, "episodes_this_iter": 16, "time_total_s": 7366.383677482605, "time_since_restore": 7366.383677482605}
{"timestamp": 1557222112, "timesteps_since_restore": 12222336, "training_iteration": 287, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-41-52", "episode_reward_min": 53.57093284316544, "timesteps_this_iter": 44011, "episode_reward_mean": 1195.1382640698027, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 287, "custom_metrics": {"cost2_mean": -91.78932720445357, "cost2_min": -127.50445339527695, "cost1_mean": 352.7992555329984, "outflow_rate_min": 325.4860739527011, "system_level_velocity_mean": 15.17338497206639, "cost1_max": 485.85444481331274, "cost1_min": 28.688023098205225, "cost2_max": -10.493958424810286, "outflow_rate_mean": 1198.5459798678905, "system_level_velocity_min": 11.590772719633115, "outflow_rate_max": 1670.4025666803782, "system_level_velocity_max": 19.65947703684609}, "info": {"num_steps_trained": 12222336, "load_time_ms": 13.618, "grad_time_ms": 10675.759, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.009605243802070618, "total_loss": 9.065330505371094, "vf_loss": 9.067497253417969, "policy_loss": -0.004901591222733259, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9762420058250427, "entropy": 1.4287292957305908}, "update_time_ms": 9.833, "num_steps_sampled": 12222336, "sample_time_ms": 15699.111}, "episode_len_mean": 638.75, "time_this_iter_s": 26.05932378768921, "num_metric_batches_dropped": 0, "timesteps_total": 12222336, "episodes_total": 4597, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce85c0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8cf8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1706.5903817116766, "episodes_this_iter": 16, "time_total_s": 7392.443001270294, "time_since_restore": 7392.443001270294}
{"timestamp": 1557222138, "timesteps_since_restore": 12268437, "training_iteration": 288, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-42-18", "episode_reward_min": 53.57093284316544, "timesteps_this_iter": 46101, "episode_reward_mean": 1209.7321615679357, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 288, "custom_metrics": {"cost2_mean": -93.90048421490584, "cost2_min": -134.73664758602615, "cost1_mean": 356.6821313530088, "outflow_rate_min": 325.4860739527011, "system_level_velocity_mean": 15.137673986247721, "cost1_max": 485.85444481331274, "cost1_min": 28.688023098205225, "cost2_max": -10.493958424810286, "outflow_rate_mean": 1212.5676023692338, "system_level_velocity_min": 11.590772719633115, "outflow_rate_max": 1670.4025666803782, "system_level_velocity_max": 19.200357116920195}, "info": {"num_steps_trained": 12268437, "load_time_ms": 14.059, "grad_time_ms": 10711.409, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011180710978806019, "total_loss": 7.926048278808594, "vf_loss": 7.927818298339844, "policy_loss": -0.0049535962752997875, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9780266880989075, "entropy": 1.3930058479309082}, "update_time_ms": 9.826, "num_steps_sampled": 12268437, "sample_time_ms": 15818.12}, "episode_len_mean": 645.32, "time_this_iter_s": 26.077052116394043, "num_metric_batches_dropped": 0, "timesteps_total": 12268437, "episodes_total": 4610, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6358>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd69b0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1706.5903817116766, "episodes_this_iter": 13, "time_total_s": 7418.520053386688, "time_since_restore": 7418.520053386688}
{"timestamp": 1557222167, "timesteps_since_restore": 12313548, "training_iteration": 289, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-42-47", "episode_reward_min": 55.670015596210135, "timesteps_this_iter": 45111, "episode_reward_mean": 1231.9666093824471, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 289, "custom_metrics": {"cost2_mean": -97.35512779793082, "cost2_min": -146.46367871738744, "cost1_mean": 360.08060686814883, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.877019389347426, "cost1_max": 485.85444481331274, "cost1_min": 29.756191947164723, "cost2_max": -10.168005293181754, "outflow_rate_mean": 1215.4083806677074, "system_level_velocity_min": 11.590772719633115, "outflow_rate_max": 1670.4025666803782, "system_level_velocity_max": 19.200357116920195}, "info": {"num_steps_trained": 12313548, "load_time_ms": 13.609, "grad_time_ms": 10811.817, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011290687136352062, "total_loss": 12.69046688079834, "vf_loss": 12.694350242614746, "policy_loss": -0.007098543457686901, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9686747193336487, "entropy": 1.418247938156128}, "update_time_ms": 9.693, "num_steps_sampled": 12313548, "sample_time_ms": 15925.096}, "episode_len_mean": 660.6, "time_this_iter_s": 28.480857849121094, "num_metric_batches_dropped": 0, "timesteps_total": 12313548, "episodes_total": 4627, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfda58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdc88>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1706.5903817116766, "episodes_this_iter": 17, "time_total_s": 7447.000911235809, "time_since_restore": 7447.000911235809}
{"timestamp": 1557222194, "timesteps_since_restore": 12357612, "training_iteration": 290, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-43-14", "episode_reward_min": 55.670015596210135, "timesteps_this_iter": 44064, "episode_reward_mean": 1227.5486202668626, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 290, "custom_metrics": {"cost2_mean": -98.8861283493752, "cost2_min": -146.46367871738744, "cost1_mean": 356.17894181475873, "outflow_rate_min": 326.59605400460765, "system_level_velocity_mean": 14.903016214077944, "cost1_max": 485.85444481331274, "cost1_min": 29.756191947164723, "cost2_max": -10.168005293181754, "outflow_rate_mean": 1205.3505221659716, "system_level_velocity_min": 11.61302526493101, "outflow_rate_max": 1670.4025666803782, "system_level_velocity_max": 19.30690807477129}, "info": {"num_steps_trained": 12357612, "load_time_ms": 13.797, "grad_time_ms": 10846.507, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01121243741363287, "total_loss": 10.149975776672363, "vf_loss": 10.153921127319336, "policy_loss": -0.007137740962207317, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9739059805870056, "entropy": 1.4267916679382324}, "update_time_ms": 9.712, "num_steps_sampled": 12357612, "sample_time_ms": 15875.829}, "episode_len_mean": 654.07, "time_this_iter_s": 27.01115369796753, "num_metric_batches_dropped": 0, "timesteps_total": 12357612, "episodes_total": 4644, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd62e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd6cc0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1706.5903817116766, "episodes_this_iter": 17, "time_total_s": 7474.012064933777, "time_since_restore": 7474.012064933777}
{"timestamp": 1557222221, "timesteps_since_restore": 12402063, "training_iteration": 291, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-43-41", "episode_reward_min": 55.670015596210135, "timesteps_this_iter": 44451, "episode_reward_mean": 1240.2936540419068, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 291, "custom_metrics": {"cost2_mean": -101.00428171742288, "cost2_min": -146.46367871738744, "cost1_mean": 359.86250465480225, "outflow_rate_min": 326.59605400460765, "system_level_velocity_mean": 14.907032552648607, "cost1_max": 485.85444481331274, "cost1_min": 29.756191947164723, "cost2_max": -10.168005293181754, "outflow_rate_mean": 1216.2111142861056, "system_level_velocity_min": 12.073242767826072, "outflow_rate_max": 1670.4025666803782, "system_level_velocity_max": 19.30690807477129}, "info": {"num_steps_trained": 12402063, "load_time_ms": 13.692, "grad_time_ms": 10755.49, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012009013444185257, "total_loss": 8.703890800476074, "vf_loss": 8.705967903137207, "policy_loss": -0.005496962461620569, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9798763394355774, "entropy": 1.3751860857009888}, "update_time_ms": 9.624, "num_steps_sampled": 12402063, "sample_time_ms": 15696.215}, "episode_len_mean": 659.16, "time_this_iter_s": 26.461905002593994, "num_metric_batches_dropped": 0, "timesteps_total": 12402063, "episodes_total": 4658, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf780>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf09e8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1706.5903817116766, "episodes_this_iter": 14, "time_total_s": 7500.473969936371, "time_since_restore": 7500.473969936371}
{"timestamp": 1557222247, "timesteps_since_restore": 12446295, "training_iteration": 292, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-44-07", "episode_reward_min": 55.670015596210135, "timesteps_this_iter": 44232, "episode_reward_mean": 1249.190464493413, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 292, "custom_metrics": {"cost2_mean": -103.54695963995653, "cost2_min": -146.46367871738744, "cost1_mean": 360.3684757239714, "outflow_rate_min": 326.59605400460765, "system_level_velocity_mean": 14.78318275696266, "cost1_max": 474.3307269424768, "cost1_min": 29.756191947164723, "cost2_max": -10.168005293181754, "outflow_rate_mean": 1219.6698242681562, "system_level_velocity_min": 11.287701939184979, "outflow_rate_max": 1670.4025666803782, "system_level_velocity_max": 19.30690807477129}, "info": {"num_steps_trained": 12446295, "load_time_ms": 13.201, "grad_time_ms": 10608.53, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012409377843141556, "total_loss": 7.864893436431885, "vf_loss": 7.86777925491333, "policy_loss": -0.006420482881367207, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9800453186035156, "entropy": 1.4162243604660034}, "update_time_ms": 9.298, "num_steps_sampled": 12446295, "sample_time_ms": 15659.223}, "episode_len_mean": 664.98, "time_this_iter_s": 26.17169427871704, "num_metric_batches_dropped": 0, "timesteps_total": 12446295, "episodes_total": 4672, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfda58>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd550>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1706.5903817116766, "episodes_this_iter": 14, "time_total_s": 7526.645664215088, "time_since_restore": 7526.645664215088}
{"timestamp": 1557222275, "timesteps_since_restore": 12492867, "training_iteration": 293, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-44-35", "episode_reward_min": 55.670015596210135, "timesteps_this_iter": 46572, "episode_reward_mean": 1252.745707388317, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 293, "custom_metrics": {"cost2_mean": -105.1117385371278, "cost2_min": -146.46367871738744, "cost1_mean": 359.88628718029474, "outflow_rate_min": 326.59605400460765, "system_level_velocity_mean": 14.616252337991817, "cost1_max": 489.6091623128067, "cost1_min": 29.756191947164723, "cost2_max": -10.168005293181754, "outflow_rate_mean": 1214.3493706781562, "system_level_velocity_min": 11.287701939184979, "outflow_rate_max": 1696.280272927073, "system_level_velocity_max": 19.30690807477129}, "info": {"num_steps_trained": 12492867, "load_time_ms": 13.433, "grad_time_ms": 10553.877, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012763329781591892, "total_loss": 10.008340835571289, "vf_loss": 10.009804725646973, "policy_loss": -0.005098264664411545, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9741264581680298, "entropy": 1.410023808479309}, "update_time_ms": 9.311, "num_steps_sampled": 12492867, "sample_time_ms": 15923.524}, "episode_len_mean": 670.31, "time_this_iter_s": 28.34060764312744, "num_metric_batches_dropped": 0, "timesteps_total": 12492867, "episodes_total": 4686, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fce8208>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1651.2898577846017, "episodes_this_iter": 14, "time_total_s": 7554.986271858215, "time_since_restore": 7554.986271858215}
{"timestamp": 1557222302, "timesteps_since_restore": 12536977, "training_iteration": 294, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-45-02", "episode_reward_min": 55.670015596210135, "timesteps_this_iter": 44110, "episode_reward_mean": 1260.2793027915586, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 294, "custom_metrics": {"cost2_mean": -106.71782062770255, "cost2_min": -147.07856282552996, "cost1_mean": 362.33032841850036, "outflow_rate_min": 326.59605400460765, "system_level_velocity_mean": 14.553649200413991, "cost1_max": 492.3630839899215, "cost1_min": 29.756191947164723, "cost2_max": -10.168005293181754, "outflow_rate_mean": 1219.0800374217977, "system_level_velocity_min": 11.287701939184979, "outflow_rate_max": 1696.280272927073, "system_level_velocity_max": 19.30690807477129}, "info": {"num_steps_trained": 12536977, "load_time_ms": 13.59, "grad_time_ms": 10565.882, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011232500895857811, "total_loss": 9.056153297424316, "vf_loss": 9.059273719787598, "policy_loss": -0.006318556610494852, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9801309108734131, "entropy": 1.4141688346862793}, "update_time_ms": 9.115, "num_steps_sampled": 12536977, "sample_time_ms": 16074.714}, "episode_len_mean": 676.04, "time_this_iter_s": 26.5543794631958, "num_metric_batches_dropped": 0, "timesteps_total": 12536977, "episodes_total": 4702, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf1d0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf780>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1651.2898577846017, "episodes_this_iter": 16, "time_total_s": 7581.540651321411, "time_since_restore": 7581.540651321411}
{"timestamp": 1557222328, "timesteps_since_restore": 12580436, "training_iteration": 295, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-45-28", "episode_reward_min": 65.09707195341535, "timesteps_this_iter": 43459, "episode_reward_mean": 1285.773425125585, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 295, "custom_metrics": {"cost2_mean": -107.32788074708307, "cost2_min": -147.07856282552996, "cost1_mean": 368.1702246471281, "outflow_rate_min": 326.59605400460765, "system_level_velocity_mean": 14.459563556456619, "cost1_max": 492.3630839899215, "cost1_min": 31.72154980723604, "cost2_max": -16.749283132106104, "outflow_rate_mean": 1227.0674602848842, "system_level_velocity_min": 11.287701939184979, "outflow_rate_max": 1696.280272927073, "system_level_velocity_max": 19.30690807477129}, "info": {"num_steps_trained": 12580436, "load_time_ms": 13.953, "grad_time_ms": 10435.654, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01151006668806076, "total_loss": 8.871816635131836, "vf_loss": 8.875659942626953, "policy_loss": -0.007119622081518173, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9793180823326111, "entropy": 1.4243121147155762}, "update_time_ms": 8.944, "num_steps_sampled": 12580436, "sample_time_ms": 16273.164}, "episode_len_mean": 688.06, "time_this_iter_s": 26.64698576927185, "num_metric_batches_dropped": 0, "timesteps_total": 12580436, "episodes_total": 4718, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd7b8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfdeb8>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1651.2898577846017, "episodes_this_iter": 16, "time_total_s": 7608.187637090683, "time_since_restore": 7608.187637090683}
{"timestamp": 1557222354, "timesteps_since_restore": 12627692, "training_iteration": 296, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-45-54", "episode_reward_min": 65.09707195341535, "timesteps_this_iter": 47256, "episode_reward_mean": 1282.9062901737468, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 296, "custom_metrics": {"cost2_mean": -105.74323717886587, "cost2_min": -147.07856282552996, "cost1_mean": 370.7614350211659, "outflow_rate_min": 326.59605400460765, "system_level_velocity_mean": 14.54692655357163, "cost1_max": 492.3630839899215, "cost1_min": 31.72154980723604, "cost2_max": -16.749283132106104, "outflow_rate_mean": 1228.6354080184449, "system_level_velocity_min": 11.287701939184979, "outflow_rate_max": 1696.280272927073, "system_level_velocity_max": 19.30690807477129}, "info": {"num_steps_trained": 12627692, "load_time_ms": 14.322, "grad_time_ms": 10382.228, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.011151084676384926, "total_loss": 7.182499408721924, "vf_loss": 7.183982849121094, "policy_loss": -0.00465964712202549, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9815210700035095, "entropy": 1.4102574586868286}, "update_time_ms": 8.66, "num_steps_sampled": 12627692, "sample_time_ms": 16275.518}, "episode_len_mean": 688.06, "time_this_iter_s": 25.949493169784546, "num_metric_batches_dropped": 0, "timesteps_total": 12627692, "episodes_total": 4730, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0940>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf0898>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1651.2898577846017, "episodes_this_iter": 12, "time_total_s": 7634.1371302604675, "time_since_restore": 7634.1371302604675}
{"timestamp": 1557222382, "timesteps_since_restore": 12671871, "training_iteration": 297, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-46-22", "episode_reward_min": 59.72883325471182, "timesteps_this_iter": 44179, "episode_reward_mean": 1274.7547307467944, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 297, "custom_metrics": {"cost2_mean": -104.57624653648497, "cost2_min": -147.07856282552996, "cost1_mean": 369.2362838828312, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.489458659594359, "cost1_max": 492.3630839899215, "cost1_min": 29.54303079855242, "cost2_max": -10.946309708633931, "outflow_rate_mean": 1222.1313374566928, "system_level_velocity_min": 11.287701939184979, "outflow_rate_max": 1696.280272927073, "system_level_velocity_max": 19.304722413591062}, "info": {"num_steps_trained": 12671871, "load_time_ms": 14.274, "grad_time_ms": 10192.015, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012059339322149754, "total_loss": 9.664280891418457, "vf_loss": 9.666927337646484, "policy_loss": -0.006080265156924725, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9795979857444763, "entropy": 1.3838157653808594}, "update_time_ms": 8.206, "num_steps_sampled": 12671871, "sample_time_ms": 16580.399}, "episode_len_mean": 688.03, "time_this_iter_s": 27.185500144958496, "num_metric_batches_dropped": 0, "timesteps_total": 12671871, "episodes_total": 4745, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2cf8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcd2940>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1651.2898577846017, "episodes_this_iter": 15, "time_total_s": 7661.322630405426, "time_since_restore": 7661.322630405426}
{"timestamp": 1557222408, "timesteps_since_restore": 12715811, "training_iteration": 298, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-46-48", "episode_reward_min": 59.72883325471182, "timesteps_this_iter": 43940, "episode_reward_mean": 1260.811337618314, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 298, "custom_metrics": {"cost2_mean": -101.94559378896565, "cost2_min": -147.07856282552996, "cost1_mean": 364.9271177137245, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.459840435648255, "cost1_max": 492.3630839899215, "cost1_min": 29.54303079855242, "cost2_max": -10.946309708633931, "outflow_rate_mean": 1206.8786049273704, "system_level_velocity_min": 10.938193097092446, "outflow_rate_max": 1696.280272927073, "system_level_velocity_max": 19.304722413591062}, "info": {"num_steps_trained": 12715811, "load_time_ms": 14.135, "grad_time_ms": 9998.933, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.01304484810680151, "total_loss": 11.752384185791016, "vf_loss": 11.75501823425293, "policy_loss": -0.006349104922264814, "cur_kl_coeff": 0.2847656309604645, "vf_explained_var": 0.9753479957580566, "entropy": 1.42721688747406}, "update_time_ms": 7.965, "num_steps_sampled": 12715811, "sample_time_ms": 16780.235}, "episode_len_mean": 682.47, "time_this_iter_s": 26.098881244659424, "num_metric_batches_dropped": 0, "timesteps_total": 12715811, "episodes_total": 4763, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf860>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcf09e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcdf940>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1595.428276347267, "episodes_this_iter": 18, "time_total_s": 7687.421511650085, "time_since_restore": 7687.421511650085}
{"timestamp": 1557222435, "timesteps_since_restore": 12760937, "training_iteration": 299, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-47-15", "episode_reward_min": 59.72883325471182, "timesteps_this_iter": 45126, "episode_reward_mean": 1258.8357596939718, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 299, "custom_metrics": {"cost2_mean": -101.76516408247868, "cost2_min": -147.07856282552996, "cost1_mean": 364.9119388072475, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.43849031335419, "cost1_max": 492.3630839899215, "cost1_min": 29.54303079855242, "cost2_max": -10.946309708633931, "outflow_rate_mean": 1207.8912147543667, "system_level_velocity_min": 10.938193097092446, "outflow_rate_max": 1696.280272927073, "system_level_velocity_max": 19.304722413591062}, "info": {"num_steps_trained": 12760937, "load_time_ms": 14.316, "grad_time_ms": 9842.965, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.012875813990831375, "total_loss": 5.850306510925293, "vf_loss": 5.853835582733154, "policy_loss": -0.007195479702204466, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9856776595115662, "entropy": 1.492827296257019}, "update_time_ms": 7.644, "num_steps_sampled": 12760937, "sample_time_ms": 16806.497}, "episode_len_mean": 682.47, "time_this_iter_s": 27.18379521369934, "num_metric_batches_dropped": 0, "timesteps_total": 12760937, "episodes_total": 4778, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd2e8>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fcfd6a0>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": false, "episode_reward_max": 1595.428276347267, "episodes_this_iter": 15, "time_total_s": 7714.605306863785, "time_since_restore": 7714.605306863785}
{"timestamp": 1557222461, "timesteps_since_restore": 12805814, "training_iteration": 300, "node_ip": "10.138.0.2", "pid": 27116, "date": "2019-05-07_09-47-41", "episode_reward_min": 59.72883325471182, "timesteps_this_iter": 44877, "episode_reward_mean": 1253.0166854089853, "experiment_id": "a510f5f34dfd4f2880b6b7d4b0c5a671", "policy_reward_mean": {}, "iterations_since_restore": 300, "custom_metrics": {"cost2_mean": -99.88202860423364, "cost2_min": -129.43486910035682, "cost1_mean": 364.32786928752927, "outflow_rate_min": 327.3926328531922, "system_level_velocity_mean": 14.443128102227886, "cost1_max": 491.9114763247034, "cost1_min": 29.54303079855242, "cost2_max": -10.946309708633931, "outflow_rate_mean": 1203.5975318659341, "system_level_velocity_min": 10.938193097092446, "outflow_rate_max": 1636.6119295763062, "system_level_velocity_max": 19.304722413591062}, "info": {"num_steps_trained": 12805814, "load_time_ms": 14.334, "grad_time_ms": 9716.801, "default": {"cur_lr": 0.0005000000237487257, "kl": 0.010991574265062809, "total_loss": 8.084635734558105, "vf_loss": 8.088022232055664, "policy_loss": -0.006515673361718655, "cur_kl_coeff": 0.28476566076278687, "vf_explained_var": 0.9814167022705078, "entropy": 1.4302568435668945}, "update_time_ms": 7.473, "num_steps_sampled": 12805814, "sample_time_ms": 16884.553}, "episode_len_mean": 681.41, "time_this_iter_s": 26.514461517333984, "num_metric_batches_dropped": 0, "timesteps_total": 12805814, "episodes_total": 4792, "hostname": "flow-main", "config": {"custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "sgd_minibatch_size": 128, "train_batch_size": 30000, "log_level": "INFO", "num_workers": 20, "num_sgd_iter": 10, "lr": 0.0005, "monitor": false, "lr_schedule": null, "num_cpus_for_driver": 1, "input": "sampler", "straggler_mitigation": false, "kl_coeff": 0.2, "sample_async": false, "lambda": 0.97, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "input_evaluation": null, "vf_share_layers": false, "model": {"lstm_use_prev_action_reward": false, "conv_activation": "relu", "fcnet_activation": "tanh", "dim": 84, "fcnet_hiddens": [100, 50, 25], "custom_model": null, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "squash_to_range": false, "conv_filters": null, "zero_mean": true, "grayscale": false, "max_seq_len": 20, "free_log_std": false, "custom_preprocessor": null, "custom_options": {}, "use_lstm": false}, "clip_param": 0.3, "compress_observations": false, "synchronize_filters": true, "num_cpus_per_worker": 1, "vf_clip_param": 1000000.0, "vf_loss_coeff": 1.0, "output": null, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "batch_mode": "truncate_episodes", "simple_optimizer": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "clip_rewards": null, "clip_actions": false, "kl_target": 0.01, "observation_filter": "NoFilter", "use_gae": true, "entropy_coeff": 0.0, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccb6a0>", "on_sample_end": null, "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f945fccbb38>"}, "gamma": 0.99, "horizon": 1500, "optimizer": {}, "num_gpus_per_worker": 0, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_gpus": 0, "output_max_file_size": 67108864, "num_envs_per_worker": 1, "preprocessor_pref": "deepmind", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}}}, "done": true, "episode_reward_max": 1595.428276347267, "episodes_this_iter": 14, "time_total_s": 7741.119768381119, "time_since_restore": 7741.119768381119}
